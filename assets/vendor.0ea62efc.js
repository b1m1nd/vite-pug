var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,i=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,o=(e,o)=>{for(var a in o||(o={}))t.call(o,a)&&i(e,a,o[a]);if(r)for(var a of r(o))n.call(o,a)&&i(e,a,o[a]);return e},a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})})),t}function u(e){var t={exports:{}};return e(t,t.exports),t.exports}var c,l=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:{}}),f=new Uint8Array(16);function h(){if(!c&&!(c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(f)}var p=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function d(e){return"string"==typeof e&&p.test(e)}for(var g,y,v=[],m=0;m<256;++m)v.push((m+256).toString(16).substr(1));function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase();if(!d(r))throw TypeError("Stringified UUID is invalid");return r}var E=0,S=0;function w(e){if(!d(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}function _(e,t,r){function n(e,n,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=w(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(n),a.set(e,n.length),(a=r(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(var s=0;s<16;++s)i[o+s]=a[s];return i}return b(a)}try{n.name=e}catch(i){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function C(e){return 14+(e+64>>>9<<4)+1}function A(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function I(e,t,r,n,i,o){return A((a=A(A(t,e),A(n,o)))<<(s=i)|a>>>32-s,r);var a,s}function T(e,t,r,n,i,o,a){return I(t&r|~t&n,e,t,i,o,a)}function P(e,t,r,n,i,o,a){return I(t&n|r&~n,e,t,i,o,a)}function F(e,t,r,n,i,o,a){return I(t^r^n,e,t,i,o,a)}function k(e,t,r,n,i,o,a){return I(r^(t|~n),e,t,i,o,a)}var R=_("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n="0123456789abcdef",i=0;i<r;i+=8){var o=e[i>>5]>>>i%32&255,a=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);t.push(a)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[C(t)-1]=t;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,a=0;a<e.length;a+=16){var s=r,u=n,c=i,l=o;r=T(r,n,i,o,e[a],7,-680876936),o=T(o,r,n,i,e[a+1],12,-389564586),i=T(i,o,r,n,e[a+2],17,606105819),n=T(n,i,o,r,e[a+3],22,-1044525330),r=T(r,n,i,o,e[a+4],7,-176418897),o=T(o,r,n,i,e[a+5],12,1200080426),i=T(i,o,r,n,e[a+6],17,-1473231341),n=T(n,i,o,r,e[a+7],22,-45705983),r=T(r,n,i,o,e[a+8],7,1770035416),o=T(o,r,n,i,e[a+9],12,-1958414417),i=T(i,o,r,n,e[a+10],17,-42063),n=T(n,i,o,r,e[a+11],22,-1990404162),r=T(r,n,i,o,e[a+12],7,1804603682),o=T(o,r,n,i,e[a+13],12,-40341101),i=T(i,o,r,n,e[a+14],17,-1502002290),r=P(r,n=T(n,i,o,r,e[a+15],22,1236535329),i,o,e[a+1],5,-165796510),o=P(o,r,n,i,e[a+6],9,-1069501632),i=P(i,o,r,n,e[a+11],14,643717713),n=P(n,i,o,r,e[a],20,-373897302),r=P(r,n,i,o,e[a+5],5,-701558691),o=P(o,r,n,i,e[a+10],9,38016083),i=P(i,o,r,n,e[a+15],14,-660478335),n=P(n,i,o,r,e[a+4],20,-405537848),r=P(r,n,i,o,e[a+9],5,568446438),o=P(o,r,n,i,e[a+14],9,-1019803690),i=P(i,o,r,n,e[a+3],14,-187363961),n=P(n,i,o,r,e[a+8],20,1163531501),r=P(r,n,i,o,e[a+13],5,-1444681467),o=P(o,r,n,i,e[a+2],9,-51403784),i=P(i,o,r,n,e[a+7],14,1735328473),r=F(r,n=P(n,i,o,r,e[a+12],20,-1926607734),i,o,e[a+5],4,-378558),o=F(o,r,n,i,e[a+8],11,-2022574463),i=F(i,o,r,n,e[a+11],16,1839030562),n=F(n,i,o,r,e[a+14],23,-35309556),r=F(r,n,i,o,e[a+1],4,-1530992060),o=F(o,r,n,i,e[a+4],11,1272893353),i=F(i,o,r,n,e[a+7],16,-155497632),n=F(n,i,o,r,e[a+10],23,-1094730640),r=F(r,n,i,o,e[a+13],4,681279174),o=F(o,r,n,i,e[a],11,-358537222),i=F(i,o,r,n,e[a+3],16,-722521979),n=F(n,i,o,r,e[a+6],23,76029189),r=F(r,n,i,o,e[a+9],4,-640364487),o=F(o,r,n,i,e[a+12],11,-421815835),i=F(i,o,r,n,e[a+15],16,530742520),r=k(r,n=F(n,i,o,r,e[a+2],23,-995338651),i,o,e[a],6,-198630844),o=k(o,r,n,i,e[a+7],10,1126891415),i=k(i,o,r,n,e[a+14],15,-1416354905),n=k(n,i,o,r,e[a+5],21,-57434055),r=k(r,n,i,o,e[a+12],6,1700485571),o=k(o,r,n,i,e[a+3],10,-1894986606),i=k(i,o,r,n,e[a+10],15,-1051523),n=k(n,i,o,r,e[a+1],21,-2054922799),r=k(r,n,i,o,e[a+8],6,1873313359),o=k(o,r,n,i,e[a+15],10,-30611744),i=k(i,o,r,n,e[a+6],15,-1560198380),n=k(n,i,o,r,e[a+13],21,1309151649),r=k(r,n,i,o,e[a+4],6,-145523070),o=k(o,r,n,i,e[a+11],10,-1120210379),i=k(i,o,r,n,e[a+2],15,718787259),n=k(n,i,o,r,e[a+9],21,-343485551),r=A(r,s),n=A(n,u),i=A(i,c),o=A(o,l)}return[r,n,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(C(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))}));function B(e,t,r){var n=(e=e||{}).random||(e.rng||h)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return b(n)}function O(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function x(e,t){return e<<t|e>>>32-t}var N=_("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var i=0;i<n.length;++i)e.push(n.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,a=Math.ceil(o/16),s=new Array(a),u=0;u<a;++u){for(var c=new Uint32Array(16),l=0;l<16;++l)c[l]=e[64*u+4*l]<<24|e[64*u+4*l+1]<<16|e[64*u+4*l+2]<<8|e[64*u+4*l+3];s[u]=c}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var f=0;f<a;++f){for(var h=new Uint32Array(80),p=0;p<16;++p)h[p]=s[f][p];for(var d=16;d<80;++d)h[d]=x(h[d-3]^h[d-8]^h[d-14]^h[d-16],1);for(var g=r[0],y=r[1],v=r[2],m=r[3],b=r[4],E=0;E<80;++E){var S=Math.floor(E/20),w=x(g,5)+O(S,y,v,m)+b+t[S]+h[E]>>>0;b=m,m=v,v=x(y,30)>>>0,y=g,g=w}r[0]=r[0]+g>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+v>>>0,r[3]=r[3]+m>>>0,r[4]=r[4]+b>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}));var U,j,D,L,M=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",v1:function(e,t,r){var n=t&&r||0,i=t||new Array(16),o=(e=e||{}).node||g,a=void 0!==e.clockseq?e.clockseq:y;if(null==o||null==a){var s=e.random||(e.rng||h)();null==o&&(o=g=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=y=16383&(s[6]<<8|s[7]))}var u=void 0!==e.msecs?e.msecs:Date.now(),c=void 0!==e.nsecs?e.nsecs:S+1,l=u-E+(c-S)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||u>E)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");E=u,S=c,y=a;var f=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=255&f;var p=u/4294967296*1e4&268435455;i[n++]=p>>>8&255,i[n++]=255&p,i[n++]=p>>>24&15|16,i[n++]=p>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var d=0;d<6;++d)i[n+d]=o[d];return t||b(i)},v3:R,v4:B,v5:N,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!d(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)},validate:d,stringify:b,parse:w});
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */j=U||(U={}),function(e){var t="object"==typeof a?a:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=n(j);function n(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0===t.Reflect?t.Reflect=j:r=n(t.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,u={create:o?function(){return ne(Object.create(null))}:a?function(){return ne({__proto__:null})}:function(){return ne({})},has:s?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:s?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,p=new(l||"function"!=typeof WeakMap?re():WeakMap);function d(e,t,r,n){if(N(r)){if(!q(e))throw new TypeError;if(!$(t))throw new TypeError;return C(e,t)}if(!q(e))throw new TypeError;if(!D(t))throw new TypeError;if(!D(n)&&!N(n)&&!U(n))throw new TypeError;return U(n)&&(n=void 0),A(e,t,r=H(r),n)}function g(e,t){function r(r,n){if(!D(r))throw new TypeError;if(!N(n)&&!G(n))throw new TypeError;R(e,t,r,n)}return r}function y(e,t,r,n){if(!D(r))throw new TypeError;return N(n)||(n=H(n)),R(e,t,r,n)}function v(e,t,r){if(!D(t))throw new TypeError;return N(r)||(r=H(r)),T(e,t,r)}function m(e,t,r){if(!D(t))throw new TypeError;return N(r)||(r=H(r)),P(e,t,r)}function b(e,t,r){if(!D(t))throw new TypeError;return N(r)||(r=H(r)),F(e,t,r)}function E(e,t,r){if(!D(t))throw new TypeError;return N(r)||(r=H(r)),k(e,t,r)}function S(e,t){if(!D(e))throw new TypeError;return N(t)||(t=H(t)),B(e,t)}function w(e,t){if(!D(e))throw new TypeError;return N(t)||(t=H(t)),O(e,t)}function _(e,t,r){if(!D(t))throw new TypeError;N(r)||(r=H(r));var n=I(t,r,!1);if(N(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var i=p.get(t);return i.delete(r),i.size>0||p.delete(t),!0}function C(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!N(n)&&!U(n)){if(!$(n))throw new TypeError;t=n}}return t}function A(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,r,n);if(!N(o)&&!U(o)){if(!D(o))throw new TypeError;n=o}}return n}function I(e,t,r){var n=p.get(e);if(N(n)){if(!r)return;n=new f,p.set(e,n)}var i=n.get(t);if(N(i)){if(!r)return;i=new f,n.set(t,i)}return i}function T(e,t,r){if(P(e,t,r))return!0;var n=Z(t);return!U(n)&&T(e,n,r)}function P(e,t,r){var n=I(t,r,!1);return!N(n)&&K(n.has(e))}function F(e,t,r){if(P(e,t,r))return k(e,t,r);var n=Z(t);return U(n)?void 0:F(e,n,r)}function k(e,t,r){var n=I(t,r,!1);if(!N(n))return n.get(e)}function R(e,t,r,n){I(r,n,!0).set(e,t)}function B(e,t){var r=O(e,t),n=Z(e);if(null===n)return r;var i=B(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var o=new h,a=[],s=0,u=r;s<u.length;s++){var c=u[s];o.has(c)||(o.add(c),a.push(c))}for(var l=0,f=i;l<f.length;l++)c=f[l],o.has(c)||(o.add(c),a.push(c));return a}function O(e,t){var r=[],n=I(e,t,!1);if(N(n))return r;for(var i=J(n.keys()),o=0;;){var a=Y(i);if(!a)return r.length=o,r;var s=Q(a);try{r[o]=s}catch(u){try{X(i)}finally{throw u}}o++}}function x(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function N(e){return void 0===e}function U(e){return null===e}function j(e){return"symbol"==typeof e}function D(e){return"object"==typeof e?null!==e:"function"==typeof e}function L(e,t){switch(x(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=W(e,n);if(void 0!==i){var o=i.call(e,r);if(D(o))throw new TypeError;return o}return M(e,"default"===r?"number":r)}function M(e,t){if("string"===t){var r=e.toString;if(z(r)&&!D(i=r.call(e)))return i;if(z(n=e.valueOf)&&!D(i=n.call(e)))return i}else{var n;if(z(n=e.valueOf)&&!D(i=n.call(e)))return i;var i,o=e.toString;if(z(o)&&!D(i=o.call(e)))return i}throw new TypeError}function K(e){return!!e}function V(e){return""+e}function H(e){var t=L(e,3);return j(t)?t:V(t)}function q(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function z(e){return"function"==typeof e}function $(e){return"function"==typeof e}function G(e){switch(x(e)){case 3:case 4:return!0;default:return!1}}function W(e,t){var r=e[t];if(null!=r){if(!z(r))throw new TypeError;return r}}function J(e){var t=W(e,i);if(!z(t))throw new TypeError;var r=t.call(e);if(!D(r))throw new TypeError;return r}function Q(e){return e.value}function Y(e){var t=e.next();return!t.done&&t}function X(e){var t=e.return;t&&t.call(e)}function Z(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,o)},t.prototype.entries=function(){return new r(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=u.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+c()}while(u.has(r,e));return r[e]=!0,e}function o(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:u.create()})}return e[n]}function a(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",d),e("metadata",g),e("defineMetadata",y),e("hasMetadata",v),e("hasOwnMetadata",m),e("getMetadata",b),e("getOwnMetadata",E),e("getMetadataKeys",S),e("getOwnMetadataKeys",w),e("deleteMetadata",_)}(r)}(),(L=D||(D={}))[L.Transient=0]="Transient",L[L.Singleton=1]="Singleton",L[L.ResolutionScoped=2]="ResolutionScoped",L[L.ContainerScoped=3]="ContainerScoped";var K=D,V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function H(e,t){function r(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function q(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function z(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function $(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(z(arguments[t]));return e}function G(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata("injectionTokens",e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}function W(e,t){return function(r,n,i){var o=Reflect.getOwnMetadata("injectionTokens",r)||{};o[i]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata("injectionTokens",o,r)}}function J(e){return!!e.useClass}function Q(e){return!!e.useFactory}var Y=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct"]}return e.prototype.createProxy=function(e){var t,r=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(r.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t[0]=e();var i=Reflect[r];return i.apply(void 0,$(t))}})),t},e}();function X(e){return"string"==typeof e||"symbol"==typeof e}function Z(e){return"object"==typeof e&&"token"in e&&"multiple"in e}function ee(e){return"object"==typeof e&&"token"in e&&"transform"in e}function te(e){return!!e.useToken}function re(e){return null!=e.useValue}var ne=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return H(t,e),t}(ne),oe=function(){this.scopedResolutions=new Map};function ae(e,t,r){var n,i,o=z(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],a=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===o?null:o,t);return n="Cannot inject the dependency "+a+' of "'+e.name+'" constructor. Reason:',void 0===i&&(i="    "),$([n],r.message.split("\n").map((function(e){return i+e}))).join("\n")}var se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return H(t,e),t}(ne),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return H(t,e),t}(ne),ce=function(){this.preResolution=new se,this.postResolution=new ue},le=new Map,fe=new(function(){function e(e){this.parent=e,this._registry=new ie,this.interceptors=new ce}return e.prototype.register=function(e,t,r){var n;if(void 0===r&&(r={lifecycle:K.Transient}),n=function(e){return J(e)||re(e)||te(e)||Q(e)}(t)?t:{useClass:t},te(n))for(var i=[e],o=n;null!=o;){var a=o.useToken;if(i.includes(a))throw new Error("Token registration cycle detected! "+$(i,[a]).join(" -> "));i.push(a);var s=this._registry.get(a);o=s&&te(s.provider)?s.provider:null}if((r.lifecycle===K.Singleton||r.lifecycle==K.ContainerScoped||r.lifecycle==K.ResolutionScoped)&&(re(n)||Q(n)))throw new Error('Cannot use lifecycle "'+K[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:r}),this},e.prototype.registerType=function(e,t){return X(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(X(e)){if(X(t))return this.register(e,{useToken:t},{lifecycle:K.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:K.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!X(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:K.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new oe);var r=this.getRegistration(e);if(!r&&X(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var n=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(function(e){return"function"==typeof e||e instanceof Y}(e)){n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var o=q(this.interceptors.preResolution.getAll(e)),a=o.next();!a.done;a=o.next()){var s=a.value;"Once"!=s.options.frequency&&i.push(s),s.callback(e,t)}}catch(u){r={error:u}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,i;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var a=q(this.interceptors.postResolution.getAll(e)),s=a.next();!s.done;s=a.next()){var u=s.value;"Once"!=u.options.frequency&&o.push(u),u.callback(e,t,r)}}catch(c){n={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(e.options.lifecycle===K.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,n=e.options.lifecycle===K.Singleton,i=e.options.lifecycle===K.ContainerScoped,o=n||i;return r=re(e.provider)?e.provider.useValue:te(e.provider)?o?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):J(e.provider)?o?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Q(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===K.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new oe);var n=this.getAllRegistrations(e);if(!n&&X(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var i=n.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,i,"All"),i}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;try{for(var r=q(this._registry.entries()),n=r.next();!n.done;n=r.next()){var i=z(n.value,2),o=i[0],a=i[1];this._registry.setAll(o,a.filter((function(e){return!re(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(s){e={error:s}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r,n=new e(this);try{for(var i=q(this._registry.entries()),o=i.next();!o.done;o=i.next()){var a=z(o.value,2),s=a[0],u=a[1];u.some((function(e){return e.options.lifecycle===K.ContainerScoped}))&&n._registry.setAll(s,u.map((function(e){return e.options.lifecycle===K.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof Y)return e.createProxy((function(e){return r.resolve(e,t)}));var n=le.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var i=n.map(this.resolveParams(t,e));return new(e.bind.apply(e,$([void 0],i)))},e.prototype.resolveParams=function(e,t){var r=this;return function(n,i){var o,a,s;try{return Z(n)?ee(n)?n.multiple?(o=r.resolve(n.transform)).transform.apply(o,$([r.resolveAll(n.token)],n.transformArgs)):(a=r.resolve(n.transform)).transform.apply(a,$([r.resolve(n.token,e)],n.transformArgs)):n.multiple?r.resolveAll(n.token):r.resolve(n.token,e):ee(n)?(s=r.resolve(n.transform,e)).transform.apply(s,$([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(u){throw new Error(ae(t,i,u))}}},e}());function he(){return function(e){le.set(e,G(e))}}if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var pe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Lifecycle:K,delay:function(e){if(void 0===e)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new Y(e)},container:fe,autoInjectable:function(){return function(e){var t=G(e);return function(r){function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return r.apply(this,$(n.concat(t.slice(n.length).map((function(t,r){var i,o,a;try{return Z(t)?ee(t)?t.multiple?(i=fe.resolve(t.transform)).transform.apply(i,$([fe.resolveAll(t.token)],t.transformArgs)):(o=fe.resolve(t.transform)).transform.apply(o,$([fe.resolve(t.token)],t.transformArgs)):t.multiple?fe.resolveAll(t.token):fe.resolve(t.token):ee(t)?(a=fe.resolve(t.transform)).transform.apply(a,$([fe.resolve(t.token)],t.transformArgs)):fe.resolve(t)}catch(u){var s=r+n.length;throw new Error(ae(e,s,u))}})))))||this}return H(n,r),n}(e)}},inject:function(e){return W(e)},injectable:he,registry:function(e){return void 0===e&&(e=[]),function(t){return e.forEach((function(e){var t=e.token,r=e.options,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(e,["token","options"]);return fe.register(t,n,r)})),t}},singleton:function(){return function(e){he()(e),fe.registerSingleton(e)}},injectAll:function(e){return W({token:e,multiple:!0})},injectAllWithTransform:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i={token:e,multiple:!0,transform:t,transformArgs:r};return W(i)},injectWithTransform:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return W(e,{transformToken:t,args:r})},scoped:function(e,t){return function(r){he()(r),fe.register(t||r,r,{lifecycle:e})}},instanceCachingFactory:function(e){var t;return function(r){return null==t&&(t=e(r)),t}},predicateAwareClassFactory:function(e,t,r,n){var i,o;return void 0===n&&(n=!0),function(a){var s=e(a);return n&&o===s||(i=(o=s)?a.resolve(t):a.resolve(r)),i}},isClassProvider:J,isFactoryProvider:Q,isNormalToken:X,isTokenProvider:te,isValueProvider:re}),de=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SOLID_CLIENT_AUTHN_KEY_PREFIX=void 0,t.SOLID_CLIENT_AUTHN_KEY_PREFIX="solidClientAuthn:"}));class ge extends Error{constructor(e,t,r=!0){super("string"==typeof e?ge.substituteParams(e,t):ge.appendErrorIri(ge.lookupErrorIri(e,t),e,r))}httpResponse(e,t=!0){return this.message=ge.appendHttpResponseDetails(this.message,e,t),this.httpErrorResponse=e,this}hasHttpResponse(){return void 0!==this.httpErrorResponse}getHttpResponse(){return this.httpErrorResponse}getHttpStatusCode(){if(void 0===this.httpErrorResponse)throw new ge("This InruptError was not provided with a HTTP response - so we can't get its HTTP Status Code.");return this.httpErrorResponse.status}getHttpStatusText(){if(void 0===this.httpErrorResponse)throw new ge("This InruptError was not provided with a HTTP response - so we can't get its HTTP Status Text!");return this.httpErrorResponse.statusText}static determineIfVocabTerm(e){return void 0!==e.strict}static lookupErrorIri(e,t){if(ge.determineIfVocabTerm(e)){const r=void 0===t?e.message:e.messageParams(...t);return void 0===r?`Looked up error message IRI [${e.value}], but found no message value.`:r}return`Error message looked up at: [${e.value}]${void 0===t?"":`, with params [${t.toString()}]`}`}static appendHttpResponseDetails(e,t,r){return r&&void 0!==t?`${e} HTTP details: status code [${t.status}], status text [${t.statusText}].`:e}static appendErrorIri(e,t,r){return r?`${e} Error IRI: [${t.value}].`:e}static substituteParams(e,t){let r=e;if(void 0!==t){const n=e.split("{{").length-1;if(n!==t.length)throw new Error(`Setting parameters on message [${e}], but it requires [${n}] params and we received [${t.length}].`);for(let e=0;e<t.length;e+=1){const n=`{{${e}}}`;r=r.replace(n,t[e])}}return r}}var ye=ge,ve=Object.defineProperty({default:ye},"__esModule",{value:!0});const me=(a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(ve);var be=class{constructor(e){this.handleables=e}async getProperHandler(e){const t=await Promise.all(this.handleables.map((t=>t.canHandle(...e))));for(let r=0;r<t.length;r+=1)if(t[r])return this.handleables[r];return null}async canHandle(...e){return null!==await this.getProperHandler(e)}async handle(...e){const t=await this.getProperHandler(e);if(t)return t.handle(...e);throw new me.default(`[${this.constructor.name}] cannot find a suitable handler for: ${e.map((e=>{try{return JSON.stringify(e)}catch(t){return e.toString()}})).join(", ")}`)}},Ee=Object.defineProperty({default:be},"__esModule",{value:!0}),Se=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.USER_SESSION_PREFIX=void 0,t.USER_SESSION_PREFIX="solidClientAuthenticationUser"})),we=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.issuerConfigSchema=void 0;t.issuerConfigSchema={type:"object",properties:{issuer:{type:"string",format:"uri"},authorization_endpoint:{type:"string",format:"uri"},token_endpoint:{type:"string",format:"uri"},userinfo_endpoint:{type:"string",format:"uri"},jwks_uri:{type:"string",format:"uri"},registration_endpoint:{type:"string",format:"uri"},scopes_supported:{type:"array",items:{type:"string"}},response_types_supported:{type:"array",items:{type:"string",joinedStringOf:["code","id_token","token","none"]}},response_modes_supported:{type:"array",items:{type:"string",enum:["query","fragment"]},default:["query","fragment"]},grant_types_supported:{type:"array",items:{type:"string",enum:["authorization_code","implicit","client_credentials","device_code","refresh_token"]},default:["authorization_code","implicit"]},acr_values_supported:{type:"array",items:{type:"string"}},subject_types_supported:{type:"array",items:{type:"string",enum:["pairwise","public"]}},id_token_signing_alg_values_supported:{type:"array",items:{type:"string"}},id_token_encryption_alg_values_supported:{type:"array",items:{type:"string"}},id_token_encryption_enc_values_supported:{type:"array",items:{type:"string"}},userinfo_signing_alg_values_supported:{type:"array",items:{type:"string"}},userinfo_encryption_alg_values_supported:{type:"array",items:{type:"string"}},userinfo_encryption_enc_values_supported:{type:"array",items:{type:"string"}},request_object_signing_alg_values_supported:{type:"array",items:{type:"string"}},request_object_encryption_alg_values_supported:{type:"array",items:{type:"string"}},request_object_encryption_enc_values_supported:{type:"array",items:{type:"string"}},token_endpoint_auth_methods_supported:{type:"array",items:{type:"string"}},token_endpoint_auth_signing_alg_values_supported:{type:"array",items:{type:"string"}},display_values_supported:{type:"array",items:{type:"string"}},claim_types_supported:{type:"array",items:{type:"string"}},claims_supported:{type:"array",items:{type:"string"}},service_documentation:{type:"array",items:{type:"string"}},claims_locales_supported:{type:"array",items:{type:"string"}},ui_locales_supported:{type:"array",items:{type:"string"}},claims_parameter_supported:{type:"boolean"},request_parameter_supported:{type:"boolean"},request_uri_parameter_supported:{type:"boolean"},require_request_uri_registration:{type:"boolean"},op_policy_uri:{type:"string",format:"uri"},op_tos_uri:{type:"string",format:"uri"}},additionalProperties:!0}})),_e=u((function(e,t){!function(e){function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,i=1;i<n;++i)t[i]=t[i].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function o(e){return null!=e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function a(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}function s(e){var n="[A-Za-z]",i="[0-9]",o=t(i,"[A-Fa-f]"),a=r(r("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+r("%[89A-Fa-f]"+o+"%"+o+o)+"|"+r("%"+o+o)),s="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",u=t("[\\:\\/\\?\\#\\[\\]\\@]",s),c=e?"[\\uE000-\\uF8FF]":"[]",l=t(n,i,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]");r(n+t(n,i,"[\\+\\-\\.]")+"*"),r(r(a+"|"+t(l,s,"[\\:]"))+"*");var f=r(r("25[0-5]")+"|"+r("2[0-4]"+i)+"|"+r("1"+i+i)+"|"+r("0?[1-9]"+i)+"|0?0?"+i),h=r(f+"\\."+f+"\\."+f+"\\."+f),p=r(o+"{1,4}"),d=r(r(p+"\\:"+p)+"|"+h),g=r(r(p+"\\:")+"{6}"+d),y=r("\\:\\:"+r(p+"\\:")+"{5}"+d),v=r(r(p)+"?\\:\\:"+r(p+"\\:")+"{4}"+d),m=r(r(r(p+"\\:")+"{0,1}"+p)+"?\\:\\:"+r(p+"\\:")+"{3}"+d),b=r(r(r(p+"\\:")+"{0,2}"+p)+"?\\:\\:"+r(p+"\\:")+"{2}"+d),E=r(r(r(p+"\\:")+"{0,3}"+p)+"?\\:\\:"+p+"\\:"+d),S=r(r(r(p+"\\:")+"{0,4}"+p)+"?\\:\\:"+d),w=r(r(r(p+"\\:")+"{0,5}"+p)+"?\\:\\:"+p),_=r(r(r(p+"\\:")+"{0,6}"+p)+"?\\:\\:"),C=r([g,y,v,m,b,E,S,w,_].join("|")),A=r(r(l+"|"+a)+"+");r("[vV]"+o+"+\\."+t(l,s,"[\\:]")+"+"),r(r(a+"|"+t(l,s))+"*");var I=r(a+"|"+t(l,s,"[\\:\\@]"));return r(r(a+"|"+t(l,s,"[\\@]"))+"+"),r(r(I+"|"+t("[\\/\\?]",c))+"*"),{NOT_SCHEME:new RegExp(t("[^]",n,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",l,s),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",l,s),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",l,s),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",l,s),"g"),NOT_QUERY:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",l,s,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",l,s),"g"),UNRESERVED:new RegExp(l,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",l,u),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+h+")$"),IPV6ADDRESS:new RegExp("^\\[?("+C+")"+r(r("\\%25|\\%(?!"+o+"{2})")+"("+A+")")+"?\\]?$")}}var u=s(!1),c=s(!0),l=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(u){i=!0,o=u}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},h=2147483647,p=36,d=1,g=26,y=38,v=700,m=72,b=128,E="-",S=/^xn--/,w=/[^\0-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=p-d,I=Math.floor,T=String.fromCharCode;function P(e){throw new RangeError(C[e])}function F(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}function k(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+F((e=e.replace(_,".")).split("."),t).join(".")}function R(e){for(var t=[],r=0,n=e.length;r<n;){var i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&i)<<10)+(1023&o)+65536):(t.push(i),r--)}else t.push(i)}return t}var B=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:p},O=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},x=function(e,t,r){var n=0;for(e=r?I(e/v):e>>1,e+=I(e/t);e>A*g>>1;n+=p)e=I(e/A);return I(n+(A+1)*e/(e+y))},N=function(e){var t=[],r=e.length,n=0,i=b,o=m,a=e.lastIndexOf(E);a<0&&(a=0);for(var s=0;s<a;++s)e.charCodeAt(s)>=128&&P("not-basic"),t.push(e.charCodeAt(s));for(var u=a>0?a+1:0;u<r;){for(var c=n,l=1,f=p;;f+=p){u>=r&&P("invalid-input");var y=B(e.charCodeAt(u++));(y>=p||y>I((h-n)/l))&&P("overflow"),n+=y*l;var v=f<=o?d:f>=o+g?g:f-o;if(y<v)break;var S=p-v;l>I(h/S)&&P("overflow"),l*=S}var w=t.length+1;o=x(n-c,w,0==c),I(n/w)>h-i&&P("overflow"),i+=I(n/w),n%=w,t.splice(n++,0,i)}return String.fromCodePoint.apply(String,t)},U=function(e){var t=[],r=(e=R(e)).length,n=b,i=0,o=m,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;f<128&&t.push(T(f))}}catch($){s=!0,u=$}finally{try{!a&&l.return&&l.return()}finally{if(s)throw u}}var y=t.length,v=y;for(y&&t.push(E);v<r;){var S=h,w=!0,_=!1,C=void 0;try{for(var A,F=e[Symbol.iterator]();!(w=(A=F.next()).done);w=!0){var k=A.value;k>=n&&k<S&&(S=k)}}catch($){_=!0,C=$}finally{try{!w&&F.return&&F.return()}finally{if(_)throw C}}var B=v+1;S-n>I((h-i)/B)&&P("overflow"),i+=(S-n)*B,n=S;var N=!0,U=!1,j=void 0;try{for(var D,L=e[Symbol.iterator]();!(N=(D=L.next()).done);N=!0){var M=D.value;if(M<n&&++i>h&&P("overflow"),M==n){for(var K=i,V=p;;V+=p){var H=V<=o?d:V>=o+g?g:V-o;if(K<H)break;var q=K-H,z=p-H;t.push(T(O(H+q%z,0))),K=I(q/z)}t.push(T(O(K,0))),o=x(i,B,v==y),i=0,++v}}}catch($){U=!0,j=$}finally{try{!N&&L.return&&L.return()}finally{if(U)throw j}}++i,++n}return t.join("")},j=function(e){return k(e,(function(e){return S.test(e)?N(e.slice(4).toLowerCase()):e}))},D=function(e){return k(e,(function(e){return w.test(e)?"xn--"+U(e):e}))},L={version:"2.1.0",ucs2:{decode:R,encode:function(e){return String.fromCodePoint.apply(String,f(e))}},decode:N,encode:U,toASCII:D,toUnicode:j},M={};function K(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function V(e){for(var t="",r=0,n=e.length;r<n;){var i=parseInt(e.substr(r+1,2),16);if(i<128)t+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&i)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var a=parseInt(e.substr(r+4,2),16),s=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function H(e,t){function r(e){var r=V(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,K).replace(t.PCT_ENCODED,i)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,K).replace(t.PCT_ENCODED,i)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,K).replace(t.PCT_ENCODED,i)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,K).replace(t.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,K).replace(t.PCT_ENCODED,i)),e}function q(e){return e.replace(/^0*(.*)/,"$1")||"0"}function z(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=l(r,2)[1];return n?n.split(".").map(q).join("."):e}function $(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=l(r,3),i=n[1],o=n[2];if(i){for(var a=i.toLowerCase().split("::").reverse(),s=l(a,2),u=s[0],c=s[1],f=c?c.split(":").map(q):[],h=u.split(":").map(q),p=t.IPV4ADDRESS.test(h[h.length-1]),d=p?7:8,g=h.length-d,y=Array(d),v=0;v<d;++v)y[v]=f[v]||h[g+v]||"";p&&(y[d-1]=z(y[d-1],t));var m=y.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(m&&m.length>1){var E=y.slice(0,m.index),S=y.slice(m.index+m.length);b=E.join(":")+"::"+S.join(":")}else b=y.join(":");return o&&(b+="%"+o),b}return e}var G=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,W=void 0==="".match(/(){0}/)[1];function J(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?c:u;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var i=e.match(G);if(i){W?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==e.indexOf("@")?i[3]:void 0,r.host=-1!==e.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==e.indexOf("?")?i[7]:void 0,r.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=$(z(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=M[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)H(r,n);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=L.toASCII(r.host.replace(n.PCT_ENCODED,V).toLowerCase())}catch(a){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+a}H(r,u)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function Q(e,t){var r=!1!==t.iri?c:u,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push($(z(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var Y=/^\.\.?\//,X=/^\/\.(\/|$)/,Z=/^\/\.\.(\/|$)/,ee=/^\/?(?:.|\n)*?(?=\/|$)/;function te(e){for(var t=[];e.length;)if(e.match(Y))e=e.replace(Y,"");else if(e.match(X))e=e.replace(X,"/");else if(e.match(Z))e=e.replace(Z,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(ee);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?c:u,n=[],i=M[(t.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||i&&i.domainHost)try{e.host=t.iri?L.toUnicode(e.host):L.toASCII(e.host.replace(r.PCT_ENCODED,V).toLowerCase())}catch(s){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+s}H(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var o=Q(e,t);if(void 0!==o&&("suffix"!==t.reference&&n.push("//"),n.push(o),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var a=e.path;t.absolutePath||i&&i.absolutePath||(a=te(a)),void 0===o&&(a=a.replace(/^\/\//,"/%2F")),n.push(a)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function ne(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(e=J(re(e,r),r),t=J(re(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(n.scheme=t.scheme,n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=te(t.path||""),n.query=t.query):(t.path?("/"===t.path.charAt(0)?n.path=te(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?n.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:n.path=t.path:n.path="/"+t.path,n.path=te(n.path)),n.query=t.query):(n.path=e.path,void 0!==t.query?n.query=t.query:n.query=e.query),n.userinfo=e.userinfo,n.host=e.host,n.port=e.port),n.scheme=e.scheme),n.fragment=t.fragment,n}function ie(e,t,r){var n=a({scheme:"null"},r);return re(ne(J(e,n),J(t,n),n,!0),n)}function oe(e,t){return"string"==typeof e?e=re(J(e,t),t):"object"===n(e)&&(e=J(re(e,t),t)),e}function ae(e,t,r){return"string"==typeof e?e=re(J(e,r),r):"object"===n(e)&&(e=re(e,r)),"string"==typeof t?t=re(J(t,r),r):"object"===n(t)&&(t=re(t,r)),e===t}function se(e,t){return e&&e.toString().replace(t&&t.iri?c.ESCAPE:u.ESCAPE,K)}function ue(e,t){return e&&e.toString().replace(t&&t.iri?c.PCT_ENCODED:u.PCT_ENCODED,V)}var ce={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},le={scheme:"https",domainHost:ce.domainHost,parse:ce.parse,serialize:ce.serialize};function fe(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var he={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=fe(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(fe(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=l(r,2),i=n[0],o=n[1];e.path=i&&"/"!==i?i:void 0,e.query=o,e.resourceName=void 0}return e.fragment=void 0,e}},pe={scheme:"wss",domainHost:he.domainHost,parse:he.parse,serialize:he.serialize},de={},ge="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",ye="[0-9A-Fa-f]",ve=r(r("%[EFef]"+ye+"%"+ye+ye+"%"+ye+ye)+"|"+r("%[89A-Fa-f]"+ye+"%"+ye+ye)+"|"+r("%"+ye+ye)),me="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",be=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),Ee="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Se=new RegExp(ge,"g"),we=new RegExp(ve,"g"),_e=new RegExp(t("[^]",me,"[\\.]",'[\\"]',be),"g"),Ce=new RegExp(t("[^]",ge,Ee),"g"),Ae=Ce;function Ie(e){var t=V(e);return t.match(Se)?t:e}var Te={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,o={},a=r.query.split("&"),s=0,u=a.length;s<u;++s){var c=a[s].split("=");switch(c[0]){case"to":for(var l=c[1].split(","),f=0,h=l.length;f<h;++f)n.push(l[f]);break;case"subject":r.subject=ue(c[1],t);break;case"body":r.body=ue(c[1],t);break;default:i=!0,o[ue(c[0],t)]=ue(c[1],t)}}i&&(r.headers=o)}r.query=void 0;for(var p=0,d=n.length;p<d;++p){var g=n[p].split("@");if(g[0]=ue(g[0]),t.unicodeSupport)g[1]=ue(g[1],t).toLowerCase();else try{g[1]=L.toASCII(ue(g[1],t).toLowerCase())}catch(y){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+y}n[p]=g.join("@")}return r},serialize:function(e,t){var r=e,n=o(e.to);if(n){for(var a=0,s=n.length;a<s;++a){var u=String(n[a]),c=u.lastIndexOf("@"),l=u.slice(0,c).replace(we,Ie).replace(we,i).replace(_e,K),f=u.slice(c+1);try{f=t.iri?L.toUnicode(f):L.toASCII(ue(f,t).toLowerCase())}catch(g){r.error=r.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+g}n[a]=l+"@"+f}r.path=n.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var p=[];for(var d in h)h[d]!==de[d]&&p.push(d.replace(we,Ie).replace(we,i).replace(Ce,K)+"="+h[d].replace(we,Ie).replace(we,i).replace(Ae,K));return p.length&&(r.query=p.join("&")),r}},Pe=/^([^\:]+)\:(.*)/,Fe={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(Pe),n=e;if(r){var i=t.scheme||n.scheme||"urn",o=r[1].toLowerCase(),a=r[2],s=i+":"+(t.nid||o),u=M[s];n.nid=o,n.nss=a,n.path=void 0,u&&(n=u.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,i=r+":"+(t.nid||n),o=M[i];o&&(e=o.serialize(e,t));var a=e,s=e.nss;return a.path=(n||t.nid)+":"+s,a}},ke=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Re={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ke)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};M[ce.scheme]=ce,M[le.scheme]=le,M[he.scheme]=he,M[pe.scheme]=pe,M[Te.scheme]=Te,M[Fe.scheme]=Fe,M[Re.scheme]=Re,e.SCHEMES=M,e.pctEncChar=K,e.pctDecChars=V,e.parse=J,e.removeDotSegments=te,e.serialize=re,e.resolveComponents=ne,e.resolve=ie,e.normalize=oe,e.equal=ae,e.escapeComponent=se,e.unescapeComponent=ue,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),Ce=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var a=o[i];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r},Ae={copy:function(e,t){for(var r in t=t||{},e)t[r]=e[r];return t},checkDataType:Ie,checkDataTypes:function(e,t,r){switch(e.length){case 1:return Ie(e[0],t,r,!0);default:var n="",i=Pe(e);for(var o in i.array&&i.object&&(n=i.null?"(":"(!"+t+" || ",n+="typeof "+t+' !== "object")',delete i.null,delete i.array,delete i.object),i.number&&delete i.integer,i)n+=(n?" && ":"")+Ie(o,t,r,!0);return n}},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var r=[],n=0;n<t.length;n++){var i=t[n];(Te[i]||"array"===e&&"array"===i)&&(r[r.length]=i)}if(r.length)return r}else{if(Te[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:Pe,getProperty:Re,escapeQuotes:Be,equal:Ce,ucs2length:function(e){for(var t,r=0,n=e.length,i=0;i<n;)r++,(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<n&&56320==(64512&(t=e.charCodeAt(i)))&&i++;return r},varOccurences:function(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var n in e)if(n!=r&&t[n])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var r in e)if(!t[r])return r},toQuotedString:Oe,getPathExpr:function(e,t,r,n){return Ue(e,r?"'/' + "+t+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,r){var n=Oe(r?"/"+je(t):Re(t));return Ue(e,n)},getData:function(e,t,r){var n,i,o,a;if(""===e)return"rootData";if("/"==e[0]){if(!xe.test(e))throw new Error("Invalid JSON-pointer: "+e);i=e,o="rootData"}else{if(!(a=e.match(Ne)))throw new Error("Invalid JSON-pointer: "+e);if(n=+a[1],"#"==(i=a[2])){if(n>=t)throw new Error("Cannot access property/index "+n+" levels up, current level is "+t);return r[t-n]}if(n>t)throw new Error("Cannot access data "+n+" levels up, current level is "+t);if(o="data"+(t-n||""),!i)return o}for(var s=o,u=i.split("/"),c=0;c<u.length;c++){var l=u[c];l&&(o+=Re(De(l)),s+=" && "+o)}return s},unescapeFragment:function(e){return De(decodeURIComponent(e))},unescapeJsonPointer:De,escapeFragment:function(e){return encodeURIComponent(je(e))},escapeJsonPointer:je};function Ie(e,t,r,n){var i=n?" !== ":" === ",o=n?" || ":" && ",a=n?"!":"",s=n?"":"!";switch(e){case"null":return t+i+"null";case"array":return a+"Array.isArray("+t+")";case"object":return"("+a+t+o+"typeof "+t+i+'"object"'+o+s+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+i+'"number"'+o+s+"("+t+" % 1)"+o+t+i+t+(r?o+a+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+i+'"'+e+'"'+(r?o+a+"isFinite("+t+")":"")+")";default:return"typeof "+t+i+'"'+e+'"'}}var Te=Pe(["string","number","integer","boolean","null"]);function Pe(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var Fe=/^[a-z$_][a-z$_0-9]*$/i,ke=/'|\\/g;function Re(e){return"number"==typeof e?"["+e+"]":Fe.test(e)?"."+e:"['"+Be(e)+"']"}function Be(e){return e.replace(ke,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function Oe(e){return"'"+Be(e)+"'"}var xe=/^\/(?:[^~]|~0|~1)*$/,Ne=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Ue(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function je(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function De(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}var Le=function(e){Ae.copy(e,this)};var Me=u((function(e){var t=e.exports=function(e,t,n){"function"==typeof t&&(n=t,t={}),r(t,"function"==typeof(n=t.cb||n)?n:n.pre||function(){},n.post||function(){},e,"",e)};function r(e,n,i,o,a,s,u,c,l,f){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var h in n(o,a,s,u,c,l,f),o){var p=o[h];if(Array.isArray(p)){if(h in t.arrayKeywords)for(var d=0;d<p.length;d++)r(e,n,i,p[d],a+"/"+h+"/"+d,s,a,h,o,d)}else if(h in t.propsKeywords){if(p&&"object"==typeof p)for(var g in p)r(e,n,i,p[g],a+"/"+h+"/"+g.replace(/~/g,"~0").replace(/\//g,"~1"),s,a,h,o,g)}else(h in t.keywords||e.allKeys&&!(h in t.skipKeywords))&&r(e,n,i,p,a+"/"+h,s,a,h,o)}i(o,a,s,u,c,l,f)}}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}})),Ke=Ve;function Ve(e,t,r){var n=this._refs[r];if("string"==typeof n){if(!this._refs[n])return Ve.call(this,e,t,n);n=this._refs[n]}if((n=n||this._schemas[r])instanceof Le)return We(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var i,o,a,s=He.call(this,t,r);return s&&(i=s.schema,t=s.root,a=s.baseId),i instanceof Le?o=i.validate||e.call(this,i.schema,t,void 0,a):void 0!==i&&(o=We(i,this._opts.inlineRefs)?i:e.call(this,i,t,void 0,a)),o}function He(e,t){var r=_e.parse(t),n=Xe(r),i=Ye(this._getId(e.schema));if(0===Object.keys(e.schema).length||n!==i){var o=et(n),a=this._refs[o];if("string"==typeof a)return qe.call(this,e,a,r);if(a instanceof Le)a.validate||this._compile(a),e=a;else{if(!((a=this._schemas[o])instanceof Le))return;if(a.validate||this._compile(a),o==et(t))return{schema:a,root:e,baseId:i};e=a}if(!e.schema)return;i=Ye(this._getId(e.schema))}return $e.call(this,r,i,e.schema,e)}function qe(e,t,r){var n=He.call(this,e,t);if(n){var i=n.schema,o=n.baseId;e=n.root;var a=this._getId(i);return a&&(o=tt(o,a)),$e.call(this,r,o,i,e)}}Ve.normalizeId=et,Ve.fullPath=Ye,Ve.url=tt,Ve.ids=function(e){var t=et(this._getId(e)),r={"":t},n={"":Ye(t,!1)},i={},o=this;return Me(e,{allKeys:!0},(function(e,t,a,s,u,c,l){if(""!==t){var f=o._getId(e),h=r[s],p=n[s]+"/"+u;if(void 0!==l&&(p+="/"+("number"==typeof l?l:Ae.escapeFragment(l))),"string"==typeof f){f=h=et(h?_e.resolve(h,f):f);var d=o._refs[f];if("string"==typeof d&&(d=o._refs[d]),d&&d.schema){if(!Ce(e,d.schema))throw new Error('id "'+f+'" resolves to more than one schema')}else if(f!=et(p))if("#"==f[0]){if(i[f]&&!Ce(e,i[f]))throw new Error('id "'+f+'" resolves to more than one schema');i[f]=e}else o._refs[f]=p}r[t]=h,n[t]=p}})),i},Ve.inlineRef=We,Ve.schema=He;var ze=Ae.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function $e(e,t,r,n){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var i=e.fragment.split("/"),o=1;o<i.length;o++){var a=i[o];if(a){if(void 0===(r=r[a=Ae.unescapeFragment(a)]))break;var s;if(!ze[a]&&((s=this._getId(r))&&(t=tt(t,s)),r.$ref)){var u=tt(t,r.$ref),c=He.call(this,n,u);c&&(r=c.schema,n=c.root,t=c.baseId)}}}return void 0!==r&&r!==n.schema?{schema:r,root:n,baseId:t}:void 0}}var Ge=Ae.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function We(e,t){return!1!==t&&(void 0===t||!0===t?Je(e):t?Qe(e)<=t:void 0)}function Je(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&!Je(t))return!1}else for(var n in e){if("$ref"==n)return!1;if("object"==typeof(t=e[n])&&!Je(t))return!1}return!0}function Qe(e){var t,r=0;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("object"==typeof(t=e[n])&&(r+=Qe(t)),r==1/0)return 1/0}else for(var i in e){if("$ref"==i)return 1/0;if(Ge[i])r++;else if("object"==typeof(t=e[i])&&(r+=Qe(t)+1),r==1/0)return 1/0}return r}function Ye(e,t){return!1!==t&&(e=et(e)),Xe(_e.parse(e))}function Xe(e){return _e.serialize(e).split("#")[0]+"#"}var Ze=/#\/?$/;function et(e){return e?e.replace(Ze,""):""}function tt(e,t){return t=et(t),_e.resolve(e,t)}var rt={Validation:it((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:it(nt)};function nt(e,t,r){this.message=r||nt.message(e,t),this.missingRef=Ke.url(e,t),this.missingSchema=Ke.normalizeId(Ke.fullPath(this.missingRef))}function it(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}nt.message=function(e,t){return"can't resolve reference "+t+" from id "+e};var ot=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,n="boolean"==typeof t.cycles&&t.cycles,i=t.cmp&&(r=t.cmp,function(e){return function(t,n){var i={key:t,value:e[t]},o={key:n,value:e[n]};return r(i,o)}}),o=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var r,a;if(Array.isArray(t)){for(a="[",r=0;r<t.length;r++)r&&(a+=","),a+=e(t[r])||"null";return a+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,u=Object.keys(t).sort(i&&i(t));for(a="",r=0;r<u.length;r++){var c=u[r],l=e(t[c]);l&&(a&&(a+=","),a+=JSON.stringify(c)+":"+l)}return o.splice(s,1),"{"+a+"}"}}(e)},at=function(e,t,r){var n="",i=!0===e.schema.$async,o=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),a=e.self._getId(e.schema);if(e.opts.strictKeywords){var s=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(s){var u="unknown keyword: "+s;if("log"!==e.opts.strictKeywords)throw new Error(u);e.logger.warn(u)}}if(e.isTop&&(n+=" var validate = ",i&&(e.async=!0,n+="async "),n+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",a&&(e.opts.sourceCode||e.opts.processCode)&&(n+=" /*# sourceURL="+a+" */ ")),"boolean"==typeof e.schema||!o&&!e.schema.$ref){t="false schema";var c=e.level,l=e.dataLevel,f=e.schema[t],h=e.schemaPath+e.util.getProperty(t),p=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,g="data"+(l||""),y="valid"+c;if(!1===e.schema){e.isTop?d=!0:n+=" var "+y+" = false; ",(Q=Q||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'boolean schema is false' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),n+=" } "):n+=" {} ";var v=n;n=Q.pop(),!e.compositeRule&&d?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?n+=i?" return data; ":" validate.errors = null; return true; ":n+=" var "+y+" = true; ";return e.isTop&&(n+=" }; return validate; "),n}if(e.isTop){var m=e.isTop;c=e.level=0,l=e.dataLevel=0,g="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}n+=" var vErrors = null; ",n+=" var errors = 0;     ",n+=" if (rootData === undefined) rootData = data; "}else{c=e.level,g="data"+((l=e.dataLevel)||"");if(a&&(e.baseId=e.resolve.url(e.baseId,a)),i&&!e.async)throw new Error("async schema in sync schema");n+=" var errs_"+c+" = errors;"}y="valid"+c,d=!e.opts.allErrors;var E="",S="",w=e.schema.type,_=Array.isArray(w);if(w&&e.opts.nullable&&!0===e.schema.nullable&&(_?-1==w.indexOf("null")&&(w=w.concat("null")):"null"!=w&&(w=[w,"null"],_=!0)),_&&1==w.length&&(w=w[0],_=!1),e.schema.$ref&&o){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(o=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(n+=" "+e.RULES.all.$comment.code(e,"$comment")),w){if(e.opts.coerceTypes)var C=e.util.coerceToTypes(e.opts.coerceTypes,w);var A=e.RULES.types[w];if(C||_||!0===A||A&&!Y(A)){h=e.schemaPath+".type",p=e.errSchemaPath+"/type",h=e.schemaPath+".type",p=e.errSchemaPath+"/type";var I=_?"checkDataTypes":"checkDataType";if(n+=" if ("+e.util[I](w,g,e.opts.strictNumbers,!0)+") { ",C){var T="dataType"+c,P="coerced"+c;n+=" var "+T+" = typeof "+g+"; var "+P+" = undefined; ","array"==e.opts.coerceTypes&&(n+=" if ("+T+" == 'object' && Array.isArray("+g+") && "+g+".length == 1) { "+g+" = "+g+"[0]; "+T+" = typeof "+g+"; if ("+e.util.checkDataType(e.schema.type,g,e.opts.strictNumbers)+") "+P+" = "+g+"; } "),n+=" if ("+P+" !== undefined) ; ";var F=C;if(F)for(var k,R=-1,B=F.length-1;R<B;)"string"==(k=F[R+=1])?n+=" else if ("+T+" == 'number' || "+T+" == 'boolean') "+P+" = '' + "+g+"; else if ("+g+" === null) "+P+" = ''; ":"number"==k||"integer"==k?(n+=" else if ("+T+" == 'boolean' || "+g+" === null || ("+T+" == 'string' && "+g+" && "+g+" == +"+g+" ","integer"==k&&(n+=" && !("+g+" % 1)"),n+=")) "+P+" = +"+g+"; "):"boolean"==k?n+=" else if ("+g+" === 'false' || "+g+" === 0 || "+g+" === null) "+P+" = false; else if ("+g+" === 'true' || "+g+" === 1) "+P+" = true; ":"null"==k?n+=" else if ("+g+" === '' || "+g+" === 0 || "+g+" === false) "+P+" = null; ":"array"==e.opts.coerceTypes&&"array"==k&&(n+=" else if ("+T+" == 'string' || "+T+" == 'number' || "+T+" == 'boolean' || "+g+" == null) "+P+" = ["+g+"]; ");n+=" else {   ",(Q=Q||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",n+=_?""+w.join(","):""+w,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=_?""+w.join(","):""+w,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),n+=" } "):n+=" {} ";v=n;n=Q.pop(),!e.compositeRule&&d?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } if ("+P+" !== undefined) {  ";var O=l?"data"+(l-1||""):"parentData";n+=" "+g+" = "+P+"; ",l||(n+="if ("+O+" !== undefined)"),n+=" "+O+"["+(l?e.dataPathArr[l]:"parentDataProperty")+"] = "+P+"; } "}else{(Q=Q||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",n+=_?""+w.join(","):""+w,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=_?""+w.join(","):""+w,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),n+=" } "):n+=" {} ";v=n;n=Q.pop(),!e.compositeRule&&d?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}n+=" } "}}if(e.schema.$ref&&!o)n+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",d&&(n+=" } if (errors === ",n+=m?"0":"errs_"+c,n+=") { ",S+="}");else{var x=e.RULES;if(x)for(var N=-1,U=x.length-1;N<U;)if(Y(A=x[N+=1])){if(A.type&&(n+=" if ("+e.util.checkDataType(A.type,g,e.opts.strictNumbers)+") { "),e.opts.useDefaults)if("object"==A.type&&e.schema.properties){f=e.schema.properties;var j=Object.keys(f);if(j)for(var D,L=-1,M=j.length-1;L<M;){if(void 0!==(H=f[D=j[L+=1]]).default){var K=g+e.util.getProperty(D);if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+K;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else n+=" if ("+K+" === undefined ","empty"==e.opts.useDefaults&&(n+=" || "+K+" === null || "+K+" === '' "),n+=" ) "+K+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(H.default)+" ":n+=" "+JSON.stringify(H.default)+" ",n+="; "}}}else if("array"==A.type&&Array.isArray(e.schema.items)){var V=e.schema.items;if(V){R=-1;for(var H,q=V.length-1;R<q;)if(void 0!==(H=V[R+=1]).default){K=g+"["+R+"]";if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+K;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else n+=" if ("+K+" === undefined ","empty"==e.opts.useDefaults&&(n+=" || "+K+" === null || "+K+" === '' "),n+=" ) "+K+" = ","shared"==e.opts.useDefaults?n+=" "+e.useDefault(H.default)+" ":n+=" "+JSON.stringify(H.default)+" ",n+="; "}}}var z=A.rules;if(z)for(var $,G=-1,W=z.length-1;G<W;)if(X($=z[G+=1])){var J=$.code(e,$.keyword,A.type);J&&(n+=" "+J+" ",d&&(E+="}"))}if(d&&(n+=" "+E+" ",E=""),A.type&&(n+=" } ",w&&w===A.type&&!C)){n+=" else { ";var Q;h=e.schemaPath+".type",p=e.errSchemaPath+"/type";(Q=Q||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",n+=_?""+w.join(","):""+w,n+="' } ",!1!==e.opts.messages&&(n+=" , message: 'should be ",n+=_?""+w.join(","):""+w,n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+g+" "),n+=" } "):n+=" {} ";v=n;n=Q.pop(),!e.compositeRule&&d?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } "}d&&(n+=" if (errors === ",n+=m?"0":"errs_"+c,n+=") { ",S+="}")}}function Y(e){for(var t=e.rules,r=0;r<t.length;r++)if(X(t[r]))return!0}function X(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var r=t.implements,n=0;n<r.length;n++)if(void 0!==e.schema[r[n]])return!0}(t)}return d&&(n+=" "+S+" "),m?(i?(n+=" if (errors === 0) return data;           ",n+=" else throw new ValidationError(vErrors); "):(n+=" validate.errors = vErrors; ",n+=" return errors === 0;       "),n+=" }; return validate;"):n+=" var "+y+" = errors === errs_"+c+";",n},st=Ae.ucs2length,ut=rt.Validation,ct=function e(t,r,n,i){var o=this,a=this._opts,s=[void 0],u={},c=[],l={},f=[],h={},p=[];r=r||{schema:t,refVal:s,refs:u};var d=lt.call(this,t,r,i),g=this._compilations[d.index];if(d.compiling)return g.callValidate=function e(){var t=g.validate,r=t.apply(this,arguments);return e.errors=t.errors,r};var y=this._formats,v=this.RULES;try{var m=E(t,r,n,i);g.validate=m;var b=g.callValidate;return b&&(b.schema=m.schema,b.errors=null,b.refs=m.refs,b.refVal=m.refVal,b.root=m.root,b.$async=m.$async,a.sourceCode&&(b.source=m.source)),m}finally{ft.call(this,t,r,i)}function E(t,n,i,l){var h=!n||n&&n.schema==t;if(n.schema!=r.schema)return e.call(o,t,n,i,l);var d,g=!0===t.$async,m=at({isTop:!0,schema:t,isRoot:h,baseId:l,root:n,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:rt.MissingRef,RULES:v,validate:at,util:Ae,resolve:Ke,resolveRef:S,usePattern:C,useDefault:A,useCustomRule:I,opts:a,formats:y,logger:o.logger,self:o});m=vt(s,gt)+vt(c,pt)+vt(f,dt)+vt(p,yt)+m,a.processCode&&(m=a.processCode(m,t));try{d=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",m)(o,v,y,r,s,f,p,Ce,st,ut),s[0]=d}catch(b){throw o.logger.error("Error compiling schema, function code:",m),b}return d.schema=t,d.errors=null,d.refs=u,d.refVal=s,d.root=h?d:n,g&&(d.$async=!0),!0===a.sourceCode&&(d.source={code:m,patterns:c,defaults:f}),d}function S(t,i,c){i=Ke.url(t,i);var l,f,h=u[i];if(void 0!==h)return _(l=s[h],f="refVal["+h+"]");if(!c&&r.refs){var p=r.refs[i];if(void 0!==p)return _(l=r.refVal[p],f=w(i,l))}f=w(i);var d=Ke.call(o,E,r,i);if(void 0===d){var g=n&&n[i];g&&(d=Ke.inlineRef(g,a.inlineRefs)?g:e.call(o,g,r,n,t))}if(void 0!==d)return function(e,t){var r=u[e];s[r]=t}(i,d),_(d,f);!function(e){delete u[e]}(i)}function w(e,t){var r=s.length;return s[r]=t,u[e]=r,"refVal"+r}function _(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function C(e){var t=l[e];return void 0===t&&(t=l[e]=c.length,c[t]=e),"pattern"+t}function A(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return Ae.toQuotedString(e);case"object":if(null===e)return"null";var t=ot(e),r=h[t];return void 0===r&&(r=h[t]=f.length,f[r]=e),"default"+r}}function I(e,t,r,n){if(!1!==o._opts.validateSchema){var i=e.definition.dependencies;if(i&&!i.every((function(e){return Object.prototype.hasOwnProperty.call(r,e)})))throw new Error("parent schema must have all required keywords: "+i.join(","));var s=e.definition.validateSchema;if(s)if(!s(t)){var u="keyword schema is invalid: "+o.errorsText(s.errors);if("log"!=o._opts.validateSchema)throw new Error(u);o.logger.error(u)}}var c,l=e.definition.compile,f=e.definition.inline,h=e.definition.macro;if(l)c=l.call(o,t,r,n);else if(h)c=h.call(o,t,r,n),!1!==a.validateSchema&&o.validateSchema(c,!0);else if(f)c=f.call(o,n,e.keyword,t,r);else if(!(c=e.definition.validate))return;if(void 0===c)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var d=p.length;return p[d]=c,{code:"customRule"+d,validate:c}}};function lt(e,t,r){var n=ht.call(this,e,t,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:e,root:t,baseId:r},{index:n,compiling:!1})}function ft(e,t,r){var n=ht.call(this,e,t,r);n>=0&&this._compilations.splice(n,1)}function ht(e,t,r){for(var n=0;n<this._compilations.length;n++){var i=this._compilations[n];if(i.schema==e&&i.root==t&&i.baseId==r)return n}return-1}function pt(e,t){return"var pattern"+e+" = new RegExp("+Ae.toQuotedString(t[e])+");"}function dt(e){return"var default"+e+" = defaults["+e+"];"}function gt(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function yt(e){return"var customRule"+e+" = customRules["+e+"];"}function vt(e,t){if(!e.length)return"";for(var r="",n=0;n<e.length;n++)r+=t(n,e);return r}var mt=u((function(e){var t=e.exports=function(){this._cache={}};t.prototype.put=function(e,t){this._cache[e]=t},t.prototype.get=function(e){return this._cache[e]},t.prototype.del=function(e){delete this._cache[e]},t.prototype.clear=function(){this._cache={}}})),bt=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,Et=[0,31,28,31,30,31,30,31,31,30,31,30,31],St=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,wt=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,_t=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,Ct=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,At=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,It=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,Tt=/^(?:\/(?:[^~/]|~0|~1)*)*$/,Pt=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,Ft=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,kt=Rt;function Rt(e){return e="full"==e?"full":"fast",Ae.copy(Rt[e])}function Bt(e){var t=e.match(bt);if(!t)return!1;var r=+t[1],n=+t[2],i=+t[3];return n>=1&&n<=12&&i>=1&&i<=(2==n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:Et[n])}function Ot(e,t){var r=e.match(St);if(!r)return!1;var n=r[1],i=r[2],o=r[3],a=r[5];return(n<=23&&i<=59&&o<=59||23==n&&59==i&&60==o)&&(!t||a)}Rt.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":Ct,url:At,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:wt,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:jt,uuid:It,"json-pointer":Tt,"json-pointer-uri-fragment":Pt,"relative-json-pointer":Ft},Rt.full={date:Bt,time:Ot,"date-time":function(e){var t=e.split(xt);return 2==t.length&&Bt(t[0])&&Ot(t[1],!0)},uri:function(e){return Nt.test(e)&&_t.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":Ct,url:At,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:wt,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:jt,uuid:It,"json-pointer":Tt,"json-pointer-uri-fragment":Pt,"relative-json-pointer":Ft};var xt=/t|\s/i;var Nt=/\/|:/;var Ut=/[^\\]\\Z/;function jt(e){if(Ut.test(e))return!1;try{return new RegExp(e),!0}catch(t){return!1}}var Dt=function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s;var p="maximum"==t,d=p?"exclusiveMaximum":"exclusiveMinimum",g=e.schema[d],y=e.opts.$data&&g&&g.$data,v=p?"<":">",m=p?">":"<",b=void 0;if(!h&&"number"!=typeof s&&void 0!==s)throw new Error(t+" must be number");if(!y&&void 0!==g&&"number"!=typeof g&&"boolean"!=typeof g)throw new Error(d+" must be number or boolean");if(y){var E=e.util.getData(g.$data,a,e.dataPathArr),S="exclusive"+o,w="exclType"+o,_="exclIsNumber"+o,C="' + "+(T="op"+o)+" + '";i+=" var schemaExcl"+o+" = "+E+"; ",i+=" var "+S+"; var "+w+" = typeof "+(E="schemaExcl"+o)+"; if ("+w+" != 'boolean' && "+w+" != 'undefined' && "+w+" != 'number') { ";var A;b=d;(A=A||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: '"+d+" should be boolean' "),e.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var I=i;i=A.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+I+"]); ":i+=" validate.errors = ["+I+"]; return false; ":i+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+w+" == 'number' ? ( ("+S+" = "+n+" === undefined || "+E+" "+v+"= "+n+") ? "+f+" "+m+"= "+E+" : "+f+" "+m+" "+n+" ) : ( ("+S+" = "+E+" === true) ? "+f+" "+m+"= "+n+" : "+f+" "+m+" "+n+" ) || "+f+" !== "+f+") { var op"+o+" = "+S+" ? '"+v+"' : '"+v+"='; ",void 0===s&&(b=d,c=e.errSchemaPath+"/"+d,n=E,h=y)}else{C=v;if((_="number"==typeof g)&&h){var T="'"+C+"'";i+=" if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" ( "+n+" === undefined || "+g+" "+v+"= "+n+" ? "+f+" "+m+"= "+g+" : "+f+" "+m+" "+n+" ) || "+f+" !== "+f+") { "}else{_&&void 0===s?(S=!0,b=d,c=e.errSchemaPath+"/"+d,n=g,m+="="):(_&&(n=Math[p?"min":"max"](g,s)),g===(!_||n)?(S=!0,b=d,c=e.errSchemaPath+"/"+d,m+="="):(S=!1,C+="="));T="'"+C+"'";i+=" if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+f+" "+m+" "+n+" || "+f+" !== "+f+") { "}}b=b||t,(A=A||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+T+", limit: "+n+", exclusive: "+S+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be "+C+" ",i+=h?"' + "+n:n+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+u:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";I=i;return i=A.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+I+"]); ":i+=" validate.errors = ["+I+"]; return false; ":i+=" var err = "+I+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",l&&(i+=" else { "),i},Lt=function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");i+="if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+f+".length "+("maxItems"==t?">":"<")+" "+n+") { ";var p=t,d=d||[];d.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxItems"==t?"more":"fewer",i+=" than ",i+=h?"' + "+n+" + '":""+s,i+=" items' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+u:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var g=i;return i=d.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",l&&(i+=" else { "),i},Mt=function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");var p="maxLength"==t?">":"<";i+="if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===e.opts.unicode?i+=" "+f+".length ":i+=" ucs2length("+f+") ",i+=" "+p+" "+n+") { ";var d=t,g=g||[];g.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(d||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be ",i+="maxLength"==t?"longer":"shorter",i+=" than ",i+=h?"' + "+n+" + '":""+s,i+=" characters' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+u:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var y=i;return i=g.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",l&&(i+=" else { "),i},Kt=function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");i+="if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" Object.keys("+f+").length "+("maxProperties"==t?">":"<")+" "+n+") { ";var p=t,d=d||[];d.push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(p||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxProperties"==t?"more":"fewer",i+=" than ",i+=h?"' + "+n+" + '":""+s,i+=" properties' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+u:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var g=i;return i=d.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",l&&(i+=" else { "),i},Vt={$ref:function(e,t,r){var n,i,o=" ",a=e.level,s=e.dataLevel,u=e.schema[t],c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(s||""),h="valid"+a;if("#"==u||"#/"==u)e.isRoot?(n=e.async,i="validate"):(n=!0===e.root.schema.$async,i="root.refVal[0]");else{var p=e.resolveRef(e.baseId,u,e.isRoot);if(void 0===p){var d=e.MissingRefError.message(e.baseId,u);if("fail"==e.opts.missingRefs){e.logger.error(d),(m=m||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(u)+"' } ",!1!==e.opts.messages&&(o+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(u)+"' "),e.opts.verbose&&(o+=" , schema: "+e.util.toQuotedString(u)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),o+=" } "):o+=" {} ";var g=o;o=m.pop(),!e.compositeRule&&l?e.async?o+=" throw new ValidationError(["+g+"]); ":o+=" validate.errors = ["+g+"]; return false; ":o+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(o+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,u,d);e.logger.warn(d),l&&(o+=" if (true) { ")}}else if(p.inline){var y=e.util.copy(e);y.level++;var v="valid"+y.level;y.schema=p.schema,y.schemaPath="",y.errSchemaPath=u,o+=" "+e.validate(y).replace(/validate\.schema/g,p.code)+" ",l&&(o+=" if ("+v+") { ")}else n=!0===p.$async||e.async&&!1!==p.$async,i=p.code}if(i){var m;(m=m||[]).push(o),o="",e.opts.passContext?o+=" "+i+".call(this, ":o+=" "+i+"( ",o+=" "+f+", (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var b=o+=" , "+(s?"data"+(s-1||""):"parentData")+" , "+(s?e.dataPathArr[s]:"parentDataProperty")+", rootData)  ";if(o=m.pop(),n){if(!e.async)throw new Error("async schema referenced by sync schema");l&&(o+=" var "+h+"; "),o+=" try { await "+b+"; ",l&&(o+=" "+h+" = true; "),o+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",l&&(o+=" "+h+" = false; "),o+=" } ",l&&(o+=" if ("+h+") { ")}else o+=" if (!"+b+") { if (vErrors === null) vErrors = "+i+".errors; else vErrors = vErrors.concat("+i+".errors); errors = vErrors.length; } ",l&&(o+=" else { ")}return o},allOf:function(e,t,r){var n=" ",i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),a=e.errSchemaPath+"/"+t,s=!e.opts.allErrors,u=e.util.copy(e),c="";u.level++;var l="valid"+u.level,f=u.baseId,h=!0,p=i;if(p)for(var d,g=-1,y=p.length-1;g<y;)d=p[g+=1],(e.opts.strictKeywords?"object"==typeof d&&Object.keys(d).length>0||!1===d:e.util.schemaHasRules(d,e.RULES.all))&&(h=!1,u.schema=d,u.schemaPath=o+"["+g+"]",u.errSchemaPath=a+"/"+g,n+="  "+e.validate(u)+" ",u.baseId=f,s&&(n+=" if ("+l+") { ",c+="}"));return s&&(n+=h?" if (true) { ":" "+c.slice(0,-1)+" "),n},anyOf:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h="errs__"+i,p=e.util.copy(e),d="";p.level++;var g="valid"+p.level;if(a.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0||!1===t:e.util.schemaHasRules(t,e.RULES.all)}))){var y=p.baseId;n+=" var "+h+" = errors; var "+f+" = false;  ";var v=e.compositeRule;e.compositeRule=p.compositeRule=!0;var m=a;if(m)for(var b,E=-1,S=m.length-1;E<S;)b=m[E+=1],p.schema=b,p.schemaPath=s+"["+E+"]",p.errSchemaPath=u+"/"+E,n+="  "+e.validate(p)+" ",p.baseId=y,n+=" "+f+" = "+f+" || "+g+"; if (!"+f+") { ",d+="}";e.compositeRule=p.compositeRule=v,n+=" "+d+" if (!"+f+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else c&&(n+=" if (true) { ");return n},$comment:function(e,t,r){var n=" ",i=e.schema[t],o=e.errSchemaPath+"/"+t;e.opts.allErrors;var a=e.util.toQuotedString(i);return!0===e.opts.$comment?n+=" console.log("+a+");":"function"==typeof e.opts.$comment&&(n+=" self._opts.$comment("+a+", "+e.util.toQuotedString(o)+", validate.root.schema);"),n},const:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h=e.opts.$data&&a&&a.$data;h&&(n+=" var schema"+i+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; "),h||(n+=" var schema"+i+" = validate.schema"+s+";"),n+="var "+f+" = equal("+l+", schema"+i+"); if (!"+f+") {   ";var p=p||[];p.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValue: schema"+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to constant' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var d=n;return n=p.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+d+"]); ":n+=" validate.errors = ["+d+"]; return false; ":n+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",c&&(n+=" else { "),n},contains:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h="errs__"+i,p=e.util.copy(e);p.level++;var d="valid"+p.level,g="i"+i,y=p.dataLevel=e.dataLevel+1,v="data"+y,m=e.baseId,b=e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all);if(n+="var "+h+" = errors;var "+f+";",b){var E=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=a,p.schemaPath=s,p.errSchemaPath=u,n+=" var "+d+" = false; for (var "+g+" = 0; "+g+" < "+l+".length; "+g+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers,!0);var S=l+"["+g+"]";p.dataPathArr[y]=g;var w=e.validate(p);p.baseId=m,e.util.varOccurences(w,v)<2?n+=" "+e.util.varReplace(w,v,S)+" ":n+=" var "+v+" = "+S+"; "+w+" ",n+=" if ("+d+") break; }  ",e.compositeRule=p.compositeRule=E,n+="  if (!"+d+") {"}else n+=" if ("+l+".length == 0) {";var _=_||[];_.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should contain a valid item' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var C=n;return n=_.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+C+"]); ":n+=" validate.errors = ["+C+"]; return false; ":n+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { ",b&&(n+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(n+=" } "),n},dependencies:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="errs__"+i,h=e.util.copy(e),p="";h.level++;var d="valid"+h.level,g={},y={},v=e.opts.ownProperties;for(S in a)if("__proto__"!=S){var m=a[S],b=Array.isArray(m)?y:g;b[S]=m}n+="var "+f+" = errors;";var E=e.errorPath;for(var S in n+="var missing"+i+";",y)if((b=y[S]).length){if(n+=" if ( "+l+e.util.getProperty(S)+" !== undefined ",v&&(n+=" && Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(S)+"') "),c){n+=" && ( ";var w=b;if(w)for(var _=-1,C=w.length-1;_<C;){k=w[_+=1],_&&(n+=" || "),n+=" ( ( "+(x=l+(O=e.util.getProperty(k)))+" === undefined ",v&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(k)+"') "),n+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?k:O)+") ) "}n+=")) {  ";var A="missing"+i,I="' + "+A+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(E,A,!0):E+" + "+A);var T=T||[];T.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+I+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==b.length?n+="property "+e.util.escapeQuotes(b[0]):n+="properties "+e.util.escapeQuotes(b.join(", ")),n+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var P=n;n=T.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+P+"]); ":n+=" validate.errors = ["+P+"]; return false; ":n+=" var err = "+P+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{n+=" ) { ";var F=b;if(F)for(var k,R=-1,B=F.length-1;R<B;){k=F[R+=1];var O=e.util.getProperty(k),x=(I=e.util.escapeQuotes(k),l+O);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(E,k,e.opts.jsonPointers)),n+=" if ( "+x+" === undefined ",v&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(k)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+I+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should have ",1==b.length?n+="property "+e.util.escapeQuotes(b[0]):n+="properties "+e.util.escapeQuotes(b.join(", ")),n+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}n+=" }   ",c&&(p+="}",n+=" else { ")}e.errorPath=E;var N=h.baseId;for(var S in g){m=g[S];(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0||!1===m:e.util.schemaHasRules(m,e.RULES.all))&&(n+=" "+d+" = true; if ( "+l+e.util.getProperty(S)+" !== undefined ",v&&(n+=" && Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(S)+"') "),n+=") { ",h.schema=m,h.schemaPath=s+e.util.getProperty(S),h.errSchemaPath=u+"/"+e.util.escapeFragment(S),n+="  "+e.validate(h)+" ",h.baseId=N,n+=" }  ",c&&(n+=" if ("+d+") { ",p+="}"))}return c&&(n+="   "+p+" if ("+f+" == errors) {"),n},enum:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h=e.opts.$data&&a&&a.$data;h&&(n+=" var schema"+i+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ");var p="i"+i,d="schema"+i;h||(n+=" var "+d+" = validate.schema"+s+";"),n+="var "+f+";",h&&(n+=" if (schema"+i+" === undefined) "+f+" = true; else if (!Array.isArray(schema"+i+")) "+f+" = false; else {"),n+=f+" = false;for (var "+p+"=0; "+p+"<"+d+".length; "+p+"++) if (equal("+l+", "+d+"["+p+"])) { "+f+" = true; break; }",h&&(n+="  }  "),n+=" if (!"+f+") {   ";var g=g||[];g.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { allowedValues: schema"+i+" } ",!1!==e.opts.messages&&(n+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var y=n;return n=g.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",c&&(n+=" else { "),n},format:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||"");if(!1===e.opts.format)return c&&(n+=" if (true) { "),n;var f,h=e.opts.$data&&a&&a.$data;h?(n+=" var schema"+i+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ",f="schema"+i):f=a;var p=e.opts.unknownFormats,d=Array.isArray(p);if(h){n+=" var "+(g="format"+i)+" = formats["+f+"]; var "+(y="isObject"+i)+" = typeof "+g+" == 'object' && !("+g+" instanceof RegExp) && "+g+".validate; var "+(v="formatType"+i)+" = "+y+" && "+g+".type || 'string'; if ("+y+") { ",e.async&&(n+=" var async"+i+" = "+g+".async; "),n+=" "+g+" = "+g+".validate; } if (  ",h&&(n+=" ("+f+" !== undefined && typeof "+f+" != 'string') || "),n+=" (","ignore"!=p&&(n+=" ("+f+" && !"+g+" ",d&&(n+=" && self._opts.unknownFormats.indexOf("+f+") == -1 "),n+=") || "),n+=" ("+g+" && "+v+" == '"+r+"' && !(typeof "+g+" == 'function' ? ",e.async?n+=" (async"+i+" ? await "+g+"("+l+") : "+g+"("+l+")) ":n+=" "+g+"("+l+") ",n+=" : "+g+".test("+l+"))))) {"}else{var g;if(!(g=e.formats[a])){if("ignore"==p)return e.logger.warn('unknown format "'+a+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(n+=" if (true) { "),n;if(d&&p.indexOf(a)>=0)return c&&(n+=" if (true) { "),n;throw new Error('unknown format "'+a+'" is used in schema at path "'+e.errSchemaPath+'"')}var y,v=(y="object"==typeof g&&!(g instanceof RegExp)&&g.validate)&&g.type||"string";if(y){var m=!0===g.async;g=g.validate}if(v!=r)return c&&(n+=" if (true) { "),n;if(m){if(!e.async)throw new Error("async format in sync schema");n+=" if (!(await "+(b="formats"+e.util.getProperty(a)+".validate")+"("+l+"))) { "}else{n+=" if (! ";var b="formats"+e.util.getProperty(a);y&&(b+=".validate"),n+="function"==typeof g?" "+b+"("+l+") ":" "+b+".test("+l+") ",n+=") { "}}var E=E||[];E.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { format:  ",n+=h?""+f:""+e.util.toQuotedString(a),n+="  } ",!1!==e.opts.messages&&(n+=" , message: 'should match format \"",n+=h?"' + "+f+" + '":""+e.util.escapeQuotes(a),n+="\"' "),e.opts.verbose&&(n+=" , schema:  ",n+=h?"validate.schema"+s:""+e.util.toQuotedString(a),n+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var S=n;return n=E.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+S+"]); ":n+=" validate.errors = ["+S+"]; return false; ":n+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",c&&(n+=" else { "),n},if:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h="errs__"+i,p=e.util.copy(e);p.level++;var d="valid"+p.level,g=e.schema.then,y=e.schema.else,v=void 0!==g&&(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0||!1===g:e.util.schemaHasRules(g,e.RULES.all)),m=void 0!==y&&(e.opts.strictKeywords?"object"==typeof y&&Object.keys(y).length>0||!1===y:e.util.schemaHasRules(y,e.RULES.all)),b=p.baseId;if(v||m){var E;p.createErrors=!1,p.schema=a,p.schemaPath=s,p.errSchemaPath=u,n+=" var "+h+" = errors; var "+f+" = true;  ";var S=e.compositeRule;e.compositeRule=p.compositeRule=!0,n+="  "+e.validate(p)+" ",p.baseId=b,p.createErrors=!0,n+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=S,v?(n+=" if ("+d+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",n+="  "+e.validate(p)+" ",p.baseId=b,n+=" "+f+" = "+d+"; ",v&&m?n+=" var "+(E="ifClause"+i)+" = 'then'; ":E="'then'",n+=" } ",m&&(n+=" else { ")):n+=" if (!"+d+") { ",m&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",n+="  "+e.validate(p)+" ",p.baseId=b,n+=" "+f+" = "+d+"; ",v&&m?n+=" var "+(E="ifClause"+i)+" = 'else'; ":E="'else'",n+=" } "),n+=" if (!"+f+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { failingKeyword: "+E+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match \"' + "+E+" + '\" schema' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" }   ",c&&(n+=" else { ")}else c&&(n+=" if (true) { ");return n},items:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h="errs__"+i,p=e.util.copy(e),d="";p.level++;var g="valid"+p.level,y="i"+i,v=p.dataLevel=e.dataLevel+1,m="data"+v,b=e.baseId;if(n+="var "+h+" = errors;var "+f+";",Array.isArray(a)){var E=e.schema.additionalItems;if(!1===E){n+=" "+f+" = "+l+".length <= "+a.length+"; ";var S=u;u=e.errSchemaPath+"/additionalItems",n+="  if (!"+f+") {   ";var w=w||[];w.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+a.length+" } ",!1!==e.opts.messages&&(n+=" , message: 'should NOT have more than "+a.length+" items' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var _=n;n=w.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+_+"]); ":n+=" validate.errors = ["+_+"]; return false; ":n+=" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u=S,c&&(d+="}",n+=" else { ")}var C=a;if(C)for(var A,I=-1,T=C.length-1;I<T;)if(A=C[I+=1],e.opts.strictKeywords?"object"==typeof A&&Object.keys(A).length>0||!1===A:e.util.schemaHasRules(A,e.RULES.all)){n+=" "+g+" = true; if ("+l+".length > "+I+") { ";var P=l+"["+I+"]";p.schema=A,p.schemaPath=s+"["+I+"]",p.errSchemaPath=u+"/"+I,p.errorPath=e.util.getPathExpr(e.errorPath,I,e.opts.jsonPointers,!0),p.dataPathArr[v]=I;var F=e.validate(p);p.baseId=b,e.util.varOccurences(F,m)<2?n+=" "+e.util.varReplace(F,m,P)+" ":n+=" var "+m+" = "+P+"; "+F+" ",n+=" }  ",c&&(n+=" if ("+g+") { ",d+="}")}if("object"==typeof E&&(e.opts.strictKeywords?"object"==typeof E&&Object.keys(E).length>0||!1===E:e.util.schemaHasRules(E,e.RULES.all))){p.schema=E,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",n+=" "+g+" = true; if ("+l+".length > "+a.length+") {  for (var "+y+" = "+a.length+"; "+y+" < "+l+".length; "+y+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,y,e.opts.jsonPointers,!0);P=l+"["+y+"]";p.dataPathArr[v]=y;F=e.validate(p);p.baseId=b,e.util.varOccurences(F,m)<2?n+=" "+e.util.varReplace(F,m,P)+" ":n+=" var "+m+" = "+P+"; "+F+" ",c&&(n+=" if (!"+g+") break; "),n+=" } }  ",c&&(n+=" if ("+g+") { ",d+="}")}}else if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){p.schema=a,p.schemaPath=s,p.errSchemaPath=u,n+="  for (var "+y+" = 0; "+y+" < "+l+".length; "+y+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,y,e.opts.jsonPointers,!0);P=l+"["+y+"]";p.dataPathArr[v]=y;F=e.validate(p);p.baseId=b,e.util.varOccurences(F,m)<2?n+=" "+e.util.varReplace(F,m,P)+" ":n+=" var "+m+" = "+P+"; "+F+" ",c&&(n+=" if (!"+g+") break; "),n+=" }"}return c&&(n+=" "+d+" if ("+h+" == errors) {"),n},maximum:Dt,minimum:Dt,maxItems:Lt,minItems:Lt,maxLength:Mt,minLength:Mt,maxProperties:Kt,minProperties:Kt,multipleOf:function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h=e.opts.$data&&s&&s.$data;if(h?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s,!h&&"number"!=typeof s)throw new Error(t+" must be number");i+="var division"+o+";if (",h&&(i+=" "+n+" !== undefined && ( typeof "+n+" != 'number' || "),i+=" (division"+o+" = "+f+" / "+n+", ",e.opts.multipleOfPrecision?i+=" Math.abs(Math.round(division"+o+") - division"+o+") > 1e-"+e.opts.multipleOfPrecision+" ":i+=" division"+o+" !== parseInt(division"+o+") ",i+=" ) ",h&&(i+="  )  "),i+=" ) {   ";var p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+n+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be multiple of ",i+=h?"' + "+n:n+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+u:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var d=i;return i=p.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+d+"]); ":i+=" validate.errors = ["+d+"]; return false; ":i+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",l&&(i+=" else { "),i},not:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="errs__"+i,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=u,n+=" var "+f+" = errors;  ";var d,g=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1,h.opts.allErrors&&(d=h.opts.allErrors,h.opts.allErrors=!1),n+=" "+e.validate(h)+" ",h.createErrors=!0,d&&(h.opts.allErrors=d),e.compositeRule=h.compositeRule=g,n+=" if ("+p+") {   ";var y=y||[];y.push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var v=n;n=y.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  errors = "+f+"; if (vErrors !== null) { if ("+f+") vErrors.length = "+f+"; else vErrors = null; } ",e.opts.allErrors&&(n+=" } ")}else n+="  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(n+=" , message: 'should NOT be valid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(n+=" if (false) { ");return n},oneOf:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h="errs__"+i,p=e.util.copy(e),d="";p.level++;var g="valid"+p.level,y=p.baseId,v="prevValid"+i,m="passingSchemas"+i;n+="var "+h+" = errors , "+v+" = false , "+f+" = false , "+m+" = null; ";var b=e.compositeRule;e.compositeRule=p.compositeRule=!0;var E=a;if(E)for(var S,w=-1,_=E.length-1;w<_;)S=E[w+=1],(e.opts.strictKeywords?"object"==typeof S&&Object.keys(S).length>0||!1===S:e.util.schemaHasRules(S,e.RULES.all))?(p.schema=S,p.schemaPath=s+"["+w+"]",p.errSchemaPath=u+"/"+w,n+="  "+e.validate(p)+" ",p.baseId=y):n+=" var "+g+" = true; ",w&&(n+=" if ("+g+" && "+v+") { "+f+" = false; "+m+" = ["+m+", "+w+"]; } else { ",d+="}"),n+=" if ("+g+") { "+f+" = "+v+" = true; "+m+" = "+w+"; }";return e.compositeRule=p.compositeRule=b,n+=d+"if (!"+f+") {   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { passingSchemas: "+m+" } ",!1!==e.opts.messages&&(n+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(n+=" } "),n},pattern:function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h=e.opts.$data&&s&&s.$data;h?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s,i+="if ( ",h&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'string') || "),i+=" !"+(h?"(new RegExp("+n+"))":e.usePattern(s))+".test("+f+") ) {   ";var p=p||[];p.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",i+=h?""+n:""+e.util.toQuotedString(s),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match pattern \"",i+=h?"' + "+n+" + '":""+e.util.escapeQuotes(s),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=h?"validate.schema"+u:""+e.util.toQuotedString(s),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var d=i;return i=p.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+d+"]); ":i+=" validate.errors = ["+d+"]; return false; ":i+=" var err = "+d+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",l&&(i+=" else { "),i},properties:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="errs__"+i,h=e.util.copy(e),p="";h.level++;var d="valid"+h.level,g="key"+i,y="idx"+i,v=h.dataLevel=e.dataLevel+1,m="data"+v,b="dataProperties"+i,E=Object.keys(a||{}).filter(O),S=e.schema.patternProperties||{},w=Object.keys(S).filter(O),_=e.schema.additionalProperties,C=E.length||w.length,A=!1===_,I="object"==typeof _&&Object.keys(_).length,T=e.opts.removeAdditional,P=A||I||T,F=e.opts.ownProperties,k=e.baseId,R=e.schema.required;if(R&&(!e.opts.$data||!R.$data)&&R.length<e.opts.loopRequired)var B=e.util.toHash(R);function O(e){return"__proto__"!==e}if(n+="var "+f+" = errors;var "+d+" = true;",F&&(n+=" var "+b+" = undefined;"),P){if(n+=F?" "+b+" = "+b+" || Object.keys("+l+"); for (var "+y+"=0; "+y+"<"+b+".length; "+y+"++) { var "+g+" = "+b+"["+y+"]; ":" for (var "+g+" in "+l+") { ",C){if(n+=" var isAdditional"+i+" = !(false ",E.length)if(E.length>8)n+=" || validate.schema"+s+".hasOwnProperty("+g+") ";else{var x=E;if(x)for(var N=-1,U=x.length-1;N<U;)J=x[N+=1],n+=" || "+g+" == "+e.util.toQuotedString(J)+" "}if(w.length){var j=w;if(j)for(var D=-1,L=j.length-1;D<L;)oe=j[D+=1],n+=" || "+e.usePattern(oe)+".test("+g+") "}n+=" ); if (isAdditional"+i+") { "}if("all"==T)n+=" delete "+l+"["+g+"]; ";else{var M=e.errorPath,K="' + "+g+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers)),A)if(T)n+=" delete "+l+"["+g+"]; ";else{n+=" "+d+" = false; ";var V=u;u=e.errSchemaPath+"/additionalProperties",(re=re||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { additionalProperty: '"+K+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is an invalid additional property":n+="should NOT have additional properties",n+="' "),e.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var H=n;n=re.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+H+"]); ":n+=" validate.errors = ["+H+"]; return false; ":n+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=V,c&&(n+=" break; ")}else if(I)if("failing"==T){n+=" var "+f+" = errors;  ";var q=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=_,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);var z=l+"["+g+"]";h.dataPathArr[v]=g;var $=e.validate(h);h.baseId=k,e.util.varOccurences($,m)<2?n+=" "+e.util.varReplace($,m,z)+" ":n+=" var "+m+" = "+z+"; "+$+" ",n+=" if (!"+d+") { errors = "+f+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+l+"["+g+"]; }  ",e.compositeRule=h.compositeRule=q}else{h.schema=_,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);z=l+"["+g+"]";h.dataPathArr[v]=g;$=e.validate(h);h.baseId=k,e.util.varOccurences($,m)<2?n+=" "+e.util.varReplace($,m,z)+" ":n+=" var "+m+" = "+z+"; "+$+" ",c&&(n+=" if (!"+d+") break; ")}e.errorPath=M}C&&(n+=" } "),n+=" }  ",c&&(n+=" if ("+d+") { ",p+="}")}var G=e.opts.useDefaults&&!e.compositeRule;if(E.length){var W=E;if(W)for(var J,Q=-1,Y=W.length-1;Q<Y;){var X=a[J=W[Q+=1]];if(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all)){var Z=e.util.getProperty(J),ee=(z=l+Z,G&&void 0!==X.default);h.schema=X,h.schemaPath=s+Z,h.errSchemaPath=u+"/"+e.util.escapeFragment(J),h.errorPath=e.util.getPath(e.errorPath,J,e.opts.jsonPointers),h.dataPathArr[v]=e.util.toQuotedString(J);$=e.validate(h);if(h.baseId=k,e.util.varOccurences($,m)<2){$=e.util.varReplace($,m,z);var te=z}else{te=m;n+=" var "+m+" = "+z+"; "}if(ee)n+=" "+$+" ";else{if(B&&B[J]){n+=" if ( "+te+" === undefined ",F&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(J)+"') "),n+=") { "+d+" = false; ";M=e.errorPath,V=u;var re,ne=e.util.escapeQuotes(J);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(M,J,e.opts.jsonPointers)),u=e.errSchemaPath+"/required",(re=re||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+ne+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+ne+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";H=n;n=re.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+H+"]); ":n+=" validate.errors = ["+H+"]; return false; ":n+=" var err = "+H+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=V,e.errorPath=M,n+=" } else { "}else c?(n+=" if ( "+te+" === undefined ",F&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(J)+"') "),n+=") { "+d+" = true; } else { "):(n+=" if ("+te+" !== undefined ",F&&(n+=" &&   Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(J)+"') "),n+=" ) { ");n+=" "+$+" } "}}c&&(n+=" if ("+d+") { ",p+="}")}}if(w.length){var ie=w;if(ie)for(var oe,ae=-1,se=ie.length-1;ae<se;){X=S[oe=ie[ae+=1]];if(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all)){h.schema=X,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(oe),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(oe),n+=F?" "+b+" = "+b+" || Object.keys("+l+"); for (var "+y+"=0; "+y+"<"+b+".length; "+y+"++) { var "+g+" = "+b+"["+y+"]; ":" for (var "+g+" in "+l+") { ",n+=" if ("+e.usePattern(oe)+".test("+g+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,g,e.opts.jsonPointers);z=l+"["+g+"]";h.dataPathArr[v]=g;$=e.validate(h);h.baseId=k,e.util.varOccurences($,m)<2?n+=" "+e.util.varReplace($,m,z)+" ":n+=" var "+m+" = "+z+"; "+$+" ",c&&(n+=" if (!"+d+") break; "),n+=" } ",c&&(n+=" else "+d+" = true; "),n+=" }  ",c&&(n+=" if ("+d+") { ",p+="}")}}}return c&&(n+=" "+p+" if ("+f+" == errors) {"),n},propertyNames:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="errs__"+i,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(n+="var "+f+" = errors;",e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=s,h.errSchemaPath=u;var d="key"+i,g="idx"+i,y="i"+i,v="' + "+d+" + '",m="data"+(h.dataLevel=e.dataLevel+1),b="dataProperties"+i,E=e.opts.ownProperties,S=e.baseId;E&&(n+=" var "+b+" = undefined; "),n+=E?" "+b+" = "+b+" || Object.keys("+l+"); for (var "+g+"=0; "+g+"<"+b+".length; "+g+"++) { var "+d+" = "+b+"["+g+"]; ":" for (var "+d+" in "+l+") { ",n+=" var startErrs"+i+" = errors; ";var w=d,_=e.compositeRule;e.compositeRule=h.compositeRule=!0;var C=e.validate(h);h.baseId=S,e.util.varOccurences(C,m)<2?n+=" "+e.util.varReplace(C,m,w)+" ":n+=" var "+m+" = "+w+"; "+C+" ",e.compositeRule=h.compositeRule=_,n+=" if (!"+p+") { for (var "+y+"=startErrs"+i+"; "+y+"<errors; "+y+"++) { vErrors["+y+"].propertyName = "+d+"; }   var err =   ",!1!==e.createErrors?(n+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { propertyName: '"+v+"' } ",!1!==e.opts.messages&&(n+=" , message: 'property name \\'"+v+"\\' is invalid' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),c&&(n+=" break; "),n+=" } }"}return c&&(n+="  if ("+f+" == errors) {"),n},required:function(e,t,r){var n=" ",i=e.level,o=e.dataLevel,a=e.schema[t],s=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,l="data"+(o||""),f="valid"+i,h=e.opts.$data&&a&&a.$data;h&&(n+=" var schema"+i+" = "+e.util.getData(a.$data,o,e.dataPathArr)+"; ");var p="schema"+i;if(!h)if(a.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var d=[],g=a;if(g)for(var y,v=-1,m=g.length-1;v<m;){y=g[v+=1];var b=e.schema.properties[y];b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0||!1===b:e.util.schemaHasRules(b,e.RULES.all))||(d[d.length]=y)}}else d=a;if(h||d.length){var E=e.errorPath,S=h||d.length>=e.opts.loopRequired,w=e.opts.ownProperties;if(c)if(n+=" var missing"+i+"; ",S){h||(n+=" var "+p+" = validate.schema"+s+"; ");var _="' + "+(F="schema"+i+"["+(I="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(E,F,e.opts.jsonPointers)),n+=" var "+f+" = true; ",h&&(n+=" if (schema"+i+" === undefined) "+f+" = true; else if (!Array.isArray(schema"+i+")) "+f+" = false; else {"),n+=" for (var "+I+" = 0; "+I+" < "+p+".length; "+I+"++) { "+f+" = "+l+"["+p+"["+I+"]] !== undefined ",w&&(n+=" &&   Object.prototype.hasOwnProperty.call("+l+", "+p+"["+I+"]) "),n+="; if (!"+f+") break; } ",h&&(n+="  }  "),n+="  if (!"+f+") {   ",(P=P||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+_+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+_+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";var C=n;n=P.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+C+"]); ":n+=" validate.errors = ["+C+"]; return false; ":n+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else{n+=" if ( ";var A=d;if(A)for(var I=-1,T=A.length-1;I<T;){R=A[I+=1],I&&(n+=" || "),n+=" ( ( "+(N=l+(x=e.util.getProperty(R)))+" === undefined ",w&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(R)+"') "),n+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?R:x)+") ) "}n+=") {  ";var P;_="' + "+(F="missing"+i)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(E,F,!0):E+" + "+F),(P=P||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+_+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+_+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ";C=n;n=P.pop(),!e.compositeRule&&c?e.async?n+=" throw new ValidationError(["+C+"]); ":n+=" validate.errors = ["+C+"]; return false; ":n+=" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else if(S){h||(n+=" var "+p+" = validate.schema"+s+"; ");var F;_="' + "+(F="schema"+i+"["+(I="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(E,F,e.opts.jsonPointers)),h&&(n+=" if ("+p+" && !Array.isArray("+p+")) {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+_+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+_+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+p+" !== undefined) { "),n+=" for (var "+I+" = 0; "+I+" < "+p+".length; "+I+"++) { if ("+l+"["+p+"["+I+"]] === undefined ",w&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", "+p+"["+I+"]) "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+_+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+_+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",h&&(n+="  }  ")}else{var k=d;if(k)for(var R,B=-1,O=k.length-1;B<O;){R=k[B+=1];var x=e.util.getProperty(R),N=(_=e.util.escapeQuotes(R),l+x);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(E,R,e.opts.jsonPointers)),n+=" if ( "+N+" === undefined ",w&&(n+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(R)+"') "),n+=") {  var err =   ",!1!==e.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { missingProperty: '"+_+"' } ",!1!==e.opts.messages&&(n+=" , message: '",e.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+_+"\\'",n+="' "),e.opts.verbose&&(n+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=E}else c&&(n+=" if (true) {");return n},uniqueItems:function(e,t,r){var n,i=" ",o=e.level,a=e.dataLevel,s=e.schema[t],u=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,f="data"+(a||""),h="valid"+o,p=e.opts.$data&&s&&s.$data;if(p?(i+=" var schema"+o+" = "+e.util.getData(s.$data,a,e.dataPathArr)+"; ",n="schema"+o):n=s,(s||p)&&!1!==e.opts.uniqueItems){p&&(i+=" var "+h+"; if ("+n+" === false || "+n+" === undefined) "+h+" = true; else if (typeof "+n+" != 'boolean') "+h+" = false; else { "),i+=" var i = "+f+".length , "+h+" = true , j; if (i > 1) { ";var d=e.schema.items&&e.schema.items.type,g=Array.isArray(d);if(!d||"object"==d||"array"==d||g&&(d.indexOf("object")>=0||d.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+f+"[i], "+f+"[j])) { "+h+" = false; break outer; } } } ";else{i+=" var itemIndices = {}, item; for (;i--;) { var item = "+f+"[i]; ";var y="checkDataType"+(g?"s":"");i+=" if ("+e.util[y](d,"item",e.opts.strictNumbers,!0)+") continue; ",g&&(i+=" if (typeof item == 'string') item = '\"' + item; "),i+=" if (typeof itemIndices[item] == 'number') { "+h+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}i+=" } ",p&&(i+="  }  "),i+=" if (!"+h+") {   ";var v=v||[];v.push(i),i="",!1!==e.createErrors?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(i+=" , schema:  ",i+=p?"validate.schema"+u:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),i+=" } "):i+=" {} ";var m=i;i=v.pop(),!e.compositeRule&&l?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",l&&(i+=" else { ")}else l&&(i+=" if (true) { ");return i},validate:at},Ht=Ae.toHash,qt=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"],zt=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var n,i=t[r].split("/"),o=e;for(n=1;n<i.length;n++)o=o[i[n]];for(n=0;n<qt.length;n++){var a=qt[n],s=o[a];s&&(o[a]={anyOf:[s,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e},$t=rt.MissingRef,Gt=function e(t,r,n){var i=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof r&&(n=r,r=void 0);var o=a(t).then((function(){var e=i._addSchema(t,void 0,r);return e.validate||s(e)}));n&&o.then((function(e){n(null,e)}),n);return o;function a(t){var r=t.$schema;return r&&!i.getSchema(r)?e.call(i,{$ref:r},!0):Promise.resolve()}function s(e){try{return i._compile(e)}catch(t){if(t instanceof $t)return function(t){var n=t.missingSchema;if(c(n))throw new Error("Schema "+n+" is loaded but "+t.missingRef+" cannot be resolved");var o=i._loadingSchemas[n];o||(o=i._loadingSchemas[n]=i._opts.loadSchema(n)).then(u,u);return o.then((function(e){if(!c(n))return a(e).then((function(){c(n)||i.addSchema(e,n,void 0,r)}))})).then((function(){return s(e)}));function u(){delete i._loadingSchemas[n]}function c(e){return i._refs[e]||i._schemas[e]}}(t);throw t}}};var Wt=function(e,t,r){var n,i,o=" ",a=e.level,s=e.dataLevel,u=e.schema[t],c=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,f=!e.opts.allErrors,h="data"+(s||""),p="valid"+a,d="errs__"+a,g=e.opts.$data&&u&&u.$data;g?(o+=" var schema"+a+" = "+e.util.getData(u.$data,s,e.dataPathArr)+"; ",i="schema"+a):i=u;var y,v,m,b,E,S=this,w="definition"+a,_=S.definition,C="";if(g&&_.$data){E="keywordValidate"+a;var A=_.validateSchema;o+=" var "+w+" = RULES.custom['"+t+"'].definition; var "+E+" = "+w+".validate;"}else{if(!(b=e.useCustomRule(S,u,e.schema,e)))return;i="validate.schema"+c,E=b.code,y=_.compile,v=_.inline,m=_.macro}var I=E+".errors",T="i"+a,P="ruleErr"+a,F=_.async;if(F&&!e.async)throw new Error("async keyword in sync schema");if(v||m||(o+=I+" = null;"),o+="var "+d+" = errors;var "+p+";",g&&_.$data&&(C+="}",o+=" if ("+i+" === undefined) { "+p+" = true; } else { ",A&&(C+="}",o+=" "+p+" = "+w+".validateSchema("+i+"); if ("+p+") { ")),v)_.statements?o+=" "+b.validate+" ":o+=" "+p+" = "+b.validate+"; ";else if(m){var k=e.util.copy(e);C="";k.level++;var R="valid"+k.level;k.schema=b.validate,k.schemaPath="";var B=e.compositeRule;e.compositeRule=k.compositeRule=!0;var O=e.validate(k).replace(/validate\.schema/g,E);e.compositeRule=k.compositeRule=B,o+=" "+O}else{(j=j||[]).push(o),o="",o+="  "+E+".call( ",e.opts.passContext?o+="this":o+="self",y||!1===_.schema?o+=" , "+h+" ":o+=" , "+i+" , "+h+" , validate.schema"+e.schemaPath+" ",o+=" , (dataPath || '')",'""'!=e.errorPath&&(o+=" + "+e.errorPath);var x=s?"data"+(s-1||""):"parentData",N=s?e.dataPathArr[s]:"parentDataProperty",U=o+=" , "+x+" , "+N+" , rootData )  ";o=j.pop(),!1===_.errors?(o+=" "+p+" = ",F&&(o+="await "),o+=U+"; "):o+=F?" var "+(I="customErrors"+a)+" = null; try { "+p+" = await "+U+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+I+" = e.errors; else throw e; } ":" "+I+" = null; "+p+" = "+U+"; "}if(_.modifying&&(o+=" if ("+x+") "+h+" = "+x+"["+N+"];"),o+=""+C,_.valid)f&&(o+=" if (true) { ");else{var j;o+=" if ( ",void 0===_.valid?(o+=" !",o+=m?""+R:""+p):o+=" "+!_.valid+" ",o+=") { ",n=S.keyword,(j=j||[]).push(o),o="",(j=j||[]).push(o),o="",!1!==e.createErrors?(o+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { keyword: '"+S.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+S.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ";var D=o;o=j.pop(),!e.compositeRule&&f?e.async?o+=" throw new ValidationError(["+D+"]); ":o+=" validate.errors = ["+D+"]; return false; ":o+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var L=o;o=j.pop(),v?_.errors?"full"!=_.errors&&(o+="  for (var "+T+"="+d+"; "+T+"<errors; "+T+"++) { var "+P+" = vErrors["+T+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+P+".schemaPath === undefined) { "+P+'.schemaPath = "'+l+'"; } ',e.opts.verbose&&(o+=" "+P+".schema = "+i+"; "+P+".data = "+h+"; "),o+=" } "):!1===_.errors?o+=" "+L+" ":(o+=" if ("+d+" == errors) { "+L+" } else {  for (var "+T+"="+d+"; "+T+"<errors; "+T+"++) { var "+P+" = vErrors["+T+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+P+".schemaPath === undefined) { "+P+'.schemaPath = "'+l+'"; } ',e.opts.verbose&&(o+=" "+P+".schema = "+i+"; "+P+".data = "+h+"; "),o+=" } } "):m?(o+="   var err =   ",!1!==e.createErrors?(o+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { keyword: '"+S.keyword+"' } ",!1!==e.opts.messages&&(o+=" , message: 'should pass \""+S.keyword+"\" keyword validation' "),e.opts.verbose&&(o+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ",o+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&f&&(e.async?o+=" throw new ValidationError(vErrors); ":o+=" validate.errors = vErrors; return false; ")):!1===_.errors?o+=" "+L+" ":(o+=" if (Array.isArray("+I+")) { if (vErrors === null) vErrors = "+I+"; else vErrors = vErrors.concat("+I+"); errors = vErrors.length;  for (var "+T+"="+d+"; "+T+"<errors; "+T+"++) { var "+P+" = vErrors["+T+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+e.errorPath+";  "+P+'.schemaPath = "'+l+'";  ',e.opts.verbose&&(o+=" "+P+".schema = "+i+"; "+P+".data = "+h+"; "),o+=" } } else { "+L+" } "),o+=" } ",f&&(o+=" else { ")}return o};var Jt={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},Qt={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:Jt.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:Jt.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},Yt=/^[a-z_$][a-z0-9_$-]*$/i,Xt=function(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!Yt.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var n=t.type;if(Array.isArray(n))for(var i=0;i<n.length;i++)a(e,n[i],t);else a(e,n,t);var o=t.metaSchema;o&&(t.$data&&this._opts.$data&&(o={anyOf:[o,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(o,!0))}function a(e,t,n){for(var i,o=0;o<r.length;o++){var a=r[o];if(a.type==t){i=a;break}}i||(i={type:t,rules:[]},r.push(i));var s={keyword:e,definition:n,custom:!0,code:Wt,implements:n.implements};i.rules.push(s),r.custom[e]=s}return r.keywords[e]=r.all[e]=!0,this},Zt=function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},er=function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var n=t[r].rules,i=0;i<n.length;i++)if(n[i].keyword==e){n.splice(i,1);break}return this},tr=function e(t,r){e.errors=null;var n=this._validateKeyword=this._validateKeyword||this.compile(Qt,!0);if(n(t))return!0;if(e.errors=n.errors,r)throw new Error("custom keyword definition is invalid: "+this.errorsText(n.errors));return!1};var rr={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1},nr=sr;sr.prototype.validate=function(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var n=this._addSchema(e);r=n.validate||this._compile(n)}var i=r(t);!0!==r.$async&&(this.errors=r.errors);return i},sr.prototype.compile=function(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},sr.prototype.addSchema=function(e,t,r,n){if(Array.isArray(e)){for(var i=0;i<e.length;i++)this.addSchema(e[i],void 0,r,n);return this}var o=this._getId(e);if(void 0!==o&&"string"!=typeof o)throw new Error("schema id must be string");return pr(this,t=Ke.normalizeId(t||o)),this._schemas[t]=this._addSchema(e,r,n,!0),this},sr.prototype.addMetaSchema=function(e,t,r){return this.addSchema(e,t,r,!0),this},sr.prototype.validateSchema=function(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(ir)?ir:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,e);if(!n&&t){var i="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(i);this.logger.error(i)}return n},sr.prototype.getSchema=function(e){var t=ur(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var r=Ke.schema.call(e,{schema:{}},t);if(r){var n=r.schema,i=r.root,o=r.baseId,a=ct.call(e,n,i,void 0,o);return e._fragments[t]=new Le({ref:t,fragment:!0,schema:n,root:i,baseId:o,validate:a}),a}}(this,e)}},sr.prototype.removeSchema=function(e){if(e instanceof RegExp)return cr(this,this._schemas,e),cr(this,this._refs,e),this;switch(typeof e){case"undefined":return cr(this,this._schemas),cr(this,this._refs),this._cache.clear(),this;case"string":var t=ur(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,n=r?r(e):e;this._cache.del(n);var i=this._getId(e);i&&(i=Ke.normalizeId(i),delete this._schemas[i],delete this._refs[i])}return this},sr.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},sr.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,n=void 0===t.dataVar?"data":t.dataVar,i="",o=0;o<e.length;o++){var a=e[o];a&&(i+=n+a.dataPath+" "+a.message+r)}return i.slice(0,-r.length)},sr.prototype._addSchema=function(e,t,r,n){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var i=this._opts.serialize,o=i?i(e):e,a=this._cache.get(o);if(a)return a;n=n||!1!==this._opts.addUsedSchema;var s=Ke.normalizeId(this._getId(e));s&&n&&pr(this,s);var u,c=!1!==this._opts.validateSchema&&!t;c&&!(u=s&&s==Ke.normalizeId(e.$schema))&&this.validateSchema(e,!0);var l=Ke.ids.call(this,e),f=new Le({id:s,schema:e,localRefs:l,cacheKey:o,meta:r});"#"!=s[0]&&n&&(this._refs[s]=f);this._cache.put(o,f),c&&u&&this.validateSchema(e,!0);return f},sr.prototype._compile=function(e,t){if(e.compiling)return e.validate=i,i.schema=e.schema,i.errors=null,i.root=t||i,!0===e.schema.$async&&(i.$async=!0),i;var r,n;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{n=ct.call(this,e.schema,t,e.localRefs)}catch(o){throw delete e.validate,o}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=n,e.refs=n.refs,e.refVal=n.refVal,e.root=n.root,n;function i(){var t=e.validate,r=t.apply(this,arguments);return i.errors=t.errors,r}},sr.prototype.compileAsync=Gt,sr.prototype.addKeyword=Xt,sr.prototype.getKeyword=Zt,sr.prototype.removeKeyword=er,sr.prototype.validateKeyword=tr,sr.ValidationError=rt.Validation,sr.MissingRefError=rt.MissingRef,sr.$dataMetaSchema=zt;var ir="http://json-schema.org/draft-07/schema",or=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],ar=["/properties"];function sr(e){if(!(this instanceof sr))return new sr(e);var t,r;e=this._opts=Ae.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:dr,warn:dr,error:dr};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=kt(e.format),this._cache=e.cache||new mt,this._loadingSchemas={},this._compilations=[],this.RULES=((t=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}]).all=Ht(r=["type","$comment"]),t.types=Ht(["number","integer","string","array","object","boolean","null"]),t.forEach((function(e){e.rules=e.rules.map((function(e){var n;if("object"==typeof e){var i=Object.keys(e)[0];n=e[i],e=i,n.forEach((function(e){r.push(e),t.all[e]=!0}))}return r.push(e),t.all[e]={keyword:e,code:Vt[e],implements:n}})),t.all.$comment={keyword:"$comment",code:Vt.$comment},e.type&&(t.types[e.type]=e)})),t.keywords=Ht(r.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),t.custom={},t),this._getId=function(e){switch(e.schemaId){case"auto":return hr;case"id":return lr;default:return fr}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=ot),this._metaOpts=function(e){for(var t=Ae.copy(e._opts),r=0;r<or.length;r++)delete t[or[r]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var r=e._opts.keywords[t];e.addKeyword(t,r)}}(this),function(e){var t;e._opts.$data&&(t=rr,e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var r=Jt;e._opts.$data&&(r=zt(r,ar));e.addMetaSchema(r,ir,!0),e._refs["http://json-schema.org/schema"]=ir}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function ur(e,t){return t=Ke.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function cr(e,t,r){for(var n in t){var i=t[n];i.meta||r&&!r.test(n)||(e._cache.del(i.cacheKey),delete t[n])}}function lr(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function fr(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function hr(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function pr(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function dr(){}var gr=u((function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,i="[object Arguments]",o="[object Boolean]",s="[object Date]",u="[object Function]",c="[object GeneratorFunction]",l="[object Map]",f="[object Number]",h="[object Object]",p="[object Promise]",d="[object RegExp]",g="[object Set]",y="[object String]",v="[object Symbol]",m="[object WeakMap]",b="[object ArrayBuffer]",E="[object DataView]",S="[object Float32Array]",w="[object Float64Array]",_="[object Int8Array]",C="[object Int16Array]",A="[object Int32Array]",I="[object Uint8Array]",T="[object Uint8ClampedArray]",P="[object Uint16Array]",F="[object Uint32Array]",k=/\w*$/,R=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,O={};O[i]=O["[object Array]"]=O[b]=O[E]=O[o]=O[s]=O[S]=O[w]=O[_]=O[C]=O[A]=O[l]=O[f]=O[h]=O[d]=O[g]=O[y]=O[v]=O[I]=O[T]=O[P]=O[F]=!0,O["[object Error]"]=O[u]=O[m]=!1;var x="object"==typeof a&&a&&a.Object===Object&&a,N="object"==typeof self&&self&&self.Object===Object&&self,U=x||N||Function("return this")(),j=t&&!t.nodeType&&t,D=j&&e&&!e.nodeType&&e,L=D&&D.exports===j;function M(e,t){return e.set(t[0],t[1]),e}function K(e,t){return e.add(t),e}function V(e,t,r,n){var i=-1,o=e?e.length:0;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function H(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(r){}return t}function q(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function z(e,t){return function(r){return e(t(r))}}function $(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var G,W=Array.prototype,J=Function.prototype,Q=Object.prototype,Y=U["__core-js_shared__"],X=(G=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",Z=J.toString,ee=Q.hasOwnProperty,te=Q.toString,re=RegExp("^"+Z.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=L?U.Buffer:void 0,ie=U.Symbol,oe=U.Uint8Array,ae=z(Object.getPrototypeOf,Object),se=Object.create,ue=Q.propertyIsEnumerable,ce=W.splice,le=Object.getOwnPropertySymbols,fe=ne?ne.isBuffer:void 0,he=z(Object.keys,Object),pe=De(U,"DataView"),de=De(U,"Map"),ge=De(U,"Promise"),ye=De(U,"Set"),ve=De(U,"WeakMap"),me=De(Object,"create"),be=He(pe),Ee=He(de),Se=He(ge),we=He(ye),_e=He(ve),Ce=ie?ie.prototype:void 0,Ae=Ce?Ce.valueOf:void 0;function Ie(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Te(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Pe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Fe(e){this.__data__=new Te(e)}function ke(e,t){var r=ze(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&$e(e)}(e)&&ee.call(e,"callee")&&(!ue.call(e,"callee")||te.call(e)==i)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,o=!!n;for(var a in e)!t&&!ee.call(e,a)||o&&("length"==a||Ke(a,n))||r.push(a);return r}function Re(e,t,r){var n=e[t];ee.call(e,t)&&qe(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function Be(e,t){for(var r=e.length;r--;)if(qe(e[r][0],t))return r;return-1}function Oe(e,t,r,n,a,p,m){var R;if(n&&(R=p?n(e,a,p,m):n(e)),void 0!==R)return R;if(!Je(e))return e;var B=ze(e);if(B){if(R=function(e){var t=e.length,r=e.constructor(t);t&&"string"==typeof e[0]&&ee.call(e,"index")&&(r.index=e.index,r.input=e.input);return r}(e),!t)return function(e,t){var r=-1,n=e.length;t||(t=Array(n));for(;++r<n;)t[r]=e[r];return t}(e,R)}else{var x=Me(e),N=x==u||x==c;if(Ge(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(x==h||x==i||N&&!p){if(H(e))return p?e:{};if(R=function(e){return"function"!=typeof e.constructor||Ve(e)?{}:(t=ae(e),Je(t)?se(t):{});var t}(N?{}:e),!t)return function(e,t){return Ue(e,Le(e),t)}(e,function(e,t){return e&&Ue(t,Qe(t),e)}(R,e))}else{if(!O[x])return p?e:{};R=function(e,t,r,n){var i=e.constructor;switch(t){case b:return Ne(e);case o:case s:return new i(+e);case E:return function(e,t){var r=t?Ne(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case S:case w:case _:case C:case A:case I:case T:case P:case F:return function(e,t){var r=t?Ne(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case l:return function(e,t,r){return V(t?r(q(e),!0):q(e),M,new e.constructor)}(e,n,r);case f:case y:return new i(e);case d:return function(e){var t=new e.constructor(e.source,k.exec(e));return t.lastIndex=e.lastIndex,t}(e);case g:return function(e,t,r){return V(t?r($(e),!0):$(e),K,new e.constructor)}(e,n,r);case v:return a=e,Ae?Object(Ae.call(a)):{}}var a}(e,x,Oe,t)}}m||(m=new Fe);var U=m.get(e);if(U)return U;if(m.set(e,R),!B)var j=r?function(e){return function(e,t,r){var n=t(e);return ze(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,Qe,Le)}(e):Qe(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););}(j||e,(function(i,o){j&&(i=e[o=i]),Re(R,o,Oe(i,t,r,n,o,e,m))})),R}function xe(e){return!(!Je(e)||(t=e,X&&X in t))&&(We(e)||H(e)?re:R).test(He(e));var t}function Ne(e){var t=new e.constructor(e.byteLength);return new oe(t).set(new oe(e)),t}function Ue(e,t,r,n){r||(r={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=n?n(r[a],e[a],a,r,e):void 0;Re(r,a,void 0===s?e[a]:s)}return r}function je(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function De(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return xe(r)?r:void 0}Ie.prototype.clear=function(){this.__data__=me?me(null):{}},Ie.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ie.prototype.get=function(e){var t=this.__data__;if(me){var n=t[e];return n===r?void 0:n}return ee.call(t,e)?t[e]:void 0},Ie.prototype.has=function(e){var t=this.__data__;return me?void 0!==t[e]:ee.call(t,e)},Ie.prototype.set=function(e,t){return this.__data__[e]=me&&void 0===t?r:t,this},Te.prototype.clear=function(){this.__data__=[]},Te.prototype.delete=function(e){var t=this.__data__,r=Be(t,e);return!(r<0)&&(r==t.length-1?t.pop():ce.call(t,r,1),!0)},Te.prototype.get=function(e){var t=this.__data__,r=Be(t,e);return r<0?void 0:t[r][1]},Te.prototype.has=function(e){return Be(this.__data__,e)>-1},Te.prototype.set=function(e,t){var r=this.__data__,n=Be(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},Pe.prototype.clear=function(){this.__data__={hash:new Ie,map:new(de||Te),string:new Ie}},Pe.prototype.delete=function(e){return je(this,e).delete(e)},Pe.prototype.get=function(e){return je(this,e).get(e)},Pe.prototype.has=function(e){return je(this,e).has(e)},Pe.prototype.set=function(e,t){return je(this,e).set(e,t),this},Fe.prototype.clear=function(){this.__data__=new Te},Fe.prototype.delete=function(e){return this.__data__.delete(e)},Fe.prototype.get=function(e){return this.__data__.get(e)},Fe.prototype.has=function(e){return this.__data__.has(e)},Fe.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Te){var n=r.__data__;if(!de||n.length<199)return n.push([e,t]),this;r=this.__data__=new Pe(n)}return r.set(e,t),this};var Le=le?z(le,Object):function(){return[]},Me=function(e){return te.call(e)};function Ke(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||B.test(e))&&e>-1&&e%1==0&&e<t}function Ve(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Q)}function He(e){if(null!=e){try{return Z.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function qe(e,t){return e===t||e!=e&&t!=t}(pe&&Me(new pe(new ArrayBuffer(1)))!=E||de&&Me(new de)!=l||ge&&Me(ge.resolve())!=p||ye&&Me(new ye)!=g||ve&&Me(new ve)!=m)&&(Me=function(e){var t=te.call(e),r=t==h?e.constructor:void 0,n=r?He(r):void 0;if(n)switch(n){case be:return E;case Ee:return l;case Se:return p;case we:return g;case _e:return m}return t});var ze=Array.isArray;function $e(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}(e.length)&&!We(e)}var Ge=fe||function(){return!1};function We(e){var t=Je(e)?te.call(e):"";return t==u||t==c}function Je(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Qe(e){return $e(e)?ke(e):function(e){if(!Ve(e))return he(e);var t=[];for(var r in Object(e))ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Oe(e,!0,!0)}})),yr=u((function(e,t){var r=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.traverseObject=t.compileJoinedStringOf=t.compileTypeof=void 0;const n=r(nr),i=r(gr),o=r(ve);function s(e){return t=>typeof t===e}function u(e){return t=>!t.split(" ").some((t=>-1===e.indexOf(t)))}function c(e,t,r,n){"object"===t.type?Object.keys(e).forEach((r=>{t.properties&&t.properties[r]&&c(e[r],t.properties[r],e,r)})):"array"===t.type?e.forEach(((r,n)=>{t.items&&c(r,t.items,e,n)})):t.shouldConvertToUrl&&r&&n&&(r[n]=e)}t.compileTypeof=s,t.compileJoinedStringOf=u,t.traverseObject=c,t.default=function(e,t){const r=i.default(t),a=new n.default;if(a.addKeyword("typeof",{compile:s}),a.addKeyword("joinedStringOf",{compile:u}),!a.validate(e,r)){let t=`${e.title?e.title:"schema"} is invalid`;throw a.errors&&(t+=":",t+=a.errors.map((e=>`\n${e.dataPath} ${e.message}`)).toString()),new o.default(t)}return c(r,e),r}})),vr=u((function(e,t){var r=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveSessionInfoToStorage=t.loadOidcContextFromStorage=t.getSessionIdFromOauthState=void 0;const n=r(yr),i=r(ve);t.getSessionIdFromOauthState=async function(e,t){return e.getForUser(t,"sessionId")},t.loadOidcContextFromStorage=async function(e,t,r){try{const[n,i,o,a]=await Promise.all([t.getForUser(e,"issuer",{errorIfNull:!0}),t.getForUser(e,"codeVerifier"),t.getForUser(e,"redirectUrl"),t.getForUser(e,"dpop",{errorIfNull:!0})]);return{codeVerifier:i,redirectUrl:o,issuerConfig:await r.fetchConfig(n),dpop:"true"===a}}catch(n){throw new Error(`Failed to retrieve OIDC context from storage associated with session [${e}]: ${n.toString()}`)}},t.saveSessionInfoToStorage=async function(e,t,r,n,i,o,a){void 0!==o&&await e.setForUser(t,{refreshToken:o},{secure:a}),void 0!==r&&await e.setForUser(t,{idToken:r},{secure:a}),void 0!==n&&await e.setForUser(t,{webId:n},{secure:a}),void 0!==i&&await e.setForUser(t,{isLoggedIn:i},{secure:a})};t.default=class{constructor(e,t){this.secureStorage=e,this.insecureStorage=t,this.RESOURCE_SERVER_SESSION_INFORMATION_KEY="tmp-resource-server-session-info"}getKey(e){return`solidClientAuthenticationUser:${e}`}async getUserData(e,t){const r=await(t?this.secureStorage:this.insecureStorage).get(this.getKey(e));if(void 0===r)return{};try{return JSON.parse(r)}catch(n){throw new i.default(`Data for user [${e}] in [${t?"secure":"unsecure"}] storage is corrupted - expected valid JSON, but got: ${r}`)}}async setUserData(e,t,r){await(r?this.secureStorage:this.insecureStorage).set(this.getKey(e),JSON.stringify(t))}async get(e,t){const r=await((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).get(e);if(void 0===r&&(null==t?void 0:t.errorIfNull))throw new i.default(`[${e}] is not stored`);return r}async set(e,t,r){return((null==r?void 0:r.secure)?this.secureStorage:this.insecureStorage).set(e,t)}async delete(e,t){return((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).delete(e)}async getForUser(e,t,r){const n=await this.getUserData(e,null==r?void 0:r.secure);let o;if(n&&n[t]||(o=void 0),o=n[t],void 0===o&&(null==r?void 0:r.errorIfNull))throw new i.default(`Field [${t}] for user [${e}] is not stored`);return o||void 0}async setForUser(e,t,r){let n;try{n=await this.getUserData(e,null==r?void 0:r.secure)}catch(i){n={}}await this.setUserData(e,o(o({},n),t),null==r?void 0:r.secure)}async deleteForUser(e,t,r){const n=await this.getUserData(e,null==r?void 0:r.secure);delete n[t],await this.setUserData(e,n,null==r?void 0:r.secure)}async deleteAllUserData(e,t){await((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).delete(this.getKey(e))}async storeResourceServerSessionInfo(e,t,r){var n;const i=JSON.parse(null!==(n=await this.insecureStorage.get(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY))&&void 0!==n?n:"{}");i.webId!==e&&(i.sessions={}),i.webId=e,i.sessions[t]={expiration:r},await this.insecureStorage.set(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY,JSON.stringify(i))}async clearResourceServerSessionInfo(e){var t;const r=JSON.parse(null!==(t=await this.insecureStorage.get(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY))&&void 0!==t?t:"{}");void 0!==r.sessions&&(delete r.sessions[e],0===Object.keys(r.sessions).length?await this.insecureStorage.set(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY,"{}"):await this.insecureStorage.set(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY,JSON.stringify(r)))}async safeGet(e,t={}){const r=t.userId?await this.getForUser(t.userId,e,{secure:t.secure}):await this.get(e,{secure:t.secure});if(r)try{const e=JSON.parse(r);if(t.schema){return n.default(t.schema,e)}return e}catch(o){let r;throw r=t.userId?await this.getForUser(t.userId,e,{secure:t.secure}):await this.get(e,{secure:t.secure}),new i.default(`Object ${JSON.stringify(r)} does not match expected schema: ${JSON.stringify(t.schema)}: ${o.toString()}. \n Please clear your local storage.`)}}}}));var mr=class{constructor(){this.map={}}async get(e){return this.map[e]||void 0}async set(e,t){this.map[e]=t}async delete(e){delete this.map[e]}},br=Object.defineProperty({default:mr},"__esModule",{value:!0});class Er extends Error{constructor(e){super(e)}}var Sr=Er,wr=Object.defineProperty({default:Sr},"__esModule",{value:!0});class _r extends Error{constructor(e){super(`[${e}] is not implemented`)}}var Cr=_r,Ar=Object.defineProperty({default:Cr},"__esModule",{value:!0}),Ir=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mockStorageUtility=t.mockStorage=t.StorageUtilityMock=t.StorageUtilitySafeGetResponse=t.StorageUtilityGetResponse=void 0,t.StorageUtilityGetResponse="getResponse",t.StorageUtilitySafeGetResponse={someKey:"someValue"},t.StorageUtilityMock={get:async(e,r)=>t.StorageUtilityGetResponse,set:async(e,t)=>{},delete:async e=>{},getForUser:async(e,r,n)=>t.StorageUtilityGetResponse,setForUser:async(e,t,r)=>{},deleteForUser:async(e,t,r)=>{},deleteAllUserData:async(e,t)=>{},safeGet:async(e,r)=>t.StorageUtilitySafeGetResponse,storeResourceServerSessionInfo:async(e,t,r)=>{},clearResourceServerSessionInfo:async e=>{}};t.mockStorage=e=>{const t=e;return{get:async e=>{if(void 0!==t[e])return"string"==typeof t[e]?t[e]:JSON.stringify(t[e])},set:async(e,r)=>{t[e]=r},delete:async e=>{delete t[e]}}};t.mockStorageUtility=(e,r=!1)=>r?new Tr.StorageUtility(t.mockStorage(e),t.mockStorage({})):new Tr.StorageUtility(t.mockStorage({}),t.mockStorage(e))})),Tr=u((function(e,t){var r=a&&a.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=a&&a.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},i=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageUtilitySafeGetResponse=t.StorageUtilityGetResponse=t.StorageUtilityMock=t.mockStorageUtility=t.mockStorage=t.NotImplementedError=t.ConfigurationError=t.InMemoryStorage=t.getSessionIdFromOauthState=t.saveSessionInfoToStorage=t.loadOidcContextFromStorage=t.StorageUtility=t.validateSchema=t.issuerConfigSchema=t.USER_SESSION_PREFIX=t.AggregateHandler=void 0,n(de,t),Object.defineProperty(t,"AggregateHandler",{enumerable:!0,get:function(){return i(Ee).default}}),Object.defineProperty(t,"USER_SESSION_PREFIX",{enumerable:!0,get:function(){return Se.USER_SESSION_PREFIX}}),Object.defineProperty(t,"issuerConfigSchema",{enumerable:!0,get:function(){return we.issuerConfigSchema}}),Object.defineProperty(t,"validateSchema",{enumerable:!0,get:function(){return i(yr).default}}),Object.defineProperty(t,"StorageUtility",{enumerable:!0,get:function(){return i(vr).default}}),Object.defineProperty(t,"loadOidcContextFromStorage",{enumerable:!0,get:function(){return vr.loadOidcContextFromStorage}}),Object.defineProperty(t,"saveSessionInfoToStorage",{enumerable:!0,get:function(){return vr.saveSessionInfoToStorage}}),Object.defineProperty(t,"getSessionIdFromOauthState",{enumerable:!0,get:function(){return vr.getSessionIdFromOauthState}}),Object.defineProperty(t,"InMemoryStorage",{enumerable:!0,get:function(){return i(br).default}}),Object.defineProperty(t,"ConfigurationError",{enumerable:!0,get:function(){return i(wr).default}}),Object.defineProperty(t,"NotImplementedError",{enumerable:!0,get:function(){return i(Ar).default}}),Object.defineProperty(t,"mockStorage",{enumerable:!0,get:function(){return Ir.mockStorage}}),Object.defineProperty(t,"mockStorageUtility",{enumerable:!0,get:function(){return Ir.mockStorageUtility}}),Object.defineProperty(t,"StorageUtilityMock",{enumerable:!0,get:function(){return Ir.StorageUtilityMock}}),Object.defineProperty(t,"StorageUtilityGetResponse",{enumerable:!0,get:function(){return Ir.StorageUtilityGetResponse}}),Object.defineProperty(t,"StorageUtilitySafeGetResponse",{enumerable:!0,get:function(){return Ir.StorageUtilitySafeGetResponse}})})),Pr=s(pe),Fr=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},kr=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Rr=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let Br=class extends Tr.StorageUtility{constructor(e,t){super(e,t)}};Br=Fr([Pr.injectable(),Rr(0,Pr.inject("secureStorage")),Rr(1,Pr.inject("insecureStorage")),kr("design:paramtypes",[Object,Object])],Br);for(var Or=Br,xr=Object.defineProperty({default:Or},"__esModule",{value:!0}),Nr=u((function(e,t){var r;r=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={debug:function(){},info:function(){},warn:function(){},error:function(){}},o=void 0,a=void 0;(t.Log=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.reset=function(){a=3,o=i},e.debug=function(){if(a>=4){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.debug.apply(o,Array.from(t))}},e.info=function(){if(a>=3){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.info.apply(o,Array.from(t))}},e.warn=function(){if(a>=2){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.warn.apply(o,Array.from(t))}},e.error=function(){if(a>=1){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.error.apply(o,Array.from(t))}},n(e,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return a},set:function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");a=e}},{key:"logger",get:function(){return o},set:function(e){if(!e.debug&&e.info&&(e.debug=e.info),!(e.debug&&e.info&&e.warn&&e.error))throw new Error("Invalid logger");o=e}}]),e}()).reset()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={setInterval:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return setInterval(e,t)})),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return clearInterval(e)}))},o=!1,a=null;t.Global=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e._testing=function(){o=!0},e.setXMLHttpRequest=function(e){a=e},n(e,null,[{key:"location",get:function(){if(!o)return location}},{key:"localStorage",get:function(){if(!o&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!o&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!o&&"undefined"!=typeof window)return a||XMLHttpRequest}},{key:"timer",get:function(){if(!o)return i}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataService=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(7);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=".well-known/openid-configuration";t.MetadataService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.JsonService;if(a(this,e),!t)throw i.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=t,this._jsonService=new r(["application/jwk-set+json"])}return e.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},e.prototype.getMetadata=function(){var e=this;return this._settings.metadata?(i.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(i.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then((function(t){i.Log.debug("MetadataService.getMetadata: json received");var r=e._settings.metadataSeed||{};return e._settings.metadata=Object.assign({},r,t),e._settings.metadata}))):(i.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},e.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},e.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},e.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},e.prototype.getTokenEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)},e.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},e.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},e.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},e.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},e.prototype._getMetadataProperty=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i.Log.debug("MetadataService.getMetadataProperty for: "+e),this.getMetadata().then((function(r){if(i.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===r[e]){if(!0===t)return void i.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+e);throw i.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+e),new Error("Metadata does not contain property "+e)}return r[e]}))},e.prototype.getSigningKeys=function(){var e=this;return this._settings.signingKeys?(i.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then((function(t){return i.Log.debug("MetadataService.getSigningKeys: jwks_uri received",t),e._jsonService.getJson(t).then((function(t){if(i.Log.debug("MetadataService.getSigningKeys: key set received",t),!t.keys)throw i.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return e._settings.signingKeys=t.keys,e._settings.signingKeys}))}))},n(e,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(s)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=s))),this._metadataUrl}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UrlUtility=void 0;var n=r(0),i=r(1);t.UrlUtility=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.addQueryParam=function(e,t,r){return e.indexOf("?")<0&&(e+="?"),"?"!==e[e.length-1]&&(e+="&"),e+=encodeURIComponent(t),(e+="=")+encodeURIComponent(r)},e.parseUrlFragment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Global;"string"!=typeof e&&(e=r.location.href);var o=e.lastIndexOf(t);o>=0&&(e=e.substr(o+1)),"?"===t&&(o=e.indexOf("#"))>=0&&(e=e.substr(0,o));for(var a,s={},u=/([^&=]+)=([^&]*)/g,c=0;a=u.exec(e);)if(s[decodeURIComponent(a[1])]=decodeURIComponent(a[2].replace(/\+/g," ")),c++>50)return n.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",e),{error:"Response exceeded expected number of parameters"};for(var l in s)return s;return{}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.JoseUtil=void 0;var n,i=r(26),o=(n=r(33))&&n.__esModule?n:{default:n};t.JoseUtil=(0,o.default)({jws:i.jws,KeyUtil:i.KeyUtil,X509:i.X509,crypto:i.crypto,hextob64u:i.hextob64u,b64tohex:i.b64tohex,AllowedSigningAlgs:i.AllowedSigningAlgs})},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClientSettings=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=r(23),s=r(6),u=r(24),c=r(2);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=".well-known/openid-configuration",h="id_token",p="openid",d="client_secret_post";t.OidcClientSettings=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.authority,i=t.metadataUrl,o=t.metadata,f=t.signingKeys,g=t.metadataSeed,y=t.client_id,v=t.client_secret,m=t.response_type,b=void 0===m?h:m,E=t.scope,S=void 0===E?p:E,w=t.redirect_uri,_=t.post_logout_redirect_uri,C=t.client_authentication,A=void 0===C?d:C,I=t.prompt,T=t.display,P=t.max_age,F=t.ui_locales,k=t.acr_values,R=t.resource,B=t.response_mode,O=t.filterProtocolClaims,x=void 0===O||O,N=t.loadUserInfo,U=void 0===N||N,j=t.staleStateAge,D=void 0===j?900:j,L=t.clockSkew,M=void 0===L?300:L,K=t.clockService,V=void 0===K?new a.ClockService:K,H=t.userInfoJwtIssuer,q=void 0===H?"OP":H,z=t.mergeClaims,$=void 0!==z&&z,G=t.stateStore,W=void 0===G?new s.WebStorageStateStore:G,J=t.ResponseValidatorCtor,Q=void 0===J?u.ResponseValidator:J,Y=t.MetadataServiceCtor,X=void 0===Y?c.MetadataService:Y,Z=t.extraQueryParams,ee=void 0===Z?{}:Z,te=t.extraTokenParams,re=void 0===te?{}:te;l(this,e),this._authority=r,this._metadataUrl=i,this._metadata=o,this._metadataSeed=g,this._signingKeys=f,this._client_id=y,this._client_secret=v,this._response_type=b,this._scope=S,this._redirect_uri=w,this._post_logout_redirect_uri=_,this._client_authentication=A,this._prompt=I,this._display=T,this._max_age=P,this._ui_locales=F,this._acr_values=k,this._resource=R,this._response_mode=B,this._filterProtocolClaims=!!x,this._loadUserInfo=!!U,this._staleStateAge=D,this._clockSkew=M,this._clockService=V,this._userInfoJwtIssuer=q,this._mergeClaims=!!$,this._stateStore=W,this._validator=new Q(this),this._metadataService=new X(this),this._extraQueryParams="object"===(void 0===ee?"undefined":n(ee))?ee:{},this._extraTokenParams="object"===(void 0===re?"undefined":n(re))?re:{}}return e.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},i(e,[{key:"client_id",get:function(){return this._client_id},set:function(e){if(this._client_id)throw o.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=e}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(e){if(this._authority)throw o.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=e}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(f)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=f)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(e){this._metadata=e}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(e){this._metadataSeed=e}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(e){this._signingKeys=e}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(e){"object"===(void 0===e?"undefined":n(e))?this._extraQueryParams=e:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(e){"object"===(void 0===e?"undefined":n(e))?this._extraTokenParams=e:this._extraTokenParams={}}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.WebStorageStateStore=void 0;var n=r(0),i=r(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.WebStorageStateStore=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.prefix,n=void 0===r?"oidc.":r,a=t.store,s=void 0===a?i.Global.localStorage:a;o(this,e),this._store=s,this._prefix=n}return e.prototype.set=function(e,t){return n.Log.debug("WebStorageStateStore.set",e),e=this._prefix+e,this._store.setItem(e,t),Promise.resolve()},e.prototype.get=function(e){n.Log.debug("WebStorageStateStore.get",e),e=this._prefix+e;var t=this._store.getItem(e);return Promise.resolve(t)},e.prototype.remove=function(e){n.Log.debug("WebStorageStateStore.remove",e),e=this._prefix+e;var t=this._store.getItem(e);return this._store.removeItem(e),Promise.resolve(t)},e.prototype.getAllKeys=function(){n.Log.debug("WebStorageStateStore.getAllKeys");for(var e=[],t=0;t<this._store.length;t++){var r=this._store.key(t);0===r.indexOf(this._prefix)&&e.push(r.substr(this._prefix.length))}return Promise.resolve(e)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonService=void 0;var n=r(0),i=r(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.JsonService=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Global.XMLHttpRequest,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,e),t&&Array.isArray(t)?this._contentTypes=t.slice():this._contentTypes=[],this._contentTypes.push("application/json"),n&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=r,this._jwtHandler=n}return e.prototype.getJson=function(e,t){var r=this;if(!e)throw n.Log.error("JsonService.getJson: No url passed"),new Error("url");return n.Log.debug("JsonService.getJson, url: ",e),new Promise((function(i,o){var a=new r._XMLHttpRequest;a.open("GET",e);var s=r._contentTypes,u=r._jwtHandler;a.onload=function(){if(n.Log.debug("JsonService.getJson: HTTP response received, status",a.status),200===a.status){var t=a.getResponseHeader("Content-Type");if(t){var r=s.find((function(e){if(t.startsWith(e))return!0}));if("application/jwt"==r)return void u(a).then(i,o);if(r)try{return void i(JSON.parse(a.responseText))}catch(c){return n.Log.error("JsonService.getJson: Error parsing JSON response",c.message),void o(c)}}o(Error("Invalid response Content-Type: "+t+", from URL: "+e))}else o(Error(a.statusText+" ("+a.status+")"))},a.onerror=function(){n.Log.error("JsonService.getJson: network error"),o(Error("Network Error"))},t&&(n.Log.debug("JsonService.getJson: token passed, setting Authorization header"),a.setRequestHeader("Authorization","Bearer "+t)),a.send()}))},e.prototype.postForm=function(e,t,r){var i=this;if(!e)throw n.Log.error("JsonService.postForm: No url passed"),new Error("url");return n.Log.debug("JsonService.postForm, url: ",e),new Promise((function(o,a){var s=new i._XMLHttpRequest;s.open("POST",e);var u=i._contentTypes;s.onload=function(){if(n.Log.debug("JsonService.postForm: HTTP response received, status",s.status),200!==s.status){if(400===s.status&&(r=s.getResponseHeader("Content-Type"))&&u.find((function(e){if(r.startsWith(e))return!0})))try{var t=JSON.parse(s.responseText);if(t&&t.error)return n.Log.error("JsonService.postForm: Error from server: ",t.error),void a(new Error(t.error))}catch(i){return n.Log.error("JsonService.postForm: Error parsing JSON response",i.message),void a(i)}a(Error(s.statusText+" ("+s.status+")"))}else{var r;if((r=s.getResponseHeader("Content-Type"))&&u.find((function(e){if(r.startsWith(e))return!0})))try{return void o(JSON.parse(s.responseText))}catch(i){return n.Log.error("JsonService.postForm: Error parsing JSON response",i.message),void a(i)}a(Error("Invalid response Content-Type: "+r+", from URL: "+e))}},s.onerror=function(){n.Log.error("JsonService.postForm: network error"),a(Error("Network Error"))};var c="";for(var l in t){var f=t[l];f&&(c.length>0&&(c+="&"),c+=encodeURIComponent(l),c+="=",c+=encodeURIComponent(f))}s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),void 0!==r&&s.setRequestHeader("Authorization","Basic "+btoa(r)),s.send(c)}))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SigninRequest=void 0;var n=r(0),i=r(3),o=r(13);t.SigninRequest=function(){function e(t){var r=t.url,a=t.client_id,s=t.redirect_uri,u=t.response_type,c=t.scope,l=t.authority,f=t.data,h=t.prompt,p=t.display,d=t.max_age,g=t.ui_locales,y=t.id_token_hint,v=t.login_hint,m=t.acr_values,b=t.resource,E=t.response_mode,S=t.request,w=t.request_uri,_=t.extraQueryParams,C=t.request_type,A=t.client_secret,I=t.extraTokenParams,T=t.skipUserInfo;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw n.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!a)throw n.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!s)throw n.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!u)throw n.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!c)throw n.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!l)throw n.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var P=e.isOidc(u),F=e.isCode(u);E||(E=e.isCode(u)?"query":null),this.state=new o.SigninState({nonce:P,data:f,client_id:a,authority:l,redirect_uri:s,code_verifier:F,request_type:C,response_mode:E,client_secret:A,scope:c,extraTokenParams:I,skipUserInfo:T}),r=i.UrlUtility.addQueryParam(r,"client_id",a),r=i.UrlUtility.addQueryParam(r,"redirect_uri",s),r=i.UrlUtility.addQueryParam(r,"response_type",u),r=i.UrlUtility.addQueryParam(r,"scope",c),r=i.UrlUtility.addQueryParam(r,"state",this.state.id),P&&(r=i.UrlUtility.addQueryParam(r,"nonce",this.state.nonce)),F&&(r=i.UrlUtility.addQueryParam(r,"code_challenge",this.state.code_challenge),r=i.UrlUtility.addQueryParam(r,"code_challenge_method","S256"));var k={prompt:h,display:p,max_age:d,ui_locales:g,id_token_hint:y,login_hint:v,acr_values:m,resource:b,request:S,request_uri:w,response_mode:E};for(var R in k)k[R]&&(r=i.UrlUtility.addQueryParam(r,R,k[R]));for(var B in _)r=i.UrlUtility.addQueryParam(r,B,_[B]);this.url=r}return e.isOidc=function(e){return!!e.split(/\s+/g).filter((function(e){return"id_token"===e}))[0]},e.isOAuth=function(e){return!!e.split(/\s+/g).filter((function(e){return"token"===e}))[0]},e.isCode=function(e){return!!e.split(/\s+/g).filter((function(e){return"code"===e}))[0]},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.State=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=(n=r(14))&&n.__esModule?n:{default:n};function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.State=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=t.data,i=t.created,o=t.request_type;s(this,e),this._id=r||(0,a.default)(),this._data=n,this._created="number"==typeof i&&i>0?i:parseInt(Date.now()/1e3),this._request_type=o}return e.prototype.toStorageString=function(){return o.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},e.fromStorageString=function(t){return o.Log.debug("State.fromStorageString"),new e(JSON.parse(t))},e.clearStaleState=function(t,r){var n=Date.now()/1e3-r;return t.getAllKeys().then((function(r){o.Log.debug("State.clearStaleState: got keys",r);for(var i=[],a=function(a){var s=r[a];u=t.get(s).then((function(r){var i=!1;if(r)try{var a=e.fromStorageString(r);o.Log.debug("State.clearStaleState: got item from key: ",s,a.created),a.created<=n&&(i=!0)}catch(u){o.Log.error("State.clearStaleState: Error parsing state for key",s,u.message),i=!0}else o.Log.debug("State.clearStaleState: no item in storage for key: ",s),i=!0;if(i)return o.Log.debug("State.clearStaleState: removed item for key: ",s),t.remove(s)})),i.push(u)},s=0;s<r.length;s++){var u;a(s)}return o.Log.debug("State.clearStaleState: waiting on promise count:",i.length),Promise.all(i)}))},i(e,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClient=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(5),a=r(12),s=r(8),u=r(34),c=r(35),l=r(36),f=r(13),h=r(9);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.OidcClient=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e),t instanceof o.OidcClientSettings?this._settings=t:this._settings=new o.OidcClientSettings(t)}return e.prototype.createSigninRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.response_type,n=t.scope,o=t.redirect_uri,a=t.data,u=t.state,c=t.prompt,l=t.display,f=t.max_age,h=t.ui_locales,p=t.id_token_hint,d=t.login_hint,g=t.acr_values,y=t.resource,v=t.request,m=t.request_uri,b=t.response_mode,E=t.extraQueryParams,S=t.extraTokenParams,w=t.request_type,_=t.skipUserInfo,C=arguments[1];i.Log.debug("OidcClient.createSigninRequest");var A=this._settings.client_id;r=r||this._settings.response_type,n=n||this._settings.scope,o=o||this._settings.redirect_uri,c=c||this._settings.prompt,l=l||this._settings.display,f=f||this._settings.max_age,h=h||this._settings.ui_locales,g=g||this._settings.acr_values,y=y||this._settings.resource,b=b||this._settings.response_mode,E=E||this._settings.extraQueryParams,S=S||this._settings.extraTokenParams;var I=this._settings.authority;return s.SigninRequest.isCode(r)&&"code"!==r?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then((function(t){i.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",t);var T=new s.SigninRequest({url:t,client_id:A,redirect_uri:o,response_type:r,scope:n,data:a||u,authority:I,prompt:c,display:l,max_age:f,ui_locales:h,id_token_hint:p,login_hint:d,acr_values:g,resource:y,request:v,request_uri:m,extraQueryParams:E,extraTokenParams:S,request_type:w,response_mode:b,client_secret:e._settings.client_secret,skipUserInfo:_}),P=T.state;return(C=C||e._stateStore).set(P.id,P.toStorageString()).then((function(){return T}))}))},e.prototype.readSigninResponseState=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.Log.debug("OidcClient.readSigninResponseState");var n="query"===this._settings.response_mode||!this._settings.response_mode&&s.SigninRequest.isCode(this._settings.response_type),o=n?"?":"#",a=new u.SigninResponse(e,o);if(!a.state)return i.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response"));t=t||this._stateStore;var c=r?t.remove.bind(t):t.get.bind(t);return c(a.state).then((function(e){if(!e)throw i.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:f.SigninState.fromStorageString(e),response:a}}))},e.prototype.processSigninResponse=function(e,t){var r=this;return i.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(e,t,!0).then((function(e){var t=e.state,n=e.response;return i.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),r._validator.validateSigninResponse(t,n)}))},e.prototype.createSignoutRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id_token_hint,n=t.data,o=t.state,a=t.post_logout_redirect_uri,s=t.extraQueryParams,u=t.request_type,l=arguments[1];return i.Log.debug("OidcClient.createSignoutRequest"),a=a||this._settings.post_logout_redirect_uri,s=s||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then((function(t){if(!t)throw i.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");i.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",t);var f=new c.SignoutRequest({url:t,id_token_hint:r,post_logout_redirect_uri:a,data:n||o,extraQueryParams:s,request_type:u}),h=f.state;return h&&(i.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(l=l||e._stateStore).set(h.id,h.toStorageString())),f}))},e.prototype.readSignoutResponseState=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.Log.debug("OidcClient.readSignoutResponseState");var n=new l.SignoutResponse(e);if(!n.state)return i.Log.debug("OidcClient.readSignoutResponseState: No state in response"),n.error?(i.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",n.error),Promise.reject(new a.ErrorResponse(n))):Promise.resolve({state:void 0,response:n});var o=n.state;t=t||this._stateStore;var s=r?t.remove.bind(t):t.get.bind(t);return s(o).then((function(e){if(!e)throw i.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:h.State.fromStorageString(e),response:n}}))},e.prototype.processSignoutResponse=function(e,t){var r=this;return i.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(e,t,!0).then((function(e){var t=e.state,n=e.response;return t?(i.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),r._validator.validateSignoutResponse(t,n)):(i.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),n)}))},e.prototype.clearStaleState=function(e){return i.Log.debug("OidcClient.clearStaleState"),e=e||this._stateStore,h.State.clearStaleState(e,this.settings.staleStateAge)},n(e,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClient=void 0;var n=r(7),i=r(2),o=r(0);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.TokenClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.JsonService,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService;if(a(this,e),!t)throw o.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r,this._metadataService=new s(this._settings)}return e.prototype.exchangeCode=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).grant_type=t.grant_type||"authorization_code",t.client_id=t.client_id||this._settings.client_id,t.client_secret=t.client_secret||this._settings.client_secret,t.redirect_uri=t.redirect_uri||this._settings.redirect_uri;var r=void 0,n=t._client_authentication||this._settings._client_authentication;return delete t._client_authentication,t.code?t.redirect_uri?t.code_verifier?t.client_id?t.client_secret||"client_secret_basic"!=n?("client_secret_basic"==n&&(r=t.client_id+":"+t.client_secret,delete t.client_id,delete t.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(n){return o.Log.debug("TokenClient.exchangeCode: Received token endpoint"),e._jsonService.postForm(n,t,r).then((function(e){return o.Log.debug("TokenClient.exchangeCode: response received"),e}))}))):(o.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(o.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(o.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(o.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(o.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},e.prototype.exchangeRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).grant_type=t.grant_type||"refresh_token",t.client_id=t.client_id||this._settings.client_id,t.client_secret=t.client_secret||this._settings.client_secret;var r=void 0,n=t._client_authentication||this._settings._client_authentication;return delete t._client_authentication,t.refresh_token?t.client_id?("client_secret_basic"==n&&(r=t.client_id+":"+t.client_secret,delete t.client_id,delete t.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(n){return o.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),e._jsonService.postForm(n,t,r).then((function(e){return o.Log.debug("TokenClient.exchangeRefreshToken: response received"),e}))}))):(o.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(o.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorResponse=void 0;var n=r(0);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.ErrorResponse=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.error,s=r.error_description,u=r.error_uri,c=r.state,l=r.session_state;if(i(this,t),!a)throw n.Log.error("No error passed to ErrorResponse"),new Error("error");var f=o(this,e.call(this,s||a));return f.name="ErrorResponse",f.error=a,f.error_description=s,f.error_uri=u,f.state=c,f.session_state=l,f}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(Error)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SigninState=void 0;var n,i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),a=r(9),s=r(4),u=(n=r(14))&&n.__esModule?n:{default:n};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.SigninState=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.nonce,i=r.authority,o=r.client_id,a=r.redirect_uri,f=r.code_verifier,h=r.response_mode,p=r.client_secret,d=r.scope,g=r.extraTokenParams,y=r.skipUserInfo;c(this,t);var v=l(this,e.call(this,arguments[0]));if(!0===n?v._nonce=(0,u.default)():n&&(v._nonce=n),!0===f?v._code_verifier=(0,u.default)()+(0,u.default)()+(0,u.default)():f&&(v._code_verifier=f),v.code_verifier){var m=s.JoseUtil.hashString(v.code_verifier,"SHA256");v._code_challenge=s.JoseUtil.hexToBase64Url(m)}return v._redirect_uri=a,v._authority=i,v._client_id=o,v._response_mode=h,v._client_secret=p,v._scope=d,v._extraTokenParams=g,v._skipUserInfo=y,v}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.toStorageString=function(){return o.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},t.fromStorageString=function(e){return o.Log.debug("SigninState.fromStorageString"),new t(JSON.parse(e))},i(t,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),t}(a.State)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return("undefined"!=n&&null!==n&&void 0!==n.getRandomValues?i:o)().replace(/-/g,"")};var n="undefined"!=typeof window?window.crypto||window.msCrypto:null;function i(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^n.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}function o(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^16*Math.random()>>e/4).toString(16)}))}e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.User=function(){function e(t){var r=t.id_token,n=t.session_state,i=t.access_token,o=t.refresh_token,a=t.token_type,s=t.scope,u=t.profile,c=t.expires_at,l=t.state;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id_token=r,this.session_state=n,this.access_token=i,this.refresh_token=o,this.token_type=a,this.scope=s,this.profile=u,this.expires_at=c,this.state=l}return e.prototype.toStorageString=function(){return i.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},e.fromStorageString=function(t){return i.Log.debug("User.fromStorageString"),new e(JSON.parse(t))},n(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var r=parseInt(Date.now()/1e3);this.expires_at=r+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenEvents=void 0;var n=r(0),i=r(46);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.AccessTokenEvents=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.accessTokenExpiringNotificationTime,n=void 0===r?60:r,a=t.accessTokenExpiringTimer,s=void 0===a?new i.Timer("Access token expiring"):a,u=t.accessTokenExpiredTimer,c=void 0===u?new i.Timer("Access token expired"):u;o(this,e),this._accessTokenExpiringNotificationTime=n,this._accessTokenExpiring=s,this._accessTokenExpired=c}return e.prototype.load=function(e){if(e.access_token&&void 0!==e.expires_in){var t=e.expires_in;if(n.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",t),t>0){var r=t-this._accessTokenExpiringNotificationTime;r<=0&&(r=1),n.Log.debug("AccessTokenEvents.load: registering expiring timer in:",r),this._accessTokenExpiring.init(r)}else n.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var i=t+1;n.Log.debug("AccessTokenEvents.load: registering expired timer in:",i),this._accessTokenExpired.init(i)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.unload=function(){n.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.addAccessTokenExpiring=function(e){this._accessTokenExpiring.addHandler(e)},e.prototype.removeAccessTokenExpiring=function(e){this._accessTokenExpiring.removeHandler(e)},e.prototype.addAccessTokenExpired=function(e){this._accessTokenExpired.addHandler(e)},e.prototype.removeAccessTokenExpired=function(e){this._accessTokenExpired.removeHandler(e)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=r(0);t.Event=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._callbacks=[]}return e.prototype.addHandler=function(e){this._callbacks.push(e)},e.prototype.removeHandler=function(e){var t=this._callbacks.findIndex((function(t){return t===e}));t>=0&&this._callbacks.splice(t,1)},e.prototype.raise=function(){n.Log.debug("Event: Raising event: "+this._name);for(var e=0;e<this._callbacks.length;e++){var t;(t=this._callbacks)[e].apply(t,arguments)}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMonitor=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(19),a=r(1);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.SessionMonitor=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.CheckSessionIFrame,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.Global.timer;if(s(this,e),!t)throw i.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=t,this._CheckSessionIFrameCtor=n,this._timer=u,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then((function(e){e?r._start(e):r._settings.monitorAnonymousSession&&r._userManager.querySessionStatus().then((function(e){var t={session_state:e.session_state};e.sub&&e.sid&&(t.profile={sub:e.sub,sid:e.sid}),r._start(t)})).catch((function(e){i.Log.error("SessionMonitor ctor: error from querySessionStatus:",e.message)}))})).catch((function(e){i.Log.error("SessionMonitor ctor: error from getUser:",e.message)})))}return e.prototype._start=function(e){var t=this,r=e.session_state;r&&(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,i.Log.debug("SessionMonitor._start: session_state:",r,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,i.Log.debug("SessionMonitor._start: session_state:",r,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(r):this._metadataService.getCheckSessionIframe().then((function(e){if(e){i.Log.debug("SessionMonitor._start: Initializing check session iframe");var n=t._client_id,o=t._checkSessionInterval,a=t._stopCheckSessionOnError;t._checkSessionIFrame=new t._CheckSessionIFrameCtor(t._callback.bind(t),n,e,o,a),t._checkSessionIFrame.load().then((function(){t._checkSessionIFrame.start(r)}))}else i.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")})).catch((function(e){i.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",e.message)})))},e.prototype._stop=function(){var e=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(i.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var t=this._timer.setInterval((function(){e._timer.clearInterval(t),e._userManager.querySessionStatus().then((function(t){var r={session_state:t.session_state};t.sub&&t.sid&&(r.profile={sub:t.sub,sid:t.sid}),e._start(r)})).catch((function(e){i.Log.error("SessionMonitor: error from querySessionStatus:",e.message)}))}),1e3)},e.prototype._callback=function(){var e=this;this._userManager.querySessionStatus().then((function(t){var r=!0;t?t.sub===e._sub?(r=!1,e._checkSessionIFrame.start(t.session_state),t.sid===e._sid?i.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",t.session_state):(i.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",t.session_state),e._userManager.events._raiseUserSessionChanged())):i.Log.debug("SessionMonitor._callback: Different subject signed into OP:",t.sub):i.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),r&&(e._sub?(i.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),e._userManager.events._raiseUserSignedOut()):(i.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),e._userManager.events._raiseUserSignedIn()))})).catch((function(t){e._sub&&(i.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",t.message),e._userManager.events._raiseUserSignedOut())}))},n(e,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSessionIFrame=void 0;var n=r(0);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.CheckSessionIFrame=function(){function e(t,r,n,o){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];i(this,e),this._callback=t,this._client_id=r,this._url=n,this._interval=o||2e3,this._stopOnError=a;var s=n.indexOf("/",n.indexOf("//")+2);this._frame_origin=n.substr(0,s),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=n}return e.prototype.load=function(){var e=this;return new Promise((function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),e._boundMessageEvent=e._message.bind(e),window.addEventListener("message",e._boundMessageEvent,!1)}))},e.prototype._message=function(e){e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(n.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(n.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):n.Log.debug("CheckSessionIFrame: "+e.data+" message from check session op iframe"))},e.prototype.start=function(e){var t=this;if(this._session_state!==e){n.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=e;var r=function(){t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};r(),this._timer=window.setInterval(r,this._interval)}},e.prototype.stop=function(){this._session_state=null,this._timer&&(n.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRevocationClient=void 0;var n=r(0),i=r(2),o=r(1);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s="access_token",u="refresh_token";t.TokenRevocationClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.XMLHttpRequest,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService;if(a(this,e),!t)throw n.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=t,this._XMLHttpRequestCtor=r,this._metadataService=new s(this._settings)}return e.prototype.revoke=function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!e)throw n.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(i!==s&&i!=u)throw n.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then((function(o){if(o){n.Log.debug("TokenRevocationClient.revoke: Revoking "+i);var a=r._settings.client_id,s=r._settings.client_secret;return r._revoke(o,a,s,e,i)}if(t)throw n.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")}))},e.prototype._revoke=function(e,t,r,i,o){var a=this;return new Promise((function(s,u){var c=new a._XMLHttpRequestCtor;c.open("POST",e),c.onload=function(){n.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",c.status),200===c.status?s():u(Error(c.statusText+" ("+c.status+")"))},c.onerror=function(){n.Log.debug("TokenRevocationClient.revoke: Network Error."),u("Network Error")};var l="client_id="+encodeURIComponent(t);r&&(l+="&client_secret="+encodeURIComponent(r)),l+="&token_type_hint="+encodeURIComponent(o),l+="&token="+encodeURIComponent(i),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send(l)}))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.CordovaPopupWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t})),this.features=t.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=t.popupWindowTarget||"_blank",this.redirect_uri=t.startUrl,i.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return e.prototype._isInAppBrowserInstalled=function(e){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some((function(t){return e.hasOwnProperty(t)}))},e.prototype.navigate=function(e){if(e&&e.url){if(!window.cordova)return this._error("cordova is undefined");var t=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(t))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(e.url,this.target,this.features),this._popup?(i.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},e.prototype._loadStartCallback=function(e){0===e.url.indexOf(this.redirect_uri)&&this._success({url:e.url})},e.prototype._exitCallback=function(e){this._error(e)},e.prototype._success=function(e){this._cleanup(),i.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),i.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._popup&&(i.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},n(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(10),o=r(5),a=r(6),s=r(37),u=r(38),c=r(16),l=r(2),f=r(48),h=r(49),p=r(19),d=r(20),g=r(18),y=r(1),v=r(15),m=r(50);t.default={Version:m.Version,Log:n.Log,OidcClient:i.OidcClient,OidcClientSettings:o.OidcClientSettings,WebStorageStateStore:a.WebStorageStateStore,InMemoryWebStorage:s.InMemoryWebStorage,UserManager:u.UserManager,AccessTokenEvents:c.AccessTokenEvents,MetadataService:l.MetadataService,CordovaPopupNavigator:f.CordovaPopupNavigator,CordovaIFrameNavigator:h.CordovaIFrameNavigator,CheckSessionIFrame:p.CheckSessionIFrame,TokenRevocationClient:d.TokenRevocationClient,SessionMonitor:g.SessionMonitor,Global:y.Global,User:v.User},e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ClockService=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseValidator=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(0),o=r(2),a=r(25),s=r(11),u=r(12),c=r(4);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];t.ResponseValidator=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.MetadataService,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.UserInfoService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c.JoseUtil,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:s.TokenClient;if(l(this,e),!t)throw i.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=t,this._metadataService=new r(this._settings),this._userInfoService=new n(this._settings),this._joseUtil=u,this._tokenClient=new f(this._settings)}return e.prototype.validateSigninResponse=function(e,t){var r=this;return i.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(e,t).then((function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: state processed"),r._validateTokens(e,t).then((function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),r._processClaims(e,t).then((function(e){return i.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),e}))}))}))},e.prototype.validateSignoutResponse=function(e,t){return e.id!==t.state?(i.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(i.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",t.error),Promise.reject(new u.ErrorResponse(t))):Promise.resolve(t))},e.prototype._processSigninParams=function(e,t){if(e.id!==t.state)return i.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!e.client_id)return i.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!e.authority)return i.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==e.authority)return i.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=e.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==e.client_id)return i.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=e.client_id;return i.Log.debug("ResponseValidator._processSigninParams: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator._processSigninParams: Response was error",t.error),Promise.reject(new u.ErrorResponse(t))):e.nonce&&!t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!e.nonce&&t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):e.code_verifier&&!t.code?(i.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!e.code_verifier&&t.code?(i.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(t.scope||(t.scope=e.scope),Promise.resolve(t))},e.prototype._processClaims=function(e,t){var r=this;if(t.isOpenIdConnect){if(i.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),t.profile=this._filterProtocolClaims(t.profile),!0!==e.skipUserInfo&&this._settings.loadUserInfo&&t.access_token)return i.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(t.access_token).then((function(e){return i.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),e.sub!==t.profile.sub?(i.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(t.profile=r._mergeClaims(t.profile,e),i.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",t.profile),t)}));i.Log.debug("ResponseValidator._processClaims: not loading user info")}else i.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(t)},e.prototype._mergeClaims=function(e,t){var r=Object.assign({},e);for(var i in t){var o=t[i];Array.isArray(o)||(o=[o]);for(var a=0;a<o.length;a++){var s=o[a];r[i]?Array.isArray(r[i])?r[i].indexOf(s)<0&&r[i].push(s):r[i]!==s&&("object"===(void 0===s?"undefined":n(s))&&this._settings.mergeClaims?r[i]=this._mergeClaims(r[i],s):r[i]=[r[i],s]):r[i]=s}}return r},e.prototype._filterProtocolClaims=function(e){i.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",e);var t=Object.assign({},e);return this._settings._filterProtocolClaims?(f.forEach((function(e){delete t[e]})),i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",t)):i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),t},e.prototype._validateTokens=function(e,t){return t.code?(i.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(e,t)):t.id_token?t.access_token?(i.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(t))},e.prototype._processCode=function(e,t){var r=this,o={client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier};return e.extraTokenParams&&"object"===n(e.extraTokenParams)&&Object.assign(o,e.extraTokenParams),this._tokenClient.exchangeCode(o).then((function(n){for(var o in n)t[o]=n[o];return t.id_token?(i.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),r._validateIdTokenAttributes(e,t)):(i.Log.debug("ResponseValidator._processCode: token response successful, returning response"),t)}))},e.prototype._validateIdTokenAttributes=function(e,t){var r=this;return this._metadataService.getIssuer().then((function(n){var o=e.client_id,a=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",a),r._settings.getEpochTime().then((function(s){return r._joseUtil.validateJwtAttributes(t.id_token,n,o,a,s).then((function(r){return e.nonce&&e.nonce!==r.nonce?(i.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):r.sub?(t.profile=r,t):(i.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))}))},e.prototype._validateIdTokenAndAccessToken=function(e,t){var r=this;return this._validateIdToken(e,t).then((function(e){return r._validateAccessToken(e)}))},e.prototype._getSigningKeyForJwt=function(e){var t=this;return this._metadataService.getSigningKeys().then((function(r){var n=e.header.kid;if(!r)return i.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));i.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var o=void 0;if(n)o=r.filter((function(e){return e.kid===n}))[0];else{if((r=t._filterByAlg(r,e.header.alg)).length>1)return i.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));o=r[0]}return Promise.resolve(o)}))},e.prototype._getSigningKeyForJwtWithSingleRetry=function(e){var t=this;return this._getSigningKeyForJwt(e).then((function(r){return r?Promise.resolve(r):(t._metadataService.resetSigningKeys(),t._getSigningKeyForJwt(e))}))},e.prototype._validateIdToken=function(e,t){var r=this;if(!e.nonce)return i.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var n=this._joseUtil.parseJwt(t.id_token);return n&&n.header&&n.payload?e.nonce!==n.payload.nonce?(i.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then((function(o){return i.Log.debug("ResponseValidator._validateIdToken: Received issuer"),r._getSigningKeyForJwtWithSingleRetry(n).then((function(a){if(!a)return i.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var s=e.client_id,u=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",u),r._joseUtil.validateJwt(t.id_token,a,o,s,u).then((function(){return i.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),n.payload.sub?(t.profile=n.payload,t):(i.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))})):(i.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",n),Promise.reject(new Error("Failed to parse id_token")))},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return i.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",t),[];r="EC"}return i.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",r),e=e.filter((function(e){return e.kty===r})),i.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",r,e.length),e},e.prototype._validateAccessToken=function(e){if(!e.profile)return i.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!e.profile.at_hash)return i.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!e.id_token)return i.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var t=this._joseUtil.parseJwt(e.id_token);if(!t||!t.header)return i.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",t),Promise.reject(new Error("Failed to parse id_token"));var r=t.header.alg;if(!r||5!==r.length)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r),Promise.reject(new Error("Unsupported alg: "+r));var n=r.substr(2,3);if(!n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));if(256!==(n=parseInt(n))&&384!==n&&512!==n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));var o="sha"+n,a=this._joseUtil.hashString(e.access_token,o);if(!a)return i.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",o),Promise.reject(new Error("Failed to validate at_hash"));var s=a.substr(0,a.length/2),u=this._joseUtil.hexToBase64Url(s);return u!==e.profile.at_hash?(i.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",u,e.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(i.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(e))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoService=void 0;var n=r(7),i=r(2),o=r(0),a=r(4);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.UserInfoService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.JsonService,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.JoseUtil;if(s(this,e),!t)throw o.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new u(this._settings),this._joseUtil=c}return e.prototype.getClaims=function(e){var t=this;return e?this._metadataService.getUserInfoEndpoint().then((function(r){return o.Log.debug("UserInfoService.getClaims: received userinfo url",r),t._jsonService.getJson(r,e).then((function(e){return o.Log.debug("UserInfoService.getClaims: claims received",e),e}))})):(o.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},e.prototype._getClaimsFromJwt=function(e){var t=this;try{var r=this._joseUtil.parseJwt(e.responseText);if(!r||!r.header||!r.payload)return o.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",r),Promise.reject(new Error("Failed to parse id_token"));var n=r.header.kid,i=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":i=this._metadataService.getIssuer();break;case"ANY":i=Promise.resolve(r.payload.iss);break;default:i=Promise.resolve(this._settings.userInfoJwtIssuer)}return i.then((function(i){return o.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+i),t._metadataService.getSigningKeys().then((function(a){if(!a)return o.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));o.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var s=void 0;if(n)s=a.filter((function(e){return e.kid===n}))[0];else{if((a=t._filterByAlg(a,r.header.alg)).length>1)return o.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));s=a[0]}if(!s)return o.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var u=t._settings.client_id,c=t._settings.clockSkew;return o.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",c),t._joseUtil.validateJwt(e.responseText,s,i,u,c,void 0,!0).then((function(){return o.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),r.payload}))}))}))}catch(a){return o.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",a.message),void reject(a)}},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return o.Log.debug("UserInfoService._filterByAlg: alg not supported: ",t),[];r="EC"}return o.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",r),e=e.filter((function(e){return e.kty===r})),o.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",r,e.length),e},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedSigningAlgs=t.b64tohex=t.hextob64u=t.crypto=t.X509=t.KeyUtil=t.jws=void 0;var n=r(27);t.jws=n.jws,t.KeyUtil=n.KEYUTIL,t.X509=n.X509,t.crypto=n.crypto,t.hextob64u=n.hextob64u,t.b64tohex=n.b64tohex,t.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=!1,i={};
/*!
        Copyright (c) 2011, Yahoo! Inc. All rights reserved.
        Code licensed under the BSD License:
        http://developer.yahoo.com/yui/license.html
        version: 2.9.0
        */if(void 0===o)var o={};o.lang={extend:function(e,t,r){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var i=function(){};if(i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),r){var o;for(o in r)e.prototype[o]=r[o];var a=function(){},s=["toString","valueOf"];try{/MSIE/.test(n)&&(a=function(e,t){for(o=0;o<s.length;o+=1){var r=s[o],n=t[r];"function"==typeof n&&n!=Object.prototype[r]&&(e[r]=n)}})}catch(u){}a(e.prototype,r)}}};
/*! CryptoJS v3.1.2 core-fix.js
         * code.google.com/p/crypto-js
         * (c) 2009-2013 by Jeff Mott. All rights reserved.
         * code.google.com/p/crypto-js/wiki/License
         * THIS IS FIX of 'core.js' to fix Hmac issue.
         * https://code.google.com/p/crypto-js/issues/detail?id=84
         * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
         */
var a,s,u,c,l,f,h,p,d,g,y,v,m,b,E,S=S||(a=Math,u=(s={}).lib={},c=u.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var r=new e;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=u.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||h).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var a=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=a<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=a.ceil(t/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(4294967296*a.random()|0);return new l.init(t,e)}}),f=s.enc={},h=f.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(r,t/2)}},p=f.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(r,t)}},d=f.Utf8={stringify:function(e){try{return decodeURIComponent(escape(p.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return p.parse(unescape(encodeURIComponent(e)))}},g=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,r=t.words,n=t.sigBytes,i=this.blockSize,o=n/(4*i),s=(o=e?a.ceil(o):a.max((0|o)-this._minBufferSize,0))*i,u=a.min(4*s,n);if(s){for(var c=0;c<s;c+=i)this._doProcessBlock(r,c);var f=r.splice(0,s);t.sigBytes-=u}return new l.init(f,u)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),u.Hasher=g.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new y.HMAC.init(e,r).finalize(t)}}}),y=s.algo={},s);m=(v=S).lib,b=m.Base,E=m.WordArray,(v=v.x64={}).Word=b.extend({init:function(e,t){this.high=e,this.low=t}}),v.WordArray=b.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var i=e[n];r.push(i.high),r.push(i.low)}return E.create(r,this.sigBytes)},clone:function(){for(var e=b.clone.call(this),t=e.words=this.words.slice(0),r=t.length,n=0;n<r;n++)t[n]=t[n].clone();return e}}),function(){var e=S,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;4>a&&i+.75*a<r;a++)e.push(n.charAt(o>>>6*(3-a)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var r=e.length,n=this._map;(i=n.charAt(64))&&-1!=(i=e.indexOf(i))&&(r=i);for(var i=[],o=0,a=0;a<r;a++)if(a%4){var s=n.indexOf(e.charAt(a-1))<<a%4*2,u=n.indexOf(e.charAt(a))>>>6-a%4*2;i[o>>>2]|=(s|u)<<24-o%4*8,o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){for(var t=S,r=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,o=[],a=[],s=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var l;e:{l=u;for(var f=e.sqrt(l),h=2;h<=f;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>c&&(o[c]=s(e.pow(u,.5))),a[c]=s(e.pow(u,1/3)),c++),u++}var p=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],s=r[3],u=r[4],c=r[5],l=r[6],f=r[7],h=0;64>h;h++){if(16>h)p[h]=0|e[t+h];else{var d=p[h-15],g=p[h-2];p[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+p[h-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[h-16]}d=f+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[h]+p[h],g=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),f=l,l=c,c=u,u=s+d|0,s=o,o=i,i=n,n=d+g|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+u|0,r[5]=r[5]+c|0,r[6]=r[6]+l|0,r[7]=r[7]+f|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)}(Math),function(){function e(){return n.create.apply(n,arguments)}for(var t=S,r=t.lib.Hasher,n=(o=t.x64).Word,i=o.WordArray,o=t.algo,a=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],s=[],u=0;80>u;u++)s[u]=e();o=o.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=(f=this._hash.words)[0],n=f[1],i=f[2],o=f[3],u=f[4],c=f[5],l=f[6],f=f[7],h=r.high,p=r.low,d=n.high,g=n.low,y=i.high,v=i.low,m=o.high,b=o.low,E=u.high,S=u.low,w=c.high,_=c.low,C=l.high,A=l.low,I=f.high,T=f.low,P=h,F=p,k=d,R=g,B=y,O=v,x=m,N=b,U=E,j=S,D=w,L=_,M=C,K=A,V=I,H=T,q=0;80>q;q++){var z=s[q];if(16>q)var $=z.high=0|e[t+2*q],G=z.low=0|e[t+2*q+1];else{$=((G=($=s[q-15]).high)>>>1|(W=$.low)<<31)^(G>>>8|W<<24)^G>>>7;var W=(W>>>1|G<<31)^(W>>>8|G<<24)^(W>>>7|G<<25),J=((G=(J=s[q-2]).high)>>>19|(Q=J.low)<<13)^(G<<3|Q>>>29)^G>>>6,Q=(Q>>>19|G<<13)^(Q<<3|G>>>29)^(Q>>>6|G<<26),Y=(G=s[q-7]).high,X=(Z=s[q-16]).high,Z=Z.low;$=($=($=$+Y+((G=W+G.low)>>>0<W>>>0?1:0))+J+((G+=Q)>>>0<Q>>>0?1:0))+X+((G+=Z)>>>0<Z>>>0?1:0),z.high=$,z.low=G}Y=U&D^~U&M,Z=j&L^~j&K,z=P&k^P&B^k&B;var ee=F&R^F&O^R&O,te=(W=(P>>>28|F<<4)^(P<<30|F>>>2)^(P<<25|F>>>7),J=(F>>>28|P<<4)^(F<<30|P>>>2)^(F<<25|P>>>7),(Q=a[q]).high),re=Q.low;X=V+((U>>>14|j<<18)^(U>>>18|j<<14)^(U<<23|j>>>9))+((Q=H+((j>>>14|U<<18)^(j>>>18|U<<14)^(j<<23|U>>>9)))>>>0<H>>>0?1:0),V=M,H=K,M=D,K=L,D=U,L=j,U=x+(X=(X=(X=X+Y+((Q+=Z)>>>0<Z>>>0?1:0))+te+((Q+=re)>>>0<re>>>0?1:0))+$+((Q+=G)>>>0<G>>>0?1:0))+((j=N+Q|0)>>>0<N>>>0?1:0)|0,x=B,N=O,B=k,O=R,k=P,R=F,P=X+(z=W+z+((G=J+ee)>>>0<J>>>0?1:0))+((F=Q+G|0)>>>0<Q>>>0?1:0)|0}p=r.low=p+F,r.high=h+P+(p>>>0<F>>>0?1:0),g=n.low=g+R,n.high=d+k+(g>>>0<R>>>0?1:0),v=i.low=v+O,i.high=y+B+(v>>>0<O>>>0?1:0),b=o.low=b+N,o.high=m+x+(b>>>0<N>>>0?1:0),S=u.low=S+j,u.high=E+U+(S>>>0<j>>>0?1:0),_=c.low=_+L,c.high=w+D+(_>>>0<L>>>0?1:0),A=l.low=A+K,l.high=C+M+(A>>>0<K>>>0?1:0),T=f.low=T+H,f.high=I+V+(T>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=r._createHelper(o),t.HmacSHA512=r._createHmacHelper(o)}(),function(){var e=S,t=(i=e.x64).Word,r=i.WordArray,n=(i=e.algo).SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)}();
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
         */
var w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function _(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=w.charAt(r>>6)+w.charAt(63&r);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=w.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=w.charAt(r>>2)+w.charAt((3&r)<<4));(3&n.length)>0;)n+="=";return n}function C(e){var t,r,n,i="",o=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t)(n=w.indexOf(e.charAt(t)))<0||(0==o?(i+=R(n>>2),r=3&n,o=1):1==o?(i+=R(r<<2|n>>4),r=15&n,o=2):2==o?(i+=R(r),i+=R(n>>2),r=3&n,o=3):(i+=R(r<<2|n>>4),i+=R(15&n),o=0));return 1==o&&(i+=R(r<<2)),i}function A(e){var t,r=C(e),n=new Array;for(t=0;2*t<r.length;++t)n[t]=parseInt(r.substring(2*t,2*t+2),16);return n}function I(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function T(){return new I(null)}I.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var a=t*this[e++]+r[n]+i;i=Math.floor(a/67108864),r[n++]=67108863&a}return i},I.prototype.DB=26,I.prototype.DM=67108863,I.prototype.DV=1<<26,I.prototype.FV=Math.pow(2,52),I.prototype.F1=26,I.prototype.F2=0;var P,F,k=new Array;for(P="0".charCodeAt(0),F=0;F<=9;++F)k[P++]=F;for(P="a".charCodeAt(0),F=10;F<36;++F)k[P++]=F;for(P="A".charCodeAt(0),F=10;F<36;++F)k[P++]=F;function R(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function B(e,t){var r=k[e.charCodeAt(t)];return null==r?-1:r}function O(e){var t=T();return t.fromInt(e),t}function x(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function N(e){this.m=e}function U(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function j(e,t){return e&t}function D(e,t){return e|t}function L(e,t){return e^t}function M(e,t){return e&~t}function K(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function V(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function H(){}function q(e){return e}function z(e){this.r2=T(),this.q3=T(),I.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}N.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},N.prototype.revert=function(e){return e},N.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},N.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},N.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},U.prototype.convert=function(e){var t=T();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(I.ZERO)>0&&this.m.subTo(t,t),t},U.prototype.revert=function(e){var t=T();return e.copyTo(t),this.reduce(t),t},U.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},U.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},U.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},I.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},I.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},I.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var a=8==r?255&e[n]:B(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=a:o+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&I.ZERO.subTo(this,this)},I.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},I.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},I.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},I.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,a=Math.floor(e/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+a+1]=this[r]>>i|s,s=(this[r]&o)<<n;for(r=a-1;r>=0;--r)t[r]=0;t[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()},I.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&o)<<i,t[a-r]=this[a]>>n;n>0&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},I.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},I.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&I.ZERO.subTo(t,t)},I.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},I.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=T());var o=T(),a=this.s,s=e.s,u=this.DB-x(n[n.t-1]);u>0?(n.lShiftTo(u,o),i.lShiftTo(u,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,l=o[c-1];if(0!=l){var f=l*(1<<this.F1)+(c>1?o[c-2]>>this.F2:0),h=this.FV/f,p=(1<<this.F1)/f,d=1<<this.F2,g=r.t,y=g-c,v=null==t?T():t;for(o.dlShiftTo(y,v),r.compareTo(v)>=0&&(r[r.t++]=1,r.subTo(v,r)),I.ONE.dlShiftTo(c,v),v.subTo(o,o);o.t<c;)o[o.t++]=0;for(;--y>=0;){var m=r[--g]==l?this.DM:Math.floor(r[g]*h+(r[g-1]+d)*p);if((r[g]+=o.am(0,m,r,y,0,c))<m)for(o.dlShiftTo(y,v),r.subTo(v,r);r[g]<--m;)r.subTo(v,r)}null!=t&&(r.drShiftTo(c,t),a!=s&&I.ZERO.subTo(t,t)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&I.ZERO.subTo(r,r)}}},I.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},I.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},I.prototype.exp=function(e,t){if(e>4294967295||e<1)return I.ONE;var r=T(),n=T(),i=t.convert(this),o=x(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)},I.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",a=this.t,s=this.DB-a*this.DB%t;if(a-- >0)for(s<this.DB&&(r=this[a]>>s)>0&&(i=!0,o=R(r));a>=0;)s<t?(r=(this[a]&(1<<s)-1)<<t-s,r|=this[--a]>>(s+=this.DB-t)):(r=this[a]>>(s-=t)&n,s<=0&&(s+=this.DB,--a)),r>0&&(i=!0),i&&(o+=R(r));return i?o:"0"},I.prototype.negate=function(){var e=T();return I.ZERO.subTo(this,e),e},I.prototype.abs=function(){return this.s<0?this.negate():this},I.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},I.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+x(this[this.t-1]^this.s&this.DM)},I.prototype.mod=function(e){var t=T();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(I.ZERO)>0&&e.subTo(t,t),t},I.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new N(t):new U(t),this.exp(e,r)},I.ZERO=O(0),I.ONE=O(1),H.prototype.convert=q,H.prototype.revert=q,H.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},H.prototype.sqrTo=function(e,t){e.squareTo(t)},z.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=T();return e.copyTo(t),this.reduce(t),t},z.prototype.revert=function(e){return e},z.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},z.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},z.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var $,G,W,J=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Q=(1<<26)/J[J.length-1];
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
         */function Y(){this.i=0,this.j=0,this.S=new Array}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
         */
function X(){!function(e){G[W++]^=255&e,G[W++]^=e>>8&255,G[W++]^=e>>16&255,G[W++]^=e>>24&255,W>=256&&(W-=256)}((new Date).getTime())}if(I.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},I.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=O(r),i=T(),o=T(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(e)+a},I.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,a=0,s=0;s<e.length;++s){var u=B(e,s);u<0?"-"==e.charAt(s)&&0==this.signum()&&(i=!0):(a=t*a+u,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),i&&I.ZERO.subTo(this,this)},I.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(I.ONE.shiftLeft(e-1),D,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(I.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},I.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},I.prototype.changeBit=function(e,t){var r=I.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},I.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},I.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},I.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},I.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},I.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},I.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},I.prototype.millerRabin=function(e){var t=this.subtract(I.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>J.length&&(e=J.length);for(var i=T(),o=0;o<e;++o){i.fromInt(J[Math.floor(Math.random()*J.length)]);var a=i.modPow(n,this);if(0!=a.compareTo(I.ONE)&&0!=a.compareTo(t)){for(var s=1;s++<r&&0!=a.compareTo(t);)if(0==(a=a.modPowInt(2,this)).compareTo(I.ONE))return!1;if(0!=a.compareTo(t))return!1}}return!0},I.prototype.clone=function(){var e=T();return this.copyTo(e),e},I.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},I.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},I.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},I.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},I.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},I.prototype.equals=function(e){return 0==this.compareTo(e)},I.prototype.min=function(e){return this.compareTo(e)<0?this:e},I.prototype.max=function(e){return this.compareTo(e)>0?this:e},I.prototype.and=function(e){var t=T();return this.bitwiseTo(e,j,t),t},I.prototype.or=function(e){var t=T();return this.bitwiseTo(e,D,t),t},I.prototype.xor=function(e){var t=T();return this.bitwiseTo(e,L,t),t},I.prototype.andNot=function(e){var t=T();return this.bitwiseTo(e,M,t),t},I.prototype.not=function(){for(var e=T(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},I.prototype.shiftLeft=function(e){var t=T();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},I.prototype.shiftRight=function(e){var t=T();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},I.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+K(this[e]);return this.s<0?this.t*this.DB:-1},I.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=V(this[r]^t);return e},I.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},I.prototype.setBit=function(e){return this.changeBit(e,D)},I.prototype.clearBit=function(e){return this.changeBit(e,M)},I.prototype.flipBit=function(e){return this.changeBit(e,L)},I.prototype.add=function(e){var t=T();return this.addTo(e,t),t},I.prototype.subtract=function(e){var t=T();return this.subTo(e,t),t},I.prototype.multiply=function(e){var t=T();return this.multiplyTo(e,t),t},I.prototype.divide=function(e){var t=T();return this.divRemTo(e,t,null),t},I.prototype.remainder=function(e){var t=T();return this.divRemTo(e,null,t),t},I.prototype.divideAndRemainder=function(e){var t=T(),r=T();return this.divRemTo(e,t,r),new Array(t,r)},I.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=O(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new N(t):t.isEven()?new z(t):new U(t);var a=new Array,s=3,u=r-1,c=(1<<r)-1;if(a[1]=n.convert(this),r>1){var l=T();for(n.sqrTo(a[1],l);s<=c;)a[s]=T(),n.mulTo(l,a[s-2],a[s]),s+=2}var f,h,p=e.t-1,d=!0,g=T();for(i=x(e[p])-1;p>=0;){for(i>=u?f=e[p]>>i-u&c:(f=(e[p]&(1<<i+1)-1)<<u-i,p>0&&(f|=e[p-1]>>this.DB+i-u)),s=r;0==(1&f);)f>>=1,--s;if((i-=s)<0&&(i+=this.DB,--p),d)a[f].copyTo(o),d=!1;else{for(;s>1;)n.sqrTo(o,g),n.sqrTo(g,o),s-=2;s>0?n.sqrTo(o,g):(h=o,o=g,g=h),n.mulTo(g,a[f],o)}for(;p>=0&&0==(e[p]&1<<i);)n.sqrTo(o,g),h=o,o=g,g=h,--i<0&&(i=this.DB-1,--p)}return n.revert(o)},I.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return I.ZERO;for(var r=e.clone(),n=this.clone(),i=O(1),o=O(0),a=O(0),s=O(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(e,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),o.subTo(s,o)):(n.subTo(r,n),t&&a.subTo(i,a),s.subTo(o,s))}return 0!=n.compareTo(I.ONE)?I.ZERO:s.compareTo(e)>=0?s.subtract(e):s.signum()<0?(s.addTo(e,s),s.signum()<0?s.add(e):s):s},I.prototype.pow=function(e){return this.exp(e,new H)},I.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},I.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=J[J.length-1]){for(t=0;t<J.length;++t)if(r[0]==J[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<J.length;){for(var n=J[t],i=t+1;i<J.length&&n<Q;)n*=J[i++];for(n=r.modInt(n);t<i;)if(n%J[t++]==0)return!1}return r.millerRabin(e)},I.prototype.square=function(){var e=T();return this.squareTo(e),e},Y.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},Y.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]},null==G){var Z;if(G=new Array,W=0,void 0!==i&&void 0!==i.msCrypto){var ee=i.msCrypto;if(ee.getRandomValues){var te=new Uint8Array(32);for(ee.getRandomValues(te),Z=0;Z<32;++Z)G[W++]=te[Z]}}for(;W<256;)Z=Math.floor(65536*Math.random()),G[W++]=Z>>>8,G[W++]=255&Z;W=0,X()}function re(){if(null==$){for(X(),($=new Y).init(G),W=0;W<G.length;++W)G[W]=0;W=0}return $.next()}function ne(){}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
         */function ie(e,t){return new I(e,t)}function oe(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return n}function ae(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
         */}function se(e,t){this.x=t,this.q=e}function ue(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=null==n?I.ONE:n,this.zinv=null}function ce(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new ue(this,null,null)}ne.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=re()},ae.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},ae.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=ie(e,16),this.e=parseInt(t,16)}},ae.prototype.encrypt=function(e){var t=function(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var o=new ne,a=new Array;t>2;){for(a[0]=0;0==a[0];)o.nextBytes(a);r[--t]=a[0]}return r[--t]=2,r[--t]=0,new I(r)}(e,this.n.bitLength()+7>>3);if(null==t)return null;var r=this.doPublic(t);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n},ae.prototype.encryptOAEP=function(e,t,r){var n=function(e,t,r,n){var i=fe.crypto.MessageDigest,o=fe.crypto.Util,a=null;if(r||(r="sha1"),"string"==typeof r&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(e){return Ae(o.hashHex(Ie(e),a))}),e.length+2*n+2>t)throw"Message too long for RSA";var s,u="";for(s=0;s<t-e.length-2*n-2;s+=1)u+="\0";var c=r("")+u+""+e,l=new Array(n);(new ne).nextBytes(l);var f=oe(l,c.length,r),h=[];for(s=0;s<c.length;s+=1)h[s]=c.charCodeAt(s)^f.charCodeAt(s);var p=oe(h,l.length,r),d=[0];for(s=0;s<l.length;s+=1)d[s+1]=l[s]^p.charCodeAt(s);return new I(d.concat(h))}(e,this.n.bitLength()+7>>3,t,r);if(null==n)return null;var i=this.doPublic(n);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o},ae.prototype.type="RSA",se.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},se.prototype.toBigInteger=function(){return this.x},se.prototype.negate=function(){return new se(this.q,this.x.negate().mod(this.q))},se.prototype.add=function(e){return new se(this.q,this.x.add(e.toBigInteger()).mod(this.q))},se.prototype.subtract=function(e){return new se(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},se.prototype.multiply=function(e){return new se(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},se.prototype.square=function(){return new se(this.q,this.x.square().mod(this.q))},se.prototype.divide=function(e){return new se(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},ue.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ue.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ue.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(I.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(I.ZERO))},ue.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(I.ZERO)&&!this.y.toBigInteger().equals(I.ZERO)},ue.prototype.negate=function(){return new ue(this.curve,this.x,this.y.negate(),this.z)},ue.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(I.ZERO.equals(r))return I.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new I("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),a=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),s=a.multiply(r),u=i.multiply(a),c=t.square().multiply(this.z),l=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(s).multiply(r).mod(this.curve.q),f=u.multiply(n).multiply(t).subtract(o.multiply(s)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(s)).mod(this.curve.q),h=s.multiply(this.z).multiply(e.z).mod(this.curve.q);return new ue(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(f),h)},ue.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new I("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),o=this.curve.a.toBigInteger(),a=t.square().multiply(e);I.ZERO.equals(o)||(a=a.add(this.z.square().multiply(o)));var s=(a=a.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),u=a.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.square().multiply(a)).mod(this.curve.q),c=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new ue(this.curve,this.curve.fromBigInteger(s),this.curve.fromBigInteger(u),c)},ue.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new I("3")),i=this.negate(),o=this,a=this.curve.q.subtract(e),s=a.multiply(new I("3")),u=new ue(this.curve,this.x,this.y),c=u.negate();for(t=n.bitLength()-2;t>0;--t){o=o.twice();var l=n.testBit(t);l!=r.testBit(t)&&(o=o.add(l?this:i))}for(t=s.bitLength()-2;t>0;--t){u=u.twice();var f=s.testBit(t);f!=a.testBit(t)&&(u=u.add(f?u:c))}return o},ue.prototype.multiplyTwo=function(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(o):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i},ce.prototype.getQ=function(){return this.q},ce.prototype.getA=function(){return this.a},ce.prototype.getB=function(){return this.b},ce.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},ce.prototype.getInfinity=function(){return this.infinity},ce.prototype.fromBigInteger=function(e){return new se(this.q,e)},ce.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),n=e.substr(t+2,t);return new ue(this,this.fromBigInteger(new I(r,16)),this.fromBigInteger(new I(n,16)));default:return null}},se.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},ue.prototype.getEncoded=function(e){var t=function(e,t){var r=e.toByteArrayUnsigned();if(t<r.length)r=r.slice(r.length-t);else for(;t>r.length;)r.unshift(0);return r},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i},ue.decodeFrom=function(e,t){t[0];var r=t.length-1,n=t.slice(1,1+r/2),i=t.slice(1+r/2,1+r);n.unshift(0),i.unshift(0);var o=new I(n),a=new I(i);return new ue(e,e.fromBigInteger(o),e.fromBigInteger(a))},ue.decodeFromHex=function(e,t){t.substr(0,2);var r=t.length-2,n=t.substr(2,r/2),i=t.substr(2+r/2,r/2),o=new I(n,16),a=new I(i,16);return new ue(e,e.fromBigInteger(o),e.fromBigInteger(a))},ue.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y).divide(t),n=r.square().subtract(this.x).subtract(e.x),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new ue(this.curve,n,i)},ue.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(I.valueOf(2)),t=this.curve.fromBigInteger(I.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new ue(this.curve,n,i)},ue.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new I("3")),i=this.negate(),o=this;for(t=n.bitLength()-2;t>0;--t){o=o.twice();var a=n.testBit(t);a!=r.testBit(t)&&(o=o.add2D(a?this:i))}return o},ue.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),o=t.multiply(t).mod(i),a=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return o.equals(a)},ue.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},ue.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(I.ONE)<0||t.compareTo(e.subtract(I.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(I.ONE)<0||r.compareTo(e.subtract(I.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
         */
var le=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(e,t,r){return t?n[t]:String.fromCharCode(parseInt(r,16))}var o=new String(""),a=Object.hasOwnProperty;return function(n,s){var u,c,l=n.match(e),f=l[0],h=!1;"{"===f?u={}:"["===f?u=[]:(u=[],h=!0);for(var p=[u],d=1-h,g=l.length;d<g;++d){var y;switch((f=l[d]).charCodeAt(0)){default:(y=p[0])[c||y.length]=+f,c=void 0;break;case 34:if(-1!==(f=f.substring(1,f.length-1)).indexOf("\\")&&(f=f.replace(t,i)),y=p[0],!c){if(!(y instanceof Array)){c=f||o;break}c=y.length}y[c]=f,c=void 0;break;case 91:y=p[0],p.unshift(y[c||y.length]=[]),c=void 0;break;case 93:p.shift();break;case 102:(y=p[0])[c||y.length]=!1,c=void 0;break;case 110:(y=p[0])[c||y.length]=null,c=void 0;break;case 116:(y=p[0])[c||y.length]=!0,c=void 0;break;case 123:y=p[0],p.unshift(y[c||y.length]={}),c=void 0;break;case 125:p.shift()}}if(h){if(1!==p.length)throw new Error;u=u[0]}else if(p.length)throw new Error;return s&&(u=function e(t,n){var i=t[n];if(i&&"object"===(void 0===i?"undefined":r(i))){var o=null;for(var u in i)if(a.call(i,u)&&i!==t){var c=e(i,u);void 0!==c?i[u]=c:(o||(o=[]),o.push(u))}if(o)for(var l=o.length;--l>=0;)delete i[o[l]]}return s.call(t,n,i)}({"":u},"")),u}}();void 0!==fe&&fe||(t.KJUR=fe={}),void 0!==fe.asn1&&fe.asn1||(fe.asn1={}),fe.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=t.substr(1).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",i=0;i<r;i++)n+="f";t=new I(n,16).xor(e).add(I.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return ke(e,t)},this.newObject=function(e){var t=fe.asn1,r=t.ASN1Object,n=t.DERBoolean,i=t.DERInteger,o=t.DERBitString,a=t.DEROctetString,s=t.DERNull,u=t.DERObjectIdentifier,c=t.DEREnumerated,l=t.DERUTF8String,f=t.DERNumericString,h=t.DERPrintableString,p=t.DERTeletexString,d=t.DERIA5String,g=t.DERUTCTime,y=t.DERGeneralizedTime,v=t.DERVisibleString,m=t.DERBMPString,b=t.DERSequence,E=t.DERSet,S=t.DERTaggedObject,w=t.ASN1Util.newObject;if(e instanceof t.ASN1Object)return e;var _=Object.keys(e);if(1!=_.length)throw new Error("key of param shall be only one.");var C=_[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+C+":"))throw new Error("undefined key: "+C);if("bool"==C)return new n(e[C]);if("int"==C)return new i(e[C]);if("bitstr"==C)return new o(e[C]);if("octstr"==C)return new a(e[C]);if("null"==C)return new s(e[C]);if("oid"==C)return new u(e[C]);if("enum"==C)return new c(e[C]);if("utf8str"==C)return new l(e[C]);if("numstr"==C)return new f(e[C]);if("prnstr"==C)return new h(e[C]);if("telstr"==C)return new p(e[C]);if("ia5str"==C)return new d(e[C]);if("utctime"==C)return new g(e[C]);if("gentime"==C)return new y(e[C]);if("visstr"==C)return new v(e[C]);if("bmpstr"==C)return new m(e[C]);if("asn1"==C)return new r(e[C]);if("seq"==C){for(var A=e[C],I=[],T=0;T<A.length;T++){var P=w(A[T]);I.push(P)}return new b({array:I})}if("set"==C){for(A=e[C],I=[],T=0;T<A.length;T++)P=w(A[T]),I.push(P);return new E({array:I})}if("tag"==C){var F=e[C];if("[object Array]"===Object.prototype.toString.call(F)&&3==F.length){var k=w(F[2]);return new S({tag:F[0],explicit:F[1],obj:k})}return new S(F)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},fe.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",r=parseInt(e.substr(0,2),16),n=(t=Math.floor(r/40)+"."+r%40,""),i=2;i<e.length;i+=2){var o=("00000000"+parseInt(e.substr(i,2),16).toString(2)).slice(-8);n+=o.substr(1,7),"0"==o.substr(0,1)&&(t=t+"."+new I(n,2).toString(10),n="")}return t},fe.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new I(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",a=0;a<i;a++)o+="0";for(n=o+n,a=0;a<n.length-1;a+=7){var s=n.substr(a,7);a!=n.length-7&&(s="1"+s),r+=t(parseInt(s,2))}return r};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),o=40*parseInt(i[0])+parseInt(i[1]);n+=t(o),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n},fe.asn1.ASN1Object=function(e){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+"".length+",v="+this.hV);var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var r=t.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},null!=e&&null!=e.tlv&&(this.hTLV=e.tlv,this.isModified=!1)},fe.asn1.DERAbstractString=function(e){fe.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=_e(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},o.lang.extend(fe.asn1.DERAbstractString,fe.asn1.ASN1Object),fe.asn1.DERAbstractTime=function(e){fe.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t)},this.formatDate=function(e,t,r){var n=this.zeroPadding,i=this.localDateToUTC(e),o=String(i.getFullYear());"utc"==t&&(o=o.substr(2,2));var a=o+n(String(i.getMonth()+1),2)+n(String(i.getDate()),2)+n(String(i.getHours()),2)+n(String(i.getMinutes()),2)+n(String(i.getSeconds()),2);if(!0===r){var s=i.getMilliseconds();if(0!=s){var u=n(String(s),3);a=a+"."+(u=u.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=me(e)},this.setByDateValue=function(e,t,r,n,i,o){var a=new Date(Date.UTC(e,t-1,r,n,i,o,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},o.lang.extend(fe.asn1.DERAbstractTime,fe.asn1.ASN1Object),fe.asn1.DERAbstractStructured=function(e){fe.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},o.lang.extend(fe.asn1.DERAbstractStructured,fe.asn1.ASN1Object),fe.asn1.DERBoolean=function(e){fe.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==e?"010100":"0101ff"},o.lang.extend(fe.asn1.DERBoolean,fe.asn1.ASN1Object),fe.asn1.DERInteger=function(e){fe.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=fe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new I(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},o.lang.extend(fe.asn1.DERInteger,fe.asn1.ASN1Object),fe.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=fe.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}fe.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var r="0"+e;this.hTLV=null,this.isModified=!0,this.hV=r+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var r=0;r<=t;r++)e+="0";var n="";for(r=0;r<e.length-1;r+=8){var i=e.substr(r,8),o=parseInt(i,2).toString(16);1==o.length&&(o="0"+o),n+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",r=0;r<e.length;r++)1==e[r]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},o.lang.extend(fe.asn1.DERBitString,fe.asn1.ASN1Object),fe.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=fe.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}fe.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},o.lang.extend(fe.asn1.DEROctetString,fe.asn1.DERAbstractString),fe.asn1.DERNull=function(){fe.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},o.lang.extend(fe.asn1.DERNull,fe.asn1.ASN1Object),fe.asn1.DERObjectIdentifier=function(e){fe.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=parseInt(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",a=0;a<i;a++)o+="0";for(n=o+n,a=0;a<n.length-1;a+=7){var s=n.substr(a,7);a!=n.length-7&&(s="1"+s),r+=t(parseInt(s,2))}return r};try{if(!e.match(/^[0-9.]+$/))return null;var n="",i=e.split("."),o=40*parseInt(i[0],10)+parseInt(i[1],10);n+=t(o),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n}catch(s){return null}}(e);if(null==t)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=fe.asn1.x509.OID.name2oid(e);if(""===t)throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(t)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){"string"==typeof e?this.setValueNameOrOid(e):void 0!==e.oid?this.setValueNameOrOid(e.oid):void 0!==e.name?this.setValueNameOrOid(e.name):void 0!==e.hex&&this.setValueHex(e.hex)},void 0!==e&&this.setByParam(e)},o.lang.extend(fe.asn1.DERObjectIdentifier,fe.asn1.ASN1Object),fe.asn1.DEREnumerated=function(e){fe.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=fe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new I(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},o.lang.extend(fe.asn1.DEREnumerated,fe.asn1.ASN1Object),fe.asn1.DERUTF8String=function(e){fe.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},o.lang.extend(fe.asn1.DERUTF8String,fe.asn1.DERAbstractString),fe.asn1.DERNumericString=function(e){fe.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},o.lang.extend(fe.asn1.DERNumericString,fe.asn1.DERAbstractString),fe.asn1.DERPrintableString=function(e){fe.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},o.lang.extend(fe.asn1.DERPrintableString,fe.asn1.DERAbstractString),fe.asn1.DERTeletexString=function(e){fe.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},o.lang.extend(fe.asn1.DERTeletexString,fe.asn1.DERAbstractString),fe.asn1.DERIA5String=function(e){fe.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},o.lang.extend(fe.asn1.DERIA5String,fe.asn1.DERAbstractString),fe.asn1.DERVisibleString=function(e){fe.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},o.lang.extend(fe.asn1.DERVisibleString,fe.asn1.DERAbstractString),fe.asn1.DERBMPString=function(e){fe.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},o.lang.extend(fe.asn1.DERBMPString,fe.asn1.DERAbstractString),fe.asn1.DERUTCTime=function(e){fe.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=me(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=me(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},o.lang.extend(fe.asn1.DERUTCTime,fe.asn1.DERAbstractTime),fe.asn1.DERGeneralizedTime=function(e){fe.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=me(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=me(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},o.lang.extend(fe.asn1.DERGeneralizedTime,fe.asn1.DERAbstractTime),fe.asn1.DERSequence=function(e){fe.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},o.lang.extend(fe.asn1.DERSequence,fe.asn1.DERAbstractStructured),fe.asn1.DERSet=function(e){fe.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},o.lang.extend(fe.asn1.DERSet,fe.asn1.DERAbstractStructured),fe.asn1.DERTaggedObject=function(e){fe.asn1.DERTaggedObject.superclass.constructor.call(this);var t=fe.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,r){this.hT=t,this.isExplicit=e,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){null!=e.tag&&(this.hT=e.tag),null!=e.explicit&&(this.isExplicit=e.explicit),null!=e.tage&&(this.hT=e.tage,this.isExplicit=!0),null!=e.tagi&&(this.hT=e.tagi,this.isExplicit=!1),null!=e.obj&&(e.obj instanceof t.ASN1Object?(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==r(e.obj)&&(this.asn1Object=t.ASN1Util.newObject(e.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=e&&this.setByParam(e)},o.lang.extend(fe.asn1.DERTaggedObject,fe.asn1.ASN1Object);var fe,he,pe,de=new function(){};function ge(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function ye(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}function ve(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function me(e){return ve(ge(e))}function be(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function Ee(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function Se(e){return e.length%2==1&&(e="0"+e),be(_(e))}function we(e){return C(Ee(e))}function _e(e){return xe(Le(e))}function Ce(e){return decodeURIComponent(Ne(e))}function Ae(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function Ie(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function Te(e){return _(e)}function Pe(e){var t=Te(e).replace(/(.{64})/g,"$1\r\n");return t.replace(/\r\n$/,"")}function Fe(e){return C(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function ke(e,t){return"-----BEGIN "+t+"-----\r\n"+Pe(e)+"\r\n-----END "+t+"-----\r\n"}function Re(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return Fe(e=void 0!==t?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),"")).replace(new RegExp("-----END "+t+"-----[^]*$"),""):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Be(e){var t,r,n,i,o,a,s,u,c,l,f;if(f=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=f[1],t=parseInt(u),2===u.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),r=parseInt(f[2])-1,n=parseInt(f[3]),i=parseInt(f[4]),o=parseInt(f[5]),a=parseInt(f[6]),s=0,""!==(c=f[7])&&(l=(c.substr(1)+"00").substr(0,3),s=parseInt(l)),Date.UTC(t,r,n,i,o,a,s);throw"unsupported zulu format: "+e}function Oe(e){return~~(Be(e)/1e3)}function xe(e){return e.replace(/%/g,"")}function Ne(e){return e.replace(/(..)/g,"%$1")}function Ue(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var r=(e=e.toLowerCase()).split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2),i=(e=e.replace("::",n)).split(":");if(8!=i.length)throw t;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function je(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var t=(e=e.toLowerCase()).match(/.{1,4}/g),r=0;r<8;r++)t[r]=t[r].replace(/^0+/,""),""==t[r]&&(t[r]="0");var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null===n)return e.slice(1,-1);var i="";for(r=0;r<n.length;r++)n[r].length>i.length&&(i=n[r]);return(e=e.replace(i,"::")).slice(1,-1)}function De(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?je(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(r){throw t}}function Le(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)"%"==t[n]?(r+=t.substr(n,3),n+=2):r=r+"%"+me(t[n]);return r}function Me(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))}function Ke(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}de.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var r=parseInt(e.substr(t+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},de.getL=function(e,t){var r=de.getLblen(e,t);return r<1?"":e.substr(t+2,2*r)},de.getVblen=function(e,t){var r;return""==(r=de.getL(e,t))?-1:("8"===r.substr(0,1)?new I(r.substr(2),16):new I(r,16)).intValue()},de.getVidx=function(e,t){var r=de.getLblen(e,t);return r<0?r:t+2*(r+1)},de.getV=function(e,t){var r=de.getVidx(e,t),n=de.getVblen(e,t);return e.substr(r,2*n)},de.getTLV=function(e,t){return e.substr(t,2)+de.getL(e,t)+de.getV(e,t)},de.getTLVblen=function(e,t){return 2+2*de.getLblen(e,t)+2*de.getVblen(e,t)},de.getNextSiblingIdx=function(e,t){return de.getVidx(e,t)+2*de.getVblen(e,t)},de.getChildIdx=function(e,t){var r,n,i,o=de,a=[];r=o.getVidx(e,t),n=2*o.getVblen(e,t),"03"==e.substr(t,2)&&(r+=2,n-=2),i=0;for(var s=r;i<=n;){var u=o.getTLVblen(e,s);if((i+=u)<=n&&a.push(s),s+=u,i>=n)break}return a},de.getNthChildIdx=function(e,t,r){return de.getChildIdx(e,t)[r]},de.getIdxbyList=function(e,t,r,n){var i,o,a=de;return 0==r.length?void 0!==n&&e.substr(t,2)!==n?-1:t:(i=r.shift())>=(o=a.getChildIdx(e,t)).length?-1:a.getIdxbyList(e,o[i],r,n)},de.getIdxbyListEx=function(e,t,r,n){var i,o,a=de;if(0==r.length)return void 0!==n&&e.substr(t,2)!==n?-1:t;i=r.shift(),o=a.getChildIdx(e,t);for(var s=0,u=0;u<o.length;u++){var c=e.substr(o[u],2);if("number"==typeof i&&!a.isContextTag(c)&&s==i||"string"==typeof i&&a.isContextTag(c,i))return a.getIdxbyListEx(e,o[u],r,n);a.isContextTag(c)||s++}return-1},de.getTLVbyList=function(e,t,r,n){var i=de,o=i.getIdxbyList(e,t,r,n);return-1==o||o>=e.length?null:i.getTLV(e,o)},de.getTLVbyListEx=function(e,t,r,n){var i=de,o=i.getIdxbyListEx(e,t,r,n);return-1==o?null:i.getTLV(e,o)},de.getVbyList=function(e,t,r,n,i){var o,a,s=de;return-1==(o=s.getIdxbyList(e,t,r,n))||o>=e.length?null:(a=s.getV(e,o),!0===i&&(a=a.substr(2)),a)},de.getVbyListEx=function(e,t,r,n,i){var o,a,s=de;return-1==(o=s.getIdxbyListEx(e,t,r,n))?null:(a=s.getV(e,o),"03"==e.substr(o,2)&&!1!==i&&(a=a.substr(2)),a)},de.getInt=function(e,t,r){null==r&&(r=-1);try{var n=e.substr(t,2);if("02"!=n&&"03"!=n)return r;var i=de.getV(e,t);return"02"==n?parseInt(i,16):function(e){try{var t=e.substr(0,2);if("00"==t)return parseInt(e.substr(2),16);var r=parseInt(t,16),n=e.substr(2),i=parseInt(n,16).toString(2);return"0"==i&&(i="00000000"),i=i.slice(0,0-r),parseInt(i,2)}catch(o){return-1}}(i)}catch(o){return r}},de.getOID=function(e,t,r){null==r&&(r=null);try{return"06"!=e.substr(t,2)?r:function(e){if(!Me(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var i=e.substr(2),o=[],a=0;a<i.length/2;a++)o.push(parseInt(i.substr(2*a,2),16));var s=[],u="";for(a=0;a<o.length;a++)128&o[a]?u+=Ve((127&o[a]).toString(2),7):(u+=Ve((127&o[a]).toString(2),7),s.push(new String(parseInt(u,2))),u="");var c=t.join(".");return s.length>0&&(c=c+"."+s.join(".")),c}catch(l){return null}}(de.getV(e,t))}catch(n){return r}},de.getOIDName=function(e,t,r){null==r&&(r=null);try{var n=de.getOID(e,t,r);if(n==r)return r;var i=fe.asn1.x509.OID.oid2name(n);return""==i?n:i}catch(o){return r}},de.getString=function(e,t,r){null==r&&(r=null);try{return Ae(de.getV(e,t))}catch(n){return r}},de.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var o=e.substr(2),a=[],s=0;s<o.length/2;s++)a.push(parseInt(o.substr(2*s,2),16));var u=[],c="";for(s=0;s<a.length;s++)128&a[s]?c+=t((127&a[s]).toString(2),7):(c+=t((127&a[s]).toString(2),7),u.push(new String(parseInt(c,2))),c="");var l=r.join(".");return u.length>0&&(l=l+"."+u.join(".")),l},de.dump=function(e,t,r,n){var i=de,o=i.getV,a=i.dump,s=i.getChildIdx,u=e;e instanceof fe.asn1.ASN1Object&&(u=e.getEncodedHex());var c=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===r&&(r=0),void 0===n&&(n="");var l,f=t.ommit_long_octet;if("01"==(l=u.substr(r,2)))return"00"==(h=o(u,r))?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n";if("02"==l)return n+"INTEGER "+c(h=o(u,r),f)+"\n";if("03"==l){var h=o(u,r);return i.isASN1HEX(h.substr(2))?(S=n+"BITSTRING, encapsulates\n")+a(h.substr(2),t,0,n+"  "):n+"BITSTRING "+c(h,f)+"\n"}if("04"==l)return h=o(u,r),i.isASN1HEX(h)?(S=n+"OCTETSTRING, encapsulates\n")+a(h,t,0,n+"  "):n+"OCTETSTRING "+c(h,f)+"\n";if("05"==l)return n+"NULL\n";if("06"==l){var p=o(u,r),d=fe.asn1.ASN1Util.oidHexToInt(p),g=fe.asn1.x509.OID.oid2name(d),y=d.replace(/\./g," ");return""!=g?n+"ObjectIdentifier "+g+" ("+y+")\n":n+"ObjectIdentifier ("+y+")\n"}if("0a"==l)return n+"ENUMERATED "+parseInt(o(u,r))+"\n";if("0c"==l)return n+"UTF8String '"+Ce(o(u,r))+"'\n";if("13"==l)return n+"PrintableString '"+Ce(o(u,r))+"'\n";if("14"==l)return n+"TeletexString '"+Ce(o(u,r))+"'\n";if("16"==l)return n+"IA5String '"+Ce(o(u,r))+"'\n";if("17"==l)return n+"UTCTime "+Ce(o(u,r))+"\n";if("18"==l)return n+"GeneralizedTime "+Ce(o(u,r))+"\n";if("1a"==l)return n+"VisualString '"+Ce(o(u,r))+"'\n";if("1e"==l)return n+"BMPString '"+Ce(o(u,r))+"'\n";if("30"==l){if("3000"==u.substr(r,4))return n+"SEQUENCE {}\n";S=n+"SEQUENCE\n";var v=t;if((2==(E=s(u,r)).length||3==E.length)&&"06"==u.substr(E[0],2)&&"04"==u.substr(E[E.length-1],2)){g=i.oidname(o(u,E[0]));var m=JSON.parse(JSON.stringify(t));m.x509ExtName=g,v=m}for(var b=0;b<E.length;b++)S+=a(u,v,E[b],n+"  ");return S}if("31"==l){S=n+"SET\n";var E=s(u,r);for(b=0;b<E.length;b++)S+=a(u,t,E[b],n+"  ");return S}if(0!=(128&(l=parseInt(l,16)))){var S,w=31&l;if(0!=(32&l)){for(S=n+"["+w+"]\n",E=s(u,r),b=0;b<E.length;b++)S+=a(u,t,E[b],n+"  ");return S}return h=o(u,r),de.isASN1HEX(h)?(S=n+"["+w+"]\n")+a(h,t,0,n+"  "):(("68747470"==h.substr(0,8)||"subjectAltName"===t.x509ExtName&&2==w)&&(h=Ce(h)),n+"["+w+"] "+h+"\n")}return n+"UNKNOWN("+l+") "+o(u,r)+"\n"},de.isContextTag=function(e,t){var r,n;e=e.toLowerCase();try{r=parseInt(e,16)}catch(i){return-1}if(void 0===t)return 128==(192&r);try{return null!=t.match(/^\[[0-9]+\]$/)&&!((n=parseInt(t.substr(1,t.length-1),10))>31)&&128==(192&r)&&(31&r)==n}catch(i){return!1}},de.isASN1HEX=function(e){var t=de;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0);return e.length-n.length-i.length==2*r},de.checkStrictDER=function(e,t,r,n,i){var o=de;if(void 0===r){if("string"!=typeof e)throw new Error("not hex string");if(e=e.toLowerCase(),!fe.lang.String.isHex(e))throw new Error("not hex string");r=e.length,i=(n=e.length/2)<128?1:Math.ceil(n.toString(16))+1}if(o.getL(e,t).length>2*i)throw new Error("L of TLV too long: idx="+t);var a=o.getVblen(e,t);if(a>n)throw new Error("value of L too long than hex: idx="+t);var s=o.getTLV(e,t),u=s.length-2-o.getL(e,t).length;if(u!==2*a)throw new Error("V string length and L's value not the same:"+u+"/"+2*a);if(0===t&&e.length!=s.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+s.length);var c=e.substr(t,2);if("02"===c){var l=o.getVidx(e,t);if("00"==e.substr(l,2)&&e.charCodeAt(l+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(c,16)){for(var f=o.getVblen(e,t),h=0,p=o.getChildIdx(e,t),d=0;d<p.length;d++)h+=o.getTLV(e,p[d]).length,o.checkStrictDER(e,p[d],r,n,i);if(2*f!=h)throw new Error("sum of children's TLV length and L unmatch: "+2*f+"!="+h)}},de.oidname=function(e){var t=fe.asn1;fe.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return""===r&&(r=e),r},void 0!==fe&&fe||(t.KJUR=fe={}),void 0!==fe.lang&&fe.lang||(fe.lang={}),fe.lang.String=function(){},"function"==typeof e?(t.utf8tob64u=he=function(t){return be(e.from(t,"utf8").toString("base64"))},t.b64utoutf8=pe=function(t){return e.from(Ee(t),"base64").toString("utf8")}):(t.utf8tob64u=he=function(e){return Se(xe(Le(e)))},t.b64utoutf8=pe=function(e){return decodeURIComponent(Ne(we(e)))}),fe.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},fe.lang.String.isHex=function(e){return Me(e)},fe.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},fe.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=Ee(e),fe.lang.String.isBase64(e))},fe.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},fe.lang.String.isPrintable=function(e){return null!==e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},fe.lang.String.isIA5=function(e){return null!==e.match(/^[\x20-\x21\x23-\x7f]*$/)},fe.lang.String.isMail=function(e){return null!==e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var Ve=function(e,t,r){return null==r&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};void 0!==fe&&fe||(t.KJUR=fe={}),void 0!==fe.crypto&&fe.crypto||(fe.crypto={}),fe.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:S.algo.MD5,sha1:S.algo.SHA1,sha224:S.algo.SHA224,sha256:S.algo.SHA256,sha384:S.algo.SHA384,sha512:S.algo.SHA512,ripemd160:S.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var o="0001",a="00"+n,s="",u=i-o.length-a.length,c=0;c<u;c+=2)s+="ff";return o+s+a},this.hashString=function(e,t){return new fe.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new fe.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof ae||e instanceof fe.crypto.DSA||e instanceof fe.crypto.ECDSA}},fe.crypto.Util.md5=function(e){return new fe.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},fe.crypto.Util.ripemd160=function(e){return new fe.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},fe.crypto.Util.SECURERANDOMGEN=new ne,fe.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return fe.crypto.Util.SECURERANDOMGEN.nextBytes(t),ve(t)},fe.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new I(fe.crypto.Util.getRandomHexOfNbytes(e),16)},fe.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=new Array((e-t)/8+1);return fe.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<t&255^255)&r[0],ve(r)},fe.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new I(fe.crypto.Util.getRandomHexOfNbits(e),16)},fe.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=fe.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(r))return r}},fe.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(1==r)throw"biMin is greater than biMax";if(0==r)return e;var n=t.subtract(e);return fe.crypto.Util.getRandomBigIntegerZeroToMax(n).add(e)},fe.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=fe.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=fe.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=fe.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(r){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+r}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=S.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(S.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(r){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+r}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=fe.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},fe.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},fe.crypto.MessageDigest.getHashLength=function(e){var t=fe.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[r])throw"not supported algorithm: "+e;return t.HASHLENGTH[r]},fe.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},fe.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=fe.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var r=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==t){try{var n=fe.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=S.algo.HMAC.create(n,this.pass)}catch(i){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+i}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=S.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(S.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=Ie(e)),void(this.pass=S.enc.Hex.parse(t))}if("object"!=(void 0===e?"undefined":r(e)))throw"KJUR.crypto.Mac unsupported password type: "+e;if(t=null,void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=_e(e.utf8)),void 0!==e.rstr&&(t=Ie(e.rstr)),void 0!==e.b64&&(t=C(e.b64)),void 0!==e.b64u&&(t=we(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=S.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=fe.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},fe.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw new Error("provider not supported: "+t);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new fe.crypto.MessageDigest({alg:this.mdAlgName})}catch(r){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+r)}this.init=function(e,t){var r=null;try{r=void 0===t?He.getKey(e):He.getKey(e,t)}catch(n){throw"init failed:"+n}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==fe.crypto.ECDSA&&(this.prvKey=new fe.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ae&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ae&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof fe.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof fe.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==fe.crypto.ECDSA&&(this.pubKey=new fe.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ae&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ae&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==fe.crypto.ECDSA&&this.pubKey instanceof fe.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==fe.crypto.DSA&&this.pubKey instanceof fe.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=fe.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=He.getKey(e.prvkeypem),this.init(t)}catch(r){throw"fatal error to load pem private key: "+r}}},fe.crypto.Cipher=function(e){},fe.crypto.Cipher.encrypt=function(e,t,r){if(t instanceof ae&&t.isPublic){var n=fe.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.encrypt(e);if("RSAOAEP"===n)return t.encryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.encryptOAEP(e,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},fe.crypto.Cipher.decrypt=function(e,t,r){if(t instanceof ae&&t.isPrivate){var n=fe.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.decrypt(e);if("RSAOAEP"===n)return t.decryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.decryptOAEP(e,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},fe.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof ae){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null==t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},fe.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==fe&&fe||(t.KJUR=fe={}),void 0!==fe.crypto&&fe.crypto||(fe.crypto={}),fe.crypto.ECDSA=function(e){var t=Error,n=I,i=ue,o=fe.crypto.ECDSA,a=fe.crypto.ECParameterDB,s=o.getName,u=de,c=u.getVbyListEx,l=u.isASN1HEX,f=new ne;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new n(e.bitLength(),f).mod(e.subtract(n.ONE)).add(n.ONE)},this.setNamedCurve=function(e){this.ecparams=a.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var r={};return r.x=e.substr(2,t),r.y=e.substr(2+t),r},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),r=this.ecparams.G.multiply(t),n=r.getX().toBigInteger(),i=r.getY().toBigInteger(),o=this.ecparams.keylen/4,a=("0000000000"+t.toString(16)).slice(-o),s="04"+("0000000000"+n.toString(16)).slice(-o)+("0000000000"+i.toString(16)).slice(-o);return this.setPrivateKeyHex(a),this.setPublicKeyHex(s),{ecprvhex:a,ecpubhex:s}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var r=new n(t,16),i=this.ecparams.n,a=new n(e.substring(0,this.ecparams.keylen/4),16);do{var s=this.getBigRandom(i),u=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(u.compareTo(n.ZERO)<=0);var c=s.modInverse(i).multiply(a.add(r.multiply(u))).mod(i);return o.biRSSigToASN1Sig(u,c)},this.sign=function(e,t){var r=t,i=this.ecparams.n,o=n.fromByteArrayUnsigned(e);do{var a=this.getBigRandom(i),s=this.ecparams.G.multiply(a).getX().toBigInteger().mod(i)}while(s.compareTo(I.ZERO)<=0);var u=a.modInverse(i).multiply(o.add(r.multiply(s))).mod(i);return this.serializeSig(s,u)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,r){try{var a,s,u=o.parseSigHex(t);a=u.r,s=u.s;var c=i.decodeFromHex(this.ecparams.curve,r),l=new n(e.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(l,a,s,c)}catch(f){return!1}},this.verify=function(e,t,o){var a,s,u;if(Bitcoin.Util.isArray(t)){var c=this.parseSig(t);a=c.r,s=c.s}else{if("object"!==(void 0===t?"undefined":r(t))||!t.r||!t.s)throw"Invalid value for signature";a=t.r,s=t.s}if(o instanceof ue)u=o;else{if(!Bitcoin.Util.isArray(o))throw"Invalid format for pubkey value, must be byte array or ECPointFp";u=i.decodeFrom(this.ecparams.curve,o)}var l=n.fromByteArrayUnsigned(e);return this.verifyRaw(l,a,s,u)},this.verifyRaw=function(e,t,r,i){var o=this.ecparams.n,a=this.ecparams.G;if(t.compareTo(n.ONE)<0||t.compareTo(o)>=0)return!1;if(r.compareTo(n.ONE)<0||r.compareTo(o)>=0)return!1;var s=r.modInverse(o),u=e.multiply(s).mod(o),c=t.multiply(s).mod(o);return a.multiply(u).add(i.multiply(c)).getX().toBigInteger().mod(o).equals(t)},this.serializeSig=function(e,t){var r=e.toByteArraySigned(),n=t.toByteArraySigned(),i=[];return i.push(2),i.push(r.length),(i=i.concat(r)).push(2),i.push(n.length),(i=i.concat(n)).unshift(i.length),i.unshift(48),i},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var i=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:n.fromByteArrayUnsigned(r),s:n.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:n.fromByteArrayUnsigned(e.slice(1,33)).mod(r),s:n.fromByteArrayUnsigned(e.slice(33,65)).mod(r),i:t}},this.readPKCS5PrvKeyHex=function(e){if(!1===l(e))throw new Error("not ASN.1 hex string");var t,r,n;try{t=c(e,0,["[0]",0],"06"),r=c(e,0,[1],"04");try{n=c(e,0,["[1]",0],"03")}catch(i){}}catch(i){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=s(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){if(!1===l(e))throw new t("not ASN.1 hex string");var r,n,i;try{c(e,0,[1,0],"06"),r=c(e,0,[1,1],"06"),n=c(e,0,[2,0,1],"04");try{i=c(e,0,[2,0,"[1]",0],"03")}catch(o){}}catch(o){throw new t("malformed PKCS#8 plain ECC private key")}if(this.curveName=s(r),void 0===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){if(!1===l(e))throw new t("not ASN.1 hex string");var r,n;try{c(e,0,[0,0],"06"),r=c(e,0,[0,1],"06"),n=c(e,0,[1],"03")}catch(i){throw new t("malformed PKCS#8 ECC public key")}if(this.curveName=s(r),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},this.readCertPubKeyHex=function(e,r){if(!1===l(e))throw new t("not ASN.1 hex string");var n,i;try{n=c(e,0,[0,5,0,1],"06"),i=c(e,0,[0,5,1],"03")}catch(o){throw new t("malformed X.509 certificate ECC public key")}if(this.curveName=s(n),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},fe.crypto.ECDSA.parseSigHex=function(e){var t=fe.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new I(t.r,16),s:new I(t.s,16)}},fe.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=de,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),"30"!=e.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var i=r(e,0);if(2!=i.length)throw new Error("signature shall have two elements");var o=i[0],a=i[1];if("02"!=e.substr(o,2))throw new Error("1st item not ASN.1 integer");if("02"!=e.substr(a,2))throw new Error("2nd item not ASN.1 integer");return{r:n(e,o),s:n(e,a)}},fe.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=fe.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return r+n},fe.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return fe.crypto.ECDSA.hexRSSigToASN1Sig(t,r)},fe.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new I(e,16),n=new I(t,16);return fe.crypto.ECDSA.biRSSigToASN1Sig(r,n)},fe.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=fe.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t});return new r.DERSequence({array:[n,i]}).getEncodedHex()},fe.crypto.ECDSA.getName=function(e){return"2b8104001f"===e?"secp192k1":"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040021"===e?"secp224r1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(e)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==fe&&fe||(t.KJUR=fe={}),void 0!==fe.crypto&&fe.crypto||(fe.crypto={}),fe.crypto.ECParameterDB=new function(){var e={},t={};function r(e){return new I(e,16)}this.getByName=function(r){var n=r;if(void 0!==t[n]&&(n=t[r]),void 0!==e[n])return e[n];throw"unregistered EC curve name: "+n},this.regist=function(n,i,o,a,s,u,c,l,f,h,p,d){e[n]={};var g=r(o),y=r(a),v=r(s),m=r(u),b=r(c),E=new ce(g,y,v),S=E.decodePointHex("04"+l+f);e[n].name=n,e[n].keylen=i,e[n].curve=E,e[n].G=S,e[n].n=m,e[n].h=b,e[n].oid=p,e[n].info=d;for(var w=0;w<h.length;w++)t[h[w]]=n}},fe.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),fe.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),fe.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),fe.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),fe.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),fe.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),fe.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),fe.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),fe.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),fe.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var He=function(){var e=function(e,r,n){return t(S.AES,e,r,n)},t=function(e,t,r,n){var i=S.enc.Hex.parse(t),o=S.enc.Hex.parse(r),a=S.enc.Hex.parse(n),s={};s.key=o,s.iv=a,s.ciphertext=i;var u=e.decrypt(s,o,{iv:a});return S.enc.Hex.stringify(u)},r=function(e,t,r){return n(S.AES,e,t,r)},n=function(e,t,r,n){var i=S.enc.Hex.parse(t),o=S.enc.Hex.parse(r),a=S.enc.Hex.parse(n),s=e.encrypt(i,o,{iv:a}),u=S.enc.Hex.parse(s.toString());return S.enc.Base64.stringify(u)},i={"AES-256-CBC":{proc:e,eproc:r,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:r,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:r,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,r,n){return t(S.TripleDES,e,r,n)},eproc:function(e,t,r){return n(S.TripleDES,e,t,r)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,r,n){return t(S.DES,e,r,n)},eproc:function(e,t,r){return n(S.DES,e,t,r)},keylen:8,ivlen:8}},o=function(e){var t={},r=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(t.cipher=r[1],t.ivsalt=r[2]);var n=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(t.type=n[1]);var i=-1,o=0;-1!=e.indexOf("\r\n\r\n")&&(i=e.indexOf("\r\n\r\n"),o=2),-1!=e.indexOf("\n\n")&&(i=e.indexOf("\n\n"),o=1);var a=e.indexOf("-----END");if(-1!=i&&-1!=a){var s=e.substring(i+2*o,a-o);s=s.replace(/\s+/g,""),t.data=s}return t},a=function(e,t,r){for(var n=r.substring(0,16),o=S.enc.Hex.parse(n),a=S.enc.Utf8.parse(t),s=i[e].keylen+i[e].ivlen,u="",c=null;;){var l=S.algo.MD5.create();if(null!=c&&l.update(c),l.update(a),l.update(o),c=l.finalize(),(u+=S.enc.Hex.stringify(c)).length>=2*s)break}var f={};return f.keyhex=u.substr(0,2*i[e].keylen),f.ivhex=u.substr(2*i[e].keylen,2*i[e].ivlen),f},s=function(e,t,r,n){var o=S.enc.Base64.parse(e),a=S.enc.Hex.stringify(o);return(0,i[t].proc)(a,r,n)};return{version:"1.0.0",parsePKCS5PEM:function(e){return o(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,r){return a(e,t,r)},decryptKeyB64:function(e,t,r,n){return s(e,t,r,n)},getDecryptedKeyHex:function(e,t){var r=o(e),n=r.cipher,i=r.ivsalt,u=r.data,c=a(n,t,i).keyhex;return s(u,n,c,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,r,n,o){var s,u,c="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===i[n])throw"KEYUTIL unsupported algorithm: "+n;return void 0!==o&&null!=o||(o=(s=i[n].ivlen,u=S.lib.WordArray.random(s),S.enc.Hex.stringify(u)).toUpperCase()),c="-----BEGIN "+e+" PRIVATE KEY-----\r\n",c+="Proc-Type: 4,ENCRYPTED\r\n",c+="DEK-Info: "+n+","+o+"\r\n",c+="\r\n",(c+=function(e,t,r,n){return(0,i[t].eproc)(e,r,n)}(t,n,a(n,r,o).keyhex,o).replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={},o=r(e,0);if(2!=o.length)throw"malformed format: SEQUENCE(0).items != 2: "+o.length;i.ciphertext=n(e,o[1]);var a=r(e,o[0]);if(2!=a.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+a.length;if("2a864886f70d01050d"!=n(e,a[0]))throw"this only supports pkcs5PBES2";var s=r(e,a[1]);if(2!=a.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+s.length;var u=r(e,s[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=n(e,u[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=n(e,u[1]);var c=r(e,s[0]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length;if("2a864886f70d01050c"!=n(e,c[0]))throw"this only supports pkcs5PBKDF2";var l=r(e,c[1]);if(l.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length;i.pbkdf2Salt=n(e,l[0]);var f=n(e,l[1]);try{i.pbkdf2Iter=parseInt(f,16)}catch(h){throw"malformed format pbkdf2Iter: "+f}return i},getPBKDF2KeyHexFromParam:function(e,t){var r=S.enc.Hex.parse(e.pbkdf2Salt),n=e.pbkdf2Iter,i=S.PBKDF2(t,r,{keySize:6,iterations:n});return S.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var r=Re(e,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(r),i=He.getPBKDF2KeyHexFromParam(n,t),o={};o.ciphertext=S.enc.Hex.parse(n.ciphertext);var a=S.enc.Hex.parse(i),s=S.enc.Hex.parse(n.encryptionSchemeIV),u=S.TripleDES.decrypt(o,a,{iv:s});return S.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(e,t){var r=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={algparam:null};if("30"!=e.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var o=r(e,0);if(3!=o.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=e.substr(o[1],2))throw"malformed PKCS8 private key(code:003)";var a=r(e,o[1]);if(2!=a.length)throw"malformed PKCS8 private key(code:004)";if("06"!=e.substr(a[0],2))throw"malformed PKCS8 private key(code:005)";if(i.algoid=n(e,a[0]),"06"==e.substr(a[1],2)&&(i.algparam=n(e,a[1])),"04"!=e.substr(o[2],2))throw"malformed PKCS8 private key(code:006)";return i.keyidx=t.getVidx(e,o[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=Re(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,r=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==r.algoid)t=new ae;else if("2a8648ce380401"==r.algoid)t=new fe.crypto.DSA;else{if("2a8648ce3d0201"!=r.algoid)throw"unsupported private key algorithm";t=new fe.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,r=de.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===r)t=new ae;else if("2a8648ce380401"===r)t=new fe.crypto.DSA;else{if("2a8648ce3d0201"!==r)throw"unsupported PKCS#8 public key hex";t=new fe.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={};if("30"!=e.substr(0,2))throw"malformed RSA key(code:001)";var o=r(e,0);if(2!=o.length)throw"malformed RSA key(code:002)";if("02"!=e.substr(o[0],2))throw"malformed RSA key(code:003)";if(i.n=n(e,o[0]),"02"!=e.substr(o[1],2))throw"malformed RSA key(code:004)";return i.e=n(e,o[1]),i},parsePublicPKCS8Hex:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={algparam:null},o=r(e,0);if(2!=o.length)throw"outer DERSequence shall have 2 elements: "+o.length;var a=o[0];if("30"!=e.substr(a,2))throw"malformed PKCS8 public key(code:001)";var s=r(e,a);if(2!=s.length)throw"malformed PKCS8 public key(code:002)";if("06"!=e.substr(s[0],2))throw"malformed PKCS8 public key(code:003)";if(i.algoid=n(e,s[0]),"06"==e.substr(s[1],2)?i.algparam=n(e,s[1]):"30"==e.substr(s[1],2)&&(i.algparam={},i.algparam.p=t.getVbyList(e,s[1],[0],"02"),i.algparam.q=t.getVbyList(e,s[1],[1],"02"),i.algparam.g=t.getVbyList(e,s[1],[2],"02")),"03"!=e.substr(o[1],2))throw"malformed PKCS8 public key(code:004)";return i.key=n(e,o[1]).substr(2),i}}}();He.getKey=function(e,t,r){var n,i=(v=de).getChildIdx,o=(v.getV,v.getVbyList),a=fe.crypto,s=a.ECDSA,u=a.DSA,c=ae,l=Re,f=He;if(void 0!==c&&e instanceof c)return e;if(void 0!==s&&e instanceof s)return e;if(void 0!==u&&e instanceof u)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new s({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new s({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(F=new c).setPublic(e.n,e.e),F;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(F=new c).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),F;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(F=new c).setPrivate(e.n,e.e,e.d),F;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(F=new u).setPublic(e.p,e.q,e.g,e.y),F;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(F=new u).setPrivate(e.p,e.q,e.g,e.y,e.x),F;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(F=new c).setPublic(we(e.n),we(e.e)),F;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(F=new c).setPrivateEx(we(e.n),we(e.e),we(e.d),we(e.p),we(e.q),we(e.dp),we(e.dq),we(e.qi)),F;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(F=new c).setPrivate(we(e.n),we(e.e),we(e.d)),F;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var h=(P=new s({curve:e.crv})).ecparams.keylen/4,p="04"+("0000000000"+we(e.x)).slice(-h)+("0000000000"+we(e.y)).slice(-h);return P.setPublicKeyHex(p),P}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){h=(P=new s({curve:e.crv})).ecparams.keylen/4,p="04"+("0000000000"+we(e.x)).slice(-h)+("0000000000"+we(e.y)).slice(-h);var d=("0000000000"+we(e.d)).slice(-h);return P.setPublicKeyHex(p),P.setPrivateKeyHex(d),P}if("pkcs5prv"===r){var g,y=e,v=de;if(9===(g=i(y,0)).length)(F=new c).readPKCS5PrvKeyHex(y);else if(6===g.length)(F=new u).readPKCS5PrvKeyHex(y);else{if(!(g.length>2&&"04"===y.substr(g[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(F=new s).readPKCS5PrvKeyHex(y)}return F}if("pkcs8prv"===r)return f.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===r)return f._getKeyFromPublicPKCS8Hex(e);if("x509pub"===r)return We.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return We.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var m=Re(e,"PUBLIC KEY");return f._getKeyFromPublicPKCS8Hex(m)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=l(e,"RSA PRIVATE KEY");return f.getKey(b,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var E=o(n=l(e,"DSA PRIVATE KEY"),0,[1],"02"),S=o(n,0,[2],"02"),w=o(n,0,[3],"02"),_=o(n,0,[4],"02"),C=o(n,0,[5],"02");return(F=new u).setPrivate(new I(E,16),new I(S,16),new I(w,16),new I(_,16),new I(C,16)),F}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED"))return b=l(e,"EC PRIVATE KEY"),f.getKey(b,null,"pkcs5prv");if(-1!=e.indexOf("-END PRIVATE KEY-"))return f.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var A=f.getDecryptedKeyHex(e,t),T=new ae;return T.readPKCS5PrvKeyHex(A),T}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var P,F=o(n=f.getDecryptedKeyHex(e,t),0,[1],"04"),k=o(n,0,[2,0],"06"),R=o(n,0,[3,0],"03").substr(2);if(void 0===fe.crypto.OID.oidhex2name[k])throw"undefined OID(hex) in KJUR.crypto.OID: "+k;return(P=new s({curve:fe.crypto.OID.oidhex2name[k]})).setPublicKeyHex(R),P.setPrivateKeyHex(F),P.isPublic=!1,P}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED"))return E=o(n=f.getDecryptedKeyHex(e,t),0,[1],"02"),S=o(n,0,[2],"02"),w=o(n,0,[3],"02"),_=o(n,0,[4],"02"),C=o(n,0,[5],"02"),(F=new u).setPrivate(new I(E,16),new I(S,16),new I(w,16),new I(_,16),new I(C,16)),F;if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return f.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},He.generateKeypair=function(e,t){if("RSA"==e){var r=t;(a=new ae).generate(r,"10001"),a.isPrivate=!0,a.isPublic=!0;var n=new ae,i=a.n.toString(16),o=a.e.toString(16);return n.setPublic(i,o),n.isPrivate=!1,n.isPublic=!0,(s={}).prvKeyObj=a,s.pubKeyObj=n,s}if("EC"==e){var a,s,u=t,c=new fe.crypto.ECDSA({curve:u}).generateKeyPairHex();return(a=new fe.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),a.setPrivateKeyHex(c.ecprvhex),a.isPrivate=!0,a.isPublic=!1,(n=new fe.crypto.ECDSA({curve:u})).setPublicKeyHex(c.ecpubhex),n.isPrivate=!1,n.isPublic=!0,(s={}).prvKeyObj=a,s.pubKeyObj=n,s}throw"unknown algorithm: "+e},He.getPEM=function(e,t,r,n,i,o){var a=fe,s=a.asn1,u=s.DERObjectIdentifier,c=s.DERInteger,l=s.ASN1Util.newObject,f=s.x509.SubjectPublicKeyInfo,h=a.crypto,p=h.DSA,d=h.ECDSA,g=ae;function y(e){return l({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function v(e){return l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function m(e){return l({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==g&&e instanceof g||void 0!==p&&e instanceof p||void 0!==d&&e instanceof d)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return ke(_=new f(e).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===r||null==r)&&1==e.isPrivate)return ke(_=y(e).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==d&&e instanceof d&&(void 0===r||null==r)&&1==e.isPrivate){var b=new u({name:e.curveName}).getEncodedHex(),E=v(e).getEncodedHex(),w="";return(w+=ke(b,"EC PARAMETERS"))+ke(E,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===r||null==r)&&1==e.isPrivate)return ke(_=m(e).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==r&&null!=r&&1==e.isPrivate){var _=y(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",_,r,n,o)}if("PKCS5PRV"==t&&void 0!==d&&e instanceof d&&void 0!==r&&null!=r&&1==e.isPrivate)return _=v(e).getEncodedHex(),void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",_,r,n,o);if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==r&&null!=r&&1==e.isPrivate)return _=m(e).getEncodedHex(),void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",_,r,n,o);var C=function(e,t){var r=A(e,t);return new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},A=function(e,t){var r=S.lib.WordArray.random(8),n=S.lib.WordArray.random(8),i=S.PBKDF2(t,r,{keySize:6,iterations:100}),o=S.enc.Hex.parse(e),a=S.TripleDES.encrypt(o,i,{iv:n})+"",s={};return s.ciphertext=a,s.pbkdf2Salt=S.enc.Hex.stringify(r),s.pbkdf2Iter=100,s.encryptionSchemeAlg="DES-EDE3-CBC",s.encryptionSchemeIV=S.enc.Hex.stringify(n),s};if("PKCS8PRV"==t&&null!=g&&e instanceof g&&1==e.isPrivate){var I=y(e).getEncodedHex();return _=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:I}}]}).getEncodedHex(),void 0===r||null==r?ke(_,"PRIVATE KEY"):ke(E=C(_,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==d&&e instanceof d&&1==e.isPrivate)return I=new l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}).getEncodedHex(),_=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:I}}]}).getEncodedHex(),void 0===r||null==r?ke(_,"PRIVATE KEY"):ke(E=C(_,r),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate)return I=new c({bigint:e.x}).getEncodedHex(),_=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:I}}]}).getEncodedHex(),void 0===r||null==r?ke(_,"PRIVATE KEY"):ke(E=C(_,r),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},He.getKeyFromCSRPEM=function(e){var t=Re(e,"CERTIFICATE REQUEST");return He.getKeyFromCSRHex(t)},He.getKeyFromCSRHex=function(e){var t=He.parseCSRHex(e);return He.getKey(t.p8pubkeyhex,null,"pkcs8pub")},He.parseCSRHex=function(e){var t=de,r=t.getChildIdx,n=t.getTLV,i={},o=e;if("30"!=o.substr(0,2))throw"malformed CSR(code:001)";var a=r(o,0);if(a.length<1)throw"malformed CSR(code:002)";if("30"!=o.substr(a[0],2))throw"malformed CSR(code:003)";var s=r(o,a[0]);if(s.length<3)throw"malformed CSR(code:004)";return i.p8pubkeyhex=n(o,s[2]),i},He.getKeyID=function(e){var t=He,r=de;"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&(e=t.getKey(e));var n=Re(t.getPEM(e)),i=r.getIdxbyList(n,0,[1]),o=r.getV(n,i).substring(2);return fe.crypto.Util.hashHex(o,"sha1")},He.getJWKFromKey=function(e){var t={};if(e instanceof ae&&e.isPrivate)return t.kty="RSA",t.n=Se(e.n.toString(16)),t.e=Se(e.e.toString(16)),t.d=Se(e.d.toString(16)),t.p=Se(e.p.toString(16)),t.q=Se(e.q.toString(16)),t.dp=Se(e.dmp1.toString(16)),t.dq=Se(e.dmq1.toString(16)),t.qi=Se(e.coeff.toString(16)),t;if(e instanceof ae&&e.isPublic)return t.kty="RSA",t.n=Se(e.n.toString(16)),t.e=Se(e.e.toString(16)),t;if(e instanceof fe.crypto.ECDSA&&e.isPrivate){if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;var r=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=Se(r.x),t.y=Se(r.y),t.d=Se(e.prvKeyHex),t}if(e instanceof fe.crypto.ECDSA&&e.isPublic){var n;if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;return r=e.getPublicKeyXYHex(),t.kty="EC",t.crv=n,t.x=Se(r.x),t.y=Se(r.y),t}throw"not supported key object"},ae.getPosArrayOfChildrenFromHex=function(e){return de.getChildIdx(e,0)},ae.getHexValueArrayOfChildrenFromHex=function(e){var t,r=de.getV,n=r(e,(t=ae.getPosArrayOfChildrenFromHex(e))[0]),i=r(e,t[1]),o=r(e,t[2]),a=r(e,t[3]),s=r(e,t[4]),u=r(e,t[5]),c=r(e,t[6]),l=r(e,t[7]),f=r(e,t[8]);return(t=new Array).push(n,i,o,a,s,u,c,l,f),t},ae.prototype.readPrivateKeyFromPEMString=function(e){var t=Re(e),r=ae.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},ae.prototype.readPKCS5PrvKeyHex=function(e){var t=ae.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ae.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,o,a,s,u,c=de,l=c.getVbyListEx;if(!1===c.isASN1HEX(e))throw new Error("not ASN.1 hex string");try{t=l(e,0,[2,0,1],"02"),r=l(e,0,[2,0,2],"02"),n=l(e,0,[2,0,3],"02"),i=l(e,0,[2,0,4],"02"),o=l(e,0,[2,0,5],"02"),a=l(e,0,[2,0,6],"02"),s=l(e,0,[2,0,7],"02"),u=l(e,0,[2,0,8],"02")}catch(f){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,i,o,a,s,u)},ae.prototype.readPKCS5PubKeyHex=function(e){var t=de,r=t.getV;if(!1===t.isASN1HEX(e))throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(2!==n.length||"02"!==e.substr(n[0],2)||"02"!==e.substr(n[1],2))throw new Error("wrong hex for PKCS#5 public key");var i=r(e,n[0]),o=r(e,n[1]);this.setPublic(i,o)},ae.prototype.readPKCS8PubKeyHex=function(e){var t=de;if(!1===t.isASN1HEX(e))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==t.getTLVbyListEx(e,0,[0,0]))throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)},ae.prototype.readCertPubKeyHex=function(e,t){var r,n;(r=new We).readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var qe=new RegExp("[^0-9a-f]","gi");function ze(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e}function $e(e,t,r){for(var n="",i=0;n.length<t;)n+=Ae(r(Ie(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return n}function Ge(e){for(var t in fe.crypto.Util.DIGESTINFOHEAD){var r=fe.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r)return[t,e.substring(n)]}return[]}function We(e){var t,r=de,n=r.getChildIdx,i=r.getV,o=r.getTLV,a=r.getVbyList,s=r.getVbyListEx,u=r.getTLVbyList,c=r.getTLVbyListEx,l=r.getIdxbyList,f=r.getIdxbyListEx,h=r.getVidx,p=r.oidname,d=r.hextooidstr,g=We,y=Re;try{t=fe.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(v){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==u(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return s(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var e=c(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(e)},this.getAlgorithmIdentifierName=function(e){for(var r in t)if(e===t[r])return r;return p(s(e,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return u(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return g.hex2dn(this.getIssuerHex())},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return u(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return g.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var e=a(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getNotAfter=function(){var e=a(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getPublicKeyHex=function(){return r.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return l(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return He.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var e=u(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(e)},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),r=this.getSignatureValueHex(),n=u(this.hex,0,[0],"30"),i=new fe.crypto.Signature({alg:t});return i.init(e),i.updateHex(n),i.verify(r)},this.parseExt=function(e){var t,o,s;if(void 0===e){if(s=this.hex,3!==this.version)return-1;t=l(s,0,[0,7,0],"30"),o=n(s,t)}else{s=Re(e);var u=l(s,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=i(s,u))return void(this.aExtInfo=new Array);t=l(s,0,[0,3,0,1,0],"30"),o=n(s,t),this.hex=s}this.aExtInfo=new Array;for(var c=0;c<o.length;c++){var f={critical:!1},p=0;3===n(s,o[c]).length&&(f.critical=!0,p=1),f.oid=r.hextooidstr(a(s,o[c],[0],"06"));var d=l(s,o[c],[1+p]);f.vidx=h(s,d),this.aExtInfo.push(f)}},this.getExtInfo=function(e){var t=this.aExtInfo,r=e;if(e.match(/^[0-9.]+$/)||(r=fe.asn1.x509.OID.name2oid(e)),""!==r)for(var n=0;n<t.length;n++)if(t[n].oid===r)return t[n]},this.getExtBasicConstraints=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("basicConstraints");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"basicConstraints"};if(t&&(n.critical=!0),"3000"===e)return n;if("30030101ff"===e)return n.cA=!0,n;if("30060101ff02"===e.substr(0,12)){var a=i(e,10),s=parseInt(a,16);return n.cA=!0,n.pathLen=s,n}throw new Error("hExtV parse error: "+e)},this.getExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("keyUsage");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"keyUsage"};return t&&(n.critical=!0),n.names=this.getExtKeyUsageString(e).split(","),n},this.getExtKeyUsageBin=function(e){if(void 0===e){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";e=o(this.hex,t.vidx)}if(8!=e.length&&10!=e.length)throw new Error("malformed key usage value: "+e);var r="000000000000000"+parseInt(e.substr(6),16).toString(2);return 8==e.length&&(r=r.slice(-8)),10==e.length&&(r=r.slice(-16)),""==(r=r.replace(/0+$/,""))&&(r="0"),r},this.getExtKeyUsageString=function(e){for(var t=this.getExtKeyUsageBin(e),r=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&r.push(We.KEYUSAGE_NAME[n]);return r.join(",")},this.getExtSubjectKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("subjectKeyIdentifier");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"subjectKeyIdentifier"};t&&(n.critical=!0);var a=i(e,0);return n.kid={hex:a},n},this.getExtAuthorityKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("authorityKeyIdentifier");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var a={extname:"authorityKeyIdentifier"};t&&(a.critical=!0);for(var s=n(e,0),u=0;u<s.length;u++){var c=e.substr(s[u],2);if("80"===c&&(a.kid={hex:i(e,s[u])}),"a1"===c){var l=o(e,s[u]),f=this.getGeneralNames(l);a.issuer=f[0].dn}"82"===c&&(a.sn={hex:i(e,s[u])})}return a},this.getExtExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("extKeyUsage");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var a={extname:"extKeyUsage",array:[]};t&&(a.critical=!0);for(var s=n(e,0),u=0;u<s.length;u++)a.array.push(p(i(e,s[u])));return a},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,r=o(this.hex,e.vidx);if(""===r)return t;for(var a=n(r,0),s=0;s<a.length;s++)t.push(p(i(r,a[s])));return t},this.getExtSubjectAltName=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("subjectAltName");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"subjectAltName",array:[]};return t&&(n.critical=!0),n.array=this.getGeneralNames(e),n},this.getExtIssuerAltName=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("issuerAltName");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"issuerAltName",array:[]};return t&&(n.critical=!0),n.array=this.getGeneralNames(e),n},this.getGeneralNames=function(e){for(var t=n(e,0),r=[],i=0;i<t.length;i++){var a=this.getGeneralName(o(e,t[i]));void 0!==a&&r.push(a)}return r},this.getGeneralName=function(e){var t=e.substr(0,2),r=i(e,0),n=Ae(r);return"81"==t?{rfc822:n}:"82"==t?{dns:n}:"86"==t?{uri:n}:"87"==t?{ip:De(r)}:"a4"==t?{dn:this.getX500Name(r)}:void 0},this.getExtSubjectAltName2=function(){var e,t,r,a=this.getExtInfo("subjectAltName");if(void 0===a)return a;for(var s=new Array,u=o(this.hex,a.vidx),c=n(u,0),l=0;l<c.length;l++)r=u.substr(c[l],2),e=i(u,c[l]),"81"===r&&(t=Ce(e),s.push(["MAIL",t])),"82"===r&&(t=Ce(e),s.push(["DNS",t])),"84"===r&&(t=We.hex2dn(e,0),s.push(["DN",t])),"86"===r&&(t=Ce(e),s.push(["URI",t])),"87"===r&&(t=De(e),s.push(["IP",t]));return s},this.getExtCRLDistributionPoints=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("cRLDistributionPoints");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"cRLDistributionPoints",array:[]};t&&(i.critical=!0);for(var a=n(e,0),s=0;s<a.length;s++){var u=o(e,a[s]);i.array.push(this.getDistributionPoint(u))}return i},this.getDistributionPoint=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var a=e.substr(r[i],2),s=o(e,r[i]);"a0"==a&&(t.dpname=this.getDistributionPointName(s))}return t},this.getDistributionPointName=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var a=e.substr(r[i],2),s=o(e,r[i]);"a0"==a&&(t.full=this.getGeneralNames(s))}return t},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var t=new Array,r=n(this.hex,e.vidx),i=0;i<r.length;i++)try{var o=Ce(a(this.hex,r[i],[0,0,0],"86"));t.push(o)}catch(s){}return t},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},r=n(this.hex,e.vidx),i=0;i<r.length;i++){var o=a(this.hex,r[i],[0],"06"),s=a(this.hex,r[i],[1],"86");"2b06010505073001"===o&&t.ocsp.push(Ce(s)),"2b06010505073002"===o&&t.caissuer.push(Ce(s))}return t},this.getExtAuthorityInfoAccess=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("authorityInfoAccess");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"authorityInfoAccess",array:[]};t&&(i.critical=!0);for(var u=n(e,0),c=0;c<u.length;c++){var l=s(e,u[c],[0],"06"),f=Ce(a(e,u[c],[1],"86"));if("2b06010505073001"==l)i.array.push({ocsp:f});else{if("2b06010505073002"!=l)throw new Error("unknown method: "+l);i.array.push({caissuer:f})}}return i},this.getExtCertificatePolicies=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("certificatePolicies");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"certificatePolicies",array:[]};t&&(i.critical=!0);for(var a=n(e,0),s=0;s<a.length;s++){var u=o(e,a[s]),c=this.getPolicyInformation(u);i.array.push(c)}return i},this.getPolicyInformation=function(e){var t={},r=a(e,0,[0],"06");t.policyoid=p(r);var i=f(e,0,[1],"30");if(-1!=i){t.array=[];for(var s=n(e,i),u=0;u<s.length;u++){var c=o(e,s[u]),l=this.getPolicyQualifierInfo(c);t.array.push(l)}}return t},this.getPolicyQualifierInfo=function(e){var t={},r=a(e,0,[0],"06");if("2b06010505070201"===r){var n=s(e,0,[1],"16");t.cps=Ae(n)}else if("2b06010505070202"===r){var i=u(e,0,[1],"30");t.unotice=this.getUserNotice(i)}return t},this.getUserNotice=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var a=o(e,r[i]);"30"!=a.substr(0,2)&&(t.exptext=this.getDisplayText(a))}return t},this.getDisplayText=function(e){var t={};return t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[e.substr(0,2)],t.str=Ae(i(e,0)),t},this.getExtCRLNumber=function(e,t){var r={extname:"cRLNumber"};if(t&&(r.critical=!0),"02"==e.substr(0,2))return r.num={hex:i(e,0)},r;throw new Error("hExtV parse error: "+e)},this.getExtCRLReason=function(e,t){var r={extname:"cRLReason"};if(t&&(r.critical=!0),"0a"==e.substr(0,2))return r.code=parseInt(i(e,0),16),r;throw new Error("hExtV parse error: "+e)},this.getExtOcspNonce=function(e,t){var r={extname:"ocspNonce"};t&&(r.critical=!0);var n=i(e,0);return r.hex=n,r},this.getExtOcspNoCheck=function(e,t){var r={extname:"ocspNoCheck"};return t&&(r.critical=!0),r},this.getExtAdobeTimeStamp=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("adobeTimeStamp");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"adobeTimeStamp"};t&&(i.critical=!0);var a=n(e,0);if(a.length>1){var s=o(e,a[1]),u=this.getGeneralName(s);null!=u.uri&&(i.uri=u.uri)}if(a.length>2){var c=o(e,a[2]);"0101ff"==c&&(i.reqauth=!0),"010100"==c&&(i.reqauth=!1)}return i},this.getX500NameRule=function(e){for(var t=null,r=[],n=0;n<e.length;n++)for(var i=e[n],o=0;o<i.length;o++)r.push(i[o]);for(n=0;n<r.length;n++){var a=r[n],s=a.ds,u=a.value,c=a.type;if("prn"!=s&&"utf8"!=s&&"ia5"!=s)return"mixed";if("ia5"==s){if("CN"!=c)return"mixed";if(fe.lang.String.isMail(u))continue;return"mixed"}if("C"==c){if("prn"==s)continue;return"mixed"}if(null==t)t=s;else if(t!==s)return"mixed"}return null==t?"prn":t},this.getX500Name=function(e){var t=this.getX500NameArray(e);return{array:t,str:this.dnarraytostr(t)}},this.getX500NameArray=function(e){for(var t=[],r=n(e,0),i=0;i<r.length;i++)t.push(this.getRDN(o(e,r[i])));return t},this.getRDN=function(e){for(var t=[],r=n(e,0),i=0;i<r.length;i++)t.push(this.getAttrTypeAndValue(o(e,r[i])));return t},this.getAttrTypeAndValue=function(e){var t={type:null,value:null,ds:null},r=n(e,0),i=a(e,r[0],[],"06"),o=a(e,r[1],[]),s=fe.asn1.ASN1Util.oidHexToInt(i);return t.type=fe.asn1.x509.OID.oid2atype(s),t.value=Ae(o),t.ds=this.HEX2STAG[e.substr(r[1],2)],t},this.readCertPEM=function(e){this.readCertHex(y(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{l(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getParam=function(){var e={};return e.version=this.getVersion(),e.serial={hex:this.getSerialNumberHex()},e.sigalg=this.getSignatureAlgorithmField(),e.issuer=this.getIssuer(),e.notbefore=this.getNotBefore(),e.notafter=this.getNotAfter(),e.subject=this.getSubject(),e.sbjpubkey=ke(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(e.ext=this.getExtParamArray()),e.sighex=this.getSignatureValueHex(),e},this.getExtParamArray=function(e){null==e&&-1!=f(this.hex,0,[0,"[3]"])&&(e=c(this.hex,0,[0,"[3]",0],"30"));for(var t=[],r=n(e,0),i=0;i<r.length;i++){var a=o(e,r[i]),s=this.getExtParam(a);null!=s&&t.push(s)}return t},this.getExtParam=function(e){var t=n(e,0).length;if(2!=t&&3!=t)throw new Error("wrong number elements in Extension: "+t+" "+e);var r=d(a(e,0,[0],"06")),i=!1;3==t&&"0101ff"==u(e,0,[1])&&(i=!0);var o=u(e,0,[t-1,0]),s=void 0;if("2.5.29.14"==r?s=this.getExtSubjectKeyIdentifier(o,i):"2.5.29.15"==r?s=this.getExtKeyUsage(o,i):"2.5.29.17"==r?s=this.getExtSubjectAltName(o,i):"2.5.29.18"==r?s=this.getExtIssuerAltName(o,i):"2.5.29.19"==r?s=this.getExtBasicConstraints(o,i):"2.5.29.31"==r?s=this.getExtCRLDistributionPoints(o,i):"2.5.29.32"==r?s=this.getExtCertificatePolicies(o,i):"2.5.29.35"==r?s=this.getExtAuthorityKeyIdentifier(o,i):"2.5.29.37"==r?s=this.getExtExtKeyUsage(o,i):"1.3.6.1.5.5.7.1.1"==r?s=this.getExtAuthorityInfoAccess(o,i):"2.5.29.20"==r?s=this.getExtCRLNumber(o,i):"2.5.29.21"==r?s=this.getExtCRLReason(o,i):"1.3.6.1.5.5.7.48.1.2"==r?s=this.getExtOcspNonce(o,i):"1.3.6.1.5.5.7.48.1.5"==r?s=this.getExtOcspNoCheck(o,i):"1.2.840.113583.1.1.9.1"==r&&(s=this.getExtAdobeTimeStamp(o,i)),null!=s)return s;var c={extname:r,extn:o};return i&&(c.critical=!0),c},this.findExt=function(e,t){for(var r=0;r<e.length;r++)if(e[r].extname==t)return e[r];return null},this.updateExtCDPFullURI=function(e,t){var r=this.findExt(e,"cRLDistributionPoints");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)if(null!=n[i].dpname&&null!=n[i].dpname.full)for(var o=n[i].dpname.full,a=0;a<o.length;a++){var s=o[i];null!=s.uri&&(s.uri=t)}},this.updateExtAIAOCSP=function(e,t){var r=this.findExt(e,"authorityInfoAccess");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)null!=n[i].ocsp&&(n[i].ocsp=t)},this.updateExtAIACAIssuer=function(e,t){var r=this.findExt(e,"authorityInfoAccess");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)null!=n[i].caissuer&&(n[i].caissuer=t)},this.dnarraytostr=function(e){return"/"+e.map((function(e){return e.map((function(e){return(t=e).type+"="+t.value;var t})).join("+")})).join("/")},this.getInfo=function(){var e,t,r,n,i=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];if(t+="    policy oid: "+i.policyoid+"\n",void 0!==i.array)for(var o=0;o<i.array.length;o++){var a=i.array[o];void 0!==a.cps&&(t+="    cps: "+a.cps+"\n")}}return t},o=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];try{void 0!==i.dpname.full[0].uri&&(t+="    "+i.dpname.full[0].uri+"\n")}catch(o){}try{void 0!==i.dname.full[0].dn.hex&&(t+="    "+We.hex2dn(i.dpname.full[0].dn.hex)+"\n")}catch(o){}}return t},a=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];void 0!==i.caissuer&&(t+="    caissuer: "+i.caissuer+"\n"),void 0!==i.ocsp&&(t+="    ocsp: "+i.ocsp+"\n")}return t};if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+Ke(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Ke(t.e.toString(16))+"\n"),null!=(r=this.aExtInfo)){e+="X509v3 Extensions:\n";for(var s=0;s<r.length;s++){var u=r[s],c=fe.asn1.x509.OID.oid2name(u.oid);""===c&&(c=u.oid);var l="";if(!0===u.critical&&(l="CRITICAL"),e+="  "+c+" "+l+":\n","basicConstraints"===c){var f=this.getExtBasicConstraints();void 0===f.cA?e+="    {}\n":(e+="    cA=true",void 0!==f.pathLen&&(e+=", pathLen="+f.pathLen),e+="\n")}else if("keyUsage"===c)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===c)e+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===c){var h=this.getExtAuthorityKeyIdentifier();void 0!==h.kid&&(e+="    kid="+h.kid.hex+"\n")}else"extKeyUsage"===c?e+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"===c?e+="    "+(n=this.getExtSubjectAltName(),JSON.stringify(n.array).replace(/[\[\]\{\}\"]/g,"")+"\n"):"cRLDistributionPoints"===c?e+=o(this.getExtCRLDistributionPoints()):"authorityInfoAccess"===c?e+=a(this.getExtAuthorityInfoAccess()):"certificatePolicies"===c&&(e+=i(this.getExtCertificatePolicies()))}}return(e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?this.readCertPEM(e):fe.lang.String.isHex(e)&&this.readCertHex(e))}ae.prototype.sign=function(e,t){var r,n=(r=e,fe.crypto.Util.hashString(r,t));return this.signWithMessageHash(n,t)},ae.prototype.signWithMessageHash=function(e,t){var r=ie(fe.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return ze(this.doPrivate(r).toString(16),this.n.bitLength())},ae.prototype.signPSS=function(e,t,r){var n,i=(n=Ie(e),fe.crypto.Util.hashHex(n,t));return void 0===r&&(r=-1),this.signWithMessageHashPSS(i,t,r)},ae.prototype.signWithMessageHashPSS=function(e,t,r){var n,i=Ae(e),o=i.length,a=this.n.bitLength()-1,s=Math.ceil(a/8),u=function(e){return fe.crypto.Util.hashHex(e,t)};if(-1===r||void 0===r)r=o;else if(-2===r)r=s-o-2;else if(r<-2)throw new Error("invalid salt length");if(s<o+r+2)throw new Error("data too long");var c="";r>0&&(c=new Array(r),(new ne).nextBytes(c),c=String.fromCharCode.apply(String,c));var l=Ae(u(Ie("\0\0\0\0\0\0\0\0"+i+c))),f=[];for(n=0;n<s-r-o-2;n+=1)f[n]=0;var h=String.fromCharCode.apply(String,f)+""+c,p=$e(l,h.length,u),d=[];for(n=0;n<h.length;n+=1)d[n]=h.charCodeAt(n)^p.charCodeAt(n);var g=65280>>8*s-a&255;for(d[0]&=~g,n=0;n<o;n++)d.push(l.charCodeAt(n));return d.push(188),ze(this.doPrivate(new I(d)).toString(16),this.n.bitLength())},ae.prototype.verify=function(e,t){var r=ie(t=(t=t.replace(qe,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var n=Ge(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;var i,o=n[0];return n[1]==(i=e,fe.crypto.Util.hashString(i,o))},ae.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=ie(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=Ge(this.doPublic(r).toString(16).replace(/^1f+00/,""));return 0!=n.length&&(n[0],n[1]==e)},ae.prototype.verifyPSS=function(e,t,r,n){var i,o=(i=Ie(e),fe.crypto.Util.hashHex(i,r));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(o,t,r,n)},ae.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i,o=new I(t,16),a=function(e){return fe.crypto.Util.hashHex(e,r)},s=Ae(e),u=s.length,c=this.n.bitLength()-1,l=Math.ceil(c/8);if(-1===n||void 0===n)n=u;else if(-2===n)n=l-u-2;else if(n<-2)throw new Error("invalid salt length");if(l<u+n+2)throw new Error("data too long");var f=this.doPublic(o).toByteArray();for(i=0;i<f.length;i+=1)f[i]&=255;for(;f.length<l;)f.unshift(0);if(188!==f[l-1])throw new Error("encoded message does not end in 0xbc");var h=(f=String.fromCharCode.apply(String,f)).substr(0,l-u-1),p=f.substr(h.length,u),d=65280>>8*l-c&255;if(0!=(h.charCodeAt(0)&d))throw new Error("bits beyond keysize not zero");var g=$e(p,h.length,a),y=[];for(i=0;i<h.length;i+=1)y[i]=h.charCodeAt(i)^g.charCodeAt(i);y[0]&=~d;var v=l-u-n-2;for(i=0;i<v;i+=1)if(0!==y[i])throw new Error("leftmost octets not zero");if(1!==y[v])throw new Error("0x01 marker not found");return p===Ae(a(Ie("\0\0\0\0\0\0\0\0"+s+String.fromCharCode.apply(String,y.slice(-n)))))},ae.SALT_LEN_HLEN=-1,ae.SALT_LEN_MAX=-2,ae.SALT_LEN_RECOVER=-2,We.hex2dn=function(e,t){if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed DN");for(var r=new Array,n=de.getChildIdx(e,t),i=0;i<n.length;i++)r.push(We.hex2rdn(e,n[i]));return"/"+(r=r.map((function(e){return e.replace("/","\\/")}))).join("/")},We.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw new Error("malformed RDN");for(var r=new Array,n=de.getChildIdx(e,t),i=0;i<n.length;i++)r.push(We.hex2attrTypeValue(e,n[i]));return(r=r.map((function(e){return e.replace("+","\\+")}))).join("+")},We.hex2attrTypeValue=function(e,t){var r=de,n=r.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed attribute type and value");var i=r.getChildIdx(e,t);2!==i.length||e.substr(i[0],2);var o=n(e,i[0]),a=fe.asn1.ASN1Util.oidHexToInt(o);return fe.asn1.x509.OID.oid2atype(a)+"="+Ae(n(e,i[1]))},We.getPublicKeyFromCertHex=function(e){var t=new We;return t.readCertHex(e),t.getPublicKey()},We.getPublicKeyFromCertPEM=function(e){var t=new We;return t.readCertPEM(e),t.getPublicKey()},We.getPublicKeyInfoPropOfCertPEM=function(e){var t,r,n=de.getVbyList,i={algparam:null};return(t=new We).readCertPEM(e),r=t.getPublicKeyHex(),i.keyhex=n(r,0,[1],"03").substr(2),i.algoid=n(r,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=n(r,0,[0,1],"06")),i},We.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==fe&&fe||(t.KJUR=fe={}),void 0!==fe.jws&&fe.jws||(fe.jws={}),fe.jws.JWS=function(){var e=fe.jws.JWS.isSafeJSONString;this.parseJWS=function(t,r){if(void 0===this.parsedJWS||!r&&void 0===this.parsedJWS.sigvalH){var n=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=n[1],o=n[2],a=n[3],s=i+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=a,this.parsedJWS.si=s,!r){var u=we(a),c=ie(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var l=pe(i),f=pe(o);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=f,!e(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},fe.jws.JWS.sign=function(e,t,n,i,o){var a,s,u,c=fe,l=c.jws.JWS,f=l.readSafeJSONString,h=l.isSafeJSONString,p=c.crypto,d=(p.ECDSA,p.Mac),g=p.Signature,y=JSON;if("string"!=typeof t&&"object"!=(void 0===t?"undefined":r(t)))throw"spHeader must be JSON string or object: "+t;if("object"==(void 0===t?"undefined":r(t))&&(s=t,a=y.stringify(s)),"string"==typeof t){if(!h(a=t))throw"JWS Head is not safe JSON string: "+a;s=f(a)}if(u=n,"object"==(void 0===n?"undefined":r(n))&&(u=y.stringify(n)),""!=e&&null!=e||void 0===s.alg||(e=s.alg),""!=e&&null!=e&&void 0===s.alg&&(s.alg=e,a=y.stringify(s)),e!==s.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+s.alg;var v=null;if(void 0===l.jwsalg2sigalg[e])throw"unsupported alg name: "+e;v=l.jwsalg2sigalg[e];var m=he(a)+"."+he(u),b="";if("Hmac"==v.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var E=new d({alg:v,prov:"cryptojs",pass:i});E.updateString(m),b=E.doFinal()}else if(-1!=v.indexOf("withECDSA")){(w=new g({alg:v})).init(i,o),w.updateString(m);var S=w.sign();b=fe.crypto.ECDSA.asn1SigToConcatSig(S)}else{var w;"none"!=v&&((w=new g({alg:v})).init(i,o),w.updateString(m),b=w.sign())}return m+"."+Se(b)},fe.jws.JWS.verify=function(e,t,n){var i,o=fe,a=o.jws.JWS,s=a.readSafeJSONString,u=o.crypto,c=u.ECDSA,l=u.Mac,f=u.Signature;void 0!==r(ae)&&(i=ae);var h=e.split(".");if(3!==h.length)return!1;var p,d=h[0]+"."+h[1],g=we(h[2]),y=s(pe(h[0])),v=null;if(void 0===y.alg)throw"algorithm not specified in header";if(p=(v=y.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0&&-1==(":"+n.join(":")+":").indexOf(":"+v+":"))throw"algorithm '"+v+"' not accepted in the list";if("none"!=v&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=He.getKey(t)),!("RS"!=p&&"PS"!=p||t instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==p&&!(t instanceof c))throw"key shall be a ECDSA obj for ES* algs";var m=null;if(void 0===a.jwsalg2sigalg[y.alg])throw"unsupported alg name: "+v;if("none"==(m=a.jwsalg2sigalg[v]))throw"not supported";if("Hmac"==m.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var b=new l({alg:m,pass:t});return b.updateString(d),g==b.doFinal()}if(-1!=m.indexOf("withECDSA")){var E,S=null;try{S=c.concatSigToASN1Sig(g)}catch(w){return!1}return(E=new f({alg:m})).init(t),E.updateString(d),E.verify(S)}return(E=new f({alg:m})).init(t),E.updateString(d),E.verify(g)},fe.jws.JWS.parse=function(e){var t,r,n,i=e.split("."),o={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=i[0],r=i[1],3==i.length&&(n=i[2]),o.headerObj=fe.jws.JWS.readSafeJSONString(pe(t)),o.payloadObj=fe.jws.JWS.readSafeJSONString(pe(r)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=pe(r):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==n&&(o.sigHex=we(n)),o},fe.jws.JWS.verifyJWT=function(e,t,n){var i=fe.jws,o=i.JWS,a=o.readSafeJSONString,s=o.inArray,u=o.includedArray,c=e.split("."),l=c[0],f=c[1],h=(we(c[2]),a(pe(l))),p=a(pe(f));if(void 0===h.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!s(h.alg,n.alg))return!1;if(void 0!==p.iss&&"object"===r(n.iss)&&!s(p.iss,n.iss))return!1;if(void 0!==p.sub&&"object"===r(n.sub)&&!s(p.sub,n.sub))return!1;if(void 0!==p.aud&&"object"===r(n.aud))if("string"==typeof p.aud){if(!s(p.aud,n.aud))return!1}else if("object"==r(p.aud)&&!u(p.aud,n.aud))return!1;var d=i.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(d=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==p.exp&&"number"==typeof p.exp&&p.exp+n.gracePeriod<d||void 0!==p.nbf&&"number"==typeof p.nbf&&d<p.nbf-n.gracePeriod||void 0!==p.iat&&"number"==typeof p.iat&&d<p.iat-n.gracePeriod||void 0!==p.jti&&void 0!==n.jti&&p.jti!==n.jti||!o.verify(e,t,n.alg))},fe.jws.JWS.includedArray=function(e,t){var n=fe.jws.JWS.inArray;if(null===e)return!1;if("object"!==(void 0===e?"undefined":r(e)))return!1;if("number"!=typeof e.length)return!1;for(var i=0;i<e.length;i++)if(!n(e[i],t))return!1;return!0},fe.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!==(void 0===t?"undefined":r(t)))return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},fe.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},fe.jws.JWS.isSafeJSONString=function(e,t,n){var i=null;try{return"object"!=(void 0===(i=le(e))?"undefined":r(i))||i.constructor===Array?0:(t&&(t[n]=i),1)}catch(o){return 0}},fe.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=(void 0===(t=le(e))?"undefined":r(t))||t.constructor===Array?null:t}catch(n){return null}},fe.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},fe.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=Ie(t);return Se(fe.crypto.Util.hashHex(r,"sha256"))},fe.jws.IntDate={},fe.jws.IntDate.get=function(e){var t=fe.jws.IntDate,r=t.getNow,n=t.getZulu;if("now"==e)return r();if("now + 1hour"==e)return r()+3600;if("now + 1day"==e)return r()+86400;if("now + 1month"==e)return r()+2592e3;if("now + 1year"==e)return r()+31536e3;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},fe.jws.IntDate.getZulu=function(e){return Oe(e)},fe.jws.IntDate.getNow=function(){return~~(new Date/1e3)},fe.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},fe.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},t.SecureRandom=ne,t.rng_seed_time=X,t.BigInteger=I,t.RSAKey=ae;var Je=fe.crypto.EDSA;t.EDSA=Je;var Qe=fe.crypto.DSA;t.DSA=Qe;var Ye=fe.crypto.Signature;t.Signature=Ye;var Xe=fe.crypto.MessageDigest;t.MessageDigest=Xe;var Ze=fe.crypto.Mac;t.Mac=Ze;var et=fe.crypto.Cipher;t.Cipher=et,t.KEYUTIL=He,t.ASN1HEX=de,t.X509=We,t.CryptoJS=S,t.b64tohex=C,t.b64toBA=A,t.stoBA=ge,t.BAtos=ye,t.BAtohex=ve,t.stohex=me,t.stob64=function(e){return _(me(e))},t.stob64u=function(e){return be(_(me(e)))},t.b64utos=function(e){return ye(A(Ee(e)))},t.b64tob64u=be,t.b64utob64=Ee,t.hex2b64=_,t.hextob64u=Se,t.b64utohex=we,t.utf8tob64u=he,t.b64utoutf8=pe,t.utf8tob64=function(e){return _(xe(Le(e)))},t.b64toutf8=function(e){return decodeURIComponent(Ne(C(e)))},t.utf8tohex=_e,t.hextoutf8=Ce,t.hextorstr=Ae,t.rstrtohex=Ie,t.hextob64=Te,t.hextob64nl=Pe,t.b64nltohex=Fe,t.hextopem=ke,t.pemtohex=Re,t.hextoArrayBuffer=function(e){if(e.length%2!=0)throw"input is not even length";if(null==e.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(2*n,2),16));return t},t.ArrayBuffertohex=function(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t},t.zulutomsec=Be,t.zulutosec=Oe,t.zulutodate=function(e){return new Date(Be(e))},t.datetozulu=function(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var o=e.getUTCMilliseconds();0!==o&&(n+="."+(o=(o=("00"+o).slice(-3)).replace(/0+$/g,"")))}return n+"Z"},t.uricmptohex=xe,t.hextouricmp=Ne,t.ipv6tohex=Ue,t.hextoipv6=je,t.hextoip=De,t.iptohex=function(e){var t="malformed IP address";if(!(e=e.toLowerCase(e)).match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return Ue(e);throw t}var r=e.split(".");if(4!==r.length)throw t;var n="";try{for(var i=0;i<4;i++)n+=("0"+parseInt(r[i]).toString(16)).slice(-2);return n}catch(o){throw t}},t.encodeURIComponentAll=Le,t.newline_toUnix=function(e){return e.replace(/\r\n/gm,"\n")},t.newline_toDos=function(e){return(e=e.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},t.hextoposhex=Ke,t.intarystrtohex=function(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map((function(e,t,r){var n=parseInt(e);if(n<0||255<n)throw"integer not in range 0-255";return("00"+n.toString(16)).slice(-2)})).join("")}catch(t){throw"malformed integer array string: "+t}},t.strdiffidx=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1},t.KJUR=fe;var tt=fe.crypto;t.crypto=tt;var rt=fe.asn1;t.asn1=rt;var nt=fe.jws;t.jws=nt;var it=fe.lang;t.lang=it}).call(this,r(28).Buffer)},function(e,t,r){(function(e){
/*!
         * The buffer module from node.js, for the browser.
         *
         * @author   Feross Aboukhadijeh <http://feross.org>
         * @license  MIT
         */
var n=r(30),i=r(31),o=r(32);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,r){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return c(this,e,t,r)}function c(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=h(e,t),e}(e,t,r,n):"string"==typeof t?function(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!u.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|d(t,r),i=(e=s(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}(e,t,r):function(e,t){if(u.isBuffer(t)){var r=0|p(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=s(e,t<0?0:0|p(t)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function d(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(e).length;default:if(n)return K(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return F(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(e,o+h)!==c(t,h)){f=!1;break}if(f)return o}return-1}function b(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function E(e,t,r,n){return H(K(t,e.length-r),e,r,n)}function S(e,t,r,n){return H(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return S(e,t,r,n)}function _(e,t,r,n){return H(V(t),e,r,n)}function C(e,t,r,n){return H(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=T));return r}(n)}t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,r){return c(null,e,t,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,r){return n=null,o=t,a=r,l(i=e),i<=0?s(n,i):void 0!==o?"string"==typeof a?s(n,i).fill(o,a):s(n,i).fill(o):s(n,i);var n,i,o,a},u.allocUnsafe=function(e){return f(null,e)},u.allocUnsafeSlow=function(e){return f(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,r,n,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(n,i),l=e.slice(t,r),f=0;f<s;++f)if(c[f]!==l[f]){o=c[f],a=l[f];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":return S(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function P(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function F(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=M(e[o]);return i}function R(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function B(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function x(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function N(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function U(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,o){return o||U(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,o){return o||U(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;r=new u(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},u.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},u.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},u.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},u.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=u.isBuffer(e)?e:K(new u(e,n).toString()),s=a.length;for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function M(e){return e<16?"0"+e.toString(16):e.toString(16)}function K(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function V(e){return n.toByteArray(function(e){if((e=(t=e,t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(L,"")).length<2)return"";for(var t;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(29))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(n){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){t.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n,a=c(e),s=a[0],u=a[1],l=new o(3*(s+(n=u))/4-n),f=0,h=u>0?s-4:s;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[f++]=t>>16&255,l[f++]=t>>8&255,l[f++]=255&t;return 2===u&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[f++]=255&t),1===u&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[f++]=t>>8&255,l[f++]=255&t),l},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,u=r-i;s<u;s+=a)o.push(l(e,s,s+a>u?u:s+a));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var i,o,a=[],s=t;s<r;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=d,a/=256,c-=8);e[r+p-d]|=128*g}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.jws,r=e.KeyUtil,i=e.X509,o=e.crypto,a=e.hextob64u,s=e.b64tohex,u=e.AllowedSigningAlgs;return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.parseJwt=function(e){n.Log.debug("JoseUtil.parseJwt");try{var r=t.JWS.parse(e);return{header:r.headerObj,payload:r.payloadObj}}catch(i){n.Log.error(i)}},e.validateJwt=function(t,o,a,u,c,l,f){n.Log.debug("JoseUtil.validateJwt");try{if("RSA"===o.kty)if(o.e&&o.n)o=r.getKey(o);else{if(!o.x5c||!o.x5c.length)return n.Log.error("JoseUtil.validateJwt: RSA key missing key material",o),Promise.reject(new Error("RSA key missing key material"));var h=s(o.x5c[0]);o=i.getPublicKeyFromCertHex(h)}else{if("EC"!==o.kty)return n.Log.error("JoseUtil.validateJwt: Unsupported key type",o&&o.kty),Promise.reject(new Error(o.kty));if(!(o.crv&&o.x&&o.y))return n.Log.error("JoseUtil.validateJwt: EC key missing key material",o),Promise.reject(new Error("EC key missing key material"));o=r.getKey(o)}return e._validateJwt(t,o,a,u,c,l,f)}catch(p){return n.Log.error(p&&p.message||p),Promise.reject("JWT validation failed")}},e.validateJwtAttributes=function(t,r,i,o,a,s){o||(o=0),a||(a=parseInt(Date.now()/1e3));var u=e.parseJwt(t).payload;if(!u.iss)return n.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(u.iss!==r)return n.Log.error("JoseUtil._validateJwt: Invalid issuer in token",u.iss),Promise.reject(new Error("Invalid issuer in token: "+u.iss));if(!u.aud)return n.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(u.aud===i||Array.isArray(u.aud)&&u.aud.indexOf(i)>=0))return n.Log.error("JoseUtil._validateJwt: Invalid audience in token",u.aud),Promise.reject(new Error("Invalid audience in token: "+u.aud));if(u.azp&&u.azp!==i)return n.Log.error("JoseUtil._validateJwt: Invalid azp in token",u.azp),Promise.reject(new Error("Invalid azp in token: "+u.azp));if(!s){var c=a+o,l=a-o;if(!u.iat)return n.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(c<u.iat)return n.Log.error("JoseUtil._validateJwt: iat is in the future",u.iat),Promise.reject(new Error("iat is in the future: "+u.iat));if(u.nbf&&c<u.nbf)return n.Log.error("JoseUtil._validateJwt: nbf is in the future",u.nbf),Promise.reject(new Error("nbf is in the future: "+u.nbf));if(!u.exp)return n.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(u.exp<l)return n.Log.error("JoseUtil._validateJwt: exp is in the past",u.exp),Promise.reject(new Error("exp is in the past:"+u.exp))}return Promise.resolve(u)},e._validateJwt=function(r,i,o,a,s,c,l){return e.validateJwtAttributes(r,o,a,s,c,l).then((function(e){try{return t.JWS.verify(r,i,u)?e:(n.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(o){return n.Log.error(o&&o.message||o),Promise.reject(new Error("signature validation failed"))}}))},e.hashString=function(e,t){try{return o.Util.hashString(e,t)}catch(r){n.Log.error(r)}},e.hexToBase64Url=function(e){try{return a(e)}catch(t){n.Log.error(t)}},e}()};var n=r(0);e.exports=t.default},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SigninResponse=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.SigninResponse=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";o(this,e);var n=i.UrlUtility.parseUrlFragment(t,r);this.error=n.error,this.error_description=n.error_description,this.error_uri=n.error_uri,this.code=n.code,this.state=n.state,this.id_token=n.id_token,this.session_state=n.session_state,this.access_token=n.access_token,this.token_type=n.token_type,this.scope=n.scope,this.profile=void 0,this.expires_in=n.expires_in}return n(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var r=parseInt(Date.now()/1e3);this.expires_at=r+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutRequest=void 0;var n=r(0),i=r(3),o=r(9);t.SignoutRequest=function e(t){var r=t.url,a=t.id_token_hint,s=t.post_logout_redirect_uri,u=t.data,c=t.extraQueryParams,l=t.request_type;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw n.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var f in a&&(r=i.UrlUtility.addQueryParam(r,"id_token_hint",a)),s&&(r=i.UrlUtility.addQueryParam(r,"post_logout_redirect_uri",s),u&&(this.state=new o.State({data:u,request_type:l}),r=i.UrlUtility.addQueryParam(r,"state",this.state.id))),c)r=i.UrlUtility.addQueryParam(r,f,c[f]);this.url=r}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutResponse=void 0;var n=r(3);t.SignoutResponse=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.UrlUtility.parseUrlFragment(t,"?");this.error=r.error,this.error_description=r.error_description,this.error_uri=r.error_uri,this.state=r.state}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryWebStorage=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.InMemoryWebStorage=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return e.prototype.getItem=function(e){return i.Log.debug("InMemoryWebStorage.getItem",e),this._data[e]},e.prototype.setItem=function(e,t){i.Log.debug("InMemoryWebStorage.setItem",e),this._data[e]=t},e.prototype.removeItem=function(e){i.Log.debug("InMemoryWebStorage.removeItem",e),delete this._data[e]},e.prototype.key=function(e){return Object.getOwnPropertyNames(this._data)[e]},n(e,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(10),a=r(39),s=r(15),u=r(45),c=r(47),l=r(18),f=r(8),h=r(20),p=r(11),d=r(4);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.UserManager=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.SilentRenewService,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.SessionMonitor,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.TokenRevocationClient,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:p.TokenClient,v=arguments.length>5&&void 0!==arguments[5]?arguments[5]:d.JoseUtil;g(this,t),r instanceof a.UserManagerSettings||(r=new a.UserManagerSettings(r));var m=y(this,e.call(this,r));return m._events=new u.UserManagerEvents(r),m._silentRenewService=new n(m),m.settings.automaticSilentRenew&&(i.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),m.startSilentRenew()),m.settings.monitorSession&&(i.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),m._sessionMonitor=new o(m)),m._tokenRevocationClient=new s(m._settings),m._tokenClient=new f(m._settings),m._joseUtil=v,m}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getUser=function(){var e=this;return this._loadUser().then((function(t){return t?(i.Log.info("UserManager.getUser: user loaded"),e._events.load(t,!1),t):(i.Log.info("UserManager.getUser: user not found in storage"),null)}))},t.prototype.removeUser=function(){var e=this;return this.storeUser(null).then((function(){i.Log.info("UserManager.removeUser: user removed from storage"),e._events.unload()}))},t.prototype.signinRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:r";var t={useReplaceToNavigate:e.useReplaceToNavigate};return this._signinStart(e,this._redirectNavigator,t).then((function(){i.Log.info("UserManager.signinRedirect: successful")}))},t.prototype.signinRedirectCallback=function(e){return this._signinEnd(e||this._redirectNavigator.url).then((function(e){return e.profile&&e.profile.sub?i.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinRedirectCallback: no sub"),e}))},t.prototype.signinPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:p";var t=e.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.display="popup",this._signin(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinPopup: no sub")),e}))):(i.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},t.prototype.signinPopupCallback=function(e){return this._signinCallback(e,this._popupNavigator).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinPopupCallback: no sub")),e})).catch((function(e){i.Log.error(e.message)}))},t.prototype.signinSilent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=Object.assign({},t),this._loadUser().then((function(r){return r&&r.refresh_token?(t.refresh_token=r.refresh_token,e._useRefreshToken(t)):(t.request_type="si:s",t.id_token_hint=t.id_token_hint||e.settings.includeIdTokenInSilentRenew&&r&&r.id_token,r&&e._settings.validateSubOnSilentRenew&&(i.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",r.profile.sub),t.current_sub=r.profile.sub),e._signinSilentIframe(t))}))},t.prototype._useRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(t).then((function(t){return t?t.access_token?e._loadUser().then((function(r){if(r){var n=Promise.resolve();return t.id_token&&(n=e._validateIdTokenFromTokenRefreshToken(r.profile,t.id_token)),n.then((function(){return i.Log.debug("UserManager._useRefreshToken: refresh token response success"),r.id_token=t.id_token||r.id_token,r.access_token=t.access_token,r.refresh_token=t.refresh_token||r.refresh_token,r.expires_in=t.expires_in,e.storeUser(r).then((function(){return e._events.load(r),r}))}))}return null})):(i.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(i.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))}))},t.prototype._validateIdTokenFromTokenRefreshToken=function(e,t){var r=this;return this._metadataService.getIssuer().then((function(n){return r.settings.getEpochTime().then((function(o){return r._joseUtil.validateJwtAttributes(t,n,r._settings.client_id,r._settings.clockSkew,o).then((function(t){return t?t.sub!==e.sub?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):t.auth_time&&t.auth_time!==e.auth_time?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):t.azp&&t.azp!==e.azp?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!t.azp&&e.azp?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))}))}))}))},t.prototype._signinSilentIframe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.prompt=e.prompt||"none",this._signin(e,this._iframeNavigator,{startUrl:t,silentRequestTimeout:e.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinSilent: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinSilent: no sub")),e}))):(i.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype.signinSilentCallback=function(e){return this._signinCallback(e,this._iframeNavigator).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinSilentCallback: no sub")),e}))},t.prototype.signinCallback=function(e){var t=this;return this.readSigninResponseState(e).then((function(r){var n=r.state;return r.response,"si:r"===n.request_type?t.signinRedirectCallback(e):"si:p"===n.request_type?t.signinPopupCallback(e):"si:s"===n.request_type?t.signinSilentCallback(e):Promise.reject(new Error("invalid response_type in state"))}))},t.prototype.signoutCallback=function(e,t){var r=this;return this.readSignoutResponseState(e).then((function(n){var i=n.state,o=n.response;return i?"so:r"===i.request_type?r.signoutRedirectCallback(e):"so:p"===i.request_type?r.signoutPopupCallback(e,t):Promise.reject(new Error("invalid response_type in state")):o}))},t.prototype.querySessionStatus=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="si:s";var r=t.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return r?(t.redirect_uri=r,t.prompt="none",t.response_type=t.response_type||this.settings.query_status_response_type,t.scope=t.scope||"openid",t.skipUserInfo=!0,this._signinStart(t,this._iframeNavigator,{startUrl:r,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(t){return e.processSigninResponse(t.url).then((function(e){if(i.Log.debug("UserManager.querySessionStatus: got signin response"),e.session_state&&e.profile.sub)return i.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid};i.Log.info("querySessionStatus successful, user not authenticated")})).catch((function(t){if(t.session_state&&e.settings.monitorAnonymousSession&&("login_required"==t.message||"consent_required"==t.message||"interaction_required"==t.message||"account_selection_required"==t.message))return i.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:t.session_state};throw t}))}))):(i.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype._signin=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signinStart(e,t,n).then((function(t){return r._signinEnd(t.url,e)}))},t.prototype._signinStart=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.prepare(n).then((function(t){return i.Log.debug("UserManager._signinStart: got navigator window handle"),r.createSigninRequest(e).then((function(e){return i.Log.debug("UserManager._signinStart: got signin request"),n.url=e.url,n.id=e.state.id,t.navigate(n)})).catch((function(e){throw t.close&&(i.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),t.close()),e}))}))},t.prototype._signinEnd=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(e).then((function(e){i.Log.debug("UserManager._signinEnd: got signin response");var n=new s.User(e);if(r.current_sub){if(r.current_sub!==n.profile.sub)return i.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",n.profile.sub),Promise.reject(new Error("login_required"));i.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return t.storeUser(n).then((function(){return i.Log.debug("UserManager._signinEnd: user stored"),t._events.load(n),n}))}))},t.prototype._signinCallback=function(e,t){i.Log.debug("UserManager._signinCallback");var r="query"===this._settings.response_mode||!this._settings.response_mode&&f.SigninRequest.isCode(this._settings.response_type)?"?":"#";return t.callback(e,void 0,r)},t.prototype.signoutRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:r";var t=e.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;t&&(e.post_logout_redirect_uri=t);var r={useReplaceToNavigate:e.useReplaceToNavigate};return this._signoutStart(e,this._redirectNavigator,r).then((function(){i.Log.info("UserManager.signoutRedirect: successful")}))},t.prototype.signoutRedirectCallback=function(e){return this._signoutEnd(e||this._redirectNavigator.url).then((function(e){return i.Log.info("UserManager.signoutRedirectCallback: successful"),e}))},t.prototype.signoutPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:p";var t=e.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return e.post_logout_redirect_uri=t,e.display="popup",e.post_logout_redirect_uri&&(e.state=e.state||{}),this._signout(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then((function(){i.Log.info("UserManager.signoutPopup: successful")}))},t.prototype.signoutPopupCallback=function(e,t){return void 0===t&&"boolean"==typeof e&&(t=e,e=null),this._popupNavigator.callback(e,t,"?").then((function(){i.Log.info("UserManager.signoutPopupCallback: successful")}))},t.prototype._signout=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signoutStart(e,t,n).then((function(e){return r._signoutEnd(e.url)}))},t.prototype._signoutStart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.prepare(n).then((function(r){return i.Log.debug("UserManager._signoutStart: got navigator window handle"),t._loadUser().then((function(o){return i.Log.debug("UserManager._signoutStart: loaded current user from storage"),(t._settings.revokeAccessTokenOnSignout?t._revokeInternal(o):Promise.resolve()).then((function(){var a=e.id_token_hint||o&&o.id_token;return a&&(i.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),e.id_token_hint=a),t.removeUser().then((function(){return i.Log.debug("UserManager._signoutStart: user removed, creating signout request"),t.createSignoutRequest(e).then((function(e){return i.Log.debug("UserManager._signoutStart: got signout request"),n.url=e.url,e.state&&(n.id=e.state.id),r.navigate(n)}))}))}))})).catch((function(e){throw r.close&&(i.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),r.close()),e}))}))},t.prototype._signoutEnd=function(e){return this.processSignoutResponse(e).then((function(e){return i.Log.debug("UserManager._signoutEnd: got signout response"),e}))},t.prototype.revokeAccessToken=function(){var e=this;return this._loadUser().then((function(t){return e._revokeInternal(t,!0).then((function(r){if(r)return i.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),t.access_token=null,t.refresh_token=null,t.expires_at=null,t.token_type=null,e.storeUser(t).then((function(){i.Log.debug("UserManager.revokeAccessToken: user stored"),e._events.load(t)}))}))})).then((function(){i.Log.info("UserManager.revokeAccessToken: access token revoked successfully")}))},t.prototype._revokeInternal=function(e,t){var r=this;if(e){var n=e.access_token,o=e.refresh_token;return this._revokeAccessTokenInternal(n,t).then((function(e){return r._revokeRefreshTokenInternal(o,t).then((function(t){return e||t||i.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),e||t}))}))}return Promise.resolve(!1)},t.prototype._revokeAccessTokenInternal=function(e,t){return!e||e.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(e,t).then((function(){return!0}))},t.prototype._revokeRefreshTokenInternal=function(e,t){return e?this._tokenRevocationClient.revoke(e,t,"refresh_token").then((function(){return!0})):Promise.resolve(!1)},t.prototype.startSilentRenew=function(){this._silentRenewService.start()},t.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},t.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then((function(e){return e?(i.Log.debug("UserManager._loadUser: user storageString loaded"),s.User.fromStorageString(e)):(i.Log.debug("UserManager._loadUser: no user storageString"),null)}))},t.prototype.storeUser=function(e){if(e){i.Log.debug("UserManager.storeUser: storing user");var t=e.toStorageString();return this._userStore.set(this._userStoreKey,t)}return i.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},n(t,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),t}(o.OidcClient)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerSettings=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(r(0),r(5)),o=r(40),a=r(41),s=r(43),u=r(6),c=r(1),l=r(8);function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.UserManagerSettings=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.popup_redirect_uri,i=r.popup_post_logout_redirect_uri,p=r.popupWindowFeatures,d=r.popupWindowTarget,g=r.silent_redirect_uri,y=r.silentRequestTimeout,v=r.automaticSilentRenew,m=void 0!==v&&v,b=r.validateSubOnSilentRenew,E=void 0!==b&&b,S=r.includeIdTokenInSilentRenew,w=void 0===S||S,_=r.monitorSession,C=void 0===_||_,A=r.monitorAnonymousSession,I=void 0!==A&&A,T=r.checkSessionInterval,P=void 0===T?2e3:T,F=r.stopCheckSessionOnError,k=void 0===F||F,R=r.query_status_response_type,B=r.revokeAccessTokenOnSignout,O=void 0!==B&&B,x=r.accessTokenExpiringNotificationTime,N=void 0===x?60:x,U=r.redirectNavigator,j=void 0===U?new o.RedirectNavigator:U,D=r.popupNavigator,L=void 0===D?new a.PopupNavigator:D,M=r.iframeNavigator,K=void 0===M?new s.IFrameNavigator:M,V=r.userStore,H=void 0===V?new u.WebStorageStateStore({store:c.Global.sessionStorage}):V;f(this,t);var q=h(this,e.call(this,arguments[0]));return q._popup_redirect_uri=n,q._popup_post_logout_redirect_uri=i,q._popupWindowFeatures=p,q._popupWindowTarget=d,q._silent_redirect_uri=g,q._silentRequestTimeout=y,q._automaticSilentRenew=m,q._validateSubOnSilentRenew=E,q._includeIdTokenInSilentRenew=w,q._accessTokenExpiringNotificationTime=N,q._monitorSession=C,q._monitorAnonymousSession=I,q._checkSessionInterval=P,q._stopCheckSessionOnError=k,R?q._query_status_response_type=R:arguments[0]&&arguments[0].response_type?q._query_status_response_type=l.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":q._query_status_response_type="id_token",q._revokeAccessTokenOnSignout=O,q._redirectNavigator=j,q._popupNavigator=L,q._iframeNavigator=K,q._userStore=H,q}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),t}(i.OidcClientSettings)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectNavigator=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.RedirectNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(){return Promise.resolve(this)},e.prototype.navigate=function(e){return e&&e.url?(e.useReplaceToNavigate?window.location.replace(e.url):window.location=e.url,Promise.resolve()):(i.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},n(e,[{key:"url",get:function(){return window.location.href}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PopupNavigator=void 0;var n=r(0),i=r(42);t.PopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new i.PopupWindow(e);return Promise.resolve(t)},e.prototype.callback=function(e,t,r){n.Log.debug("PopupNavigator.callback");try{return i.PopupWindow.notifyOpener(e,t,r),Promise.resolve()}catch(o){return Promise.reject(o)}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PopupWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(3);t.PopupWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t}));var n=t.popupWindowTarget||"_blank",o=t.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",n,o),this._popup&&(i.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return e.prototype.navigate=function(e){return this._popup?e&&e.url?(i.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=e.id,this._id&&(window["popupCallback_"+e.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=e.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},e.prototype._success=function(e){i.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(e)},e.prototype._error=function(e){i.Log.error("PopupWindow.error: ",e),this._cleanup(),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup(!1)},e.prototype._cleanup=function(e){i.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!e&&this._popup.close(),this._popup=null},e.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},e.prototype._callback=function(e,t){this._cleanup(t),e?(i.Log.debug("PopupWindow.callback success"),this._success({url:e})):(i.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},e.notifyOpener=function(e,t,r){if(window.opener){if(e=e||window.location.href){var n=o.UrlUtility.parseUrlFragment(e,r);if(n.state){var a="popupCallback_"+n.state,s=window.opener[a];s?(i.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),s(e,t)):i.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else i.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else i.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},n(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameNavigator=void 0;var n=r(0),i=r(44);t.IFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new i.IFrameWindow(e);return Promise.resolve(t)},e.prototype.callback=function(e){n.Log.debug("IFrameNavigator.callback");try{return i.IFrameWindow.notifyParent(e),Promise.resolve()}catch(t){return Promise.reject(t)}},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.IFrameWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t})),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return e.prototype.navigate=function(e){if(e&&e.url){var t=e.silentRequestTimeout||1e4;i.Log.debug("IFrameWindow.navigate: Using timeout of:",t),this._timer=window.setTimeout(this._timeout.bind(this),t),this._frame.src=e.url}else this._error("No url provided");return this.promise},e.prototype._success=function(e){this._cleanup(),i.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),i.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._frame&&(i.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},e.prototype._timeout=function(){i.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},e.prototype._message=function(e){if(i.Log.debug("IFrameWindow.message"),this._timer&&e.origin===this._origin&&e.source===this._frame.contentWindow&&"string"==typeof e.data&&(e.data.startsWith("http://")||e.data.startsWith("https://"))){var t=e.data;t?this._success({url:t}):this._error("Invalid response from frame")}},e.notifyParent=function(e){i.Log.debug("IFrameWindow.notifyParent"),(e=e||window.location.href)&&(i.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(e,location.protocol+"//"+location.host))},n(e,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerEvents=void 0;var n=r(0),i=r(16),o=r(17);t.UserManagerEvents=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n._userLoaded=new o.Event("User loaded"),n._userUnloaded=new o.Event("User unloaded"),n._silentRenewError=new o.Event("Silent renew error"),n._userSignedIn=new o.Event("User signed in"),n._userSignedOut=new o.Event("User signed out"),n._userSessionChanged=new o.Event("User session changed"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.load=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.Log.debug("UserManagerEvents.load"),e.prototype.load.call(this,t),r&&this._userLoaded.raise(t)},t.prototype.unload=function(){n.Log.debug("UserManagerEvents.unload"),e.prototype.unload.call(this),this._userUnloaded.raise()},t.prototype.addUserLoaded=function(e){this._userLoaded.addHandler(e)},t.prototype.removeUserLoaded=function(e){this._userLoaded.removeHandler(e)},t.prototype.addUserUnloaded=function(e){this._userUnloaded.addHandler(e)},t.prototype.removeUserUnloaded=function(e){this._userUnloaded.removeHandler(e)},t.prototype.addSilentRenewError=function(e){this._silentRenewError.addHandler(e)},t.prototype.removeSilentRenewError=function(e){this._silentRenewError.removeHandler(e)},t.prototype._raiseSilentRenewError=function(e){n.Log.debug("UserManagerEvents._raiseSilentRenewError",e.message),this._silentRenewError.raise(e)},t.prototype.addUserSignedIn=function(e){this._userSignedIn.addHandler(e)},t.prototype.removeUserSignedIn=function(e){this._userSignedIn.removeHandler(e)},t.prototype._raiseUserSignedIn=function(){n.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},t.prototype.addUserSignedOut=function(e){this._userSignedOut.addHandler(e)},t.prototype.removeUserSignedOut=function(e){this._userSignedOut.removeHandler(e)},t.prototype._raiseUserSignedOut=function(){n.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},t.prototype.addUserSessionChanged=function(e){this._userSessionChanged.addHandler(e)},t.prototype.removeUserSessionChanged=function(e){this._userSessionChanged.removeHandler(e)},t.prototype._raiseUserSessionChanged=function(){n.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},t}(i.AccessTokenEvents)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(1),a=r(17);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.Timer=function(e){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.timer,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;s(this,t);var a=u(this,e.call(this,r));return a._timer=n,a._nowFunc=i||function(){return Date.now()/1e3},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.init=function(e){e<=0&&(e=1),e=parseInt(e);var t=this.now+e;if(this.expiration===t&&this._timerHandle)i.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),i.Log.debug("Timer.init timer "+this._name+" for duration:",e),this._expiration=t;var r=5;e<r&&(r=e),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*r)}},t.prototype.cancel=function(){this._timerHandle&&(i.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},t.prototype._callback=function(){var t=this._expiration-this.now;i.Log.debug("Timer.callback; "+this._name+" timer expires in:",t),this._expiration<=this.now&&(this.cancel(),e.prototype.raise.call(this))},n(t,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),t}(a.Event)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SilentRenewService=void 0;var n=r(0);t.SilentRenewService=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userManager=t}return e.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then((function(e){})).catch((function(e){n.Log.error("SilentRenewService.start: Error from getUser:",e.message)})))},e.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},e.prototype._tokenExpiring=function(){var e=this;this._userManager.signinSilent().then((function(e){n.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")}),(function(t){n.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",t.message),e._userManager.events._raiseSilentRenewError(t)}))},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupNavigator=void 0;var n=r(21);t.CordovaPopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new n.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaIFrameNavigator=void 0;var n=r(21);t.CordovaIFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){e.popupWindowFeatures="hidden=yes";var t=new n.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.11.5"}])},e.exports=r()})),Ur=u((function(e,t){e.exports=function(){function e(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function t(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,i=void 0,o=void 0,s=function(e,t){E[n]=e,E[n+1]=t,2===(n+=2)&&(o?o(S):_())};function u(e){o=e}function c(e){s=e}var l="undefined"!=typeof window?window:void 0,f=l||{},h=f.MutationObserver||f.WebKitMutationObserver,p="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function g(){return function(){return process.nextTick(S)}}function y(){return void 0!==i?function(){i(S)}:b()}function v(){var e=0,t=new h(S),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function m(){var e=new MessageChannel;return e.port1.onmessage=S,function(){return e.port2.postMessage(0)}}function b(){var e=setTimeout;return function(){return e(S,1)}}var E=new Array(1e3);function S(){for(var e=0;e<n;e+=2)(0,E[e])(E[e+1]),E[e]=void 0,E[e+1]=void 0;n=0}function w(){try{var e=Function("return this")().require("vertx");return i=e.runOnLoop||e.runOnContext,y()}catch(t){return b()}}var _=void 0;function C(e,t){var r=this,n=new this.constructor(T);void 0===n[I]&&G(n);var i=r._state;if(i){var o=arguments[i-1];s((function(){return H(i,n,o,r._result)}))}else K(r,n,e,t);return n}function A(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(T);return j(r,e),r}_=p?g():h?v():d?m():void 0===l?w():b();var I=Math.random().toString(36).substring(2);function T(){}var P=void 0,F=1,k=2;function R(){return new TypeError("You cannot resolve a promise with itself")}function B(){return new TypeError("A promises callback cannot return that same promise.")}function O(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}function x(e,t,r){s((function(e){var n=!1,i=O(r,t,(function(r){n||(n=!0,t!==r?j(e,r):L(e,r))}),(function(t){n||(n=!0,M(e,t))}),"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,M(e,i))}),e)}function N(e,t){t._state===F?L(e,t._result):t._state===k?M(e,t._result):K(t,void 0,(function(t){return j(e,t)}),(function(t){return M(e,t)}))}function U(e,r,n){r.constructor===e.constructor&&n===C&&r.constructor.resolve===A?N(e,r):void 0===n?L(e,r):t(n)?x(e,r,n):L(e,r)}function j(t,r){if(t===r)M(t,R());else if(e(r)){var n=void 0;try{n=r.then}catch(i){return void M(t,i)}U(t,r,n)}else L(t,r)}function D(e){e._onerror&&e._onerror(e._result),V(e)}function L(e,t){e._state===P&&(e._result=t,e._state=F,0!==e._subscribers.length&&s(V,e))}function M(e,t){e._state===P&&(e._state=k,e._result=t,s(D,e))}function K(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+F]=r,i[o+k]=n,0===o&&e._state&&s(V,e)}function V(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,a=0;a<t.length;a+=3)n=t[a],i=t[a+r],n?H(r,n,i,o):i(o);e._subscribers.length=0}}function H(e,r,n,i){var o=t(n),a=void 0,s=void 0,u=!0;if(o){try{a=n(i)}catch(c){u=!1,s=c}if(r===a)return void M(r,B())}else a=i;r._state!==P||(o&&u?j(r,a):!1===u?M(r,s):e===F?L(r,a):e===k&&M(r,a))}function q(e,t){try{t((function(t){j(e,t)}),(function(t){M(e,t)}))}catch(r){M(e,r)}}var z=0;function $(){return z++}function G(e){e[I]=z++,e._state=void 0,e._result=void 0,e._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var J=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(T),this.promise[I]||G(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?L(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&L(this.promise,this._result))):M(this.promise,W())}return e.prototype._enumerate=function(e){for(var t=0;this._state===P&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===A){var i=void 0,o=void 0,a=!1;try{i=e.then}catch(u){a=!0,o=u}if(i===C&&e._state!==P)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===te){var s=new r(T);a?M(s,o):U(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===P&&(this._remaining--,e===k?M(n,r):this._result[t]=r),0===this._remaining&&L(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;K(e,void 0,(function(e){return r._settledAt(F,t,e)}),(function(e){return r._settledAt(k,t,e)}))},e}();function Q(e){return new J(this,e).promise}function Y(e){var t=this;return r(e)?new t((function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))}function X(e){var t=new this(T);return M(t,e),t}function Z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function e(t){this[I]=$(),this._result=this._state=void 0,this._subscribers=[],T!==t&&("function"!=typeof t&&Z(),this instanceof e?q(this,t):ee())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var r=this,n=r.constructor;return t(e)?r.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):r.then(e,e)},e}();function re(){var e=void 0;if(void 0!==a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(n){}if("[object Promise]"===r&&!t.cast)return}e.Promise=te}return te.prototype.then=C,te.all=Q,te.race=Y,te.resolve=A,te.reject=X,te._setScheduler=u,te._setAsap=c,te._asap=s,te.polyfill=re,te.Promise=te,te}()})),jr=function(e){var t=$r(e),r=t[0],n=t[1];return 3*(r+n)/4-n},Dr=function(e){var t,r,n=$r(e),i=n[0],o=n[1],a=new Vr(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,u=o>0?i-4:i;for(r=0;r<u;r+=4)t=Kr[e.charCodeAt(r)]<<18|Kr[e.charCodeAt(r+1)]<<12|Kr[e.charCodeAt(r+2)]<<6|Kr[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=Kr[e.charCodeAt(r)]<<2|Kr[e.charCodeAt(r+1)]>>4,a[s++]=255&t);1===o&&(t=Kr[e.charCodeAt(r)]<<10|Kr[e.charCodeAt(r+1)]<<4|Kr[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},Lr=function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(Gr(e,a,a+o>s?s:a+o));1===n?(t=e[r-1],i.push(Mr[t>>2]+Mr[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(Mr[t>>10]+Mr[t>>4&63]+Mr[t<<2&63]+"="));return i.join("")},Mr=[],Kr=[],Vr="undefined"!=typeof Uint8Array?Uint8Array:Array,Hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qr=0,zr=Hr.length;qr<zr;++qr)Mr[qr]=Hr[qr],Kr[Hr.charCodeAt(qr)]=qr;function $r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Gr(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(Mr[(i=n)>>18&63]+Mr[i>>12&63]+Mr[i>>6&63]+Mr[63&i]);return o.join("")}Kr["-".charCodeAt(0)]=62,Kr["_".charCodeAt(0)]=63;var Wr={byteLength:jr,toByteArray:Dr,fromByteArray:Lr},Jr=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=c}return(p?-1:1)*a*Math.pow(2,o-n)},Qr=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+p]=255&a,p+=d,a/=256,c-=8);e[r+p-d]|=128*g},Yr=u((function(e,t){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=function(e){+e!=e&&(e=0);return o.alloc(+e)},t.INSPECT_MAX_BYTES=50;var n=2147483647;function i(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|h(e,t),n=i(r),a=n.write(e,t);a!==r&&(n=n.slice(0,a));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(D(e,Uint8Array)){var t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return c(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(D(e,ArrayBuffer)||e&&D(e.buffer,ArrayBuffer))return l(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(D(e,SharedArrayBuffer)||e&&D(e.buffer,SharedArrayBuffer)))return l(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return o.from(n,t,r);var a=function(e){if(o.isBuffer(e)){var t=0|f(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||L(e.length)?i(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return s(e),i(e<0?0:0|f(e))}function c(e){for(var t=e.length<0?0:0|f(e.length),r=i(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function l(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,o.prototype),n}function f(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function h(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||D(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(i)return n?-1:N(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return w(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function d(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),L(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(e,o+h)!==c(t,h)){f=!1;break}if(f)return o}return-1}function v(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(L(s))return a;e[r+a]=s}return a}function m(e,t,r,n){return j(N(t,e.length-r),e,r,n)}function b(e,t,r,n){return j(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return j(U(t),e,r,n)}function S(e,t,r,n){return j(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function w(e,t,r){return 0===t&&r===e.length?Wr.fromByteArray(e):Wr.fromByteArray(e.slice(t,r))}function _(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}t.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return a(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return function(e,t,r){return s(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(D(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),D(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(D(a,Uint8Array))i+a.length>n.length?o.from(a).copy(n,i):Uint8Array.prototype.set.call(n,a,i);else{if(!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i)}i+=a.length}return n},o.byteLength=h,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)d(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)d(this,t,t+3),d(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)d(this,t,t+7),d(this,t+1,t+6),d(this,t+2,t+5),d(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(e,t,r,n,i){if(D(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),u=Math.min(a,s),c=this.slice(n,i),l=e.slice(t,r),f=0;f<u;++f)if(c[f]!==l[f]){a=c[f],s=l[f];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return m(this,e,t,r);case"ascii":case"latin1":case"binary":return b(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function I(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function T(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=M[e[o]];return i}function P(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function F(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,r,n,i,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,i){return t=+t,r>>>=0,i||R(e,0,r,4),Qr(e,t,r,n,23,4),r+4}function O(e,t,r,n,i){return t=+t,r>>>=0,i||R(e,0,r,8),Qr(e,t,r,n,52,8),r+8}o.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),Jr(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),Jr(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),Jr(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),Jr(this,e,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||k(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||k(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);k(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);k(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return O(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return O(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=o.isBuffer(e)?e:o.from(e,n),u=s.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%u]}return this};var x=/[^+/0-9A-Za-z-_]/g;function N(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function U(e){return Wr.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(x,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function D(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function L(e){return e!=e}var M=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()})),Xr=u((function(e){var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],c=!1,l=-1;function f(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&h())}function h(){if(!c){var e=a(f);c=!0;for(var t=u.length;t;){for(s=u,u=[];++l<t;)s&&s[l].run();l=-1,t=u.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function d(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||c||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=d,n.addListener=d,n.once=d,n.off=d,n.removeListener=d,n.removeAllListeners=d,n.emit=d,n.prependListener=d,n.prependOnceListener=d,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}}));
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Zr=function(e){return e};var en=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},tn=Math.max;var rn=function(e,t,r){return t=tn(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=tn(n.length-t,0),a=Array(o);++i<o;)a[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=r(a),en(e,this,s)}};var nn=function(e){return function(){return e}},on="object"==typeof a&&a&&a.Object===Object&&a,an="object"==typeof self&&self&&self.Object===Object&&self,sn=on||an||Function("return this")(),un=sn.Symbol,cn=Object.prototype,ln=cn.hasOwnProperty,fn=cn.toString,hn=un?un.toStringTag:void 0;var pn=function(e){var t=ln.call(e,hn),r=e[hn];try{e[hn]=void 0;var n=!0}catch(o){}var i=fn.call(e);return n&&(t?e[hn]=r:delete e[hn]),i},dn=Object.prototype.toString;var gn=function(e){return dn.call(e)},yn=un?un.toStringTag:void 0;var vn=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":yn&&yn in Object(e)?pn(e):gn(e)};var mn=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var bn,En=function(e){if(!mn(e))return!1;var t=vn(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Sn=sn["__core-js_shared__"],wn=(bn=/[^.]+$/.exec(Sn&&Sn.keys&&Sn.keys.IE_PROTO||""))?"Symbol(src)_1."+bn:"";var _n=function(e){return!!wn&&wn in e},Cn=Function.prototype.toString;var An=function(e){if(null!=e){try{return Cn.call(e)}catch(t){}try{return e+""}catch(t){}}return""},In=/^\[object .+?Constructor\]$/,Tn=Function.prototype,Pn=Object.prototype,Fn=Tn.toString,kn=Pn.hasOwnProperty,Rn=RegExp("^"+Fn.call(kn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Bn=function(e){return!(!mn(e)||_n(e))&&(En(e)?Rn:In).test(An(e))};var On=function(e,t){return null==e?void 0:e[t]};var xn=function(e,t){var r=On(e,t);return Bn(r)?r:void 0},Nn=function(){try{var e=xn(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Un=Nn?function(e,t){return Nn(e,"toString",{configurable:!0,enumerable:!1,value:nn(t),writable:!0})}:Zr,jn=Date.now;var Dn=function(e){var t=0,r=0;return function(){var n=jn(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},Ln=Dn(Un);var Mn=function(e,t){return Ln(rn(e,t,Zr),e+"")},Kn=xn(sn,"WeakMap"),Vn=Kn&&new Kn,Hn=Vn?function(e,t){return Vn.set(e,t),e}:Zr,qn=Object.create,zn=function(){function e(){}return function(t){if(!mn(t))return{};if(qn)return qn(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var $n=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=zn(e.prototype),n=e.apply(r,t);return mn(n)?n:r}};var Gn=function(e,t,r){var n=1&t,i=$n(e);return function t(){var o=this&&this!==sn&&this instanceof t?i:e;return o.apply(n?r:this,arguments)}},Wn=Math.max;var Jn=function(e,t,r,n){for(var i=-1,o=e.length,a=r.length,s=-1,u=t.length,c=Wn(o-a,0),l=Array(u+c),f=!n;++s<u;)l[s]=t[s];for(;++i<a;)(f||i<o)&&(l[r[i]]=e[i]);for(;c--;)l[s++]=e[i++];return l},Qn=Math.max;var Yn=function(e,t,r,n){for(var i=-1,o=e.length,a=-1,s=r.length,u=-1,c=t.length,l=Qn(o-s,0),f=Array(l+c),h=!n;++i<l;)f[i]=e[i];for(var p=i;++u<c;)f[p+u]=t[u];for(;++a<s;)(h||i<o)&&(f[p+r[a]]=e[i++]);return f};var Xn=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n};var Zn=function(){};function ei(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}ei.prototype=zn(Zn.prototype),ei.prototype.constructor=ei;var ti=ei;var ri=function(){},ni=Vn?function(e){return Vn.get(e)}:ri,ii={},oi=Object.prototype.hasOwnProperty;var ai=function(e){for(var t=e.name+"",r=ii[t],n=oi.call(ii,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t};function si(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}si.prototype=zn(Zn.prototype),si.prototype.constructor=si;var ui=si,ci=Array.isArray;var li=function(e){return null!=e&&"object"==typeof e};var fi=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var hi=function(e){if(e instanceof ti)return e.clone();var t=new ui(e.__wrapped__,e.__chain__);return t.__actions__=fi(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},pi=Object.prototype.hasOwnProperty;function di(e){if(li(e)&&!ci(e)&&!(e instanceof ti)){if(e instanceof ui)return e;if(pi.call(e,"__wrapped__"))return hi(e)}return new ui(e)}di.prototype=Zn.prototype,di.prototype.constructor=di;var gi=di;var yi=function(e){var t=ai(e),r=gi[t];if("function"!=typeof r||!(t in ti.prototype))return!1;if(e===r)return!0;var n=ni(r);return!!n&&e===n[0]},vi=Dn(Hn),mi=/\{\n\/\* \[wrapped with (.+)\] \*/,bi=/,? & /;var Ei=function(e){var t=e.match(mi);return t?t[1].split(bi):[]},Si=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var wi=function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(Si,"{\n/* [wrapped with "+t+"] */\n")};var _i=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var Ci=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1};var Ai=function(e){return e!=e};var Ii=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1};var Ti=function(e,t,r){return t==t?Ii(e,t,r):Ci(e,Ai,r)};var Pi=function(e,t){return!!(null==e?0:e.length)&&Ti(e,t,0)>-1},Fi=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var ki=function(e,t){return _i(Fi,(function(r){var n="_."+r[0];t&r[1]&&!Pi(e,n)&&e.push(n)})),e.sort()};var Ri=function(e,t,r){var n=t+"";return Ln(e,wi(n,ki(Ei(n),r)))};var Bi=function(e,t,r,n,i,o,a,s,u,c){var l=8&t;t|=l?32:64,4&(t&=~(l?64:32))||(t&=-4);var f=[e,t,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,s,u,c],h=r.apply(void 0,f);return yi(e)&&vi(h,f),h.placeholder=n,Ri(h,e,t)};var Oi=function(e){return e.placeholder},xi=/^(?:0|[1-9]\d*)$/;var Ni=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&xi.test(e))&&e>-1&&e%1==0&&e<t},Ui=Math.min;var ji=function(e,t){for(var r=e.length,n=Ui(t.length,r),i=fi(e);n--;){var o=t[n];e[n]=Ni(o,r)?i[o]:void 0}return e};var Di=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var a=e[r];a!==t&&"__lodash_placeholder__"!==a||(e[r]="__lodash_placeholder__",o[i++]=r)}return o};var Li=function e(t,r,n,i,o,a,s,u,c,l){var f=128&r,h=1&r,p=2&r,d=24&r,g=512&r,y=p?void 0:$n(t);return function v(){for(var m=arguments.length,b=Array(m),E=m;E--;)b[E]=arguments[E];if(d)var S=Oi(v),w=Xn(b,S);if(i&&(b=Jn(b,i,o,d)),a&&(b=Yn(b,a,s,d)),m-=w,d&&m<l){var _=Di(b,S);return Bi(t,r,e,v.placeholder,n,b,_,u,c,l-m)}var C=h?n:this,A=p?C[t]:t;return m=b.length,u?b=ji(b,u):g&&m>1&&b.reverse(),f&&c<m&&(b.length=c),this&&this!==sn&&this instanceof v&&(A=y||$n(A)),A.apply(C,b)}};var Mi=function(e,t,r){var n=$n(e);return function i(){for(var o=arguments.length,a=Array(o),s=o,u=Oi(i);s--;)a[s]=arguments[s];var c=o<3&&a[0]!==u&&a[o-1]!==u?[]:Di(a,u);if((o-=c.length)<r)return Bi(e,t,Li,i.placeholder,void 0,a,c,void 0,void 0,r-o);var l=this&&this!==sn&&this instanceof i?n:e;return en(l,this,a)}};var Ki=function(e,t,r,n){var i=1&t,o=$n(e);return function t(){for(var a=-1,s=arguments.length,u=-1,c=n.length,l=Array(c+s),f=this&&this!==sn&&this instanceof t?o:e;++u<c;)l[u]=n[u];for(;s--;)l[u++]=arguments[++a];return en(f,i?r:this,l)}},Vi=Math.min;var Hi=function(e,t){var r=e[1],n=t[1],i=r|n,o=i<131,a=128==n&&8==r||128==n&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!o&&!a)return e;1&n&&(e[2]=t[2],i|=1&r?0:4);var s=t[3];if(s){var u=e[3];e[3]=u?Jn(u,s,t[4]):s,e[4]=u?Di(e[3],"__lodash_placeholder__"):t[4]}return(s=t[5])&&(u=e[5],e[5]=u?Yn(u,s,t[6]):s,e[6]=u?Di(e[5],"__lodash_placeholder__"):t[6]),(s=t[7])&&(e[7]=s),128&n&&(e[8]=null==e[8]?t[8]:Vi(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e},qi=/\s/;var zi=function(e){for(var t=e.length;t--&&qi.test(e.charAt(t)););return t},$i=/^\s+/;var Gi=function(e){return e?e.slice(0,zi(e)+1).replace($i,""):e};var Wi=function(e){return"symbol"==typeof e||li(e)&&"[object Symbol]"==vn(e)},Ji=/^[-+]0x[0-9a-f]+$/i,Qi=/^0b[01]+$/i,Yi=/^0o[0-7]+$/i,Xi=parseInt;var Zi=function(e){if("number"==typeof e)return e;if(Wi(e))return NaN;if(mn(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=mn(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Gi(e);var r=Qi.test(e);return r||Yi.test(e)?Xi(e.slice(2),r?2:8):Ji.test(e)?NaN:+e};var eo=function(e){return e?Infinity===(e=Zi(e))||-Infinity===e?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var to=function(e){var t=eo(e),r=t%1;return t==t?r?t-r:t:0},ro=Math.max;var no=function(e,t,r,n,i,o,a,s){var u=2&t;if(!u&&"function"!=typeof e)throw new TypeError("Expected a function");var c=n?n.length:0;if(c||(t&=-97,n=i=void 0),a=void 0===a?a:ro(to(a),0),s=void 0===s?s:to(s),c-=i?i.length:0,64&t){var l=n,f=i;n=i=void 0}var h=u?void 0:ni(e),p=[e,t,r,n,i,l,f,o,a,s];if(h&&Hi(p,h),e=p[0],t=p[1],r=p[2],n=p[3],i=p[4],!(s=p[9]=void 0===p[9]?u?0:e.length:ro(p[9]-c,0))&&24&t&&(t&=-25),t&&1!=t)d=8==t||16==t?Mi(e,t,s):32!=t&&33!=t||i.length?Li.apply(void 0,p):Ki(e,t,r,n);else var d=Gn(e,t,r);return Ri((h?Hn:vi)(d,p),e,t)},io=Mn((function(e,t){var r=Di(t,Oi(io));return no(e,64,void 0,t,r)}));io.placeholder={};var oo=io;var ao=function(){this.__data__=[],this.size=0};var so=function(e,t){return e===t||e!=e&&t!=t};var uo=function(e,t){for(var r=e.length;r--;)if(so(e[r][0],t))return r;return-1},co=Array.prototype.splice;var lo=function(e){var t=this.__data__,r=uo(t,e);return!(r<0)&&(r==t.length-1?t.pop():co.call(t,r,1),--this.size,!0)};var fo=function(e){var t=this.__data__,r=uo(t,e);return r<0?void 0:t[r][1]};var ho=function(e){return uo(this.__data__,e)>-1};var po=function(e,t){var r=this.__data__,n=uo(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function go(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}go.prototype.clear=ao,go.prototype.delete=lo,go.prototype.get=fo,go.prototype.has=ho,go.prototype.set=po;var yo=go;var vo=function(){this.__data__=new yo,this.size=0};var mo=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var bo=function(e){return this.__data__.get(e)};var Eo=function(e){return this.__data__.has(e)},So=xn(sn,"Map"),wo=xn(Object,"create");var _o=function(){this.__data__=wo?wo(null):{},this.size=0};var Co=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ao=Object.prototype.hasOwnProperty;var Io=function(e){var t=this.__data__;if(wo){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Ao.call(t,e)?t[e]:void 0},To=Object.prototype.hasOwnProperty;var Po=function(e){var t=this.__data__;return wo?void 0!==t[e]:To.call(t,e)};var Fo=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=wo&&void 0===t?"__lodash_hash_undefined__":t,this};function ko(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ko.prototype.clear=_o,ko.prototype.delete=Co,ko.prototype.get=Io,ko.prototype.has=Po,ko.prototype.set=Fo;var Ro=ko;var Bo=function(){this.size=0,this.__data__={hash:new Ro,map:new(So||yo),string:new Ro}};var Oo=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var xo=function(e,t){var r=e.__data__;return Oo(t)?r["string"==typeof t?"string":"hash"]:r.map};var No=function(e){var t=xo(this,e).delete(e);return this.size-=t?1:0,t};var Uo=function(e){return xo(this,e).get(e)};var jo=function(e){return xo(this,e).has(e)};var Do=function(e,t){var r=xo(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Lo(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Lo.prototype.clear=Bo,Lo.prototype.delete=No,Lo.prototype.get=Uo,Lo.prototype.has=jo,Lo.prototype.set=Do;var Mo=Lo;var Ko=function(e,t){var r=this.__data__;if(r instanceof yo){var n=r.__data__;if(!So||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Mo(n)}return r.set(e,t),this.size=r.size,this};function Vo(e){var t=this.__data__=new yo(e);this.size=t.size}Vo.prototype.clear=vo,Vo.prototype.delete=mo,Vo.prototype.get=bo,Vo.prototype.has=Eo,Vo.prototype.set=Ko;var Ho=Vo;var qo=function(e,t,r){"__proto__"==t&&Nn?Nn(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var zo=function(e,t,r){(void 0!==r&&!so(e[t],r)||void 0===r&&!(t in e))&&qo(e,t,r)};var $o=function(e){return function(t,r,n){for(var i=-1,o=Object(t),a=n(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===r(o[u],u,o))break}return t}}(),Go=u((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?sn.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=o?o(r):new e.constructor(r);return e.copy(n),n}})),Wo=sn.Uint8Array;var Jo=function(e){var t=new e.constructor(e.byteLength);return new Wo(t).set(new Wo(e)),t};var Qo=function(e,t){var r=t?Jo(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var Yo=function(e,t){return function(r){return e(t(r))}},Xo=Yo(Object.getPrototypeOf,Object),Zo=Object.prototype;var ea=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Zo)};var ta=function(e){return"function"!=typeof e.constructor||ea(e)?{}:zn(Xo(e))};var ra=function(e){return li(e)&&"[object Arguments]"==vn(e)},na=Object.prototype,ia=na.hasOwnProperty,oa=na.propertyIsEnumerable,aa=ra(function(){return arguments}())?ra:function(e){return li(e)&&ia.call(e,"callee")&&!oa.call(e,"callee")};var sa=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var ua=function(e){return null!=e&&sa(e.length)&&!En(e)};var ca=function(e){return li(e)&&ua(e)};var la=function(){return!1},fa=u((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r?sn.Buffer:void 0,o=(i?i.isBuffer:void 0)||la;e.exports=o})),ha=Function.prototype,pa=Object.prototype,da=ha.toString,ga=pa.hasOwnProperty,ya=da.call(Object);var va=function(e){if(!li(e)||"[object Object]"!=vn(e))return!1;var t=Xo(e);if(null===t)return!0;var r=ga.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&da.call(r)==ya},ma={};ma["[object Float32Array]"]=ma["[object Float64Array]"]=ma["[object Int8Array]"]=ma["[object Int16Array]"]=ma["[object Int32Array]"]=ma["[object Uint8Array]"]=ma["[object Uint8ClampedArray]"]=ma["[object Uint16Array]"]=ma["[object Uint32Array]"]=!0,ma["[object Arguments]"]=ma["[object Array]"]=ma["[object ArrayBuffer]"]=ma["[object Boolean]"]=ma["[object DataView]"]=ma["[object Date]"]=ma["[object Error]"]=ma["[object Function]"]=ma["[object Map]"]=ma["[object Number]"]=ma["[object Object]"]=ma["[object RegExp]"]=ma["[object Set]"]=ma["[object String]"]=ma["[object WeakMap]"]=!1;var ba=function(e){return li(e)&&sa(e.length)&&!!ma[vn(e)]};var Ea=function(e){return function(t){return e(t)}},Sa=u((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,i=n&&n.exports===r&&on.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(t){}}();e.exports=o})),wa=Sa&&Sa.isTypedArray,_a=wa?Ea(wa):ba;var Ca=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},Aa=Object.prototype.hasOwnProperty;var Ia=function(e,t,r){var n=e[t];Aa.call(e,t)&&so(n,r)&&(void 0!==r||t in e)||qo(e,t,r)};var Ta=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),i?qo(r,s,u):Ia(r,s,u)}return r};var Pa=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},Fa=Object.prototype.hasOwnProperty;var ka=function(e,t){var r=ci(e),n=!r&&aa(e),i=!r&&!n&&fa(e),o=!r&&!n&&!i&&_a(e),a=r||n||i||o,s=a?Pa(e.length,String):[],u=s.length;for(var c in e)!t&&!Fa.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Ni(c,u))||s.push(c);return s};var Ra=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Ba=Object.prototype.hasOwnProperty;var Oa=function(e){if(!mn(e))return Ra(e);var t=ea(e),r=[];for(var n in e)("constructor"!=n||!t&&Ba.call(e,n))&&r.push(n);return r};var xa=function(e){return ua(e)?ka(e,!0):Oa(e)};var Na=function(e){return Ta(e,xa(e))};var Ua=function(e,t,r,n,i,o,a){var s=Ca(e,r),u=Ca(t,r),c=a.get(u);if(c)zo(e,r,c);else{var l=o?o(s,u,r+"",e,t,a):void 0,f=void 0===l;if(f){var h=ci(u),p=!h&&fa(u),d=!h&&!p&&_a(u);l=u,h||p||d?ci(s)?l=s:ca(s)?l=fi(s):p?(f=!1,l=Go(u,!0)):d?(f=!1,l=Qo(u,!0)):l=[]:va(u)||aa(u)?(l=s,aa(s)?l=Na(s):mn(s)&&!En(s)||(l=ta(u))):f=!1}f&&(a.set(u,l),i(l,u,n,o,a),a.delete(u)),zo(e,r,l)}};var ja=function e(t,r,n,i,o){t!==r&&$o(r,(function(a,s){if(o||(o=new Ho),mn(a))Ua(t,r,s,n,e,i,o);else{var u=i?i(Ca(t,s),a,s+"",t,r,o):void 0;void 0===u&&(u=a),zo(t,s,u)}}),xa)};var Da=function(e,t,r){if(!mn(r))return!1;var n=typeof t;return!!("number"==n?ua(r)&&Ni(t,r.length):"string"==n&&t in r)&&so(r[t],e)};var La,Ma=function(e){return Mn((function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&Da(r[0],r[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=r[n];s&&e(t,s,n,o)}return t}))},Ka=Ma((function(e,t,r){ja(e,t,r)})),Va=(La=[],"undefined"!=typeof Uint8ClampedArray&&La.push(Uint8ClampedArray),"undefined"!=typeof Uint8Array&&La.push(Uint8Array),"undefined"!=typeof Uint16Array&&La.push(Uint16Array),"undefined"!=typeof Uint32Array&&La.push(Uint32Array),"undefined"!=typeof Float32Array&&La.push(Float32Array),"undefined"!=typeof Float64Array&&La.push(Float64Array),La);var Ha=oo(Ka,(function(e,t){if(Buffer.isBuffer(t))t=Buffer.from(t);else{var r=function(e){for(var t,r=0;!t&&Va.length>r;r++)e instanceof Va[r]&&(t=Va[r]);return t}(t);t=r?new r(t,t.byteOffset,t.byteLength):void 0}return t})),qa={options:{usePureJavaScript:!1}},za={},$a=za,Ga={};za.encode=function(e,t,r){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!=typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,o=t.length,a=t.charAt(0),s=[0];for(i=0;i<e.length;++i){for(var u=0,c=e[i];u<s.length;++u)c+=s[u]<<8,s[u]=c%o,c=c/o|0;for(;c>0;)s.push(c%o),c=c/o|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=a;for(i=s.length-1;i>=0;--i)n+=t[s[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),o=[0];for(r=0;r<e.length();++r){for(var a=0,s=e.at(r);a<o.length;++a)s+=o[a]<<8,o[a]=s%n,s=s/n|0;for(;s>0;)o.push(s%n),s=s/n|0}var u="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)u+=i;for(r=o.length-1;r>=0;--r)u+=t[o[r]];return u}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},za.decode=function(e,t){if("string"!=typeof e)throw new TypeError('"input" must be a string.');if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');var r=Ga[t];if(!r){r=Ga[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");var i=t.length,o=t.charAt(0),a=[0];for(n=0;n<e.length;n++){var s=r[e.charCodeAt(n)];if(void 0===s)return;for(var u=0,c=s;u<a.length;++u)c+=a[u]*i,a[u]=255&c,c>>=8;for(;c>0;)a.push(255&c),c>>=8}for(var l=0;e[l]===o&&l<e.length-1;++l)a.push(0);return"undefined"!=typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())},u((function(e){var t=e.exports=qa.util=qa.util||{};function r(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function n(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(t.isArrayBuffer(e)||t.isArrayBufferView(e))if("undefined"!=typeof Buffer&&e instanceof Buffer)this.data=e.toString("binary");else{var r=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,r)}catch(o){for(var i=0;i<r.length;++i)this.putByte(r[i])}}else(e instanceof n||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!=typeof process&&process.nextTick&&!process.browser)return t.nextTick=process.nextTick,void("function"==typeof setImmediate?t.setImmediate=setImmediate:t.setImmediate=t.nextTick);if("function"==typeof setImmediate)return t.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(t.nextTick=function(e){return setImmediate(e)});if(t.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){let n=function(t){if(t.source===window&&t.data===e){t.stopPropagation();var n=r.slice();r.length=0,n.forEach((function(e){e()}))}};var e="forge.setImmediate",r=[];t.setImmediate=function(t){r.push(t),1===r.length&&window.postMessage(e,"*")},window.addEventListener("message",n,!0)}if("undefined"!=typeof MutationObserver){var n=Date.now(),i=!0,o=document.createElement("div");r=[];new MutationObserver((function(){var e=r.slice();r.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var a=t.setImmediate;t.setImmediate=function(e){Date.now()-n>15?(n=Date.now(),a(e)):(r.push(e),1===r.length&&o.setAttribute("a",i=!i))}}t.nextTick=t.setImmediate}(),t.isNodejs="undefined"!=typeof process&&process.versions&&process.versions.node,t.globalScope=t.isNodejs?a:"undefined"==typeof self?window:self,t.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},t.isArrayBufferView=function(e){return e&&t.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},t.ByteBuffer=n,t.ByteStringBuffer=n;t.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},t.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},t.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},t.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},t.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},t.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},t.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(t.encodeUtf8(e))},t.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},t.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},t.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},t.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},t.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},t.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},t.ByteStringBuffer.prototype.putInt=function(e,t){r(t);var n="";do{t-=8,n+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(n)},t.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},t.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},t.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},t.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},t.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},t.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},t.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},t.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},t.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},t.ByteStringBuffer.prototype.getInt=function(e){r(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},t.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},t.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},t.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},t.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},t.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},t.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},t.ByteStringBuffer.prototype.copy=function(){var e=t.createBuffer(this.data);return e.read=this.read,e},t.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},t.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},t.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},t.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},t.ByteStringBuffer.prototype.toString=function(){return t.decodeUtf8(this.bytes())},t.DataBuffer=function(e,r){r=r||{},this.read=r.readOffset||0,this.growSize=r.growSize||1024;var n=t.isArrayBuffer(e),i=t.isArrayBufferView(e);if(n||i)return this.data=n?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in r?r.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in r&&(this.write=r.writeOffset)},t.DataBuffer.prototype.length=function(){return this.write-this.read},t.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},t.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},t.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},t.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},t.DataBuffer.prototype.putBytes=function(e,r){if(t.isArrayBufferView(e)){var n=(i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-i.byteOffset;return this.accommodate(n),new Uint8Array(this.data.buffer,this.write).set(i),this.write+=n,this}if(t.isArrayBuffer(e)){var i=new Uint8Array(e);return this.accommodate(i.byteLength),new Uint8Array(this.data.buffer).set(i,this.write),this.write+=i.byteLength,this}if(e instanceof t.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&t.isArrayBufferView(e.data)){i=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(i.byteLength),new Uint8Array(e.data.byteLength,this.write).set(i),this.write+=i.byteLength,this}if(e instanceof t.ByteStringBuffer&&(e=e.data,r="binary"),r=r||"binary","string"==typeof e){var o;if("hex"===r)return this.accommodate(Math.ceil(e.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=t.binary.hex.decode(e,o,this.write),this;if("base64"===r)return this.accommodate(3*Math.ceil(e.length/4)),o=new Uint8Array(this.data.buffer,this.write),this.write+=t.binary.base64.decode(e,o,this.write),this;if("utf8"===r&&(e=t.encodeUtf8(e),r="binary"),"binary"===r||"raw"===r)return this.accommodate(e.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=t.binary.raw.decode(o),this;if("utf16"===r)return this.accommodate(2*e.length),o=new Uint16Array(this.data.buffer,this.write),this.write+=t.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+r)}throw Error("Invalid parameter: "+e)},t.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},t.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},t.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},t.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},t.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},t.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},t.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},t.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},t.DataBuffer.prototype.putInt=function(e,t){r(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},t.DataBuffer.prototype.putSignedInt=function(e,t){return r(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},t.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},t.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},t.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},t.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},t.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},t.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},t.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},t.DataBuffer.prototype.getInt=function(e){r(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},t.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},t.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},t.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},t.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},t.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},t.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},t.DataBuffer.prototype.copy=function(){return new t.DataBuffer(this)},t.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},t.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},t.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},t.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},t.DataBuffer.prototype.toString=function(e){var r=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return t.binary.raw.encode(r);if("hex"===e)return t.binary.hex.encode(r);if("base64"===e)return t.binary.base64.encode(r);if("utf8"===e)return t.text.utf8.decode(r);if("utf16"===e)return t.text.utf16.decode(r);throw new Error("Invalid encoding: "+e)},t.createBuffer=function(e,r){return r=r||"raw",void 0!==e&&"utf8"===r&&(e=t.encodeUtf8(e)),new t.ByteBuffer(e)},t.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},t.xorBytes=function(e,t,r){for(var n="",i="",o="",a=0,s=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),s>=10&&(n+=o,o="",s=0),o+=String.fromCharCode(i),++s;return n+=o},t.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},t.bytesToHex=function(e){return t.createBuffer(e).toHex()},t.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],s="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";t.encode64=function(e,t){for(var r,n,o,a="",s="",u=0;u<e.length;)r=e.charCodeAt(u++),n=e.charCodeAt(u++),o=e.charCodeAt(u++),a+=i.charAt(r>>2),a+=i.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=i.charAt((15&n)<<2|o>>6),a+=isNaN(o)?"=":i.charAt(63&o)),t&&a.length>t&&(s+=a.substr(0,t)+"\r\n",a=a.substr(t));return s+=a},t.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,a="",s=0;s<e.length;)t=o[e.charCodeAt(s++)-43],r=o[e.charCodeAt(s++)-43],n=o[e.charCodeAt(s++)-43],i=o[e.charCodeAt(s++)-43],a+=String.fromCharCode(t<<2|r>>4),64!==n&&(a+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(a+=String.fromCharCode((3&n)<<6|i)));return a},t.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},t.decodeUtf8=function(e){return decodeURIComponent(escape(e))},t.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:$a.encode,decode:$a.decode}},t.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},t.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,o=0;o<e.length;++o)n[i++]=e.charCodeAt(o);return t?i-r:n},t.binary.hex.encode=t.bytesToHex,t.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,o=r=r||0;for(1&e.length&&(i=1,n[o++]=parseInt(e[0],16));i<e.length;i+=2)n[o++]=parseInt(e.substr(i,2),16);return t?o-r:n},t.binary.base64.encode=function(e,t){for(var r,n,o,a="",s="",u=0;u<e.byteLength;)r=e[u++],n=e[u++],o=e[u++],a+=i.charAt(r>>2),a+=i.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=i.charAt((15&n)<<2|o>>6),a+=isNaN(o)?"=":i.charAt(63&o)),t&&a.length>t&&(s+=a.substr(0,t)+"\r\n",a=a.substr(t));return s+=a},t.binary.base64.decode=function(e,t,r){var n,i,a,s,u=t;u||(u=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var c=0,l=r=r||0;c<e.length;)n=o[e.charCodeAt(c++)-43],i=o[e.charCodeAt(c++)-43],a=o[e.charCodeAt(c++)-43],s=o[e.charCodeAt(c++)-43],u[l++]=n<<2|i>>4,64!==a&&(u[l++]=(15&i)<<4|a>>2,64!==s&&(u[l++]=(3&a)<<6|s));return t?l-r:u.subarray(0,l)},t.binary.base58.encode=function(e,r){return t.binary.baseN.encode(e,s,r)},t.binary.base58.decode=function(e,r){return t.binary.baseN.decode(e,s,r)},t.text={utf8:{},utf16:{}},t.text.utf8.encode=function(e,r,n){e=t.encodeUtf8(e);var i=r;i||(i=new Uint8Array(e.length));for(var o=n=n||0,a=0;a<e.length;++a)i[o++]=e.charCodeAt(a);return r?o-n:i},t.text.utf8.decode=function(e){return t.decodeUtf8(String.fromCharCode.apply(null,e))},t.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),o=r=r||0,a=r,s=0;s<e.length;++s)i[a++]=e.charCodeAt(s),o+=2;return t?o-r:n},t.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},t.deflate=function(e,r,n){if(r=t.decode64(e.deflate(t.encode64(r)).rval),n){var i=2;32&r.charCodeAt(1)&&(i=6),r=r.substring(i,r.length-4)}return r},t.inflate=function(e,r,n){var i=e.inflate(t.encode64(r)).rval;return null===i?null:t.decode64(i)};var u=function(e,r,n){if(!e)throw new Error("WebStorage not available.");var i;if(null===n?i=e.removeItem(r):(n=t.encode64(JSON.stringify(n)),i=e.setItem(r,n)),void 0!==i&&!0!==i.rval){var o=new Error(i.error.message);throw o.id=i.error.id,o.name=i.error.name,o}},c=function(e,r){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(r);if(e.init)if(null===n.rval){if(n.error){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}n=null}else n=n.rval;return null!==n&&(n=JSON.parse(t.decode64(n))),n},l=function(e,t,r,n){var i=c(e,t);null===i&&(i={}),i[r]=n,u(e,t,i)},f=function(e,t,r){var n=c(e,t);return null!==n&&(n=r in n?n[r]:null),n},h=function(e,t,r){var n=c(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),u(e,t,n)}},p=function(e,t){u(e,t,null)},d=function(e,t,r){var n,i=null;void 0===r&&(r=["web","flash"]);var o=!1,a=null;for(var s in r){n=r[s];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),o="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),o=!0)}catch(u){a=u}if(o)break}if(!o)throw a;return i};t.setItem=function(e,t,r,n,i){d(l,arguments,i)},t.getItem=function(e,t,r,n){return d(f,arguments,n)},t.removeItem=function(e,t,r,n){d(h,arguments,n)},t.clearItems=function(e,t,r){d(p,arguments,r)},t.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(80!==n.port&&"http"===n.scheme||443!==n.port&&"https"===n.scheme)&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var g=null;t.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var i,o,a=r[n].indexOf("=");a>0?(i=r[n].substring(0,a),o=r[n].substring(a+1)):(i=r[n],o=null),i in t||(t[i]=[]),i in Object.prototype||null===o||t[i].push(unescape(o))}return t};return void 0===e?(null===g&&(g="undefined"!=typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=g):t=r(e),t},t.parseFragment=function(e){var r=e,n="",i=e.indexOf("?");i>0&&(r=e.substring(0,i),n=e.substring(i+1));var o=r.split("/");return o.length>0&&""===o[0]&&o.shift(),{pathString:r,queryString:n,path:o,query:""===n?{}:t.getQueryVariables(n)}},t.makeRequest=function(e){var r=t.parseFragment(e),n={path:r.pathString,query:r.queryString,getPath:function(e){return void 0===e?r.path:r.path[e]},getQuery:function(e,t){var n;return void 0===e?n=r.query:(n=r.query[e])&&void 0!==t&&(n=n[t]),n},getQueryLast:function(e,t){var r=n.getQuery(e);return r?r[r.length-1]:t}};return n},t.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},t.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},t.format=function(e){for(var t,r,n=/%./g,i=0,o=[],a=0;t=n.exec(e);){(r=e.substring(a,n.lastIndex-2)).length>0&&o.push(r),a=n.lastIndex;var s=t[0][1];switch(s){case"s":case"o":i<arguments.length?o.push(arguments[1+i++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+s+"?>")}}return o.push(e.substring(a)),o.join("")},t.formatNumber=function(e,t,r,n){var i=e,o=isNaN(t=Math.abs(t))?2:t,a=void 0===r?",":r,s=void 0===n?".":n,u=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+s:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+s)+(o?a+Math.abs(i-c).toFixed(o).slice(2):"")},t.formatSize=function(e){return e=e>=1073741824?t.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?t.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?t.formatNumber(e/1024,0)+" KiB":t.formatNumber(e,0)+" bytes"},t.bytesFromIP=function(e){return-1!==e.indexOf(".")?t.bytesFromIPv4(e):-1!==e.indexOf(":")?t.bytesFromIPv6(e):null},t.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var r=t.createBuffer(),n=0;n<e.length;++n){var i=parseInt(e[n],10);if(isNaN(i))return null;r.putByte(i)}return r.getBytes()},t.bytesFromIPv6=function(e){for(var r=0,n=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++r,!0}))).length+r),i=t.createBuffer(),o=0;o<8;++o)if(e[o]&&0!==e[o].length){var a=t.hexToBytes(e[o]);a.length<2&&i.putByte(0),i.putBytes(a)}else i.fillWithByte(0,n),n=0;return i.getBytes()},t.bytesToIP=function(e){return 4===e.length?t.bytesToIPv4(e):16===e.length?t.bytesToIPv6(e):null},t.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},t.bytesToIPv6=function(e){if(16!==e.length)return null;for(var r=[],n=[],i=0,o=0;o<e.length;o+=2){for(var a=t.bytesToHex(e[o]+e[o+1]);"0"===a[0]&&"0"!==a;)a=a.substr(1);if("0"===a){var s=n[n.length-1],u=r.length;s&&u===s.end+1?(s.end=u,s.end-s.start>n[i].end-n[i].start&&(i=n.length-1)):n.push({start:u,end:u})}r.push(a)}if(n.length>0){var c=n[i];c.end-c.start>0&&(r.splice(c.start,c.end-c.start+1,""),0===c.start&&r.unshift(""),7===c.end&&r.push(""))}return r.join(":")},t.estimateCores=function(e,r){if("function"==typeof e&&(r=e,e={}),e=e||{},"cores"in t&&!e.update)return r(null,t.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return t.cores=navigator.hardwareConcurrency,r(null,t.cores);if("undefined"==typeof Worker)return t.cores=1,r(null,t.cores);if("undefined"==typeof Blob)return t.cores=2,r(null,t.cores);var n=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){var t=Date.now(),r=t+4;self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(i,o,a){if(0===o){var s=Math.floor(i.reduce((function(e,t){return e+t}),0)/i.length);return t.cores=Math.max(1,s),URL.revokeObjectURL(n),r(null,t.cores)}!function(e,t){for(var r=[],i=[],o=0;o<e;++o){var a=new Worker(n);a.addEventListener("message",(function(n){if(i.push(n.data),i.length===e){for(var o=0;o<e;++o)r[o].terminate();t(null,i)}})),r.push(a)}for(o=0;o<e;++o)r[o].postMessage(o)}(a,(function(t,r){i.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],o=r[n]=[],a=0;a<e;++a)if(n!==a){var s=t[a];(i.st>s.st&&i.st<s.et||s.st>i.st&&s.st<i.et)&&o.push(a)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(a,r)),e(i,o-1,a)}))}([],5,16)}})),qa.cipher=qa.cipher||{},qa.cipher.algorithms=qa.cipher.algorithms||{},qa.cipher.createCipher=function(e,t){var r=e;if("string"==typeof r&&(r=qa.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new qa.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},qa.cipher.createDecipher=function(e,t){var r=e;if("string"==typeof r&&(r=qa.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new qa.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},qa.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),qa.cipher.algorithms[e]=t},qa.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in qa.cipher.algorithms?qa.cipher.algorithms[e]:null};var Wa=qa.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};function Ja(e,t){qa.cipher.registerAlgorithm(e,(function(){return new qa.aes.Algorithm(e,t)}))}Wa.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=qa.util.createBuffer(),this.output=e.output||qa.util.createBuffer(),this.mode.start(t)},Wa.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},Wa.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))},u((function(e){qa.cipher=qa.cipher||{};var t=e.exports=qa.cipher.modes=qa.cipher.modes||{};function r(e,t){if("string"==typeof e&&(e=qa.util.createBuffer(e)),qa.util.isArray(e)&&e.length>4){var r=e;e=qa.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!qa.util.isArray(e)){var i=[],o=t/4;for(n=0;n<o;++n)i.push(e.getInt32());e=i}return e}function n(e){e[e.length-1]=e[e.length-1]+1&4294967295}function i(e){return[e/4294967296|0,4294967295&e]}t.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},t.ecb.prototype.start=function(e){},t.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},t.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},t.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},t.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},t.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},t.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=r(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},t.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},t.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},t.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},t.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},t.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=qa.util.createBuffer(),this._partialBytes=0},t.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=r(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},t.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},t.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=qa.util.createBuffer(),this._partialBytes=0},t.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=r(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(o>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},t.ofb.prototype.decrypt=t.ofb.prototype.encrypt,t.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=qa.util.createBuffer(),this._partialBytes=0},t.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=r(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ctr.prototype.encrypt=function(e,t,r){var i=e.length();if(0===i)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize)for(var o=0;o<this._ints;++o)t.putInt32(e.getInt32()^this._outBlock[o]);else{var a=(this.blockSize-i)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(o=0;o<this._ints;++o)this._partialOutput.putInt32(e.getInt32()^this._outBlock[o]);if(a>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}n(this._inBlock)},t.ctr.prototype.decrypt=t.ctr.prototype.encrypt,t.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=qa.util.createBuffer(),this._partialBytes=0,this._R=3774873600},t.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=qa.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?qa.util.createBuffer(e.additionalData):qa.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=qa.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var o=r.length();if(12===o)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(i(8*o)))}this._inBlock=this._j0.slice(0),n(this._inBlock),this._partialBytes=0,t=qa.util.createBuffer(t),this._aDataLength=i(8*t.length());var a=t.length()%this.blockSize;for(a&&t.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},t.gcm.prototype.encrypt=function(e,t,r){var i=e.length();if(0===i)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&i>=this.blockSize){for(var o=0;o<this._ints;++o)t.putInt32(this._outBlock[o]^=e.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-i)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(o=0;o<this._ints;++o)this._partialOutput.putInt32(e.getInt32()^this._outBlock[o]);if(a<=0||r){if(r){var s=i%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),n(this._inBlock)},t.gcm.prototype.decrypt=function(e,t,r){var i=e.length();if(i<this.blockSize&&!(r&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),n(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)t.putInt32(this._outBlock[o]^this._hashBlock[o]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize},t.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=qa.util.createBuffer();var n=this._aDataLength.concat(i(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,n);var o=[];this.cipher.encrypt(this._j0,o);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^o[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},t.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},t.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},t.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},t.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},t.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,o=new Array(i),a=0;a<i;++a){var s=[0,0,0,0],u=(n-1-a%n)*t;s[a/n|0]=1<<t-1<<u,o[a]=this.generateSubHashTable(this.multiply(s,e),t)}return o},t.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var a=1;a<o;++a){var s=i[o],u=i[a];i[o+a]=[s[0]^u[0],s[1]^u[1],s[2]^u[2],s[3]^u[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var c=i[o^n];i[o]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i}})),qa.aes=qa.aes||{},qa.aes.startEncrypting=function(e,t,r,n){var i=os({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},qa.aes.createEncryptionCipher=function(e,t){return os({key:e,output:null,decrypt:!1,mode:t})},qa.aes.startDecrypting=function(e,t,r,n){var i=os({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},qa.aes.createDecryptionCipher=function(e,t){return os({key:e,output:null,decrypt:!0,mode:t})},qa.aes.Algorithm=function(e,t){ts||rs();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return is(r._w,e,t,!1)},decrypt:function(e,t){return is(r._w,e,t,!0)}}}),r._init=!1},qa.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!=typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(qa.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=qa.util.createBuffer();for(var n=0;n<t.length;++n)r.putByte(t[n])}}else r=qa.util.createBuffer(r);if(!qa.util.isArray(r)){t=r,r=[];var i=t.length();if(16===i||24===i||32===i){i>>>=2;for(n=0;n<i;++n)r.push(t.getInt32())}}if(!qa.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var o=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=ns(r,e.decrypt&&!a),this._init=!0}},qa.aes._expandKey=function(e,t){return ts||rs(),ns(e,t)},qa.aes._updateBlock=is,Ja("AES-ECB",qa.cipher.modes.ecb),Ja("AES-CBC",qa.cipher.modes.cbc),Ja("AES-CFB",qa.cipher.modes.cfb),Ja("AES-OFB",qa.cipher.modes.ofb),Ja("AES-CTR",qa.cipher.modes.ctr),Ja("AES-GCM",qa.cipher.modes.gcm);var Qa,Ya,Xa,Za,es,ts=!1;function rs(){ts=!0,Xa=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Qa=new Array(256),Ya=new Array(256),Za=new Array(4),es=new Array(4);for(t=0;t<4;++t)Za[t]=new Array(256),es[t]=new Array(256);var r,n,i,o,a,s,u,c=0,l=0;for(t=0;t<256;++t){o=(o=l^l<<1^l<<2^l<<3^l<<4)>>8^255&o^99,Qa[c]=o,Ya[o]=c,s=(a=e[o])<<24^o<<16^o<<8^o^a,u=((r=e[c])^(n=e[r])^(i=e[n]))<<24^(c^i)<<16^(c^n^i)<<8^c^r^i;for(var f=0;f<4;++f)Za[f][c]=s,es[f][o]=u,s=s<<24|s>>>8,u=u<<24|u>>>8;0===c?c=l=1:(c=r^e[e[e[r^i]]],l^=e[e[l]])}}function ns(e,t){for(var r,n=e.slice(0),i=1,o=n.length,a=4*(o+6+1),s=o;s<a;++s)r=n[s-1],s%o==0?(r=Qa[r>>>16&255]<<24^Qa[r>>>8&255]<<16^Qa[255&r]<<8^Qa[r>>>24]^Xa[i]<<24,i++):o>6&&s%o==4&&(r=Qa[r>>>24]<<24^Qa[r>>>16&255]<<16^Qa[r>>>8&255]<<8^Qa[255&r]),n[s]=n[s-o]^r;if(t){for(var u,c=es[0],l=es[1],f=es[2],h=es[3],p=n.slice(0),d=(s=0,(a=n.length)-4);s<a;s+=4,d-=4)if(0===s||s===a-4)p[s]=n[d],p[s+1]=n[d+3],p[s+2]=n[d+2],p[s+3]=n[d+1];else for(var g=0;g<4;++g)u=n[d+g],p[s+(3&-g)]=c[Qa[u>>>24]]^l[Qa[u>>>16&255]]^f[Qa[u>>>8&255]]^h[Qa[255&u]];n=p}return n}function is(e,t,r,n){var i,o,a,s,u,c,l,f,h,p,d,g,y=e.length/4-1;n?(i=es[0],o=es[1],a=es[2],s=es[3],u=Ya):(i=Za[0],o=Za[1],a=Za[2],s=Za[3],u=Qa),c=t[0]^e[0],l=t[n?3:1]^e[1],f=t[2]^e[2],h=t[n?1:3]^e[3];for(var v=3,m=1;m<y;++m)p=i[c>>>24]^o[l>>>16&255]^a[f>>>8&255]^s[255&h]^e[++v],d=i[l>>>24]^o[f>>>16&255]^a[h>>>8&255]^s[255&c]^e[++v],g=i[f>>>24]^o[h>>>16&255]^a[c>>>8&255]^s[255&l]^e[++v],h=i[h>>>24]^o[c>>>16&255]^a[l>>>8&255]^s[255&f]^e[++v],c=p,l=d,f=g;r[0]=u[c>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[255&h]^e[++v],r[n?3:1]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[255&c]^e[++v],r[2]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[c>>>8&255]<<8^u[255&l]^e[++v],r[n?1:3]=u[h>>>24]<<24^u[c>>>16&255]<<16^u[l>>>8&255]<<8^u[255&f]^e[++v]}function os(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),n=(t=e.decrypt?qa.cipher.createDecipher(r,e.key):qa.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var i=null;r instanceof qa.util.ByteBuffer&&(i=r,r={}),(r=r||{}).output=i,r.iv=e,n.call(t,r)},t}u((function(e){qa.pki=qa.pki||{};var t=e.exports=qa.pki.oids=qa.oids=qa.oids||{};function r(e,r){t[e]=r,t[r]=e}function n(e,r){t[e]=r}r("1.2.840.113549.1.1.1","rsaEncryption"),r("1.2.840.113549.1.1.4","md5WithRSAEncryption"),r("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),r("1.2.840.113549.1.1.7","RSAES-OAEP"),r("1.2.840.113549.1.1.8","mgf1"),r("1.2.840.113549.1.1.9","pSpecified"),r("1.2.840.113549.1.1.10","RSASSA-PSS"),r("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),r("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),r("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),r("1.3.101.112","EdDSA25519"),r("1.2.840.10040.4.3","dsa-with-sha1"),r("1.3.14.3.2.7","desCBC"),r("1.3.14.3.2.26","sha1"),r("2.16.840.1.101.3.4.2.1","sha256"),r("2.16.840.1.101.3.4.2.2","sha384"),r("2.16.840.1.101.3.4.2.3","sha512"),r("1.2.840.113549.2.5","md5"),r("1.2.840.113549.1.7.1","data"),r("1.2.840.113549.1.7.2","signedData"),r("1.2.840.113549.1.7.3","envelopedData"),r("1.2.840.113549.1.7.4","signedAndEnvelopedData"),r("1.2.840.113549.1.7.5","digestedData"),r("1.2.840.113549.1.7.6","encryptedData"),r("1.2.840.113549.1.9.1","emailAddress"),r("1.2.840.113549.1.9.2","unstructuredName"),r("1.2.840.113549.1.9.3","contentType"),r("1.2.840.113549.1.9.4","messageDigest"),r("1.2.840.113549.1.9.5","signingTime"),r("1.2.840.113549.1.9.6","counterSignature"),r("1.2.840.113549.1.9.7","challengePassword"),r("1.2.840.113549.1.9.8","unstructuredAddress"),r("1.2.840.113549.1.9.14","extensionRequest"),r("1.2.840.113549.1.9.20","friendlyName"),r("1.2.840.113549.1.9.21","localKeyId"),r("1.2.840.113549.1.9.22.1","x509Certificate"),r("1.2.840.113549.1.12.10.1.1","keyBag"),r("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),r("1.2.840.113549.1.12.10.1.3","certBag"),r("1.2.840.113549.1.12.10.1.4","crlBag"),r("1.2.840.113549.1.12.10.1.5","secretBag"),r("1.2.840.113549.1.12.10.1.6","safeContentsBag"),r("1.2.840.113549.1.5.13","pkcs5PBES2"),r("1.2.840.113549.1.5.12","pkcs5PBKDF2"),r("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),r("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),r("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),r("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),r("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),r("1.2.840.113549.2.7","hmacWithSHA1"),r("1.2.840.113549.2.8","hmacWithSHA224"),r("1.2.840.113549.2.9","hmacWithSHA256"),r("1.2.840.113549.2.10","hmacWithSHA384"),r("1.2.840.113549.2.11","hmacWithSHA512"),r("1.2.840.113549.3.7","des-EDE3-CBC"),r("2.16.840.1.101.3.4.1.2","aes128-CBC"),r("2.16.840.1.101.3.4.1.22","aes192-CBC"),r("2.16.840.1.101.3.4.1.42","aes256-CBC"),r("2.5.4.3","commonName"),r("2.5.4.5","serialName"),r("2.5.4.6","countryName"),r("2.5.4.7","localityName"),r("2.5.4.8","stateOrProvinceName"),r("2.5.4.9","streetAddress"),r("2.5.4.10","organizationName"),r("2.5.4.11","organizationalUnitName"),r("2.5.4.13","description"),r("2.5.4.15","businessCategory"),r("2.5.4.17","postalCode"),r("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),r("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),r("2.16.840.1.113730.1.1","nsCertType"),r("2.16.840.1.113730.1.13","nsComment"),n("2.5.29.1","authorityKeyIdentifier"),n("2.5.29.2","keyAttributes"),n("2.5.29.3","certificatePolicies"),n("2.5.29.4","keyUsageRestriction"),n("2.5.29.5","policyMapping"),n("2.5.29.6","subtreesConstraint"),n("2.5.29.7","subjectAltName"),n("2.5.29.8","issuerAltName"),n("2.5.29.9","subjectDirectoryAttributes"),n("2.5.29.10","basicConstraints"),n("2.5.29.11","nameConstraints"),n("2.5.29.12","policyConstraints"),n("2.5.29.13","basicConstraints"),r("2.5.29.14","subjectKeyIdentifier"),r("2.5.29.15","keyUsage"),n("2.5.29.16","privateKeyUsagePeriod"),r("2.5.29.17","subjectAltName"),r("2.5.29.18","issuerAltName"),r("2.5.29.19","basicConstraints"),n("2.5.29.20","cRLNumber"),n("2.5.29.21","cRLReason"),n("2.5.29.22","expirationDate"),n("2.5.29.23","instructionCode"),n("2.5.29.24","invalidityDate"),n("2.5.29.25","cRLDistributionPoints"),n("2.5.29.26","issuingDistributionPoint"),n("2.5.29.27","deltaCRLIndicator"),n("2.5.29.28","issuingDistributionPoint"),n("2.5.29.29","certificateIssuer"),n("2.5.29.30","nameConstraints"),r("2.5.29.31","cRLDistributionPoints"),r("2.5.29.32","certificatePolicies"),n("2.5.29.33","policyMappings"),n("2.5.29.34","policyConstraints"),r("2.5.29.35","authorityKeyIdentifier"),n("2.5.29.36","policyConstraints"),r("2.5.29.37","extKeyUsage"),n("2.5.29.46","freshestCRL"),n("2.5.29.54","inhibitAnyPolicy"),r("1.3.6.1.4.1.11129.2.4.2","timestampList"),r("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),r("1.3.6.1.5.5.7.3.1","serverAuth"),r("1.3.6.1.5.5.7.3.2","clientAuth"),r("1.3.6.1.5.5.7.3.3","codeSigning"),r("1.3.6.1.5.5.7.3.4","emailProtection"),r("1.3.6.1.5.5.7.3.8","timeStamping")})),u((function(e){var t=e.exports=qa.asn1=qa.asn1||{};function r(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}t.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},t.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},t.create=function(e,r,n,i,o){if(qa.util.isArray(i)){for(var a=[],s=0;s<i.length;++s)void 0!==i[s]&&a.push(i[s]);i=a}var u={tagClass:e,type:r,constructed:n,composed:n||qa.util.isArray(i),value:i};return o&&"bitStringContents"in o&&(u.bitStringContents=o.bitStringContents,u.original=t.copy(u)),u},t.copy=function(e,r){var n;if(qa.util.isArray(e)){n=[];for(var i=0;i<e.length;++i)n.push(t.copy(e[i],r));return n}return"string"==typeof e?e:(n={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:t.copy(e.value,r)},r&&!r.excludeBitStringContents&&(n.bitStringContents=e.bitStringContents),n)},t.equals=function(e,r,n){if(qa.util.isArray(e)){if(!qa.util.isArray(r))return!1;if(e.length!==r.length)return!1;for(var i=0;i<e.length;++i)if(!t.equals(e[i],r[i]))return!1;return!0}if(typeof e!=typeof r)return!1;if("string"==typeof e)return e===r;var o=e.tagClass===r.tagClass&&e.type===r.type&&e.constructed===r.constructed&&e.composed===r.composed&&t.equals(e.value,r.value);return n&&n.includeBitStringContents&&(o=o&&e.bitStringContents===r.bitStringContents),o},t.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function n(e,i,o,a){var s;r(e,i,2);var u=e.getByte();i--;var c=192&u,l=31&u;s=e.length();var f,h,p=function(e,t){var n=e.getByte();if(t--,128!==n){var i;if(128&n){var o=127&n;r(e,t,o),i=e.getInt(o<<3)}else i=n;if(i<0)throw new Error("Negative length: "+i);return i}}(e,i);if(i-=s-e.length(),void 0!==p&&p>i){if(a.strict){var d=new Error("Too few bytes to read ASN.1 value.");throw d.available=e.length(),d.remaining=i,d.requested=p,d}p=i}var g=32==(32&u);if(g)if(f=[],void 0===p)for(;;){if(r(e,i,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),i-=2;break}s=e.length(),f.push(n(e,i,o+1,a)),i-=s-e.length()}else for(;p>0;)s=e.length(),f.push(n(e,p,o+1,a)),i-=s-e.length(),p-=s-e.length();if(void 0===f&&c===t.Class.UNIVERSAL&&l===t.Type.BITSTRING&&(h=e.bytes(p)),void 0===f&&a.decodeBitStrings&&c===t.Class.UNIVERSAL&&l===t.Type.BITSTRING&&p>1){var y=e.read,v=i,m=0;if(l===t.Type.BITSTRING&&(r(e,i,1),m=e.getByte(),i--),0===m)try{s=e.length();var b=n(e,i,o+1,{verbose:a.verbose,strict:!0,decodeBitStrings:!0}),E=s-e.length();i-=E,l==t.Type.BITSTRING&&E++;var S=b.tagClass;E!==p||S!==t.Class.UNIVERSAL&&S!==t.Class.CONTEXT_SPECIFIC||(f=[b])}catch(_){}void 0===f&&(e.read=y,i=v)}if(void 0===f){if(void 0===p){if(a.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=i}if(l===t.Type.BMPSTRING)for(f="";p>0;p-=2)r(e,i,2),f+=String.fromCharCode(e.getInt16()),i-=2;else f=e.getBytes(p)}var w=void 0===h?null:{bitStringContents:h};return t.create(c,l,g,f,w)}t.fromDer=function(e,t){return void 0===t&&(t={strict:!0,decodeBitStrings:!0}),"boolean"==typeof t&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"==typeof e&&(e=qa.util.createBuffer(e)),n(e,e.length(),0,t)},t.toDer=function(e){var r=qa.util.createBuffer(),n=e.tagClass|e.type,i=qa.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=t.equals(e,e.original))),o)i.putBytes(e.bitStringContents);else if(e.composed){e.constructed?n|=32:i.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&i.putBuffer(t.toDer(e.value[a]))}else if(e.type===t.Type.BMPSTRING)for(a=0;a<e.value.length;++a)i.putInt16(e.value.charCodeAt(a));else e.type===t.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0==(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128==(128&e.value.charCodeAt(1)))?i.putBytes(e.value.substr(1)):i.putBytes(e.value);if(r.putByte(n),i.length()<=127)r.putByte(127&i.length());else{var s=i.length(),u="";do{u+=String.fromCharCode(255&s),s>>>=8}while(s>0);r.putByte(128|u.length);for(a=u.length-1;a>=0;--a)r.putByte(u.charCodeAt(a))}return r.putBuffer(i),r},t.oidToDer=function(e){var t,r,n,i,o=e.split("."),a=qa.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var s=2;s<o.length;++s){t=!0,r=[],n=parseInt(o[s],10);do{i=127&n,n>>>=7,t||(i|=128),r.push(i),t=!1}while(n>0);for(var u=r.length-1;u>=0;--u)a.putByte(r[u])}return a},t.derToOid=function(e){var t;"string"==typeof e&&(e=qa.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)n<<=7,128&(r=e.getByte())?n+=127&r:(t+="."+(n+r),n=0);return t},t.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),o=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),s=0;if(e.length>11){var u=e.charAt(10),c=10;"+"!==u&&"-"!==u&&(s=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(o,a,s,0),c&&("+"===(u=e.charAt(c))||"-"===u)){var l=60*parseInt(e.substr(c+1,2),10)+parseInt(e.substr(c+4,2),10);l*=6e4,"+"===u?t.setTime(+t-l):t.setTime(+t+l)}return t},t.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),u=0,c=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var f=e.length-5,h=e.charAt(f);"+"!==h&&"-"!==h||(c=60*parseInt(e.substr(f+1,2),10)+parseInt(e.substr(f+4,2),10),c*=6e4,"+"===h&&(c*=-1),l=!0);return"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(o,a,s,u),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(o,a,s,u)),t},t.dateToUtcTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},t.dateToGeneralizedTime=function(e){if("string"==typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},t.integerToDer=function(e){var t=qa.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},t.derToInteger=function(e){"string"==typeof e&&(e=qa.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},t.validate=function(e,r,n,i){var o=!1;if(e.tagClass!==r.tagClass&&void 0!==r.tagClass||e.type!==r.type&&void 0!==r.type)i&&(e.tagClass!==r.tagClass&&i.push("["+r.name+'] Expected tag class "'+r.tagClass+'", got "'+e.tagClass+'"'),e.type!==r.type&&i.push("["+r.name+'] Expected type "'+r.type+'", got "'+e.type+'"'));else if(e.constructed===r.constructed||void 0===r.constructed){if(o=!0,r.value&&qa.util.isArray(r.value))for(var a=0,s=0;o&&s<r.value.length;++s)o=r.value[s].optional||!1,e.value[a]&&((o=t.validate(e.value[a],r.value[s],n,i))?++a:r.value[s].optional&&(o=!0)),!o&&i&&i.push("["+r.name+'] Tag class "'+r.tagClass+'", type "'+r.type+'" expected value length "'+r.value.length+'", got "'+e.value.length+'"');if(o&&n&&(r.capture&&(n[r.capture]=e.value),r.captureAsn1&&(n[r.captureAsn1]=e),r.captureBitStringContents&&"bitStringContents"in e&&(n[r.captureBitStringContents]=e.bitStringContents),r.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)n[r.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");n[r.captureBitStringValue]=e.bitStringContents.slice(1)}}else i&&i.push("["+r.name+'] Expected constructed "'+r.constructed+'", got "'+e.constructed+'"');return o};var i=/[^\\u0000-\\u00ff]/;t.prettyPrint=function(e,r,n){var o="";n=n||2,(r=r||0)>0&&(o+="\n");for(var a="",s=0;s<r*n;++s)a+=" ";switch(o+=a+"Tag: ",e.tagClass){case t.Class.UNIVERSAL:o+="Universal:";break;case t.Class.APPLICATION:o+="Application:";break;case t.Class.CONTEXT_SPECIFIC:o+="Context-Specific:";break;case t.Class.PRIVATE:o+="Private:"}if(e.tagClass===t.Class.UNIVERSAL)switch(o+=e.type,e.type){case t.Type.NONE:o+=" (None)";break;case t.Type.BOOLEAN:o+=" (Boolean)";break;case t.Type.INTEGER:o+=" (Integer)";break;case t.Type.BITSTRING:o+=" (Bit string)";break;case t.Type.OCTETSTRING:o+=" (Octet string)";break;case t.Type.NULL:o+=" (Null)";break;case t.Type.OID:o+=" (Object Identifier)";break;case t.Type.ODESC:o+=" (Object Descriptor)";break;case t.Type.EXTERNAL:o+=" (External or Instance of)";break;case t.Type.REAL:o+=" (Real)";break;case t.Type.ENUMERATED:o+=" (Enumerated)";break;case t.Type.EMBEDDED:o+=" (Embedded PDV)";break;case t.Type.UTF8:o+=" (UTF8)";break;case t.Type.ROID:o+=" (Relative Object Identifier)";break;case t.Type.SEQUENCE:o+=" (Sequence)";break;case t.Type.SET:o+=" (Set)";break;case t.Type.PRINTABLESTRING:o+=" (Printable String)";break;case t.Type.IA5String:o+=" (IA5String (ASCII))";break;case t.Type.UTCTIME:o+=" (UTC time)";break;case t.Type.GENERALIZEDTIME:o+=" (Generalized time)";break;case t.Type.BMPSTRING:o+=" (BMP String)"}else o+=e.type;if(o+="\n",o+=a+"Constructed: "+e.constructed+"\n",e.composed){var u=0,c="";for(s=0;s<e.value.length;++s)void 0!==e.value[s]&&(u+=1,c+=t.prettyPrint(e.value[s],r+1,n),s+1<e.value.length&&(c+=","));o+=a+"Sub values: "+u+c}else{if(o+=a+"Value: ",e.type===t.Type.OID){var l=t.derToOid(e.value);o+=l,qa.pki&&qa.pki.oids&&l in qa.pki.oids&&(o+=" ("+qa.pki.oids[l]+") ")}if(e.type===t.Type.INTEGER)try{o+=t.derToInteger(e.value)}catch(h){o+="0x"+qa.util.bytesToHex(e.value)}else if(e.type===t.Type.BITSTRING){if(e.value.length>1?o+="0x"+qa.util.bytesToHex(e.value.slice(1)):o+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);1==f?o+=" (1 unused bit shown)":f>1&&(o+=" ("+f+" unused bits shown)")}}else e.type===t.Type.OCTETSTRING?(i.test(e.value)||(o+="("+e.value+") "),o+="0x"+qa.util.bytesToHex(e.value)):e.type===t.Type.UTF8?o+=qa.util.decodeUtf8(e.value):e.type===t.Type.PRINTABLESTRING||e.type===t.Type.IA5String?o+=e.value:i.test(e.value)?o+="0x"+qa.util.bytesToHex(e.value):0===e.value.length?o+="[null]":o+=e.value}return o}})),qa.md=qa.md||{},qa.md.algorithms=qa.md.algorithms||{},u((function(e){(e.exports=qa.hmac=qa.hmac||{}).create=function(){var e=null,t=null,r=null,n=null,i={start:function(i,o){if(null!==i)if("string"==typeof i){if(!((i=i.toLowerCase())in qa.md.algorithms))throw new Error('Unknown hash algorithm "'+i+'"');t=qa.md.algorithms[i].create()}else t=i;if(null===o)o=e;else{if("string"==typeof o)o=qa.util.createBuffer(o);else if(qa.util.isArray(o)){var a=o;o=qa.util.createBuffer();for(var s=0;s<a.length;++s)o.putByte(a[s])}var u=o.length();u>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=qa.util.createBuffer(),n=qa.util.createBuffer(),u=o.length();for(s=0;s<u;++s){a=o.at(s);r.putByte(54^a),n.putByte(92^a)}if(u<t.blockLength)for(a=t.blockLength-u,s=0;s<a;++s)r.putByte(54),n.putByte(92);e=o,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(n),t.update(e),t.digest()}};return i.digest=i.getMac,i}})),u((function(e){qa.mgf=qa.mgf||{},(e.exports=qa.mgf.mgf1=qa.mgf1=qa.mgf1||{}).create=function(e){return{generate:function(t,r){for(var n=new qa.util.ByteBuffer,i=Math.ceil(r/e.digestLength),o=0;o<i;o++){var a=new qa.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),n.putBuffer(e.digest())}return n.truncate(n.length()-r),n.getBytes()}}}}));var as,ss=s(l),us=qa.pkcs5=qa.pkcs5||{};function cs(e,t){qa.cipher.registerAlgorithm(e,(function(){return new qa.des.Algorithm(e,t)}))}qa.util.isNodejs&&!qa.options.usePureJavaScript&&(as=ss),qa.pbkdf2=us.pbkdf2=function(e,t,r,n,i,o){if("function"==typeof i&&(o=i,i=null),qa.util.isNodejs&&!qa.options.usePureJavaScript&&as.pbkdf2&&(null===i||"object"!=typeof i)&&(as.pbkdf2Sync.length>4||!i||"sha1"===i))return"string"!=typeof i&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),o?4===as.pbkdf2Sync.length?as.pbkdf2(e,t,r,n,(function(e,t){if(e)return o(e);o(null,t.toString("binary"))})):as.pbkdf2(e,t,r,n,i,(function(e,t){if(e)return o(e);o(null,t.toString("binary"))})):4===as.pbkdf2Sync.length?as.pbkdf2Sync(e,t,r,n).toString("binary"):as.pbkdf2Sync(e,t,r,n,i).toString("binary");if(null==i&&(i="sha1"),"string"==typeof i){if(!(i in qa.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=qa.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var s=new Error("Derived key is too long.");if(o)return o(s);throw s}var u=Math.ceil(n/a),c=n-(u-1)*a,l=qa.hmac.create();l.start(i,e);var f,h,p,d="";if(!o){for(var g=1;g<=u;++g){l.start(null,null),l.update(t),l.update(qa.util.int32ToBytes(g)),f=p=l.digest().getBytes();for(var y=2;y<=r;++y)l.start(null,null),l.update(p),h=l.digest().getBytes(),f=qa.util.xorBytes(f,h,a),p=h;d+=g<u?f:f.substr(0,c)}return d}g=1;function v(){if(g>u)return o(null,d);l.start(null,null),l.update(t),l.update(qa.util.int32ToBytes(g)),f=p=l.digest().getBytes(),y=2,m()}function m(){if(y<=r)return l.start(null,null),l.update(p),h=l.digest().getBytes(),f=qa.util.xorBytes(f,h,a),p=h,++y,qa.util.setImmediate(m);d+=g<u?f:f.substr(0,c),++g,v()}v()},u((function(e){var t=e.exports=qa.pem=qa.pem||{};function r(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var o=0,a=-1;for(i=0;i<t.length;++i,++o)if(o>65&&-1!==a){var s=t[a];","===s?(++a,t=t.substr(0,a)+"\r\n "+t.substr(a)):t=t.substr(0,a)+"\r\n"+s+t.substr(a+1),o=i-a-1,a=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(a=i);return t}function n(e){return e.replace(/^\s+/,"")}t.encode=function(e,t){t=t||{};var n,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=r(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=r(n={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),i+=r(n)),e.headers)for(var o=0;o<e.headers.length;++o)i+=r(e.headers[o]);return e.procType&&(i+="\r\n"),i+=qa.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},t.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;t=i.exec(e);){var s={type:t[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:qa.util.decode64(t[3])};if(r.push(s),t[2]){for(var u=t[2].split(a),c=0;t&&c<u.length;){for(var l=u[c].replace(/\s+$/,""),f=c+1;f<u.length;++f){var h=u[f];if(!/\s/.test(h[0]))break;l+=h,c=f}if(t=l.match(o)){for(var p={name:t[1],values:[]},d=t[2].split(","),g=0;g<d.length;++g)p.values.push(n(d[g]));if(s.procType)if(s.contentDomain||"Content-Domain"!==p.name)if(s.dekInfo||"DEK-Info"!==p.name)s.headers.push(p);else{if(0===p.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');s.dekInfo={algorithm:d[0],parameters:d[1]||null}}else s.contentDomain=d[0]||"";else{if("Proc-Type"!==p.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');s.procType={version:d[0],type:d[1]}}}++c}if("ENCRYPTED"===s.procType&&!s.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}})),u((function(e){var t=e.exports=qa.sha256=qa.sha256||{};qa.md.sha256=qa.md.algorithms.sha256=t,t.create=function(){n||(r=String.fromCharCode(128),r+=qa.util.fillString(String.fromCharCode(0),64),i=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=!0);var e=null,t=qa.util.createBuffer(),a=new Array(64),s={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var r=s.messageLengthSize/4,n=0;n<r;++n)s.fullMessageLength.push(0);return t=qa.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},s}};return s.start(),s.update=function(r,n){"utf8"===n&&(r=qa.util.encodeUtf8(r));var i=r.length;s.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var u=s.fullMessageLength.length-1;u>=0;--u)s.fullMessageLength[u]+=i[1],i[1]=i[0]+(s.fullMessageLength[u]/4294967296>>>0),s.fullMessageLength[u]=s.fullMessageLength[u]>>>0,i[0]=i[1]/4294967296>>>0;return t.putBytes(r),o(e,a,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var n=qa.util.createBuffer();n.putBytes(t.bytes());var i,u=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize&s.blockLength-1;n.putBytes(r.substr(0,s.blockLength-u));for(var c=8*s.fullMessageLength[0],l=0;l<s.fullMessageLength.length-1;++l)c+=(i=8*s.fullMessageLength[l+1])/4294967296>>>0,n.putInt32(c>>>0),c=i>>>0;n.putInt32(c);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};o(f,a,n);var h=qa.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h.putInt32(f.h5),h.putInt32(f.h6),h.putInt32(f.h7),h},s};var r=null,n=!1,i=null;function o(e,t,r){for(var n,o,a,s,u,c,l,f,h,p,d,g,y,v=r.length();v>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=((n=t[u-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,o=((o=t[u-15])>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,t[u]=n+t[u-7]+o+t[u-16]|0;for(c=e.h0,l=e.h1,f=e.h2,h=e.h3,p=e.h4,d=e.h5,g=e.h6,y=e.h7,u=0;u<64;++u)a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),s=c&l|f&(c^l),n=y+((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(g^p&(d^g))+i[u]+t[u],y=g,g=d,d=p,p=h+n>>>0,h=f,f=l,l=c,c=n+(o=a+s)>>>0;e.h0=e.h0+c|0,e.h1=e.h1+l|0,e.h2=e.h2+f|0,e.h3=e.h3+h|0,e.h4=e.h4+p|0,e.h5=e.h5+d|0,e.h6=e.h6+g|0,e.h7=e.h7+y|0,v-=64}}})),u((function(e){var t=null;!qa.util.isNodejs||qa.options.usePureJavaScript||process.versions["node-webkit"]||(t=ss),(e.exports=qa.prng=qa.prng||{}).create=function(e){for(var r={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},n=e.md,i=new Array(32),o=0;o<32;++o)i[o]=n.create();function a(){if(r.pools[0].messageLength>=32)return s();var e=32-r.pools[0].messageLength<<5;r.collect(r.seedFileSync(e)),s()}function s(){r.reseeds=4294967295===r.reseeds?0:r.reseeds+1;var e=r.plugin.md.create();e.update(r.keyBytes);for(var t=1,n=0;n<32;++n)r.reseeds%t==0&&(e.update(r.pools[n].digest().getBytes()),r.pools[n].start()),t<<=1;r.keyBytes=e.digest().getBytes(),e.start(),e.update(r.keyBytes);var i=e.digest().getBytes();r.key=r.plugin.formatKey(r.keyBytes),r.seed=r.plugin.formatSeed(i),r.generated=0}function u(e){var t=null,r=qa.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var i=qa.util.createBuffer();if(t)for(;i.length()<e;){var o=Math.max(1,Math.min(e-i.length(),65536)/4),a=new Uint32Array(Math.floor(o));try{t(a);for(var s=0;s<a.length;++s)i.putInt32(a[s])}catch(h){if(!("undefined"!=typeof QuotaExceededError&&h instanceof QuotaExceededError))throw h}}if(i.length()<e)for(var u,c,l,f=Math.floor(65536*Math.random());i.length()<e;){c=16807*(65535&f),c+=(32767&(u=16807*(f>>16)))<<16,f=4294967295&(c=(2147483647&(c+=u>>15))+(c>>31));for(s=0;s<3;++s)l=f>>>(s<<3),l^=Math.floor(256*Math.random()),i.putByte(String.fromCharCode(255&l))}return i.getBytes(e)}return r.pools=i,r.pool=0,r.generate=function(e,t){if(!t)return r.generateSync(e);var n=r.plugin.cipher,i=r.plugin.increment,o=r.plugin.formatKey,a=r.plugin.formatSeed,u=qa.util.createBuffer();r.key=null,function c(l){if(l)return t(l);if(u.length()>=e)return t(null,u.getBytes(e));r.generated>1048575&&(r.key=null);if(null===r.key)return qa.util.nextTick((function(){!function(e){if(r.pools[0].messageLength>=32)return s(),e();var t=32-r.pools[0].messageLength<<5;r.seedFile(t,(function(t,n){if(t)return e(t);r.collect(n),s(),e()}))}(c)}));var f=n(r.key,r.seed);r.generated+=f.length,u.putBytes(f),r.key=o(n(r.key,i(r.seed))),r.seed=a(n(r.key,r.seed)),qa.util.setImmediate(c)}()},r.generateSync=function(e){var t=r.plugin.cipher,n=r.plugin.increment,i=r.plugin.formatKey,o=r.plugin.formatSeed;r.key=null;for(var s=qa.util.createBuffer();s.length()<e;){r.generated>1048575&&(r.key=null),null===r.key&&a();var u=t(r.key,r.seed);r.generated+=u.length,s.putBytes(u),r.key=i(t(r.key,n(r.seed))),r.seed=o(t(r.key,r.seed))}return s.getBytes(e)},t?(r.seedFile=function(e,r){t.randomBytes(e,(function(e,t){if(e)return r(e);r(null,t.toString())}))},r.seedFileSync=function(e){return t.randomBytes(e).toString()}):(r.seedFile=function(e,t){try{t(null,u(e))}catch(r){t(r)}},r.seedFileSync=u),r.collect=function(e){for(var t=e.length,n=0;n<t;++n)r.pools[r.pool].update(e.substr(n,1)),r.pool=31===r.pool?0:r.pool+1},r.collectInt=function(e,t){for(var n="",i=0;i<t;i+=8)n+=String.fromCharCode(e>>i&255);r.collect(n)},r.registerWorker=function(e){if(e===self)r.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(t){var n=t.data;n.forge&&n.forge.prng&&r.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},r}})),u((function(e){qa.random&&qa.random.getBytes?e.exports=qa.random:function(t){var r={},n=new Array(4),i=qa.util.createBuffer();function o(){var e=qa.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=qa.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),qa.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=qa.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return qa.aes._updateBlock(e,t,n,!1),i.putInt32(n[0]),i.putInt32(n[1]),i.putInt32(n[2]),i.putInt32(n[3]),i.getBytes()},r.increment=function(e){return++e[3],e},r.md=qa.md.sha256;var a=o(),s=null,u=qa.util.globalScope,c=u.crypto||u.msCrypto;if(c&&c.getRandomValues&&(s=function(e){return c.getRandomValues(e)}),!qa.util.isNodejs&&!s){if(a.collectInt(+new Date,32),"undefined"!=typeof navigator){var l="";for(var f in navigator)try{"string"==typeof navigator[f]&&(l+=navigator[f])}catch(h){}a.collect(l),l=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(qa.random)for(var f in a)qa.random[f]=a[f];else qa.random=a;qa.random.createInstance=o,e.exports=qa.random}("undefined"!=typeof jQuery?jQuery:null)})),u((function(e){var t=e.exports=qa.sha1=qa.sha1||{};qa.md.sha1=qa.md.algorithms.sha1=t,t.create=function(){n||(r=String.fromCharCode(128),r+=qa.util.fillString(String.fromCharCode(0),64),n=!0);var e=null,t=qa.util.createBuffer(),o=new Array(80),a={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var r=a.messageLengthSize/4,n=0;n<r;++n)a.fullMessageLength.push(0);return t=qa.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},a}};return a.start(),a.update=function(r,n){"utf8"===n&&(r=qa.util.encodeUtf8(r));var s=r.length;a.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=a.fullMessageLength.length-1;u>=0;--u)a.fullMessageLength[u]+=s[1],s[1]=s[0]+(a.fullMessageLength[u]/4294967296>>>0),a.fullMessageLength[u]=a.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(r),i(e,o,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var n=qa.util.createBuffer();n.putBytes(t.bytes());var s,u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;n.putBytes(r.substr(0,a.blockLength-u));for(var c=8*a.fullMessageLength[0],l=0;l<a.fullMessageLength.length-1;++l)c+=(s=8*a.fullMessageLength[l+1])/4294967296>>>0,n.putInt32(c>>>0),c=s>>>0;n.putInt32(c);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};i(f,o,n);var h=qa.util.createBuffer();return h.putInt32(f.h0),h.putInt32(f.h1),h.putInt32(f.h2),h.putInt32(f.h3),h.putInt32(f.h4),h},a};var r=null,n=!1;function i(e,t,r){for(var n,i,o,a,s,u,c,l=r.length();l>=64;){for(i=e.h0,o=e.h1,a=e.h2,s=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,n=(i<<5|i>>>27)+(s^o&(a^s))+u+1518500249+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<20;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(s^o&(a^s))+u+1518500249+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<32;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(o^a^s)+u+1859775393+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<40;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(o^a^s)+u+1859775393+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<60;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(o&a|s&(o^a))+u+2400959708+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;for(;c<80;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(o^a^s)+u+3395469782+n,u=s,s=a,a=(o<<30|o>>>2)>>>0,o=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+o|0,e.h2=e.h2+a|0,e.h3=e.h3+s|0,e.h4=e.h4+u|0,l-=64}}})),u((function(e){var t=e.exports=qa.pkcs1=qa.pkcs1||{};function r(e,t,r){r||(r=qa.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),o=0;o<i;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(e+a),n+=r.digest().getBytes()}return n.substring(0,t)}t.encode_rsa_oaep=function(e,t,n){var i,o,a,s;"string"==typeof n?(i=n,o=arguments[3]||void 0,a=arguments[4]||void 0):n&&(i=n.label||void 0,o=n.seed||void 0,a=n.md||void 0,n.mgf1&&n.mgf1.md&&(s=n.mgf1.md)),a?a.start():a=qa.md.sha1.create(),s||(s=a);var u=Math.ceil(e.n.bitLength()/8),c=u-2*a.digestLength-2;if(t.length>c)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=c,g;i||(i=""),a.update(i,"raw");for(var l=a.digest(),f="",h=c-t.length,p=0;p<h;p++)f+="\0";var d=l.getBytes()+f+""+t;if(o){if(o.length!==a.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=o.length,g.digestLength=a.digestLength,g}}else o=qa.random.getBytes(a.digestLength);var y=r(o,u-a.digestLength-1,s),v=qa.util.xorBytes(d,y,d.length),m=r(v,a.digestLength,s),b=qa.util.xorBytes(o,m,o.length);return"\0"+b+v},t.decode_rsa_oaep=function(e,t,n){var i,o,a;"string"==typeof n?(i=n,o=arguments[3]||void 0):n&&(i=n.label||void 0,o=n.md||void 0,n.mgf1&&n.mgf1.md&&(a=n.mgf1.md));var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s)throw(v=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,v.expectedLength=s,v;if(void 0===o?o=qa.md.sha1.create():o.start(),a||(a=o),s<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),o.update(i,"raw");for(var u=o.digest().getBytes(),c=t.charAt(0),l=t.substring(1,o.digestLength+1),f=t.substring(1+o.digestLength),h=r(f,o.digestLength,a),p=qa.util.xorBytes(l,h,l.length),d=r(p,s-o.digestLength-1,a),g=qa.util.xorBytes(f,d,f.length),y=g.substring(0,o.digestLength),v="\0"!==c,m=0;m<o.digestLength;++m)v|=u.charAt(m)!==y.charAt(m);for(var b=1,E=o.digestLength,S=o.digestLength;S<g.length;S++){var w=g.charCodeAt(S),_=1&w^1,C=b?65534:0;v|=w&C,E+=b&=_}if(v||1!==g.charCodeAt(E))throw new Error("Invalid RSAES-OAEP padding.");return g.substring(E+1)}})),qa.des=qa.des||{},qa.des.startEncrypting=function(e,t,r,n){var i=Es({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},qa.des.createEncryptionCipher=function(e,t){return Es({key:e,output:null,decrypt:!1,mode:t})},qa.des.startDecrypting=function(e,t,r,n){var i=Es({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},qa.des.createDecryptionCipher=function(e,t){return Es({key:e,output:null,decrypt:!0,mode:t})},qa.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return bs(r._keys,e,t,!1)},decrypt:function(e,t){return bs(r._keys,e,t,!0)}}}),r._init=!1},qa.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=qa.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,E=0;E<y;E++){var S=e.getInt32(),w=e.getInt32();S^=(t=252645135&(S>>>4^w))<<4,S^=t=65535&((w^=t)>>>-16^S),S^=(t=858993459&(S>>>2^(w^=t<<-16)))<<2,S^=t=65535&((w^=t)>>>-16^S),S^=(t=1431655765&(S>>>1^(w^=t<<-16)))<<1,S^=t=16711935&((w^=t)>>>8^S),t=(S^=(t=1431655765&(S>>>1^(w^=t<<8)))<<1)<<8|(w^=t)>>>20&240,S=w<<24|w<<8&16711680|w>>>8&65280|w>>>24&240,w=t;for(var _=0;_<m.length;++_){m[_]?(S=S<<2|S>>>26,w=w<<2|w>>>26):(S=S<<1|S>>>27,w=w<<1|w>>>27),w&=-15;var C=r[(S&=-15)>>>28]|n[S>>>24&15]|i[S>>>20&15]|o[S>>>16&15]|a[S>>>12&15]|s[S>>>8&15]|u[S>>>4&15],A=c[w>>>28]|l[w>>>24&15]|f[w>>>20&15]|h[w>>>16&15]|p[w>>>12&15]|d[w>>>8&15]|g[w>>>4&15];t=65535&(A>>>16^C),v[b++]=C^t,v[b++]=A^t<<16}}return v}(t),this._init=!0}},cs("DES-ECB",qa.cipher.modes.ecb),cs("DES-CBC",qa.cipher.modes.cbc),cs("DES-CFB",qa.cipher.modes.cfb),cs("DES-OFB",qa.cipher.modes.ofb),cs("DES-CTR",qa.cipher.modes.ctr),cs("3DES-ECB",qa.cipher.modes.ecb),cs("3DES-CBC",qa.cipher.modes.cbc),cs("3DES-CFB",qa.cipher.modes.cfb),cs("3DES-OFB",qa.cipher.modes.ofb),cs("3DES-CTR",qa.cipher.modes.ctr);var ls,fs=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],hs=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],ps=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],ds=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],gs=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],ys=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],vs=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],ms=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function bs(e,t,r,n){var i,o,a=32===e.length?3:9;i=3===a?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s=t[0],u=t[1];s^=(o=252645135&(s>>>4^u))<<4,s^=(o=65535&(s>>>16^(u^=o)))<<16,s^=o=858993459&((u^=o)>>>2^s),s^=o=16711935&((u^=o<<2)>>>8^s),s=(s^=(o=1431655765&(s>>>1^(u^=o<<8)))<<1)<<1|s>>>31,u=(u^=o)<<1|u>>>31;for(var c=0;c<a;c+=3){for(var l=i[c+1],f=i[c+2],h=i[c];h!=l;h+=f){var p=u^e[h],d=(u>>>4|u<<28)^e[h+1];o=s,s=u,u=o^(hs[p>>>24&63]|ds[p>>>16&63]|ys[p>>>8&63]|ms[63&p]|fs[d>>>24&63]|ps[d>>>16&63]|gs[d>>>8&63]|vs[63&d])}o=s,s=u,u=o}u=u>>>1|u<<31,u^=o=1431655765&((s=s>>>1|s<<31)>>>1^u),u^=(o=16711935&(u>>>8^(s^=o<<1)))<<8,u^=(o=858993459&(u>>>2^(s^=o)))<<2,u^=o=65535&((s^=o)>>>16^u),u^=o=252645135&((s^=o<<16)>>>4^u),s^=o<<4,r[0]=s,r[1]=u}function Es(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),n=(t=e.decrypt?qa.cipher.createDecipher(r,e.key):qa.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var i=null;r instanceof qa.util.ByteBuffer&&(i=r,r={}),(r=r||{}).output=i,r.iv=e,n.call(t,r)},t}function Ss(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function ws(){return new Ss(null)}function _s(e,t,r,n,i,o){for(var a=16383&t,s=t>>14;--o>=0;){var u=16383&this.data[e],c=this.data[e++]>>14,l=s*u+c*a;i=((u=a*u+((16383&l)<<14)+r.data[n]+i)>>28)+(l>>14)+s*c,r.data[n++]=268435455&u}return i}u((function(e){var t=qa.asn1,r=e.exports=qa.pkcs7asn1=qa.pkcs7asn1||{};qa.pkcs7=qa.pkcs7||{},qa.pkcs7.asn1=r;var n={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};r.contentInfoValidator=n;var i={name:"EncryptedContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};r.envelopedDataValidator={name:"EnvelopedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(i)},r.encryptedDataValidator={name:"EncryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"}].concat(i)};var o={name:"SignerInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};r.signedDataValidator={name:"SignedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,capture:"signerInfos",optional:!0,value:[o]}]},r.recipientInfoValidator={name:"RecipientInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}})),qa.mgf=qa.mgf||{},qa.mgf.mgf1=qa.mgf1,u((function(e){(e.exports=qa.pss=qa.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,n=e.mgf,i=r.digestLength,o=e.salt||null;if("string"==typeof o&&(o=qa.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||qa.random,s={encode:function(e,s){var u,c,l=s-1,f=Math.ceil(l/8),h=e.digest().getBytes();if(f<i+t+2)throw new Error("Message is too long to encrypt.");c=null===o?a.getBytesSync(t):o.bytes();var p=new qa.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(h),p.putBytes(c),r.start(),r.update(p.getBytes());var d=r.digest().getBytes(),g=new qa.util.ByteBuffer;g.fillWithByte(0,f-t-i-2),g.putByte(1),g.putBytes(c);var y=g.getBytes(),v=f-i-1,m=n.generate(d,v),b="";for(u=0;u<v;u++)b+=String.fromCharCode(y.charCodeAt(u)^m.charCodeAt(u));var E=65280>>8*f-l&255;return(b=String.fromCharCode(b.charCodeAt(0)&~E)+b.substr(1))+d+String.fromCharCode(188)},verify:function(e,o,a){var s,u=a-1,c=Math.ceil(u/8);if(o=o.substr(-c),c<i+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(c-1))throw new Error("Encoded message does not end in 0xBC.");var l=c-i-1,f=o.substr(0,l),h=o.substr(l,i),p=65280>>8*c-u&255;if(0!=(f.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var d=n.generate(h,l),g="";for(s=0;s<l;s++)g+=String.fromCharCode(f.charCodeAt(s)^d.charCodeAt(s));g=String.fromCharCode(g.charCodeAt(0)&~p)+g.substr(1);var y=c-i-t-2;for(s=0;s<y;s++)if(0!==g.charCodeAt(s))throw new Error("Leftmost octets not zero as expected");if(1!==g.charCodeAt(y))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=g.substr(-t),m=new qa.util.ByteBuffer;return m.fillWithByte(0,8),m.putBytes(e),m.putBytes(v),r.start(),r.update(m.getBytes()),h===r.digest().getBytes()}};return s}})),qa.jsbn=qa.jsbn||{},qa.jsbn.BigInteger=Ss,"undefined"==typeof navigator?(Ss.prototype.am=_s,ls=28):"Microsoft Internet Explorer"==navigator.appName?(Ss.prototype.am=function(e,t,r,n,i,o){for(var a=32767&t,s=t>>15;--o>=0;){var u=32767&this.data[e],c=this.data[e++]>>15,l=s*u+c*a;i=((u=a*u+((32767&l)<<15)+r.data[n]+(1073741823&i))>>>30)+(l>>>15)+s*c+(i>>>30),r.data[n++]=1073741823&u}return i},ls=30):"Netscape"!=navigator.appName?(Ss.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=67108863&a}return i},ls=26):(Ss.prototype.am=_s,ls=28),Ss.prototype.DB=ls,Ss.prototype.DM=(1<<ls)-1,Ss.prototype.DV=1<<ls;Ss.prototype.FV=Math.pow(2,52),Ss.prototype.F1=52-ls,Ss.prototype.F2=2*ls-52;var Cs,As,Is=new Array;for(Cs="0".charCodeAt(0),As=0;As<=9;++As)Is[Cs++]=As;for(Cs="a".charCodeAt(0),As=10;As<36;++As)Is[Cs++]=As;for(Cs="A".charCodeAt(0),As=10;As<36;++As)Is[Cs++]=As;function Ts(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function Ps(e,t){var r=Is[e.charCodeAt(t)];return null==r?-1:r}function Fs(e){var t=ws();return t.fromInt(e),t}function ks(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function Rs(e){this.m=e}function Bs(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Os(e,t){return e&t}function xs(e,t){return e|t}function Ns(e,t){return e^t}function Us(e,t){return e&~t}function js(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function Ds(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function Ls(){}function Ms(e){return e}function Ks(e){this.r2=ws(),this.q3=ws(),Ss.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}Rs.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},Rs.prototype.revert=function(e){return e},Rs.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},Rs.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},Rs.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},Bs.prototype.convert=function(e){var t=ws();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(Ss.ZERO)>0&&this.m.subTo(t,t),t},Bs.prototype.revert=function(e){var t=ws();return e.copyTo(t),this.reduce(t),t},Bs.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},Bs.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},Bs.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},Ss.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},Ss.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},Ss.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var a=8==r?255&e[n]:Ps(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this.data[this.t++]=a:o+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this.data[this.t++]=a>>this.DB-o):this.data[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&Ss.ZERO.subTo(this,this)},Ss.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},Ss.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},Ss.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},Ss.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,a=Math.floor(e/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+a+1]=this.data[r]>>i|s,s=(this.data[r]&o)<<n;for(r=a-1;r>=0;--r)t.data[r]=0;t.data[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()},Ss.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&o)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},Ss.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},Ss.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&Ss.ZERO.subTo(t,t)},Ss.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},Ss.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=ws());var o=ws(),a=this.s,s=e.s,u=this.DB-ks(n.data[n.t-1]);u>0?(n.lShiftTo(u,o),i.lShiftTo(u,r)):(n.copyTo(o),i.copyTo(r));var c=o.t,l=o.data[c-1];if(0!=l){var f=l*(1<<this.F1)+(c>1?o.data[c-2]>>this.F2:0),h=this.FV/f,p=(1<<this.F1)/f,d=1<<this.F2,g=r.t,y=g-c,v=null==t?ws():t;for(o.dlShiftTo(y,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),Ss.ONE.dlShiftTo(c,v),v.subTo(o,o);o.t<c;)o.data[o.t++]=0;for(;--y>=0;){var m=r.data[--g]==l?this.DM:Math.floor(r.data[g]*h+(r.data[g-1]+d)*p);if((r.data[g]+=o.am(0,m,r,y,0,c))<m)for(o.dlShiftTo(y,v),r.subTo(v,r);r.data[g]<--m;)r.subTo(v,r)}null!=t&&(r.drShiftTo(c,t),a!=s&&Ss.ZERO.subTo(t,t)),r.t=c,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&Ss.ZERO.subTo(r,r)}}},Ss.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},Ss.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},Ss.prototype.exp=function(e,t){if(e>4294967295||e<1)return Ss.ONE;var r=ws(),n=ws(),i=t.convert(this),o=ks(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)},Ss.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",a=this.t,s=this.DB-a*this.DB%t;if(a-- >0)for(s<this.DB&&(r=this.data[a]>>s)>0&&(i=!0,o=Ts(r));a>=0;)s<t?(r=(this.data[a]&(1<<s)-1)<<t-s,r|=this.data[--a]>>(s+=this.DB-t)):(r=this.data[a]>>(s-=t)&n,s<=0&&(s+=this.DB,--a)),r>0&&(i=!0),i&&(o+=Ts(r));return i?o:"0"},Ss.prototype.negate=function(){var e=ws();return Ss.ZERO.subTo(this,e),e},Ss.prototype.abs=function(){return this.s<0?this.negate():this},Ss.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},Ss.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+ks(this.data[this.t-1]^this.s&this.DM)},Ss.prototype.mod=function(e){var t=ws();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(Ss.ZERO)>0&&e.subTo(t,t),t},Ss.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new Rs(t):new Bs(t),this.exp(e,r)},Ss.ZERO=Fs(0),Ss.ONE=Fs(1),Ls.prototype.convert=Ms,Ls.prototype.revert=Ms,Ls.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},Ls.prototype.sqrTo=function(e,t){e.squareTo(t)},Ks.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ws();return e.copyTo(t),this.reduce(t),t},Ks.prototype.revert=function(e){return e},Ks.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},Ks.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},Ks.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var Vs=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Hs=(1<<26)/Vs[Vs.length-1];if(Ss.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},Ss.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=Fs(r),i=ws(),o=ws(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(e)+a},Ss.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,a=0,s=0;s<e.length;++s){var u=Ps(e,s);u<0?"-"==e.charAt(s)&&0==this.signum()&&(i=!0):(a=t*a+u,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),i&&Ss.ZERO.subTo(this,this)},Ss.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(Ss.ONE.shiftLeft(e-1),xs,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(Ss.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},Ss.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},Ss.prototype.changeBit=function(e,t){var r=Ss.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},Ss.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},Ss.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},Ss.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},Ss.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},Ss.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},Ss.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},Ss.prototype.millerRabin=function(e){var t=this.subtract(Ss.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),o={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},a=0;a<e;++a){do{n=new Ss(this.bitLength(),o)}while(n.compareTo(Ss.ONE)<=0||n.compareTo(t)>=0);var s=n.modPow(i,this);if(0!=s.compareTo(Ss.ONE)&&0!=s.compareTo(t)){for(var u=1;u++<r&&0!=s.compareTo(t);)if(0==(s=s.modPowInt(2,this)).compareTo(Ss.ONE))return!1;if(0!=s.compareTo(t))return!1}}return!0},Ss.prototype.clone=function(){var e=ws();return this.copyTo(e),e},Ss.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},Ss.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},Ss.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},Ss.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},Ss.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},Ss.prototype.equals=function(e){return 0==this.compareTo(e)},Ss.prototype.min=function(e){return this.compareTo(e)<0?this:e},Ss.prototype.max=function(e){return this.compareTo(e)>0?this:e},Ss.prototype.and=function(e){var t=ws();return this.bitwiseTo(e,Os,t),t},Ss.prototype.or=function(e){var t=ws();return this.bitwiseTo(e,xs,t),t},Ss.prototype.xor=function(e){var t=ws();return this.bitwiseTo(e,Ns,t),t},Ss.prototype.andNot=function(e){var t=ws();return this.bitwiseTo(e,Us,t),t},Ss.prototype.not=function(){for(var e=ws(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},Ss.prototype.shiftLeft=function(e){var t=ws();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},Ss.prototype.shiftRight=function(e){var t=ws();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},Ss.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+js(this.data[e]);return this.s<0?this.t*this.DB:-1},Ss.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Ds(this.data[r]^t);return e},Ss.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},Ss.prototype.setBit=function(e){return this.changeBit(e,xs)},Ss.prototype.clearBit=function(e){return this.changeBit(e,Us)},Ss.prototype.flipBit=function(e){return this.changeBit(e,Ns)},Ss.prototype.add=function(e){var t=ws();return this.addTo(e,t),t},Ss.prototype.subtract=function(e){var t=ws();return this.subTo(e,t),t},Ss.prototype.multiply=function(e){var t=ws();return this.multiplyTo(e,t),t},Ss.prototype.divide=function(e){var t=ws();return this.divRemTo(e,t,null),t},Ss.prototype.remainder=function(e){var t=ws();return this.divRemTo(e,null,t),t},Ss.prototype.divideAndRemainder=function(e){var t=ws(),r=ws();return this.divRemTo(e,t,r),new Array(t,r)},Ss.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=Fs(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new Rs(t):t.isEven()?new Ks(t):new Bs(t);var a=new Array,s=3,u=r-1,c=(1<<r)-1;if(a[1]=n.convert(this),r>1){var l=ws();for(n.sqrTo(a[1],l);s<=c;)a[s]=ws(),n.mulTo(l,a[s-2],a[s]),s+=2}var f,h,p=e.t-1,d=!0,g=ws();for(i=ks(e.data[p])-1;p>=0;){for(i>=u?f=e.data[p]>>i-u&c:(f=(e.data[p]&(1<<i+1)-1)<<u-i,p>0&&(f|=e.data[p-1]>>this.DB+i-u)),s=r;0==(1&f);)f>>=1,--s;if((i-=s)<0&&(i+=this.DB,--p),d)a[f].copyTo(o),d=!1;else{for(;s>1;)n.sqrTo(o,g),n.sqrTo(g,o),s-=2;s>0?n.sqrTo(o,g):(h=o,o=g,g=h),n.mulTo(g,a[f],o)}for(;p>=0&&0==(e.data[p]&1<<i);)n.sqrTo(o,g),h=o,o=g,g=h,--i<0&&(i=this.DB-1,--p)}return n.revert(o)},Ss.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return Ss.ZERO;for(var r=e.clone(),n=this.clone(),i=Fs(1),o=Fs(0),a=Fs(0),s=Fs(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&s.isEven()||(a.addTo(this,a),s.subTo(e,s)),a.rShiftTo(1,a)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),o.subTo(s,o)):(n.subTo(r,n),t&&a.subTo(i,a),s.subTo(o,s))}return 0!=n.compareTo(Ss.ONE)?Ss.ZERO:s.compareTo(e)>=0?s.subtract(e):s.signum()<0?(s.addTo(e,s),s.signum()<0?s.add(e):s):s},Ss.prototype.pow=function(e){return this.exp(e,new Ls)},Ss.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},Ss.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=Vs[Vs.length-1]){for(t=0;t<Vs.length;++t)if(r.data[0]==Vs[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<Vs.length;){for(var n=Vs[t],i=t+1;i<Vs.length&&n<Hs;)n*=Vs[i++];for(n=r.modInt(n);t<i;)if(n%Vs[t++]==0)return!1}return r.millerRabin(e)},u((function(e){!function(){if(qa.prime)e.exports=qa.prime;else{var t=e.exports=qa.prime=qa.prime||{},r=qa.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],i=new r(null);i.fromInt(30);var o=function(e,t){return e|t};t.generateProbablePrime=function(e,t,n){"function"==typeof t&&(n=t,t={});var i=(t=t||{}).algorithm||"PRIMEINC";"string"==typeof i&&(i={name:i}),i.options=i.options||{};var o=t.prng||qa.random,s={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===i.name)return function(e,t,n,i){if("workers"in n)return function(e,t,n,i){if("undefined"==typeof Worker)return a(e,t,n,i);var o=u(e,t),s=n.workers,c=n.workLoad||100,l=30*c/8,f=n.workerScript||"forge/prime.worker.js";if(-1===s)return qa.util.estimateCores((function(e,t){e&&(t=2),s=t-1,h()}));function h(){s=Math.max(1,s);for(var n=[],a=0;a<s;++a)n[a]=new Worker(f);for(a=0;a<s;++a)n[a].addEventListener("message",p);var h=!1;function p(a){if(!h){var s=a.data;if(s.found){for(var f=0;f<n.length;++f)n[f].terminate();return h=!0,i(null,new r(s.prime,16))}o.bitLength()>e&&(o=u(e,t));var p=o.toString(16);a.target.postMessage({hex:p,workLoad:c}),o.dAddOffset(l,0)}}}h()}(e,t,n,i);return a(e,t,n,i)}(e,s,i.options,n);throw new Error("Invalid prime generation algorithm: "+i.name)}}function a(e,t,r,n){var i=u(e,t),o=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in r&&(o=r.millerRabinTests);var a=10;"maxBlockTime"in r&&(a=r.maxBlockTime),s(i,e,t,0,o,a,n)}function s(e,t,r,i,o,a,c){var l=+new Date;do{if(e.bitLength()>t&&(e=u(t,r)),e.isProbablePrime(o))return c(null,e);e.dAddOffset(n[i++%8],0)}while(a<0||+new Date-l<a);qa.util.setImmediate((function(){s(e,t,r,i,o,a,c)}))}function u(e,t){var n=new r(e,t),a=e-1;return n.testBit(a)||n.bitwiseTo(r.ONE.shiftLeft(a),o,n),n.dAddOffset(31-n.mod(i).byteValue(),0),n}}()})),void 0===qs)var qs=qa.jsbn.BigInteger;var zs=qa.util.isNodejs?ss:null,$s=qa.asn1,Gs=qa.util;qa.pki=qa.pki||{},qa.pki.rsa=qa.rsa=qa.rsa||{};var Ws=qa.pki,Js=[6,4,2,4,2,4,6,2],Qs={name:"PrivateKeyInfo",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:$s.Class.UNIVERSAL,type:$s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:$s.Class.UNIVERSAL,type:$s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Ys={name:"RSAPrivateKey",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Xs={name:"RSAPublicKey",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:$s.Class.UNIVERSAL,type:$s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Zs=qa.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:$s.Class.UNIVERSAL,type:$s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:$s.Class.UNIVERSAL,type:$s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:$s.Class.UNIVERSAL,type:$s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},eu=function(e){var t;if(!(e.algorithm in Ws.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=Ws.oids[e.algorithm];var n=$s.oidToDer(t).getBytes(),i=$s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[]),o=$s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[]);o.value.push($s.create($s.Class.UNIVERSAL,$s.Type.OID,!1,n)),o.value.push($s.create($s.Class.UNIVERSAL,$s.Type.NULL,!1,""));var a=$s.create($s.Class.UNIVERSAL,$s.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(o),i.value.push(a),$s.toDer(i).getBytes()},tu=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var n;t.dP||(t.dP=t.d.mod(t.p.subtract(qs.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(qs.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{n=new qs(qa.util.bytesToHex(qa.random.getBytes(t.n.bitLength()/8)),16)}while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(qs.ONE));for(var i=(e=e.multiply(n.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),o=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(o)<0;)i=i.add(t.p);var a=i.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);return a=a.multiply(n.modInverse(t.n)).mod(t.n)};function ru(e,t,r){var n=qa.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var a,s=i-3-e.length;if(0===r||1===r){a=0===r?0:255;for(var u=0;u<s;++u)n.putByte(a)}else for(;s>0;){var c=0,l=qa.random.getBytes(s);for(u=0;u<s;++u)0===(a=l.charCodeAt(u))?++c:n.putByte(a);s=c}return n.putByte(0),n.putBytes(e),n}function nu(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),o=qa.util.createBuffer(e),a=o.getByte(),s=o.getByte();if(0!==a||r&&0!==s&&1!==s||!r&&2!=s||r&&0===s&&void 0===n)throw new Error("Encryption block is invalid.");var u=0;if(0===s){u=i-3-n;for(var c=0;c<u;++c)if(0!==o.getByte())throw new Error("Encryption block is invalid.")}else if(1===s)for(u=0;o.length()>1;){if(255!==o.getByte()){--o.read;break}++u}else if(2===s)for(u=0;o.length()>1;){if(0===o.getByte()){--o.read;break}++u}if(0!==o.getByte()||u!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function iu(e,t,r){"function"==typeof t&&(r=t,t={});var n={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function i(){o(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?a(t,e.q):void o(e.qBits,a))}))}function o(e,t){qa.prime.generateProbablePrime(e,n,t)}function a(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var s=e.p;e.p=e.q,e.q=s}if(0!==e.p.subtract(qs.ONE).gcd(e.e).compareTo(qs.ONE))return e.p=null,void i();if(0!==e.q.subtract(qs.ONE).gcd(e.e).compareTo(qs.ONE))return e.q=null,void o(e.qBits,a);if(e.p1=e.p.subtract(qs.ONE),e.q1=e.q.subtract(qs.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(qs.ONE))return e.p=e.q=null,void i();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void o(e.qBits,a);var u=e.e.modInverse(e.phi);e.keys={privateKey:Ws.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:Ws.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(n.prng=t.prng),i()}function ou(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=qa.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0==(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128==(128&r.charCodeAt(1)))?r.substr(1):r}function au(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function su(e){return qa.util.isNodejs&&"function"==typeof zs[e]}function uu(e){return void 0!==Gs.globalScope&&"object"==typeof Gs.globalScope.crypto&&"object"==typeof Gs.globalScope.crypto.subtle&&"function"==typeof Gs.globalScope.crypto.subtle[e]}function cu(e){return void 0!==Gs.globalScope&&"object"==typeof Gs.globalScope.msCrypto&&"object"==typeof Gs.globalScope.msCrypto.subtle&&"function"==typeof Gs.globalScope.msCrypto.subtle[e]}function lu(e){for(var t=qa.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}Ws.rsa.encrypt=function(e,t,r){var n,i=r,o=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(i=2===r,n=ru(e,t,r)):(n=qa.util.createBuffer()).putBytes(e);for(var a=new qs(n.toHex(),16),s=tu(a,t,i).toString(16),u=qa.util.createBuffer(),c=o-Math.ceil(s.length/2);c>0;)u.putByte(0),--c;return u.putBytes(qa.util.hexToBytes(s)),u.getBytes()},Ws.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=e.length,o.expected=i,o}var a=new qs(qa.util.createBuffer(e).toHex(),16);if(a.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var s=tu(a,t,r).toString(16),u=qa.util.createBuffer(),c=i-Math.ceil(s.length/2);c>0;)u.putByte(0),--c;return u.putBytes(qa.util.hexToBytes(s)),!1!==n?nu(u.getBytes(),t,r):u.getBytes()},Ws.rsa.createKeyPairGenerationState=function(e,t,r){"string"==typeof e&&(e=parseInt(e,10)),e=e||2048;var n,i=(r=r||{}).prng||qa.random,o={nextBytes:function(e){for(var t=i.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},a=r.algorithm||"PRIMEINC";if("PRIMEINC"!==a)throw new Error("Invalid key generation algorithm: "+a);return(n={algorithm:a,state:0,bits:e,rng:o,eInt:t||65537,e:new qs(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(n.eInt),n},Ws.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new qs(null);r.fromInt(30);for(var n,i=0,o=function(e,t){return e|t},a=+new Date,s=0;null===e.keys&&(t<=0||s<t);){if(0===e.state){var u=null===e.p?e.pBits:e.qBits,c=u-1;0===e.pqState?(e.num=new qs(u,e.rng),e.num.testBit(c)||e.num.bitwiseTo(qs.ONE.shiftLeft(c),o,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),i=0,++e.pqState):1===e.pqState?e.num.bitLength()>u?e.pqState=0:e.num.isProbablePrime(au(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Js[i++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(qs.ONE).gcd(e.e).compareTo(qs.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(qs.ONE),e.q1=e.q.subtract(qs.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(qs.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var l=e.e.modInverse(e.phi);e.keys={privateKey:Ws.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:Ws.rsa.setPublicKey(e.n,e.e)}}s+=(n=+new Date)-a,a=n}return null!==e.keys},Ws.rsa.generateKeyPair=function(e,t,r,n){if(1===arguments.length?"object"==typeof e?(r=e,e=void 0):"function"==typeof e&&(n=e,e=void 0):2===arguments.length?"number"==typeof e?"function"==typeof t?(n=t,t=void 0):"number"!=typeof t&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):3===arguments.length&&("number"==typeof t?"function"==typeof r&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(n){if(su("generateKeyPair"))return zs.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return n(e);n(null,{privateKey:Ws.privateKeyFromPem(r),publicKey:Ws.publicKeyFromPem(t)})}));if(uu("generateKey")&&uu("exportKey"))return Gs.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:lu(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return Gs.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){n(e)})).then((function(e){if(e){var t=Ws.privateKeyFromAsn1($s.fromDer(qa.util.createBuffer(e)));n(null,{privateKey:t,publicKey:Ws.setRsaPublicKey(t.n,t.e)})}}));if(cu("generateKey")&&cu("exportKey")){var i=Gs.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:lu(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return i.oncomplete=function(e){var t=e.target.result,r=Gs.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=Ws.privateKeyFromAsn1($s.fromDer(qa.util.createBuffer(t)));n(null,{privateKey:r,publicKey:Ws.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){n(e)}},void(i.onerror=function(e){n(e)})}}else if(su("generateKeyPairSync")){var o=zs.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Ws.privateKeyFromPem(o.privateKey),publicKey:Ws.publicKeyFromPem(o.publicKey)}}var a=Ws.rsa.createKeyPairGenerationState(e,t,r);if(!n)return Ws.rsa.stepKeyPairGenerationState(a,0),a.keys;iu(a,r,n)},Ws.setRsaPublicKey=Ws.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,n){if("string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return ru(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return qa.pkcs1.encode_rsa_oaep(t,e,n)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"==typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var i=t.encode(e,r,!0);return Ws.rsa.encrypt(i,r,!0)},verify:function(e,t,n){"string"==typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=nu(t,r,!0),e===$s.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===(t=nu(t,r,!0))}});var i=Ws.rsa.decrypt(t,r,!0,!1);return n.verify(e,i,r.n.bitLength())}};return r},Ws.setRsaPrivateKey=Ws.rsa.setPrivateKey=function(e,t,r,n,i,o,a,s){var u={n:e,e:t,d:r,p:n,q:i,dP:o,dQ:a,qInv:s,decrypt:function(e,t,r){"string"==typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var n=Ws.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:nu};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return qa.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(n,u,!1)},sign:function(e,t){var r=!1;"string"==typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:eu},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,u.n.bitLength());return Ws.rsa.encrypt(n,u,r)}};return u},Ws.wrapRsaPrivateKey=function(e){return $s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,$s.integerToDer(0).getBytes()),$s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[$s.create($s.Class.UNIVERSAL,$s.Type.OID,!1,$s.oidToDer(Ws.oids.rsaEncryption).getBytes()),$s.create($s.Class.UNIVERSAL,$s.Type.NULL,!1,"")]),$s.create($s.Class.UNIVERSAL,$s.Type.OCTETSTRING,!1,$s.toDer(e).getBytes())])},Ws.privateKeyFromAsn1=function(e){var t,r,n,i,o,a,s,u,c={},l=[];if($s.validate(e,Qs,c,l)&&(e=$s.fromDer(qa.util.createBuffer(c.privateKey))),c={},l=[],!$s.validate(e,Ys,c,l)){var f=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw f.errors=l,f}return t=qa.util.createBuffer(c.privateKeyModulus).toHex(),r=qa.util.createBuffer(c.privateKeyPublicExponent).toHex(),n=qa.util.createBuffer(c.privateKeyPrivateExponent).toHex(),i=qa.util.createBuffer(c.privateKeyPrime1).toHex(),o=qa.util.createBuffer(c.privateKeyPrime2).toHex(),a=qa.util.createBuffer(c.privateKeyExponent1).toHex(),s=qa.util.createBuffer(c.privateKeyExponent2).toHex(),u=qa.util.createBuffer(c.privateKeyCoefficient).toHex(),Ws.setRsaPrivateKey(new qs(t,16),new qs(r,16),new qs(n,16),new qs(i,16),new qs(o,16),new qs(a,16),new qs(s,16),new qs(u,16))},Ws.privateKeyToAsn1=Ws.privateKeyToRSAPrivateKey=function(e){return $s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,$s.integerToDer(0).getBytes()),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.n)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.e)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.d)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.p)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.q)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.dP)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.dQ)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.qInv))])},Ws.publicKeyFromAsn1=function(e){var t={},r=[];if($s.validate(e,Zs,t,r)){var n,i=$s.derToOid(t.publicKeyOid);if(i!==Ws.oids.rsaEncryption)throw(n=new Error("Cannot read public key. Unknown OID.")).oid=i,n;e=t.rsaPublicKey}if(r=[],!$s.validate(e,Xs,t,r))throw(n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,n;var o=qa.util.createBuffer(t.publicKeyModulus).toHex(),a=qa.util.createBuffer(t.publicKeyExponent).toHex();return Ws.setRsaPublicKey(new qs(o,16),new qs(a,16))},Ws.publicKeyToAsn1=Ws.publicKeyToSubjectPublicKeyInfo=function(e){return $s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[$s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[$s.create($s.Class.UNIVERSAL,$s.Type.OID,!1,$s.oidToDer(Ws.oids.rsaEncryption).getBytes()),$s.create($s.Class.UNIVERSAL,$s.Type.NULL,!1,"")]),$s.create($s.Class.UNIVERSAL,$s.Type.BITSTRING,!1,[Ws.publicKeyToRSAPublicKey(e)])])},Ws.publicKeyToRSAPublicKey=function(e){return $s.create($s.Class.UNIVERSAL,$s.Type.SEQUENCE,!0,[$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.n)),$s.create($s.Class.UNIVERSAL,$s.Type.INTEGER,!1,ou(e.e))])},u((function(e){var t=qa.asn1,r=e.exports=qa.pki=qa.pki||{},n=r.oids,i={};i.CN=n.commonName,i.commonName="CN",i.C=n.countryName,i.countryName="C",i.L=n.localityName,i.localityName="L",i.ST=n.stateOrProvinceName,i.stateOrProvinceName="ST",i.O=n.organizationName,i.organizationName="O",i.OU=n.organizationalUnitName,i.organizationalUnitName="OU",i.E=n.emailAddress,i.emailAddress="E";var o=qa.pki.rsa.publicKeyValidator,a={name:"Certificate",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:t.Class.UNIVERSAL,type:t.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:t.Class.UNIVERSAL,type:t.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:t.Class.UNIVERSAL,type:t.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:t.Class.UNIVERSAL,type:t.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},o,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:t.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:t.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},s={name:"rsapss",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:t.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:t.Class.UNIVERSAL,type:t.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:t.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:t.Class.UNIVERSAL,type:t.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},u={name:"CertificationRequestInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},o,{name:"CertificationRequestInfo.attributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0}]}]}]},c={name:"CertificationRequest",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[u,{name:"CertificationRequest.signatureAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function l(e,t){"string"==typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}r.RDNAttributesAsArray=function(e,r){for(var o,a,s,u=[],c=0;c<e.value.length;++c){o=e.value[c];for(var l=0;l<o.value.length;++l)s={},a=o.value[l],s.type=t.derToOid(a.value[0].value),s.value=a.value[1].value,s.valueTagClass=a.value[1].type,s.type in n&&(s.name=n[s.type],s.name in i&&(s.shortName=i[s.name])),r&&(r.update(s.type),r.update(s.value)),u.push(s)}return u},r.CRIAttributesAsArray=function(e){for(var o=[],a=0;a<e.length;++a)for(var s=e[a],u=t.derToOid(s.value[0].value),c=s.value[1].value,l=0;l<c.length;++l){var f={};if(f.type=u,f.value=c[l].value,f.valueTagClass=c[l].type,f.type in n&&(f.name=n[f.type],f.name in i&&(f.shortName=i[f.name])),f.type===n.extensionRequest){f.extensions=[];for(var h=0;h<f.value.length;++h)f.extensions.push(r.certificateExtensionFromAsn1(f.value[h]))}o.push(f)}return o};var f=function(e,r,i){var o={};if(e!==n["RSASSA-PSS"])return o;i&&(o={hash:{algorithmOid:n.sha1},mgf:{algorithmOid:n.mgf1,hash:{algorithmOid:n.sha1}},saltLength:20});var a={},u=[];if(!t.validate(r,s,a,u)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=u,c}return void 0!==a.hashOid&&(o.hash=o.hash||{},o.hash.algorithmOid=t.derToOid(a.hashOid)),void 0!==a.maskGenOid&&(o.mgf=o.mgf||{},o.mgf.algorithmOid=t.derToOid(a.maskGenOid),o.mgf.hash=o.mgf.hash||{},o.mgf.hash.algorithmOid=t.derToOid(a.maskGenHashOid)),void 0!==a.saltLength&&(o.saltLength=a.saltLength.charCodeAt(0)),o};function h(e){for(var r,n,i=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){var s=(r=o[a]).value,u=t.Type.PRINTABLESTRING;"valueTagClass"in r&&(u=r.valueTagClass)===t.Type.UTF8&&(s=qa.util.encodeUtf8(s)),n=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.type).getBytes()),t.create(t.Class.UNIVERSAL,u,!1,s)])]),i.value.push(n)}return i}function p(e){for(var o,a=0;a<e.length;++a){if(void 0===(o=e[a]).name&&(o.type&&o.type in r.oids?o.name=r.oids[o.type]:o.shortName&&o.shortName in i&&(o.name=r.oids[i[o.shortName]])),void 0===o.type){if(!o.name||!(o.name in r.oids))throw(u=new Error("Attribute type not specified.")).attribute=o,u;o.type=r.oids[o.name]}if(void 0===o.shortName&&o.name&&o.name in i&&(o.shortName=i[o.name]),o.type===n.extensionRequest&&(o.valueConstructed=!0,o.valueTagClass=t.Type.SEQUENCE,!o.value&&o.extensions)){o.value=[];for(var s=0;s<o.extensions.length;++s)o.value.push(r.certificateExtensionToAsn1(d(o.extensions[s])))}var u;if(void 0===o.value)throw(u=new Error("Attribute value not specified.")).attribute=o,u}}function d(e,i){if(i=i||{},void 0===e.name&&e.id&&e.id in r.oids&&(e.name=r.oids[e.id]),void 0===e.id){if(!e.name||!(e.name in r.oids))throw(E=new Error("Extension ID not specified.")).extension=e,E;e.id=r.oids[e.name]}if(void 0!==e.value)return e;if("keyUsage"===e.name){var o=0,a=0,s=0;e.digitalSignature&&(a|=128,o=7),e.nonRepudiation&&(a|=64,o=6),e.keyEncipherment&&(a|=32,o=5),e.dataEncipherment&&(a|=16,o=4),e.keyAgreement&&(a|=8,o=3),e.keyCertSign&&(a|=4,o=2),e.cRLSign&&(a|=2,o=1),e.encipherOnly&&(a|=1,o=0),e.decipherOnly&&(s|=128,o=7);var u=String.fromCharCode(o);0!==s?u+=String.fromCharCode(a)+String.fromCharCode(s):0!==a&&(u+=String.fromCharCode(a)),e.value=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(t.create(t.Class.UNIVERSAL,t.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);var c=e.value.value;for(var l in e)!0===e[l]&&(l in n?c.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n[l]).getBytes())):-1!==l.indexOf(".")&&c.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(l).getBytes())))}else if("nsCertType"===e.name){o=0,a=0;e.client&&(a|=128,o=7),e.server&&(a|=64,o=6),e.email&&(a|=32,o=5),e.objsign&&(a|=16,o=4),e.reserved&&(a|=8,o=3),e.sslCA&&(a|=4,o=2),e.emailCA&&(a|=2,o=1),e.objCA&&(a|=1,o=0);u=String.fromCharCode(o);0!==a&&(u+=String.fromCharCode(a)),e.value=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);for(var f=0;f<e.altNames.length;++f){u=(v=e.altNames[f]).value;if(7===v.type&&v.ip){if(null===(u=qa.util.bytesFromIP(v.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===v.type&&(u=v.oid?t.oidToDer(t.oidToDer(v.oid)):t.oidToDer(u));e.value.value.push(t.create(t.Class.CONTEXT_SPECIFIC,v.type,!1,u))}}else if("nsComment"===e.name&&i.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=t.create(t.Class.UNIVERSAL,t.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&i.cert){var p=i.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=p.toHex(),e.value=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,p.getBytes())}else if("authorityKeyIdentifier"===e.name&&i.cert){e.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);c=e.value.value;if(e.keyIdentifier){var d=!0===e.keyIdentifier?i.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;c.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var g=[t.create(t.Class.CONTEXT_SPECIFIC,4,!0,[h(!0===e.authorityCertIssuer?i.cert.issuer:e.authorityCertIssuer)])];c.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,g))}if(e.serialNumber){var y=qa.util.hexToBytes(!0===e.serialNumber?i.cert.serialNumber:e.serialNumber);c.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!1,y))}}else if("cRLDistributionPoints"===e.name){e.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);c=e.value.value;var v,m=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),b=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]);for(f=0;f<e.altNames.length;++f){u=(v=e.altNames[f]).value;if(7===v.type&&v.ip){if(null===(u=qa.util.bytesFromIP(v.ip)))throw(E=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,E}else 8===v.type&&(u=v.oid?t.oidToDer(t.oidToDer(v.oid)):t.oidToDer(u));b.value.push(t.create(t.Class.CONTEXT_SPECIFIC,v.type,!1,u))}m.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[b])),c.push(m)}var E;if(void 0===e.value)throw(E=new Error("Extension value not specified.")).extension=e,E;return e}function g(e,r){switch(e){case n["RSASSA-PSS"]:var i=[];return void 0!==r.hash.algorithmOid&&i.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.hash.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])])),void 0!==r.mgf.algorithmOid&&i.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.mgf.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.mgf.hash.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])])])),void 0!==r.saltLength&&i.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(r.saltLength).getBytes())])),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,i);default:return t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")}}function y(e){var r=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return r;for(var n=e.attributes,i=0;i<n.length;++i){var o=n[i],a=o.value,s=t.Type.UTF8;"valueTagClass"in o&&(s=o.valueTagClass),s===t.Type.UTF8&&(a=qa.util.encodeUtf8(a));var u=!1;"valueConstructed"in o&&(u=o.valueConstructed);var c=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(o.type).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,s,u,a)])]);r.value.push(c)}return r}r.certificateFromPem=function(e,n,i){var o=qa.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=t.fromDer(o.body,i);return r.certificateFromAsn1(s,n)},r.certificateToPem=function(e,n){var i={type:"CERTIFICATE",body:t.toDer(r.certificateToAsn1(e)).getBytes()};return qa.pem.encode(i,{maxline:n})},r.publicKeyFromPem=function(e){var n=qa.pem.decode(e)[0];if("PUBLIC KEY"!==n.type&&"RSA PUBLIC KEY"!==n.type){var i=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw i.headerType=n.type,i}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=t.fromDer(n.body);return r.publicKeyFromAsn1(o)},r.publicKeyToPem=function(e,n){var i={type:"PUBLIC KEY",body:t.toDer(r.publicKeyToAsn1(e)).getBytes()};return qa.pem.encode(i,{maxline:n})},r.publicKeyToRSAPublicKeyPem=function(e,n){var i={type:"RSA PUBLIC KEY",body:t.toDer(r.publicKeyToRSAPublicKey(e)).getBytes()};return qa.pem.encode(i,{maxline:n})},r.getPublicKeyFingerprint=function(e,n){var i,o=(n=n||{}).md||qa.md.sha1.create();switch(n.type||"RSAPublicKey"){case"RSAPublicKey":i=t.toDer(r.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":i=t.toDer(r.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+n.type+'".')}o.start(),o.update(i);var a=o.digest();if("hex"===n.encoding){var s=a.toHex();return n.delimiter?s.match(/.{2}/g).join(n.delimiter):s}if("binary"===n.encoding)return a.getBytes();if(n.encoding)throw new Error('Unknown encoding "'+n.encoding+'".');return a},r.certificationRequestFromPem=function(e,n,i){var o=qa.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=t.fromDer(o.body,i);return r.certificationRequestFromAsn1(s,n)},r.certificationRequestToPem=function(e,n){var i={type:"CERTIFICATE REQUEST",body:t.toDer(r.certificationRequestToAsn1(e)).getBytes()};return qa.pem.encode(i,{maxline:n})},r.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return l(e.issuer,t)},e.issuer.addField=function(t){p([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return l(e.subject,t)},e.subject.addField=function(t){p([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){p(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){p(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)d(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"==typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(i,o){e.md=o||qa.md.sha1.create();var a=n[e.md.algorithm+"WithRSAEncryption"];if(!a){var s=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw s.algorithm=e.md.algorithm,s}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=r.getTBSCertificate(e);var u=t.toDer(e.tbsCertificate);e.md.update(u.getBytes()),e.signature=i.sign(e.md)},e.verify=function(i){var o=!1;if(!e.issued(i)){var a=i.issuer,s=e.subject;throw(d=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.")).expectedIssuer=a.attributes,d.actualIssuer=s.attributes,d}var u=i.md;if(null===u){if(i.signatureOid in n)switch(n[i.signatureOid]){case"sha1WithRSAEncryption":u=qa.md.sha1.create();break;case"md5WithRSAEncryption":u=qa.md.md5.create();break;case"sha256WithRSAEncryption":u=qa.md.sha256.create();break;case"sha384WithRSAEncryption":u=qa.md.sha384.create();break;case"sha512WithRSAEncryption":u=qa.md.sha512.create();break;case"RSASSA-PSS":u=qa.md.sha256.create()}if(null===u)throw(d=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=i.signatureOid,d;var c=i.tbsCertificate||r.getTBSCertificate(i),l=t.toDer(c);u.update(l.getBytes())}if(null!==u){var f;switch(i.signatureOid){case n.sha1WithRSAEncryption:f=void 0;break;case n["RSASSA-PSS"]:var h,p,d;if(void 0===(h=n[i.signatureParameters.mgf.hash.algorithmOid])||void 0===qa.md[h])throw(d=new Error("Unsupported MGF hash function.")).oid=i.signatureParameters.mgf.hash.algorithmOid,d.name=h,d;if(void 0===(p=n[i.signatureParameters.mgf.algorithmOid])||void 0===qa.mgf[p])throw(d=new Error("Unsupported MGF function.")).oid=i.signatureParameters.mgf.algorithmOid,d.name=p,d;if(p=qa.mgf[p].create(qa.md[h].create()),void 0===(h=n[i.signatureParameters.hash.algorithmOid])||void 0===qa.md[h])throw{message:"Unsupported RSASSA-PSS hash function.",oid:i.signatureParameters.hash.algorithmOid,name:h};f=qa.pss.create(qa.md[h].create(),p,i.signatureParameters.saltLength)}o=e.publicKey.verify(u.digest().getBytes(),i.signature,f)}return o},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var o,a;r=!0;for(var s=0;r&&s<n.attributes.length;++s)o=n.attributes[s],a=i.attributes[s],o.type===a.type&&o.value===a.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return r.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=n.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var o=e.generateSubjectKeyIdentifier().getBytes();return qa.util.hexToBytes(i.subjectKeyIdentifier)===o}}return!1},e},r.certificateFromAsn1=function(e,i){var o={},s=[];if(!t.validate(e,a,o,s))throw(d=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.")).errors=s,d;if(t.derToOid(o.publicKeyOid)!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var u=r.createCertificate();u.version=o.certVersion?o.certVersion.charCodeAt(0):0;var c=qa.util.createBuffer(o.certSerialNumber);u.serialNumber=c.toHex(),u.signatureOid=qa.asn1.derToOid(o.certSignatureOid),u.signatureParameters=f(u.signatureOid,o.certSignatureParams,!0),u.siginfo.algorithmOid=qa.asn1.derToOid(o.certinfoSignatureOid),u.siginfo.parameters=f(u.siginfo.algorithmOid,o.certinfoSignatureParams,!1),u.signature=o.certSignature;var h=[];if(void 0!==o.certValidity1UTCTime&&h.push(t.utcTimeToDate(o.certValidity1UTCTime)),void 0!==o.certValidity2GeneralizedTime&&h.push(t.generalizedTimeToDate(o.certValidity2GeneralizedTime)),void 0!==o.certValidity3UTCTime&&h.push(t.utcTimeToDate(o.certValidity3UTCTime)),void 0!==o.certValidity4GeneralizedTime&&h.push(t.generalizedTimeToDate(o.certValidity4GeneralizedTime)),h.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(h.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(u.validity.notBefore=h[0],u.validity.notAfter=h[1],u.tbsCertificate=o.tbsCertificate,i){var d;if(u.md=null,u.signatureOid in n)switch(n[u.signatureOid]){case"sha1WithRSAEncryption":u.md=qa.md.sha1.create();break;case"md5WithRSAEncryption":u.md=qa.md.md5.create();break;case"sha256WithRSAEncryption":u.md=qa.md.sha256.create();break;case"sha384WithRSAEncryption":u.md=qa.md.sha384.create();break;case"sha512WithRSAEncryption":u.md=qa.md.sha512.create();break;case"RSASSA-PSS":u.md=qa.md.sha256.create()}if(null===u.md)throw(d=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=u.signatureOid,d;var g=t.toDer(u.tbsCertificate);u.md.update(g.getBytes())}var y=qa.md.sha1.create();u.issuer.getField=function(e){return l(u.issuer,e)},u.issuer.addField=function(e){p([e]),u.issuer.attributes.push(e)},u.issuer.attributes=r.RDNAttributesAsArray(o.certIssuer,y),o.certIssuerUniqueId&&(u.issuer.uniqueId=o.certIssuerUniqueId),u.issuer.hash=y.digest().toHex();var v=qa.md.sha1.create();return u.subject.getField=function(e){return l(u.subject,e)},u.subject.addField=function(e){p([e]),u.subject.attributes.push(e)},u.subject.attributes=r.RDNAttributesAsArray(o.certSubject,v),o.certSubjectUniqueId&&(u.subject.uniqueId=o.certSubjectUniqueId),u.subject.hash=v.digest().toHex(),o.certExtensions?u.extensions=r.certificateExtensionsFromAsn1(o.certExtensions):u.extensions=[],u.publicKey=r.publicKeyFromAsn1(o.subjectPublicKeyInfo),u},r.certificateExtensionsFromAsn1=function(e){for(var t=[],n=0;n<e.value.length;++n)for(var i=e.value[n],o=0;o<i.value.length;++o)t.push(r.certificateExtensionFromAsn1(i.value[o]));return t},r.certificateExtensionFromAsn1=function(e){var r={};if(r.id=t.derToOid(e.value[0].value),r.critical=!1,e.value[1].type===t.Type.BOOLEAN?(r.critical=0!==e.value[1].value.charCodeAt(0),r.value=e.value[2].value):r.value=e.value[1].value,r.id in n)if(r.name=n[r.id],"keyUsage"===r.name){var i=0,o=0;(s=t.fromDer(r.value)).value.length>1&&(i=s.value.charCodeAt(1),o=s.value.length>2?s.value.charCodeAt(2):0),r.digitalSignature=128==(128&i),r.nonRepudiation=64==(64&i),r.keyEncipherment=32==(32&i),r.dataEncipherment=16==(16&i),r.keyAgreement=8==(8&i),r.keyCertSign=4==(4&i),r.cRLSign=2==(2&i),r.encipherOnly=1==(1&i),r.decipherOnly=128==(128&o)}else if("basicConstraints"===r.name){(s=t.fromDer(r.value)).value.length>0&&s.value[0].type===t.Type.BOOLEAN?r.cA=0!==s.value[0].value.charCodeAt(0):r.cA=!1;var a=null;s.value.length>0&&s.value[0].type===t.Type.INTEGER?a=s.value[0].value:s.value.length>1&&(a=s.value[1].value),null!==a&&(r.pathLenConstraint=t.derToInteger(a))}else if("extKeyUsage"===r.name)for(var s=t.fromDer(r.value),u=0;u<s.value.length;++u){var c=t.derToOid(s.value[u].value);c in n?r[n[c]]=!0:r[c]=!0}else if("nsCertType"===r.name){i=0;(s=t.fromDer(r.value)).value.length>1&&(i=s.value.charCodeAt(1)),r.client=128==(128&i),r.server=64==(64&i),r.email=32==(32&i),r.objsign=16==(16&i),r.reserved=8==(8&i),r.sslCA=4==(4&i),r.emailCA=2==(2&i),r.objCA=1==(1&i)}else if("subjectAltName"===r.name||"issuerAltName"===r.name){var l;r.altNames=[];s=t.fromDer(r.value);for(var f=0;f<s.value.length;++f){var h={type:(l=s.value[f]).type,value:l.value};switch(r.altNames.push(h),l.type){case 1:case 2:case 6:break;case 7:h.ip=qa.util.bytesToIP(l.value);break;case 8:h.oid=t.derToOid(l.value)}}}else if("subjectKeyIdentifier"===r.name){s=t.fromDer(r.value);r.subjectKeyIdentifier=qa.util.bytesToHex(s.value)}return r},r.certificationRequestFromAsn1=function(e,i){var o={},a=[];if(!t.validate(e,c,o,a))throw(u=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.")).errors=a,u;if(t.derToOid(o.publicKeyOid)!==r.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=r.createCertificationRequest();if(s.version=o.csrVersion?o.csrVersion.charCodeAt(0):0,s.signatureOid=qa.asn1.derToOid(o.csrSignatureOid),s.signatureParameters=f(s.signatureOid,o.csrSignatureParams,!0),s.siginfo.algorithmOid=qa.asn1.derToOid(o.csrSignatureOid),s.siginfo.parameters=f(s.siginfo.algorithmOid,o.csrSignatureParams,!1),s.signature=o.csrSignature,s.certificationRequestInfo=o.certificationRequestInfo,i){var u;if(s.md=null,s.signatureOid in n)switch(n[s.signatureOid]){case"sha1WithRSAEncryption":s.md=qa.md.sha1.create();break;case"md5WithRSAEncryption":s.md=qa.md.md5.create();break;case"sha256WithRSAEncryption":s.md=qa.md.sha256.create();break;case"sha384WithRSAEncryption":s.md=qa.md.sha384.create();break;case"sha512WithRSAEncryption":s.md=qa.md.sha512.create();break;case"RSASSA-PSS":s.md=qa.md.sha256.create()}if(null===s.md)throw(u=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=s.signatureOid,u;var h=t.toDer(s.certificationRequestInfo);s.md.update(h.getBytes())}var d=qa.md.sha1.create();return s.subject.getField=function(e){return l(s.subject,e)},s.subject.addField=function(e){p([e]),s.subject.attributes.push(e)},s.subject.attributes=r.RDNAttributesAsArray(o.certificationRequestInfoSubject,d),s.subject.hash=d.digest().toHex(),s.publicKey=r.publicKeyFromAsn1(o.subjectPublicKeyInfo),s.getAttribute=function(e){return l(s,e)},s.addAttribute=function(e){p([e]),s.attributes.push(e)},s.attributes=r.CRIAttributesAsArray(o.certificationRequestInfoAttributes||[]),s},r.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return l(e.subject,t)},e.subject.addField=function(t){p([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return l(e,t)},e.addAttribute=function(t){p([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){p(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){p(t),e.attributes=t},e.sign=function(i,o){e.md=o||qa.md.sha1.create();var a=n[e.md.algorithm+"WithRSAEncryption"];if(!a){var s=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw s.algorithm=e.md.algorithm,s}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=r.getCertificationRequestInfo(e);var u=t.toDer(e.certificationRequestInfo);e.md.update(u.getBytes()),e.signature=i.sign(e.md)},e.verify=function(){var i=!1,o=e.md;if(null===o){if(e.signatureOid in n)switch(n[e.signatureOid]){case"sha1WithRSAEncryption":o=qa.md.sha1.create();break;case"md5WithRSAEncryption":o=qa.md.md5.create();break;case"sha256WithRSAEncryption":o=qa.md.sha256.create();break;case"sha384WithRSAEncryption":o=qa.md.sha384.create();break;case"sha512WithRSAEncryption":o=qa.md.sha512.create();break;case"RSASSA-PSS":o=qa.md.sha256.create()}if(null===o)throw(f=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=e.signatureOid,f;var a=e.certificationRequestInfo||r.getCertificationRequestInfo(e),s=t.toDer(a);o.update(s.getBytes())}if(null!==o){var u;switch(e.signatureOid){case n.sha1WithRSAEncryption:break;case n["RSASSA-PSS"]:var c,l,f;if(void 0===(c=n[e.signatureParameters.mgf.hash.algorithmOid])||void 0===qa.md[c])throw(f=new Error("Unsupported MGF hash function.")).oid=e.signatureParameters.mgf.hash.algorithmOid,f.name=c,f;if(void 0===(l=n[e.signatureParameters.mgf.algorithmOid])||void 0===qa.mgf[l])throw(f=new Error("Unsupported MGF function.")).oid=e.signatureParameters.mgf.algorithmOid,f.name=l,f;if(l=qa.mgf[l].create(qa.md[c].create()),void 0===(c=n[e.signatureParameters.hash.algorithmOid])||void 0===qa.md[c])throw(f=new Error("Unsupported RSASSA-PSS hash function.")).oid=e.signatureParameters.hash.algorithmOid,f.name=c,f;u=qa.pss.create(qa.md[c].create(),l,e.signatureParameters.saltLength)}i=e.publicKey.verify(o.digest().getBytes(),e.signature,u)}return i},e};var v=new Date("1950-01-01T00:00:00Z"),m=new Date("2050-01-01T00:00:00Z");function b(e){return e>=v&&e<m?t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(e)):t.create(t.Class.UNIVERSAL,t.Type.GENERALIZEDTIME,!1,t.dateToGeneralizedTime(e))}r.getTBSCertificate=function(e){var n=b(e.validity.notBefore),i=b(e.validity.notAfter),o=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.version).getBytes())]),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,qa.util.hexToBytes(e.serialNumber)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.siginfo.algorithmOid).getBytes()),g(e.siginfo.algorithmOid,e.siginfo.parameters)]),h(e.issuer),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[n,i]),h(e.subject),r.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(r.certificateExtensionsToAsn1(e.extensions)),o},r.getCertificationRequestInfo=function(e){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.version).getBytes()),h(e.subject),r.publicKeyToAsn1(e.publicKey),y(e)])},r.distinguishedNameToAsn1=function(e){return h(e)},r.certificateToAsn1=function(e){var n=e.tbsCertificate||r.getTBSCertificate(e);return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[n,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.signatureOid).getBytes()),g(e.signatureOid,e.signatureParameters)]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},r.certificateExtensionsToAsn1=function(e){var n=t.create(t.Class.CONTEXT_SPECIFIC,3,!0,[]),i=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);n.value.push(i);for(var o=0;o<e.length;++o)i.value.push(r.certificateExtensionToAsn1(e[o]));return n},r.certificateExtensionToAsn1=function(e){var r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);r.value.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.id).getBytes())),e.critical&&r.value.push(t.create(t.Class.UNIVERSAL,t.Type.BOOLEAN,!1,String.fromCharCode(255)));var n=e.value;return"string"!=typeof e.value&&(n=t.toDer(n).getBytes()),r.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n)),r},r.certificationRequestToAsn1=function(e){var n=e.certificationRequestInfo||r.getCertificationRequestInfo(e);return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[n,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.signatureOid).getBytes()),g(e.signatureOid,e.signatureParameters)]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},r.createCaStore=function(e){var n={certs:{}};function i(e){return o(e),n.certs[e.hash]||null}function o(e){if(!e.hash){var t=qa.md.sha1.create();e.attributes=r.RDNAttributesAsArray(h(e),t),e.hash=t.digest().toHex()}}if(n.getIssuer=function(e){return i(e.issuer)},n.addCertificate=function(e){if("string"==typeof e&&(e=qa.pki.certificateFromPem(e)),o(e.subject),!n.hasCertificate(e))if(e.subject.hash in n.certs){var t=n.certs[e.subject.hash];qa.util.isArray(t)||(t=[t]),t.push(e),n.certs[e.subject.hash]=t}else n.certs[e.subject.hash]=e},n.hasCertificate=function(e){"string"==typeof e&&(e=qa.pki.certificateFromPem(e));var n=i(e.subject);if(!n)return!1;qa.util.isArray(n)||(n=[n]);for(var o=t.toDer(r.certificateToAsn1(e)).getBytes(),a=0;a<n.length;++a){if(o===t.toDer(r.certificateToAsn1(n[a])).getBytes())return!0}return!1},n.listAllCertificates=function(){var e=[];for(var t in n.certs)if(n.certs.hasOwnProperty(t)){var r=n.certs[t];if(qa.util.isArray(r))for(var i=0;i<r.length;++i)e.push(r[i]);else e.push(r)}return e},n.removeCertificate=function(e){var a;if("string"==typeof e&&(e=qa.pki.certificateFromPem(e)),o(e.subject),!n.hasCertificate(e))return null;var s=i(e.subject);if(!qa.util.isArray(s))return a=n.certs[e.subject.hash],delete n.certs[e.subject.hash],a;for(var u=t.toDer(r.certificateToAsn1(e)).getBytes(),c=0;c<s.length;++c){u===t.toDer(r.certificateToAsn1(s[c])).getBytes()&&(a=s[c],s.splice(c,1))}return 0===s.length&&delete n.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var s=e[a];n.addCertificate(s)}return n},r.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},r.verifyCertificateChain=function(e,t,n){"function"==typeof n&&(n={verify:n}),n=n||{};var i=(t=t.slice(0)).slice(0),o=n.validityCheckDate;void 0===o&&(o=new Date);var a=!0,s=null,u=0;do{var c=t.shift(),l=null,f=!1;if(o&&(o<c.validity.notBefore||o>c.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:r.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:o}),null===s){if(null===(l=t[0]||e.getIssuer(c))&&c.isIssuer(c)&&(f=!0,l=c),l){var h=l;qa.util.isArray(h)||(h=[h]);for(var p=!1;!p&&h.length>0;){l=h.shift();try{p=l.verify(c)}catch(S){}}p||(s={message:"Certificate signature is invalid.",error:r.certificateError.bad_certificate})}null!==s||l&&!f||e.hasCertificate(c)||(s={message:"Certificate is not trusted.",error:r.certificateError.unknown_ca})}if(null===s&&l&&!c.isIssuer(l)&&(s={message:"Certificate issuer is invalid.",error:r.certificateError.bad_certificate}),null===s)for(var d={keyUsage:!0,basicConstraints:!0},g=0;null===s&&g<c.extensions.length;++g){var y=c.extensions[g];y.critical&&!(y.name in d)&&(s={message:"Certificate has an unsupported critical extension.",error:r.certificateError.unsupported_certificate})}if(null===s&&(!a||0===t.length&&(!l||f))){var v=c.getExtension("basicConstraints"),m=c.getExtension("keyUsage");if(null!==m&&(m.keyCertSign&&null!==v||(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:r.certificateError.bad_certificate})),null!==s||null===v||v.cA||(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:r.certificateError.bad_certificate}),null===s&&null!==m&&"pathLenConstraint"in v)u-1>v.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:r.certificateError.bad_certificate})}var b=null===s||s.error,E=n.verify?n.verify(b,u,i):b;if(!0!==E)throw!0===b&&(s={message:"The application rejected the certificate.",error:r.certificateError.bad_certificate}),(E||0===E)&&("object"!=typeof E||qa.util.isArray(E)?"string"==typeof E&&(s.error=E):(E.message&&(s.message=E.message),E.error&&(s.error=E.error))),s;s=null,a=!1,++u}while(t.length>0);return!0}})),u((function(e){var t=qa.asn1,r=e.exports=qa.pkcs7=qa.pkcs7||{};function n(e){var n={},i=[];if(!t.validate(e,r.asn1.recipientInfoValidator,n,i)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=i,o}return{version:n.version.charCodeAt(0),issuer:qa.pki.RDNAttributesAsArray(n.issuer),serialNumber:qa.util.createBuffer(n.serial).toHex(),encryptedContent:{algorithm:t.derToOid(n.encAlgorithm),parameter:n.encParameter.value,content:n.encKey}}}function i(e){for(var r,n=[],i=0;i<e.length;++i)n.push((r=e[i],t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(r.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[qa.pki.distinguishedNameToAsn1({attributes:r.issuer}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,qa.util.hexToBytes(r.serialNumber))]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.encryptedContent.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,r.encryptedContent.content)])));return n}function o(e){var r=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[qa.pki.distinguishedNameToAsn1({attributes:e.issuer}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,qa.util.hexToBytes(e.serialNumber))]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.digestAlgorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&r.value.push(e.authenticatedAttributesAsn1),r.value.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.signatureAlgorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])),r.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var n=t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<e.unauthenticatedAttributes.length;++i){var o=e.unauthenticatedAttributes[i];n.values.push(a(o))}r.value.push(n)}return r}function a(e){var r;if(e.type===qa.pki.oids.contentType)r=t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.value).getBytes());else if(e.type===qa.pki.oids.messageDigest)r=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===qa.pki.oids.signingTime){var n=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"==typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?t.utcTimeToDate(o):t.generalizedTimeToDate(o):new Date(a)}r=o>=n&&o<i?t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(o)):t.create(t.Class.UNIVERSAL,t.Type.GENERALIZEDTIME,!1,t.dateToGeneralizedTime(o))}return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.type).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[r])])}function s(e,r,n){var i={};if(!t.validate(r,n,i,[])){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}if(t.derToOid(i.contentType)!==qa.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(qa.util.isArray(i.encryptedContent))for(var s=0;s<i.encryptedContent.length;++s){if(i.encryptedContent[s].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[s].value}else a=i.encryptedContent;e.encryptedContent={algorithm:t.derToOid(i.encAlgorithm),parameter:qa.util.createBuffer(i.encParameter.value),content:qa.util.createBuffer(a)}}if(i.content){a="";if(qa.util.isArray(i.content))for(s=0;s<i.content.length;++s){if(i.content[s].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[s].value}else a=i.content;e.content=qa.util.createBuffer(a)}return e.version=i.version.charCodeAt(0),e.rawCapture=i,i}function u(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case qa.pki.oids["aes128-CBC"]:case qa.pki.oids["aes192-CBC"]:case qa.pki.oids["aes256-CBC"]:t=qa.aes.createDecryptionCipher(e.encryptedContent.key);break;case qa.pki.oids.desCBC:case qa.pki.oids["des-EDE3-CBC"]:t=qa.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}r.messageFromPem=function(e){var n=qa.pem.decode(e)[0];if("PKCS7"!==n.type){var i=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw i.headerType=n.type,i}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=t.fromDer(n.body);return r.messageFromAsn1(o)},r.messageToPem=function(e,r){var n={type:"PKCS7",body:t.toDer(e.toAsn1()).getBytes()};return qa.pem.encode(n,{maxline:r})},r.messageFromAsn1=function(e){var n={},i=[];if(!t.validate(e,r.asn1.contentInfoValidator,n,i)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=i,o}var a,s=t.derToOid(n.contentType);switch(s){case qa.pki.oids.envelopedData:a=r.createEnvelopedData();break;case qa.pki.oids.encryptedData:a=r.createEncryptedData();break;case qa.pki.oids.signedData:a=r.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return a.fromAsn1(n.content.value[0]),a},r.createSignedData=function(){var e=null;return e={type:qa.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(s(e,t,r.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var n=e.rawCapture.certificates.value,i=0;i<n.length;++i)e.certificates.push(qa.pki.certificateFromAsn1(n[i]))},toAsn1:function(){e.contentInfo||e.sign();for(var r=[],n=0;n<e.certificates.length;++n)r.push(qa.pki.certificateToAsn1(e.certificates[n]));var i=[],o=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return r.length>0&&o.value[0].value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,r)),i.length>0&&o.value[0].value.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,i)),o.value[0].value.push(t.create(t.Class.UNIVERSAL,t.Type.SET,!0,e.signerInfos)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var r=t.issuer,n=t.serialNumber;if(t.certificate){var i=t.certificate;"string"==typeof i&&(i=qa.pki.certificateFromPem(i)),r=i.issuer.attributes,n=i.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"==typeof o&&(o=qa.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||qa.pki.oids.sha1;switch(a){case qa.pki.oids.sha1:case qa.pki.oids.sha256:case qa.pki.oids.sha384:case qa.pki.oids.sha512:case qa.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var s=t.authenticatedAttributes||[];if(s.length>0){for(var u=!1,c=!1,l=0;l<s.length;++l){var f=s[l];if(u||f.type!==qa.pki.oids.contentType){if(c||f.type!==qa.pki.oids.messageDigest);else if(c=!0,u)break}else if(u=!0,c)break}if(!u||!c)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:r,serialNumber:n,digestAlgorithm:a,signatureAlgorithm:qa.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:s,unauthenticatedAttributes:[]})},sign:function(r){var n;(r=r||{},"object"!=typeof e.content||null===e.contentInfo)&&(e.contentInfo=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(qa.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof qa.util.ByteBuffer?n=e.content.bytes():"string"==typeof e.content&&(n=qa.util.encodeUtf8(e.content)),r.detached?e.detachedContent=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n):e.contentInfo.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,n)]))));0!==e.signers.length&&function(r){var n;n=e.detachedContent?e.detachedContent:(n=e.contentInfo.value[1]).value[0];if(!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=t.derToOid(e.contentInfo.value[0].value),s=t.toDer(n);for(var u in s.getByte(),t.getBerValueLength(s),s=s.getBytes(),r)r[u].start().update(s);for(var c=new Date,l=0;l<e.signers.length;++l){var f=e.signers[l];if(0===f.authenticatedAttributes.length){if(i!==qa.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[]),p=0;p<f.authenticatedAttributes.length;++p){var d=f.authenticatedAttributes[p];d.type===qa.pki.oids.messageDigest?d.value=r[f.digestAlgorithm].digest():d.type===qa.pki.oids.signingTime&&(d.value||(d.value=c)),h.value.push(a(d)),f.authenticatedAttributesAsn1.value.push(a(d))}s=t.toDer(h).getBytes(),f.md.start().update(s)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(e.signers)}(function(){for(var r={},n=0;n<e.signers.length;++n){var i=e.signers[n];(o=i.digestAlgorithm)in r||(r[o]=qa.md[qa.pki.oids[o]].create()),0===i.authenticatedAttributes.length?i.md=r[o]:i.md=qa.md[qa.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],r)e.digestAlgorithmIdentifiers.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(o).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]));return r}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"==typeof t&&(t=qa.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},r.createEncryptedData=function(){var e=null;return e={type:qa.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:qa.pki.oids["aes256-CBC"]},fromAsn1:function(t){s(e,t,r.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),u(e)}}},r.createEnvelopedData=function(){var e=null;return e={type:qa.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:qa.pki.oids["aes256-CBC"]},fromAsn1:function(t){var i=s(e,t,r.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(n(e[r]));return t}(i.recipientInfos.value)},toAsn1:function(){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(e.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(e.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,i(e.recipients)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,(r=e.encryptedContent,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(qa.pki.oids.data).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,r.parameter.getBytes())]),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,r.content.getBytes())])]))])])]);var r},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],o=i.issuer;if(i.serialNumber===t.serialNumber&&o.length===r.length){for(var a=!0,s=0;s<r.length;++s)if(o[s].type!==r[s].type||o[s].value!==r[s].value){a=!1;break}if(a)return i}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case qa.pki.oids.rsaEncryption:case qa.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=qa.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}u(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:qa.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var n,i,o;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case qa.pki.oids["aes128-CBC"]:n=16,i=16,o=qa.aes.createEncryptionCipher;break;case qa.pki.oids["aes192-CBC"]:n=24,i=16,o=qa.aes.createEncryptionCipher;break;case qa.pki.oids["aes256-CBC"]:n=32,i=16,o=qa.aes.createEncryptionCipher;break;case qa.pki.oids["des-EDE3-CBC"]:n=24,i=8,o=qa.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=qa.util.createBuffer(qa.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=qa.util.createBuffer(qa.random.getBytes(i));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var s=0;s<e.recipients.length;++s){var u=e.recipients[s];if(void 0===u.encryptedContent.content)switch(u.encryptedContent.algorithm){case qa.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}}}}));var fu=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],hu=[1,2,3,5],pu=function(e,t){return e<<t&65535|(65535&e)>>16-t},du=function(e,t){return(65535&e)>>t|e<<16-t&65535};qa.rc2=qa.rc2||{},qa.rc2.expandKey=function(e,t){"string"==typeof e&&(e=qa.util.createBuffer(e)),t=t||128;var r,n=e,i=e.length(),o=t,a=Math.ceil(o/8),s=255>>(7&o);for(r=i;r<128;r++)n.putByte(fu[n.at(r-1)+n.at(r-i)&255]);for(n.setAt(128-a,fu[n.at(128-a)&s]),r=127-a;r>=0;r--)n.setAt(r,fu[n.at(r+1)^n.at(r+a)]);return n};var gu=function(e,t,r){var n,i,o,a,s=!1,u=null,c=null,l=null,f=[];for(e=qa.rc2.expandKey(e,t),o=0;o<64;o++)f.push(e.getInt16Le());r?(n=function(e){for(o=0;o<4;o++)e[o]+=f[a]+(e[(o+3)%4]&e[(o+2)%4])+(~e[(o+3)%4]&e[(o+1)%4]),e[o]=pu(e[o],hu[o]),a++},i=function(e){for(o=0;o<4;o++)e[o]+=f[63&e[(o+3)%4]]}):(n=function(e){for(o=3;o>=0;o--)e[o]=du(e[o],hu[o]),e[o]-=f[a]+(e[(o+3)%4]&e[(o+2)%4])+(~e[(o+3)%4]&e[(o+1)%4]),a--},i=function(e){for(o=3;o>=0;o--)e[o]-=f[63&e[(o+3)%4]]});var h=function(e){var t=[];for(o=0;o<4;o++){var n=u.getInt16Le();null!==l&&(r?n^=l.getInt16Le():l.putInt16Le(n)),t.push(65535&n)}a=r?0:63;for(var i=0;i<e.length;i++)for(var s=0;s<e[i][0];s++)e[i][1](t);for(o=0;o<4;o++)null!==l&&(r?l.putInt16Le(t[o]):t[o]^=l.getInt16Le()),c.putInt16Le(t[o])},p=null;return p={start:function(e,t){e&&"string"==typeof e&&(e=qa.util.createBuffer(e)),s=!1,u=qa.util.createBuffer(),c=t||new qa.util.createBuffer,l=e,p.output=c},update:function(e){for(s||u.putBuffer(e);u.length()>=8;)h([[5,n],[1,i],[6,n],[1,i],[5,n]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,u,!r);else{var n=8===u.length()?8:8-u.length();u.fillWithByte(n,n)}if(t&&(s=!0,p.update()),!r&&(t=0===u.length()))if(e)t=e(8,c,!r);else{var i=c.length(),o=c.at(i-1);o>i?t=!1:c.truncate(o)}return t}}};if(qa.rc2.startEncrypting=function(e,t,r){var n=qa.rc2.createEncryptionCipher(e,128);return n.start(t,r),n},qa.rc2.createEncryptionCipher=function(e,t){return gu(e,t,!0)},qa.rc2.startDecrypting=function(e,t,r){var n=qa.rc2.createDecryptionCipher(e,128);return n.start(t,r),n},qa.rc2.createDecryptionCipher=function(e,t){return gu(e,t,!1)},void 0===yu)var yu=qa.jsbn.BigInteger;var vu=qa.asn1,mu=qa.pki=qa.pki||{};mu.pbe=qa.pbe=qa.pbe||{};var bu,Eu,Su=mu.oids,wu={name:"EncryptedPrivateKeyInfo",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},_u={name:"PBES2Algorithms",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:vu.Class.UNIVERSAL,type:vu.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:vu.Class.UNIVERSAL,type:vu.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Cu={name:"pkcs-12PbeParams",tagClass:vu.Class.UNIVERSAL,type:vu.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:vu.Class.UNIVERSAL,type:vu.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:vu.Class.UNIVERSAL,type:vu.Type.INTEGER,constructed:!1,capture:"iterations"}]};function Au(e,t){return e.start().update(t).digest().getBytes()}function Iu(e){var t;if(e){if(!(t=mu.oids[vu.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return Tu(t)}function Tu(e){var t=qa.md;switch(e){case"hmacWithSHA224":t=qa.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}
/*!
 * deps/forge.js - Forge Package Customization
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
function Pu(e){e=e||{},this.name="",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._blocks=this.blockSize/4,this._inBlock=new Array(this._blocks),this._outBlock=new Array(this._blocks)}mu.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n,i,o,a=qa.random.getBytesSync(r.saltSize),s=r.count,u=vu.integerToDer(s);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var c,l,f;switch(r.algorithm){case"aes128":n=16,c=16,l=Su["aes128-CBC"],f=qa.aes.createEncryptionCipher;break;case"aes192":n=24,c=16,l=Su["aes192-CBC"],f=qa.aes.createEncryptionCipher;break;case"aes256":n=32,c=16,l=Su["aes256-CBC"],f=qa.aes.createEncryptionCipher;break;case"des":n=8,c=8,l=Su.desCBC,f=qa.des.createEncryptionCipher;break;default:throw(v=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,v}var h="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Tu(h),d=qa.pkcs5.pbkdf2(t,a,s,n,p),g=qa.random.getBytesSync(c);(m=f(d)).start(g),m.update(vu.toDer(e)),m.finish(),o=m.output.getBytes();var y=function(e,t,r,n){var i=vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OCTETSTRING,!1,e),vu.create(vu.Class.UNIVERSAL,vu.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==n&&i.value.push(vu.create(vu.Class.UNIVERSAL,vu.Type.INTEGER,!1,qa.util.hexToBytes(r.toString(16))),vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OID,!1,vu.oidToDer(mu.oids[n]).getBytes()),vu.create(vu.Class.UNIVERSAL,vu.Type.NULL,!1,"")]));return i}(a,u,n,h);i=vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OID,!1,vu.oidToDer(Su.pkcs5PBES2).getBytes()),vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OID,!1,vu.oidToDer(Su.pkcs5PBKDF2).getBytes()),y]),vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OID,!1,vu.oidToDer(l).getBytes()),vu.create(vu.Class.UNIVERSAL,vu.Type.OCTETSTRING,!1,g)])])])}else{var v;if("3des"!==r.algorithm)throw(v=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,v;n=24;var m,b=new qa.util.ByteBuffer(a);d=mu.pbe.generatePkcs12Key(t,b,1,s,n),g=mu.pbe.generatePkcs12Key(t,b,2,s,n);(m=qa.des.createEncryptionCipher(d)).start(g),m.update(vu.toDer(e)),m.finish(),o=m.output.getBytes(),i=vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OID,!1,vu.oidToDer(Su["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[vu.create(vu.Class.UNIVERSAL,vu.Type.OCTETSTRING,!1,a),vu.create(vu.Class.UNIVERSAL,vu.Type.INTEGER,!1,u.getBytes())])])}return vu.create(vu.Class.UNIVERSAL,vu.Type.SEQUENCE,!0,[i,vu.create(vu.Class.UNIVERSAL,vu.Type.OCTETSTRING,!1,o)])},mu.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!vu.validate(e,wu,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var a=vu.derToOid(n.encryptionOid),s=mu.pbe.getCipher(a,n.encryptionParams,t),u=qa.util.createBuffer(n.encryptedData);return s.update(u),s.finish()&&(r=vu.fromDer(s.output)),r},mu.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:vu.toDer(e).getBytes()};return qa.pem.encode(r,{maxline:t})},mu.encryptedPrivateKeyFromPem=function(e){var t=qa.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return vu.fromDer(t.body)},mu.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var n=mu.wrapRsaPrivateKey(mu.privateKeyToAsn1(e));return n=mu.encryptPrivateKeyInfo(n,t,r),mu.encryptedPrivateKeyToPem(n)}var i,o,a,s;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,o=qa.random.getBytesSync(16),s=qa.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,o=qa.random.getBytesSync(16),s=qa.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,o=qa.random.getBytesSync(16),s=qa.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,o=qa.random.getBytesSync(8),s=qa.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,o=qa.random.getBytesSync(8),s=qa.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var c=s(qa.pbe.opensslDeriveBytes(t,o.substr(0,8),a));c.start(o),c.update(vu.toDer(mu.privateKeyToAsn1(e))),c.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:qa.util.bytesToHex(o).toUpperCase()},body:c.output.getBytes()};return qa.pem.encode(l)},mu.decryptRsaPrivateKey=function(e,t){var r=null,n=qa.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==n.type&&"PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type)throw(a=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=a,a;if(n.procType&&"ENCRYPTED"===n.procType.type){var i,o;switch(n.dekInfo.algorithm){case"DES-CBC":i=8,o=qa.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,o=qa.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,o=qa.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,o=qa.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,o=qa.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,o=function(e){return qa.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":i=8,o=function(e){return qa.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":i=16,o=function(e){return qa.rc2.createDecryptionCipher(e,128)};break;default:var a;throw(a=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".')).algorithm=n.dekInfo.algorithm,a}var s=qa.util.hexToBytes(n.dekInfo.parameters),u=o(qa.pbe.opensslDeriveBytes(t,s.substr(0,8),i));if(u.start(s),u.update(qa.util.createBuffer(n.body)),!u.finish())return r;r=u.output.getBytes()}else r=n.body;return null!==(r="ENCRYPTED PRIVATE KEY"===n.type?mu.decryptPrivateKeyInfo(vu.fromDer(r),t):vu.fromDer(r))&&(r=mu.privateKeyFromAsn1(r)),r},mu.pbe.generatePkcs12Key=function(e,t,r,n,i,o){var a,s;if(null==o){if(!("sha1"in qa.md))throw new Error('"sha1" hash algorithm unavailable.');o=qa.md.sha1.create()}var u=o.digestLength,c=o.blockLength,l=new qa.util.ByteBuffer,f=new qa.util.ByteBuffer;if(null!=e){for(s=0;s<e.length;s++)f.putInt16(e.charCodeAt(s));f.putInt16(0)}var h=f.length(),p=t.length(),d=new qa.util.ByteBuffer;d.fillWithByte(r,c);var g=c*Math.ceil(p/c),y=new qa.util.ByteBuffer;for(s=0;s<g;s++)y.putByte(t.at(s%p));var v=c*Math.ceil(h/c),m=new qa.util.ByteBuffer;for(s=0;s<v;s++)m.putByte(f.at(s%h));var b=y;b.putBuffer(m);for(var E=Math.ceil(i/u),S=1;S<=E;S++){var w=new qa.util.ByteBuffer;w.putBytes(d.bytes()),w.putBytes(b.bytes());for(var _=0;_<n;_++)o.start(),o.update(w.getBytes()),w=o.digest();var C=new qa.util.ByteBuffer;for(s=0;s<c;s++)C.putByte(w.at(s%u));var A=Math.ceil(p/c)+Math.ceil(h/c),I=new qa.util.ByteBuffer;for(a=0;a<A;a++){var T=new qa.util.ByteBuffer(b.getBytes(c)),P=511;for(s=C.length()-1;s>=0;s--)P>>=8,P+=C.at(s)+T.at(s),T.setAt(s,255&P);I.putBuffer(T)}b=I,l.putBuffer(w)}return l.truncate(l.length()-i),l},mu.pbe.getCipher=function(e,t,r){switch(e){case mu.oids.pkcs5PBES2:return mu.pbe.getCipherForPBES2(e,t,r);case mu.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case mu.oids["pbewithSHAAnd40BitRC2-CBC"]:return mu.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},mu.pbe.getCipherForPBES2=function(e,t,r){var n,i={},o=[];if(!vu.validate(t,_u,i,o))throw(n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=o,n;if((e=vu.derToOid(i.kdfOid))!==mu.oids.pkcs5PBKDF2)throw(n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,n.supportedOids=["pkcs5PBKDF2"],n;if((e=vu.derToOid(i.encOid))!==mu.oids["aes128-CBC"]&&e!==mu.oids["aes192-CBC"]&&e!==mu.oids["aes256-CBC"]&&e!==mu.oids["des-EDE3-CBC"]&&e!==mu.oids.desCBC)throw(n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n;var a,s,u=i.kdfSalt,c=qa.util.createBuffer(i.kdfIterationCount);switch(c=c.getInt(c.length()<<3),mu.oids[e]){case"aes128-CBC":a=16,s=qa.aes.createDecryptionCipher;break;case"aes192-CBC":a=24,s=qa.aes.createDecryptionCipher;break;case"aes256-CBC":a=32,s=qa.aes.createDecryptionCipher;break;case"des-EDE3-CBC":a=24,s=qa.des.createDecryptionCipher;break;case"desCBC":a=8,s=qa.des.createDecryptionCipher}var l=Iu(i.prfOid),f=qa.pkcs5.pbkdf2(r,u,c,a,l),h=i.encIv,p=s(f);return p.start(h),p},mu.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!vu.validate(t,Cu,n,i))throw(l=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=i,l;var o,a,s,u=qa.util.createBuffer(n.salt),c=qa.util.createBuffer(n.iterations);switch(c=c.getInt(c.length()<<3),e){case mu.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:o=24,a=8,s=qa.des.startDecrypting;break;case mu.oids["pbewithSHAAnd40BitRC2-CBC"]:o=5,a=8,s=function(e,t){var r=qa.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var l;throw(l=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,l}var f=Iu(n.prfOid),h=mu.pbe.generatePkcs12Key(r,u,1,c,o,f);return f.start(),s(h,mu.pbe.generatePkcs12Key(r,u,2,c,a,f))},mu.pbe.opensslDeriveBytes=function(e,t,r,n){if(null==n){if(!("md5"in qa.md))throw new Error('"md5" hash algorithm unavailable.');n=qa.md.md5.create()}null===t&&(t="");for(var i=[Au(n,e+t)],o=16,a=1;o<r;++a,o+=16)i.push(Au(n,i[a-1]+e+t));return i.join("").substr(0,r)},u((function(e){var t=qa.asn1,r=qa.pki,n=e.exports=qa.pkcs12=qa.pkcs12||{},i={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},o={name:"PFX",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},i,{name:"PFX.macData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:t.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},a={name:"SafeBag",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},s={name:"Attribute",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,capture:"values"}]},u={name:"CertBag",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:t.Class.UNIVERSAL,type:t.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function c(e,t,r,n){for(var i=[],o=0;o<e.length;o++)for(var a=0;a<e[o].safeBags.length;a++){var s=e[o].safeBags[a];void 0!==n&&s.type!==n||(null!==t?void 0!==s.attributes[t]&&s.attributes[t].indexOf(r)>=0&&i.push(s):i.push(s))}return i}function l(e){if(e.composed||e.constructed){for(var t=qa.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function f(e,n){var i={},o=[];if(!t.validate(e,qa.pkcs7.asn1.encryptedDataValidator,i,o))throw(a=new Error("Cannot read EncryptedContentInfo.")).errors=o,a;var a,s=t.derToOid(i.contentType);if(s!==r.oids.data)throw(a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=s,a;s=t.derToOid(i.encAlgorithm);var u=r.pbe.getCipher(s,i.encParameter,n),c=l(i.encryptedContentAsn1),f=qa.util.createBuffer(c.value);if(u.update(f),!u.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return u.output.getBytes()}function h(e,n,i){if(!n&&0===e.length)return[];if((e=t.fromDer(e,n)).tagClass!==t.Class.UNIVERSAL||e.type!==t.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var o=[],s=0;s<e.value.length;s++){var c=e.value[s],l={},f=[];if(!t.validate(c,a,l,f))throw(v=new Error("Cannot read SafeBag.")).errors=f,v;var h,d,g={type:t.derToOid(l.bagId),attributes:p(l.bagAttributes)};o.push(g);var y=l.bagValue.value[0];switch(g.type){case r.oids.pkcs8ShroudedKeyBag:if(null===(y=r.decryptPrivateKeyInfo(y,i)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{g.key=r.privateKeyFromAsn1(y)}catch(m){g.key=null,g.asn1=y}continue;case r.oids.certBag:h=u,d=function(){if(t.derToOid(l.certId)!==r.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=t.derToOid(l.certId),e}var i=t.fromDer(l.cert,n);try{g.cert=r.certificateFromAsn1(i,!0)}catch(m){g.cert=null,g.asn1=i}};break;default:var v;throw(v=new Error("Unsupported PKCS#12 SafeBag type.")).oid=g.type,v}if(void 0!==h&&!t.validate(y,h,l,f))throw(v=new Error("Cannot read PKCS#12 "+h.name)).errors=f,v;d()}return o}function p(e){var n={};if(void 0!==e)for(var i=0;i<e.length;++i){var o={},a=[];if(!t.validate(e[i],s,o,a)){var u=new Error("Cannot read PKCS#12 BagAttribute.");throw u.errors=a,u}var c=t.derToOid(o.oid);if(void 0!==r.oids[c]){n[r.oids[c]]=[];for(var l=0;l<o.values.length;++l)n[r.oids[c]].push(o.values[l].value)}}return n}n.pkcs12FromAsn1=function(e,a,s){"string"==typeof a?(s=a,a=!0):void 0===a&&(a=!0);var u={};if(!t.validate(e,o,u,[]))throw(p=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=p,p;var p,d={version:u.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=qa.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=c(d.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=c(d.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=c(d.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return c(d.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return c(d.safeContents,"localKeyId",e,t)}};if(3!==u.version.charCodeAt(0))throw(p=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=u.version.charCodeAt(0),p;if(t.derToOid(u.contentType)!==r.oids.data)throw(p=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=t.derToOid(u.contentType),p;var g=u.content.value[0];if(g.tagClass!==t.Class.UNIVERSAL||g.type!==t.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(g=l(g),u.mac){var y=null,v=0,m=t.derToOid(u.macAlgorithm);switch(m){case r.oids.sha1:y=qa.md.sha1.create(),v=20;break;case r.oids.sha256:y=qa.md.sha256.create(),v=32;break;case r.oids.sha384:y=qa.md.sha384.create(),v=48;break;case r.oids.sha512:y=qa.md.sha512.create(),v=64;break;case r.oids.md5:y=qa.md.md5.create(),v=16}if(null===y)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+m);var b=new qa.util.ByteBuffer(u.macSalt),E="macIterations"in u?parseInt(qa.util.bytesToHex(u.macIterations),16):1,S=n.generateKey(s,b,3,E,v,y),w=qa.hmac.create();if(w.start(y,S),w.update(g.value),w.getMac().getBytes()!==u.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,n,o,a){if((n=t.fromDer(n,o)).tagClass!==t.Class.UNIVERSAL||n.type!==t.Type.SEQUENCE||!0!==n.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var s=0;s<n.value.length;s++){var u=n.value[s],c={},p=[];if(!t.validate(u,i,c,p))throw(v=new Error("Cannot read ContentInfo.")).errors=p,v;var d={encrypted:!1},g=null,y=c.content.value[0];switch(t.derToOid(c.contentType)){case r.oids.data:if(y.tagClass!==t.Class.UNIVERSAL||y.type!==t.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");g=l(y).value;break;case r.oids.encryptedData:g=f(y,a),d.encrypted=!0;break;default:var v;throw(v=new Error("Unsupported PKCS#12 contentType.")).contentType=t.derToOid(c.contentType),v}d.safeBags=h(g,o,a),e.safeContents.push(d)}}(d,g.value,a,s),d},n.toPkcs12Asn1=function(e,i,o,a){(a=a||{}).saltSize=a.saltSize||8,a.count=a.count||2048,a.algorithm=a.algorithm||a.encAlgorithm||"aes128","useMac"in a||(a.useMac=!0),"localKeyId"in a||(a.localKeyId=null),"generateLocalKeyId"in a||(a.generateLocalKeyId=!0);var s,u=a.localKeyId;if(null!==u)u=qa.util.hexToBytes(u);else if(a.generateLocalKeyId)if(i){var c=qa.util.isArray(i)?i[0]:i;"string"==typeof c&&(c=r.certificateFromPem(c)),(I=qa.md.sha1.create()).update(t.toDer(r.certificateToAsn1(c)).getBytes()),u=I.digest().getBytes()}else u=qa.random.getBytes(20);var l=[];null!==u&&l.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.localKeyId).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,u)])])),"friendlyName"in a&&l.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.friendlyName).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.BMPSTRING,!1,a.friendlyName)])])),l.length>0&&(s=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,l));var f=[],h=[];null!==i&&(h=qa.util.isArray(i)?i:[i]);for(var p=[],d=0;d<h.length;++d){"string"==typeof(i=h[d])&&(i=r.certificateFromPem(i));var g=0===d?s:void 0,y=r.certificateToAsn1(i),v=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.certBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.x509Certificate).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(y).getBytes())])])]),g]);p.push(v)}if(p.length>0){var m=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,p),b=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(m).getBytes())])]);f.push(b)}var E=null;if(null!==e){var S=r.wrapRsaPrivateKey(r.privateKeyToAsn1(e));E=null===o?t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.keyBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[S]),s]):t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(S,o,a)]),s]);var w=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[E]),_=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(w).getBytes())])]);f.push(_)}var C,A=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,f);if(a.useMac){var I=qa.md.sha1.create(),T=new qa.util.ByteBuffer(qa.random.getBytes(a.saltSize)),P=a.count,F=(e=n.generateKey(o,T,3,P,20),qa.hmac.create());F.start(I,e),F.update(t.toDer(A).getBytes());var k=F.getMac();C=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.sha1).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,k.getBytes())]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,T.getBytes()),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(P).getBytes())])}return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(3).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(A).getBytes())])]),C])},n.generateKey=qa.pbe.generatePkcs12Key})),u((function(e){var t=qa.asn1,r=e.exports=qa.pki=qa.pki||{};r.pemToDer=function(e){var t=qa.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return qa.util.createBuffer(t.body)},r.privateKeyFromPem=function(e){var n=qa.pem.decode(e)[0];if("PRIVATE KEY"!==n.type&&"RSA PRIVATE KEY"!==n.type){var i=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw i.headerType=n.type,i}if(n.procType&&"ENCRYPTED"===n.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var o=t.fromDer(n.body);return r.privateKeyFromAsn1(o)},r.privateKeyToPem=function(e,n){var i={type:"RSA PRIVATE KEY",body:t.toDer(r.privateKeyToAsn1(e)).getBytes()};return qa.pem.encode(i,{maxline:n})},r.privateKeyInfoToPem=function(e,r){var n={type:"PRIVATE KEY",body:t.toDer(e).getBytes()};return qa.pem.encode(n,{maxline:r})}})),u((function(e){var t=e.exports=qa.sha512=qa.sha512||{};qa.md.sha512=qa.md.algorithms.sha512=t;var r=qa.sha384=qa.sha512.sha384=qa.sha512.sha384||{};r.create=function(){return t.create("SHA-384")},qa.md.sha384=qa.md.algorithms.sha384=r,qa.sha512.sha256=qa.sha512.sha256||{create:function(){return t.create("SHA-512/256")}},qa.md["sha512/256"]=qa.md.algorithms["sha512/256"]=qa.sha512.sha256,qa.sha512.sha224=qa.sha512.sha224||{create:function(){return t.create("SHA-512/224")}},qa.md["sha512/224"]=qa.md.algorithms["sha512/224"]=qa.sha512.sha224,t.create=function(e){if(i||(n=String.fromCharCode(128),n+=qa.util.fillString(String.fromCharCode(0),128),o=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(a={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],a["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],a["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],a["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],i=!0),void 0===e&&(e="SHA-512"),!(e in a))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=a[e],r=null,u=qa.util.createBuffer(),c=new Array(80),l=0;l<80;++l)c[l]=new Array(2);var f=64;switch(e){case"SHA-384":f=48;break;case"SHA-512/256":f=32;break;case"SHA-512/224":f=28}var h={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:f,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){h.messageLength=0,h.fullMessageLength=h.messageLength128=[];for(var e=h.messageLengthSize/4,n=0;n<e;++n)h.fullMessageLength.push(0);u=qa.util.createBuffer(),r=new Array(t.length);for(n=0;n<t.length;++n)r[n]=t[n].slice(0);return h}};return h.start(),h.update=function(e,t){"utf8"===t&&(e=qa.util.encodeUtf8(e));var n=e.length;h.messageLength+=n,n=[n/4294967296>>>0,n>>>0];for(var i=h.fullMessageLength.length-1;i>=0;--i)h.fullMessageLength[i]+=n[1],n[1]=n[0]+(h.fullMessageLength[i]/4294967296>>>0),h.fullMessageLength[i]=h.fullMessageLength[i]>>>0,n[0]=n[1]/4294967296>>>0;return u.putBytes(e),s(r,c,u),(u.read>2048||0===u.length())&&u.compact(),h},h.digest=function(){var t=qa.util.createBuffer();t.putBytes(u.bytes());var i,o=h.fullMessageLength[h.fullMessageLength.length-1]+h.messageLengthSize&h.blockLength-1;t.putBytes(n.substr(0,h.blockLength-o));for(var a=8*h.fullMessageLength[0],l=0;l<h.fullMessageLength.length-1;++l)a+=(i=8*h.fullMessageLength[l+1])/4294967296>>>0,t.putInt32(a>>>0),a=i>>>0;t.putInt32(a);var f=new Array(r.length);for(l=0;l<r.length;++l)f[l]=r[l].slice(0);s(f,c,t);var p,d=qa.util.createBuffer();p="SHA-512"===e?f.length:"SHA-384"===e?f.length-2:f.length-4;for(l=0;l<p;++l)d.putInt32(f[l][0]),l===p-1&&"SHA-512/224"===e||d.putInt32(f[l][1]);return d},h};var n=null,i=!1,o=null,a=null;function s(e,t,r){for(var n,i,a,s,u,c,l,f,h,p,d,g,y,v,m,b,E,S,w,_,C,A,I,T,P,F,k,R,B,O,x,N,U,j=r.length();j>=128;){for(k=0;k<16;++k)t[k][0]=r.getInt32()>>>0,t[k][1]=r.getInt32()>>>0;for(;k<80;++k)n=(((R=(O=t[k-2])[0])>>>19|(B=O[1])<<13)^(B>>>29|R<<3)^R>>>6)>>>0,i=((R<<13|B>>>19)^(B<<3|R>>>29)^(R<<26|B>>>6))>>>0,a=(((R=(N=t[k-15])[0])>>>1|(B=N[1])<<31)^(R>>>8|B<<24)^R>>>7)>>>0,s=((R<<31|B>>>1)^(R<<24|B>>>8)^(R<<25|B>>>7))>>>0,x=t[k-7],U=t[k-16],B=i+x[1]+s+U[1],t[k][0]=n+x[0]+a+U[0]+(B/4294967296>>>0)>>>0,t[k][1]=B>>>0;for(d=e[0][0],g=e[0][1],y=e[1][0],v=e[1][1],m=e[2][0],b=e[2][1],E=e[3][0],S=e[3][1],w=e[4][0],_=e[4][1],C=e[5][0],A=e[5][1],I=e[6][0],T=e[6][1],P=e[7][0],F=e[7][1],k=0;k<80;++k)l=((w>>>14|_<<18)^(w>>>18|_<<14)^(_>>>9|w<<23))>>>0,f=(I^w&(C^I))>>>0,u=((d>>>28|g<<4)^(g>>>2|d<<30)^(g>>>7|d<<25))>>>0,c=((d<<4|g>>>28)^(g<<30|d>>>2)^(g<<25|d>>>7))>>>0,h=(d&y|m&(d^y))>>>0,p=(g&v|b&(g^v))>>>0,B=F+(((w<<18|_>>>14)^(w<<14|_>>>18)^(_<<23|w>>>9))>>>0)+((T^_&(A^T))>>>0)+o[k][1]+t[k][1],n=P+l+f+o[k][0]+t[k][0]+(B/4294967296>>>0)>>>0,i=B>>>0,a=u+h+((B=c+p)/4294967296>>>0)>>>0,s=B>>>0,P=I,F=T,I=C,T=A,C=w,A=_,w=E+n+((B=S+i)/4294967296>>>0)>>>0,_=B>>>0,E=m,S=b,m=y,b=v,y=d,v=g,d=n+a+((B=i+s)/4294967296>>>0)>>>0,g=B>>>0;B=e[0][1]+g,e[0][0]=e[0][0]+d+(B/4294967296>>>0)>>>0,e[0][1]=B>>>0,B=e[1][1]+v,e[1][0]=e[1][0]+y+(B/4294967296>>>0)>>>0,e[1][1]=B>>>0,B=e[2][1]+b,e[2][0]=e[2][0]+m+(B/4294967296>>>0)>>>0,e[2][1]=B>>>0,B=e[3][1]+S,e[3][0]=e[3][0]+E+(B/4294967296>>>0)>>>0,e[3][1]=B>>>0,B=e[4][1]+_,e[4][0]=e[4][0]+w+(B/4294967296>>>0)>>>0,e[4][1]=B>>>0,B=e[5][1]+A,e[5][0]=e[5][0]+C+(B/4294967296>>>0)>>>0,e[5][1]=B>>>0,B=e[6][1]+T,e[6][0]=e[6][0]+I+(B/4294967296>>>0)>>>0,e[6][1]=B>>>0,B=e[7][1]+F,e[7][0]=e[7][0]+P+(B/4294967296>>>0)>>>0,e[7][1]=B>>>0,j-=128}}})),Pu.prototype.start=function(){},Pu.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;var n;for(n=0;n<this._blocks;++n)this._inBlock[n]=e.getInt32();for(this.cipher.encrypt(this._inBlock,this._outBlock),n=0;n<this._blocks;++n)t.putInt32(this._outBlock[n])},Pu.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;var n;for(n=0;n<this._blocks;++n)this._inBlock[n]=e.getInt32();for(this.cipher.decrypt(this._inBlock,this._outBlock),n=0;n<this._blocks;++n)t.putInt32(this._outBlock[n])},Eu=Pu,bu=function(){return new qa.aes.Algorithm("AES",Eu)},qa.cipher.registerAlgorithm("AES",bu);var Fu=qa;var ku=function(e){var t=e.length,r=t%4;if(!r)return e;var n=t,i=4-r,o=t+i,a=Buffer.alloc(o);for(a.write(e);i--;)a.write("=",n++);return a.toString()},Ru=Object.defineProperty({default:ku},"__esModule",{value:!0});function Bu(e,t){return void 0===t&&(t="utf8"),Buffer.isBuffer(e)?xu(e.toString("base64")):xu(Buffer.from(e,t).toString("base64"))}function Ou(e){return e=e.toString(),Ru.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function xu(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var Nu=Bu;Nu.encode=Bu,Nu.decode=function(e,t){return void 0===t&&(t="utf8"),Buffer.from(Ou(e),"base64").toString(t)},Nu.toBase64=Ou,Nu.fromBase64=xu,Nu.toBuffer=function(e){return Buffer.from(Ou(e),"base64")};var Uu,ju=Nu,Du=Object.defineProperty({default:ju},"__esModule",{value:!0}),Lu=u((function(e){e.exports=Du.default,e.exports.default=e.exports})),Mu={encode:function(e,t){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Buffer.isBuffer(e)||(e=Buffer.from(e,t)),Lu.encode(e)},decode:Lu.toBuffer},Ku=u((function(e,t){var r=t;r.encode=function(e){var t=encodeURIComponent(e||"");return t=t.replace(/%([0-9a-fA-F]{2})/g,(function(e,t){return t=parseInt(t,16),String.fromCharCode(t)}))},r.decode=function(e){var t=(e||"").replace(/[\u0080-\u00ff]/g,(function(e){return"%"+(256|e.charCodeAt(0)).toString(16).substring(1)}));return t=decodeURIComponent(t)}}));var Vu=Uu={base64url:Mu,utf8:Ku,asBuffer:function(e,t){return Buffer.isBuffer(e)?e:"string"==typeof e?"base64url"===(t=t||"binary")?Uu.base64url.decode(e):Buffer.from(e,t):(Fu.util.isArrayBufferView(e)?e=e instanceof Uint8Array?e:new Uint8Array(e.buffer,e.byteOffset,e.byteOffset+e.byteLength):Fu.util.isArrayBuffer(e)&&(e=new Uint8Array(e)),Buffer.from(e))},randomBytes:function(e){return Buffer.from(Fu.random.getBytes(e),"binary")}},Hu=Yo(Object.keys,Object),qu=Object.prototype.hasOwnProperty;var zu=function(e){if(!ea(e))return Hu(e);var t=[];for(var r in Object(e))qu.call(e,r)&&"constructor"!=r&&t.push(r);return t};var $u=function(e){return ua(e)?ka(e):zu(e)};var Gu=function(e,t){return e&&Ta(t,$u(t),e)};var Wu=function(e,t){return e&&Ta(t,xa(t),e)};var Ju=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var Qu=function(){return[]},Yu=Object.prototype.propertyIsEnumerable,Xu=Object.getOwnPropertySymbols,Zu=Xu?function(e){return null==e?[]:(e=Object(e),Ju(Xu(e),(function(t){return Yu.call(e,t)})))}:Qu;var ec=function(e,t){return Ta(e,Zu(e),t)};var tc=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},rc=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)tc(t,Zu(e)),e=Xo(e);return t}:Qu;var nc=function(e,t){return Ta(e,rc(e),t)};var ic=function(e,t,r){var n=t(e);return ci(e)?n:tc(n,r(e))};var oc=function(e){return ic(e,$u,Zu)};var ac=function(e){return ic(e,xa,rc)},sc=xn(sn,"DataView"),uc=xn(sn,"Promise"),cc=xn(sn,"Set"),lc=An(sc),fc=An(So),hc=An(uc),pc=An(cc),dc=An(Kn),gc=vn;(sc&&"[object DataView]"!=gc(new sc(new ArrayBuffer(1)))||So&&"[object Map]"!=gc(new So)||uc&&"[object Promise]"!=gc(uc.resolve())||cc&&"[object Set]"!=gc(new cc)||Kn&&"[object WeakMap]"!=gc(new Kn))&&(gc=function(e){var t=vn(e),r="[object Object]"==t?e.constructor:void 0,n=r?An(r):"";if(n)switch(n){case lc:return"[object DataView]";case fc:return"[object Map]";case hc:return"[object Promise]";case pc:return"[object Set]";case dc:return"[object WeakMap]"}return t});var yc=gc,vc=Object.prototype.hasOwnProperty;var mc=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&vc.call(e,"index")&&(r.index=e.index,r.input=e.input),r};var bc=function(e,t){var r=t?Jo(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},Ec=/\w*$/;var Sc=function(e){var t=new e.constructor(e.source,Ec.exec(e));return t.lastIndex=e.lastIndex,t},wc=un?un.prototype:void 0,_c=wc?wc.valueOf:void 0;var Cc=function(e){return _c?Object(_c.call(e)):{}};var Ac=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return Jo(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return bc(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Qo(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return Sc(e);case"[object Set]":return new n;case"[object Symbol]":return Cc(e)}};var Ic=function(e){return li(e)&&"[object Map]"==yc(e)},Tc=Sa&&Sa.isMap,Pc=Tc?Ea(Tc):Ic;var Fc=function(e){return li(e)&&"[object Set]"==yc(e)},kc=Sa&&Sa.isSet,Rc=kc?Ea(kc):Fc,Bc={};Bc["[object Arguments]"]=Bc["[object Array]"]=Bc["[object ArrayBuffer]"]=Bc["[object DataView]"]=Bc["[object Boolean]"]=Bc["[object Date]"]=Bc["[object Float32Array]"]=Bc["[object Float64Array]"]=Bc["[object Int8Array]"]=Bc["[object Int16Array]"]=Bc["[object Int32Array]"]=Bc["[object Map]"]=Bc["[object Number]"]=Bc["[object Object]"]=Bc["[object RegExp]"]=Bc["[object Set]"]=Bc["[object String]"]=Bc["[object Symbol]"]=Bc["[object Uint8Array]"]=Bc["[object Uint8ClampedArray]"]=Bc["[object Uint16Array]"]=Bc["[object Uint32Array]"]=!0,Bc["[object Error]"]=Bc["[object Function]"]=Bc["[object WeakMap]"]=!1;var Oc=function e(t,r,n,i,o,a){var s,u=1&r,c=2&r,l=4&r;if(n&&(s=o?n(t,i,o,a):n(t)),void 0!==s)return s;if(!mn(t))return t;var f=ci(t);if(f){if(s=mc(t),!u)return fi(t,s)}else{var h=yc(t),p="[object Function]"==h||"[object GeneratorFunction]"==h;if(fa(t))return Go(t,u);if("[object Object]"==h||"[object Arguments]"==h||p&&!o){if(s=c||p?{}:ta(t),!u)return c?nc(t,Wu(s,t)):ec(t,Gu(s,t))}else{if(!Bc[h])return o?t:{};s=Ac(t,h,u)}}a||(a=new Ho);var d=a.get(t);if(d)return d;a.set(t,s),Rc(t)?t.forEach((function(i){s.add(e(i,r,n,i,t,a))})):Pc(t)&&t.forEach((function(i,o){s.set(o,e(i,r,n,o,t,a))}));var g=f?void 0:(l?c?ac:oc:c?xa:$u)(t);return _i(g||t,(function(i,o){g&&(i=t[o=i]),Ia(s,o,e(i,r,n,o,t,a))})),s};for(var xc=function(e){return Oc(e,4)},Nc=u((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}})),Uc=[],jc=0;jc<256;++jc)Uc[jc]=(jc+256).toString(16).substr(1);var Dc,Lc,Mc=function(e,t){var r=t||0,n=Uc;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")},Kc=0,Vc=0;var Hc=function(e,t,r){var n=t&&r||0,i=t||[],o=(e=e||{}).node||Dc,a=void 0!==e.clockseq?e.clockseq:Lc;if(null==o||null==a){var s=Nc();null==o&&(o=Dc=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=Lc=16383&(s[6]<<8|s[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:Vc+1,l=u-Kc+(c-Vc)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||u>Kc)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Kc=u,Vc=c,Lc=a;var f=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[n++]=f>>>24&255,i[n++]=f>>>16&255,i[n++]=f>>>8&255,i[n++]=255&f;var h=u/4294967296*1e4&268435455;i[n++]=h>>>8&255,i[n++]=255&h,i[n++]=h>>>24&15|16,i[n++]=h>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var p=0;p<6;++p)i[n+p]=o[p];return t||Mc(i)};var qc=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||Nc)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[n+o]=i[o];return t||Mc(i)},zc=qc;zc.v1=Hc,zc.v4=qc;var $c=zc,Gc=Object.prototype.hasOwnProperty,Wc=Ma((function(e,t){if(ea(t)||ua(t))Ta(t,$u(t),e);else for(var r in t)Gc.call(t,r)&&Ia(e,r,t[r])})),Jc=un?un.isConcatSpreadable:void 0;var Qc=function(e){return ci(e)||aa(e)||!!(Jc&&e&&e[Jc])};var Yc=function e(t,r,n,i,o){var a=-1,s=t.length;for(n||(n=Qc),o||(o=[]);++a<s;){var u=t[a];r>0&&n(u)?r>1?e(u,r-1,n,i,o):tc(o,u):i||(o[o.length]=u)}return o};var Xc=function(e){return(null==e?0:e.length)?Yc(e,1):[]};var Zc=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var el=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var tl=function(e){return this.__data__.has(e)};function rl(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Mo;++t<r;)this.add(e[t])}rl.prototype.add=rl.prototype.push=el,rl.prototype.has=tl;var nl=rl;var il=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1};var ol=function(e,t){return e.has(t)},al=Math.min;var sl=function(e,t,r){for(var n=r?il:Pi,i=e[0].length,o=e.length,a=o,s=Array(o),u=1/0,c=[];a--;){var l=e[a];a&&t&&(l=Zc(l,Ea(t))),u=al(l.length,u),s[a]=!r&&(t||i>=120&&l.length>=120)?new nl(a&&l):void 0}l=e[0];var f=-1,h=s[0];e:for(;++f<i&&c.length<u;){var p=l[f],d=t?t(p):p;if(p=r||0!==p?p:0,!(h?ol(h,d):n(c,d,r))){for(a=o;--a;){var g=s[a];if(!(g?ol(g,d):n(e[a],d,r)))continue e}h&&h.push(d),c.push(p)}}return c};var ul=function(e){return ca(e)?e:[]},cl=Mn((function(e){var t=Zc(e,ul);return t.length&&t[0]===e[0]?sl(t):[]})),ll=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fl=/^\w*$/;var hl=function(e,t){if(ci(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Wi(e))||(fl.test(e)||!ll.test(e)||null!=t&&e in Object(t))};function pl(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(pl.Cache||Mo),r}pl.Cache=Mo;var dl=pl;var gl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yl=/\\(\\)?/g,vl=function(e){var t=dl(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(gl,(function(e,r,n,i){t.push(n?i.replace(yl,"$1"):r||e)})),t})),ml=un?un.prototype:void 0,bl=ml?ml.toString:void 0;var El=function e(t){if("string"==typeof t)return t;if(ci(t))return Zc(t,e)+"";if(Wi(t))return bl?bl.call(t):"";var r=t+"";return"0"==r&&1/t==-Infinity?"-0":r};var Sl=function(e){return null==e?"":El(e)};var wl=function(e,t){return ci(e)?e:hl(e,t)?[e]:vl(Sl(e))};var _l=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var Cl=function(e){if("string"==typeof e||Wi(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};var Al=function(e,t){for(var r=0,n=(t=wl(t,e)).length;null!=e&&r<n;)e=e[Cl(t[r++])];return r&&r==n?e:void 0};var Il=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o};var Tl=function(e,t){return t.length<2?e:Al(e,Il(t,0,-1))};var Pl=function(e,t){return t=wl(t,e),null==(e=Tl(e,t))||delete e[Cl(_l(t))]};var Fl=function(e){return va(e)?void 0:e};var kl=function(e){return Ln(rn(e,void 0,Xc),e+"")},Rl=kl((function(e,t){var r={};if(null==e)return r;var n=!1;t=Zc(t,(function(t){return t=wl(t,e),n||(n=t.length>1),t})),Ta(e,ac(e),r),n&&(r=Oc(r,7,Fl));for(var i=t.length;i--;)Pl(r,t[i]);return r}));var Bl=function(e,t,r,n){if(!mn(e))return e;for(var i=-1,o=(t=wl(t,e)).length,a=o-1,s=e;null!=s&&++i<o;){var u=Cl(t[i]),c=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=a){var l=s[u];void 0===(c=n?n(l,u,s):void 0)&&(c=mn(l)?l:Ni(t[i+1])?[]:{})}Ia(s,u,c),s=s[u]}return e};var Ol=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var a=t[n],s=Al(e,a);r(s,a)&&Bl(o,wl(a,e),s)}return o};var xl=function(e,t){return null!=e&&t in Object(e)};var Nl=function(e,t,r){for(var n=-1,i=(t=wl(t,e)).length,o=!1;++n<i;){var a=Cl(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&sa(i)&&Ni(a,i)&&(ci(e)||aa(e))};var Ul=function(e,t){return null!=e&&Nl(e,t,xl)};var jl=function(e,t){return Ol(e,t,(function(t,r){return Ul(e,r)}))},Dl=kl((function(e,t){return null==e?{}:jl(e,t)}));var Ll=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},Ml=cc&&1/Ll(new cc([,-0]))[1]==1/0?function(e){return new cc(e)}:ri;var Kl=function(e,t,r){var n=-1,i=Pi,o=e.length,a=!0,s=[],u=s;if(r)a=!1,i=il;else if(o>=200){var c=t?null:Ml(e);if(c)return Ll(c);a=!1,i=ol,u=new nl}else u=t?[]:s;e:for(;++n<o;){var l=e[n],f=t?t(l):l;if(l=r||0!==l?l:0,a&&f==f){for(var h=u.length;h--;)if(u[h]===f)continue e;t&&u.push(f),s.push(l)}else i(u,f,r)||(u!==s&&u.push(f),s.push(l))}return s};var Vl=function(e){return e&&e.length?Kl(e):[]},Hl=u((function(e,t){"undefined"==typeof Promise&&Ur.polyfill(),t.int32ToBuffer=function(e,t){return(t=t||Buffer.alloc(4))[0]=e>>>24&255,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=255&e,t};var r=Math.pow(2,32);t.int64ToBuffer=function(e,n){n=n||Buffer.alloc(8);var i=Math.floor(e/r),o=e%r;return i=t.int32ToBuffer(i),o=t.int32ToBuffer(o),n=Buffer.concat([i,o])};var n={};Object.defineProperty(t,"subtleCrypto",{get:function(){return"subtleCrypto"in n?n.subtleCrypto:n.subtleCrypto=function(){if("undefined"!=typeof crypto&&void 0!==crypto.subtle)return crypto.subtle}()},enumerable:!0}),Object.defineProperty(t,"nodeCrypto",{get:function(){return"nodeCrypto"in n?n.nodeCrypto:n.nodeCrypto=function(){var e;try{e=ss}catch(t){return}if(Object.keys(e).length)return e}()},enumerable:!0}),t.setupFallback=function(e,r,n){return e&&t.nodeCrypto?function(){var t,r=arguments;function i(e){return 0===e.message.indexOf("unsupported algorithm:")?n.apply(null,r):Promise.reject(e)}try{t=Promise.resolve(e.apply(null,r))}catch(o){t=i(o)}return t}:r&&t.subtleCrypto?function(){var e,t=arguments;function i(e){return e.code!==DOMException.NOT_SUPPORTED_ERR&&"Only ArrayBuffer and ArrayBufferView objects can be passed as CryptoOperationData"!==e.message&&e instanceof Error?Promise.reject(e):n.apply(null,t)}try{e=(e=r.apply(null,t)).catch(i)}catch(o){e=i(o)}return e}:n}})),ql={CHUNK_SIZE:1024,HASHLENGTH:{"SHA-1":160,"SHA-256":256,"SHA-384":384,"SHA-512":512},ENCLENGTH:{"AES-128-CBC":128,"AES-192-CBC":192,"AES-256-CBC":256,"AES-128-KW":128,"AES-192-KW":192,"AES-256-KW":256},KEYLENGTH:{"A128CBC-HS256":256,"A192CBC-HS384":384,"A256CBC-HS512":512,"A128CBC+HS256":256,"A192CBC+HS384":384,"A256CBC+HS512":512,A128GCM:128,A192GCM:192,A256GCM:256,A128KW:128,A192KW:192,A256KW:256,"ECDH-ES+A128KW":128,"ECDH-ES+A192KW":192,"ECDH-ES+A256KW":256},NONCELENGTH:{"A128CBC-HS256":128,"A192CBC-HS384":128,"A256CBC-HS512":128,"A128CBC+HS256":128,"A192CBC+HS384":128,"A256CBC+HS512":128,A128GCM:96,A192GCM:96,A256GCM:96}};
/*!
 * algorithms/helpers.js - Internal functions and fields used in Cryptographic
 * Algorithms
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
/*!
 * util/databuffer.js - Forge-compatible Buffer based on Node.js Buffers
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
function zl(e,t){t=t||{},Buffer.isBuffer(e)?this.data=e:Fu.util.isArrayBuffer(e)?(e=new Uint8Array(e),this.data=Buffer.from(e)):Fu.util.isArrayBufferView(e)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),this.data=Buffer.from(e)),this.data&&(this.write=this.data.length,e=void 0),this.growSize=t.growSize||zl.DEFAULT_GROW_SIZE,this.write=this.write||0,this.read=this.read||0,e?this.putBytes(e):this.data||this.accommodate(0),t.readOffset="readOffset"in t?t.readOffset:this.read,this.write="writeOffset"in t?t.writeOffset:this.write,this.read=Math.min(t.readOffset,this.write)}zl.DEFAULT_GROW_SIZE=16,zl.prototype.length=function(){return this.write-this.read},zl.prototype.available=function(){return this.data.length-this.write},zl.prototype.isEmpty=function(){return this.length()<=0},zl.prototype.accommodate=function(e){if(this.data){if(this.available()<e){e=Math.max(e,this.growSize);var t=this.data,r=Buffer.alloc(t.length+e);t.copy(r,0),this.data=r}}else e=Math.max(this.write+e,this.growSize),this.data=Buffer.alloc(e);return this.data.fill(0,this.write),this},zl.prototype.clear=function(){return this.read=this.write=0,this.data=Buffer.alloc(0),this},zl.prototype.truncate=function(e){return this.write=this.read+Math.max(0,this.length()-e),this.data.fill(0,this.write),this},zl.prototype.compact=function(){return this.read>0&&(this.write===this.read?this.read=this.write=0:(this.data.copy(this.data,0,this.read,this.write),this.write=this.write-this.read,this.read=0),this.data.fill(0,this.write)),this},zl.prototype.copy=function(){return new zl(this,{readOffset:this.read,writeOffset:this.write,growSize:this.growSize})},zl.prototype.equals=function(e){if(!zl.isBuffer(e))return!1;if(e.length()!==this.length())return!1;for(var t=!0,r=this.read-e.read,n=e.read;e.write>n;n++)t=t&&this.data[n+r]===e.data[n];return t},zl.prototype.at=function(e){return this.data[this.read+e]},zl.prototype.setAt=function(e,t){return this.data[this.read+e]=t,this},zl.prototype.last=function(){return this.data[this.write-1]},zl.prototype.bytes=function(e){var t;if(void 0===e?e=this.length():e&&(e=Math.min(e,this.length())),0===e)t="";else{var r=this.read,n=r+e,i=this.data.slice(r,n);t=String.fromCharCode.apply(null,i)}return t},zl.prototype.buffer=function(e){var t;if(void 0===e?e=this.length():e&&(e=Math.min(e,this.length())),0===e)t=new ArrayBuffer(0);else{var r=this.read,n=r+e,i=this.data.slice(r,n);(t=new Uint8Array(n-r)).set(i)}return t},zl.prototype.native=function(e){var t;if(void 0===e?e=this.length():e&&(e=Math.min(e,this.length())),0===e)t=Buffer.alloc(0);else{var r=this.read,n=r+e;t=this.data.slice(r,n)}return t},zl.prototype.toHex=function(){return this.toString("hex")},zl.prototype.toString=function(e){if(0===this.length())return"";var t=this.data.slice(this.read,this.write);switch(e=e||"utf8"){case"raw":return t.toString("binary");case"base64url":return Mu.encode(t);case"utf16":return t.toString("ucs2");default:return t.toString(e)}},zl.prototype.fillWithByte=function(e,t){return t||(t=this.available()),this.accommodate(t),this.data.fill(e,this.write,this.write+t),this.write+=t,this},zl.prototype.getBuffer=function(e){var t=this.buffer(e);return this.read+=t.byteLength,t},zl.prototype.putBuffer=function(e){return this.putBytes(e)},zl.prototype.getBytes=function(e){var t=this.bytes(e);return this.read+=t.length,t},zl.prototype.putBytes=function(e,t){if("string"==typeof e){switch(t=t||"binary"){case"utf16":t="ucs-2";break;case"raw":t="binary";break;case"base64url":e=Mu.decode(e)}Buffer.isBuffer(e)||(e=Buffer.from(e,t))}var r,n;if(e instanceof zl){var i=e;e=i.data.slice(i.read,i.write),i.read=i.write}else e instanceof Fu.util.ByteStringBuffer&&(e=e.getBytes());if(Buffer.isBuffer(e))r=e;else if(Array.isArray(e))r=Buffer.from(e);else if(Fu.util.isArrayBuffer(e))r=new Uint8Array(e),r=Buffer.from(r);else{if(!Fu.util.isArrayBufferView(e))throw new TypeError("invalid source type");r=e instanceof Uint8Array?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=Buffer.from(r)}return this.accommodate(r.length),n=this.data,r.copy(n,this.write),this.write+=r.length,this},zl.prototype.getNative=function(e){var t=this.native(e);return this.read+=t.length,t},zl.prototype.putNative=zl.prototype.putBuffer,zl.prototype.getByte=function(){var e=this.data[this.read];return this.read=Math.min(this.read+1,this.write),e},zl.prototype.putByte=function(e){return this.accommodate(1),this.data[this.write]=255&e,this.write++,this},zl.prototype.getInt16=function(){var e=this.data[this.read]<<8^this.data[this.read+1];return this.read=Math.min(this.read+2,this.write),e},zl.prototype.putInt16=function(e){return this.accommodate(2),this.data[this.write]=e>>>8&255,this.data[this.write+1]=255&e,this.write+=2,this},zl.prototype.getInt24=function(){var e=this.data[this.read]<<16^this.data[this.read+1]<<8^this.data[this.read+2];return this.read=Math.min(this.read+3,this.write),e},zl.prototype.putInt24=function(e){return this.accommodate(3),this.data[this.write]=e>>>16&255,this.data[this.write+1]=e>>>8&255,this.data[this.write+2]=255&e,this.write+=3,this},zl.prototype.getInt32=function(){var e=this.data[this.read]<<24^this.data[this.read+1]<<16^this.data[this.read+2]<<8^this.data[this.read+3];return this.read=Math.min(this.read+4,this.write),e},zl.prototype.putInt32=function(e){return this.accommodate(4),this.data[this.write]=e>>>24&255,this.data[this.write+1]=e>>>16&255,this.data[this.write+2]=e>>>8&255,this.data[this.write+3]=255&e,this.write+=4,this},zl.prototype.getInt16Le=function(){var e=this.data[this.read+1]<<8^this.data[this.read];return this.read=Math.min(this.read+2,this.write),e},zl.prototype.putInt16Le=function(e){return this.accommodate(2),this.data[this.write+1]=e>>>8&255,this.data[this.write]=255&e,this.write+=2,this},zl.prototype.getInt24Le=function(){var e=this.data[this.read+2]<<16^this.data[this.read+1]<<8^this.data[this.read];return this.read=Math.min(this.read+3,this.write),e},zl.prototype.putInt24Le=function(e){return this.accommodate(3),this.data[this.write+2]=e>>>16&255,this.data[this.write+1]=e>>>8&255,this.data[this.write]=255&e,this.write+=3,this},zl.prototype.getInt32Le=function(){var e=this.data[this.read+3]<<24^this.data[this.read+2]<<16^this.data[this.read+1]<<8^this.data[this.read];return this.read=Math.min(this.read+4,this.write),e},zl.prototype.putInt32Le=function(e){return this.accommodate(4),this.data[this.write+3]=e>>>24&255,this.data[this.write+2]=e>>>16&255,this.data[this.write+1]=e>>>8&255,this.data[this.write]=255&e,this.write+=4,this},zl.prototype.getInt=function(e){var t=0;do{t=t<<8|this.getByte(),e-=8}while(e>0);return t},zl.prototype.putInt=function(e,t){this.accommodate(Math.ceil(t/8));do{t-=8,this.putByte(e>>t&255)}while(t>0);return this},zl.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},zl.prototype.putString=function(e){return this.putBytes(e,"utf16")},zl.isBuffer=function(e){return e instanceof zl},zl.asBuffer=function(e){return zl.isBuffer(e)?e:e?new zl(e):new zl};var $l=zl;
/*!
 * algorithms/hmac.js - HMAC-based "signatures"
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function Gl(e){var t=e.replace("HS","SHA").toLowerCase(),r=e.replace("HS","SHA-");function n(e,t){return(e=(e||ql.HASHLENGTH[r])/8)>t.length?Promise.reject(new Error("invalid key length")):Promise.resolve(t)}return Hl.setupFallback((function(e,r,i){return n((i=i||{}).length,e).then((function(){var n=Hl.nodeCrypto.createHmac(t,e);n.update(r);var i=n.digest();return{data:r,mac:i}}))}),(function(e,t,i){var o={name:"HMAC",hash:{name:r}};return n((i=i||{}).length,e).then((function(){return Hl.subtleCrypto.importKey("raw",e,o,!0,["sign"])})).then((function(e){return Hl.subtleCrypto.sign(o,e,t)})).then((function(e){var r=Buffer.from(e);return{data:t,mac:r}}))}),(function(e,r,i){return n((i=i||{}).length,e).then((function(){var n=Fu.hmac.create();return n.start(t,e.toString("binary")),n.update(r.toString("binary")),n=Buffer.from(n.digest().bytes(),"binary"),{data:r,mac:n}}))}))}function Wl(e){var t=e.replace("HS","SHA").toLowerCase(),r=e.replace("HS","SHA-");function n(e,t,n){e=(e||ql.HASHLENGTH[r])/8;for(var i=!0,o=0;e>o;o++)i=i&&t[o]===n[o];return i}return Hl.setupFallback((function(e,r,i,o){o=o||{};var a=Hl.nodeCrypto.createHmac(t,e);a.update(r);var s=a.digest();if(!n(o.length,i,s))throw new Error("verification failed");return{data:r,mac:s,valid:!0}}),(function(e,t,i,o){var a={name:"HMAC",hash:{name:r}};return((o=o||{}).length?Hl.subtleCrypto.importKey("raw",e,a,!0,["sign"]).then((function(e){return Hl.subtleCrypto.sign(a,e,t)})).then((function(e){var t=Buffer.from(e);return n(o.length,i,t)})):Hl.subtleCrypto.importKey("raw",e,a,!0,["verify"]).then((function(e){return Hl.subtleCrypto.verify(a,e,i,t)}))).then((function(e){return e?{data:t,mac:i,valid:!0}:Promise.reject(new Error("verifaction failed"))}))}),(function(e,r,i,o){o=o||{};var a=Fu.hmac.create();return a.start(t,new $l(e)),a.update(r.toString("binary")),a=Buffer.from(a.digest().bytes(),"binary"),n(o.length,i,a)?Promise.resolve({data:r,mac:i,valid:!0}):Promise.reject(new Error("verification failed"))}))}var Jl={};["HS1","HS256","HS384","HS512"].forEach((function(e){Jl[e]={sign:Gl(e),verify:Wl(e)}}));var Ql=Jl;
/*!
 * algorithms/sha.js - Cryptographic Secure Hash Algorithms, versions 1 and 2
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */var Yl={};["SHA-1","SHA-256","SHA-384","SHA-512"].forEach((function(e){var t,r,n;Yl[e]={digest:(t=e,r=t.replace("SHA-","SHA").toLowerCase(),n={name:t},Hl.setupFallback((function(e){var t=Hl.nodeCrypto.createHash(r);return t.update(e),t.digest()}),(function(e){return Hl.subtleCrypto.digest(n,e).then((function(e){return e=Buffer.from(e)}))}),(function(e){var t=Fu.md[r].create();return t.update(e.toString("binary")),t=Buffer.from(t.digest().bytes(),"binary"),Promise.resolve(t)})))}}));var Xl=Yl;
/*!
 * algorithms/aes-cbc-hmac-sha2.js - AES-CBC-HMAC-SHA2 Composited Encryption
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function Zl(e){if(16!==e.length)throw new Error("invalid iv")}function ef(e){return Hl.setupFallback((function(t,r,n){try{Zl(n)}catch(o){return Promise.reject(o)}var i=Promise.resolve(r);return i=i.then((function(r){var i="AES-"+e+"-CBC",o=Hl.nodeCrypto.createCipheriv(i,t,n);return Buffer.concat([o.update(r),o.final()])}))}),(function(e,t,r){try{Zl(r)}catch(i){return Promise.reject(i)}var n=Promise.resolve();return n=(n=(n=n.then((function(){return Hl.subtleCrypto.importKey("raw",e,{name:"AES-CBC"},!0,["encrypt"])}))).then((function(e){var n={name:"AES-CBC",iv:r};return Hl.subtleCrypto.encrypt(n,e,t)}))).then((function(e){return e=Buffer.from(e)}))}),(function(e,t,r){try{Zl(r)}catch(i){return Promise.reject(i)}var n=Promise.resolve();return n=n.then((function(){var n=Fu.cipher.createCipher("AES-CBC",new $l(e));return n.start({iv:new $l(r)}),n.update(new $l(t)),n.finish()?Buffer.from(n.output.bytes(),"binary"):Promise.reject(new Error("encryption failed"))}))}))}function tf(e){return Hl.setupFallback((function(t,r,n){try{Zl(n)}catch(o){return Promise.reject(o)}var i=Promise.resolve();return i=i.then((function(){var i="AES-"+e+"-CBC",o=Hl.nodeCrypto.createDecipheriv(i,t,n);return Buffer.concat([o.update(r),o.final()])}))}),(function(e,t,r){try{Zl(r)}catch(i){return Promise.reject(i)}var n=Promise.resolve();return n=(n=(n=n.then((function(){return Hl.subtleCrypto.importKey("raw",e,{name:"AES-CBC"},!0,["decrypt"])}))).then((function(e){var n={name:"AES-CBC",iv:r};return Hl.subtleCrypto.decrypt(n,e,t)}))).then((function(e){return e=Buffer.from(e)}))}),(function(e,t,r){try{Zl(r)}catch(i){return Promise.reject(i)}var n=Promise.resolve();return n=n.then((function(){var n=Fu.cipher.createDecipher("AES-CBC",new $l(e));return n.start({iv:new $l(r)}),n.update(new $l(t)),n.finish()?Buffer.from(n.output.bytes(),"binary"):Promise.reject(new Error("encryption failed"))}))}))}function rf(e,t){if(t<<1!=e.length<<3)throw new Error("invalid encryption key size")}function nf(e){var t=ef(e);return function(r,n,i){try{rf(r,e)}catch(l){return Promise.reject(l)}var o=r.slice(e/8),a=r.slice(0,e/8),s=i.iv||Buffer.alloc(0),u=i.aad||i.adata||Buffer.alloc(0),c=t(o,n,s);return c=c.then((function(t){var r=Buffer.concat([u,s,t,Hl.int64ToBuffer(8*u.length)]);return Ql["HS"+2*e].sign(a,r,{length:e}).then((function(r){var n=r.mac.slice(0,e/8);return{data:t,tag:n}}))}))}}function of(e){var t=tf(e);return function(r,n,i){try{rf(r,e)}catch(f){return Promise.reject(f)}var o=r.slice(e/8),a=r.slice(0,e/8),s=i.iv||Buffer.alloc(0),u=i.aad||i.adata||Buffer.alloc(0),c=i.tag||i.mac||Buffer.alloc(0),l=Promise.resolve();return l=(l=l.then((function(){var t=Buffer.concat([u,s,n,Hl.int64ToBuffer(8*u.length)]);return Ql["HS"+2*e].verify(a,t,c,{length:e}).then((function(){return n}),(function(){throw new Error("mac check failed")}))}))).then((function(){return t(o,n,s)}))}}var af=Buffer.from("Encryption","utf8"),sf=Buffer.from("Integrity","utf8"),uf=Buffer.from(".","utf8");function cf(e,t,r,n){var i=8*e.length,o=i/2,a=Promise.resolve();return a=(a=a.then((function(){return Buffer.concat([Hl.int32ToBuffer(1),e,Hl.int32ToBuffer(o),Buffer.from(t,"utf8"),r,n,af])}))).then((function(e){return Xl["SHA-"+i].digest(e).then((function(e){return e.slice(0,o/8)}))})),a=Promise.resolve(a)}function lf(e,t,r,n){var i=8*e.length,o=i,a=Promise.resolve();return a=(a=a.then((function(){return Buffer.concat([Hl.int32ToBuffer(1),e,Hl.int32ToBuffer(o),Buffer.from(t,"utf8"),r,n,sf])}))).then((function(e){return Xl["SHA-"+i].digest(e).then((function(e){return e.slice(0,o/8)}))})),a=Promise.resolve(a)}function ff(e,t){var r=ef(e);return function(n,i,o){var a,s,u=o.epu||Hl.int32ToBuffer(0),c=o.epv||Hl.int32ToBuffer(0),l=o.iv||Buffer.alloc(0),f=o.aad||o.adata||Buffer.alloc(0),h=o.kdata||Buffer.alloc(0),p=[cf(n,t,u,c),lf(n,t,u,c)],d=Promise.all(p).then((function(e){a=e[0],s=e[1]}));return d=(d=(d=d.then((function(){return r(a,i,l)}))).then((function(t){var r=Buffer.concat([f,uf,Buffer.from(h),uf,Buffer.from(Vu.base64url.encode(l),"utf8"),uf,Buffer.from(Vu.base64url.encode(t),"utf8")]);return Promise.all([Promise.resolve(t),Ql["HS"+2*e].sign(s,r,{length:e})])}))).then((function(e){return{data:e[0],tag:e[1].mac}}))}}function hf(e,t){var r=tf(e);return function(n,i,o){var a,s,u=o.epu||Hl.int32ToBuffer(0),c=o.epv||Hl.int32ToBuffer(0),l=o.iv||Buffer.alloc(0),f=o.aad||o.adata||Buffer.alloc(0),h=o.kdata||Buffer.alloc(0),p=o.tag||o.mac||Buffer.alloc(0),d=[cf(n,t,u,c),lf(n,t,u,c)],g=Promise.all(d).then((function(e){a=e[0],s=e[1]}));return g=(g=g.then((function(){var t=Buffer.concat([f,uf,Buffer.from(h),uf,Buffer.from(Vu.base64url.encode(l),"utf8"),uf,Buffer.from(Vu.base64url.encode(i),"utf8")]);try{return Ql["HS"+2*e].verify(s,t,p,{loose:!1})}catch(r){throw new Error("mac check failed")}}))).then((function(){return r(a,i,l)}))}}var pf={};["A128CBC-HS256","A192CBC-HS384","A256CBC-HS512"].forEach((function(e){var t=parseInt(/A(\d+)CBC-HS(\d+)?/g.exec(e)[1]);pf[e]={encrypt:nf(t),decrypt:of(t)}})),["A128CBC+HS256","A192CBC+HS384","A256CBC+HS512"].forEach((function(e){var t=parseInt(/A(\d+)CBC\+HS(\d+)?/g.exec(e)[1]);pf[e]={encrypt:ff(t,e),decrypt:hf(t,e)}}));var df=pf,gf=vf,yf=null;try{yf=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(Aw){}function vf(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function mf(e){return!0===(e&&e.__isLong__)}vf.prototype.__isLong__,Object.defineProperty(vf.prototype,"__isLong__",{value:!0}),vf.isLong=mf;var bf={},Ef={};function Sf(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=Ef[e])?n:(r=_f(e,(0|e)<0?-1:0,!0),i&&(Ef[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=bf[e])?n:(r=_f(e,e<0?-1:0,!1),i&&(bf[e]=r),r)}function wf(e,t){if(isNaN(e))return t?Bf:Rf;if(t){if(e<0)return Bf;if(e>=Pf)return jf}else{if(e<=-Ff)return Df;if(e+1>=Ff)return Uf}return e<0?wf(-e,t).neg():_f(e%Tf|0,e/Tf|0,t)}function _f(e,t,r){return new vf(e,t,r)}vf.fromInt=Sf,vf.fromNumber=wf,vf.fromBits=_f;var Cf=Math.pow;function Af(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return Rf;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return Af(e.substring(1),t,r).neg();for(var i=wf(Cf(r,8)),o=Rf,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=parseInt(e.substring(a,a+s),r);if(s<8){var c=wf(Cf(r,s));o=o.mul(c).add(wf(u))}else o=(o=o.mul(i)).add(wf(u))}return o.unsigned=t,o}function If(e,t){return"number"==typeof e?wf(e,t):"string"==typeof e?Af(e,t):_f(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}vf.fromString=Af,vf.fromValue=If;var Tf=4294967296,Pf=Tf*Tf,Ff=Pf/2,kf=Sf(1<<24),Rf=Sf(0);vf.ZERO=Rf;var Bf=Sf(0,!0);vf.UZERO=Bf;var Of=Sf(1);vf.ONE=Of;var xf=Sf(1,!0);vf.UONE=xf;var Nf=Sf(-1);vf.NEG_ONE=Nf;var Uf=_f(-1,2147483647,!1);vf.MAX_VALUE=Uf;var jf=_f(-1,-1,!0);vf.MAX_UNSIGNED_VALUE=jf;var Df=_f(0,-2147483648,!1);vf.MIN_VALUE=Df;var Lf=vf.prototype;Lf.toInt=function(){return this.unsigned?this.low>>>0:this.low},Lf.toNumber=function(){return this.unsigned?(this.high>>>0)*Tf+(this.low>>>0):this.high*Tf+(this.low>>>0)},Lf.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Df)){var t=wf(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=wf(Cf(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),u=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}},Lf.getHighBits=function(){return this.high},Lf.getHighBitsUnsigned=function(){return this.high>>>0},Lf.getLowBits=function(){return this.low},Lf.getLowBitsUnsigned=function(){return this.low>>>0},Lf.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Df)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},Lf.isZero=function(){return 0===this.high&&0===this.low},Lf.eqz=Lf.isZero,Lf.isNegative=function(){return!this.unsigned&&this.high<0},Lf.isPositive=function(){return this.unsigned||this.high>=0},Lf.isOdd=function(){return 1==(1&this.low)},Lf.isEven=function(){return 0==(1&this.low)},Lf.equals=function(e){return mf(e)||(e=If(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},Lf.eq=Lf.equals,Lf.notEquals=function(e){return!this.eq(e)},Lf.neq=Lf.notEquals,Lf.ne=Lf.notEquals,Lf.lessThan=function(e){return this.comp(e)<0},Lf.lt=Lf.lessThan,Lf.lessThanOrEqual=function(e){return this.comp(e)<=0},Lf.lte=Lf.lessThanOrEqual,Lf.le=Lf.lessThanOrEqual,Lf.greaterThan=function(e){return this.comp(e)>0},Lf.gt=Lf.greaterThan,Lf.greaterThanOrEqual=function(e){return this.comp(e)>=0},Lf.gte=Lf.greaterThanOrEqual,Lf.ge=Lf.greaterThanOrEqual,Lf.compare=function(e){if(mf(e)||(e=If(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},Lf.comp=Lf.compare,Lf.negate=function(){return!this.unsigned&&this.eq(Df)?Df:this.not().add(Of)},Lf.neg=Lf.negate,Lf.add=function(e){mf(e)||(e=If(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,c=0,l=0,f=0;return l+=(f+=i+(65535&e.low))>>>16,c+=(l+=n+s)>>>16,u+=(c+=r+a)>>>16,u+=t+o,_f((l&=65535)<<16|(f&=65535),(u&=65535)<<16|(c&=65535),this.unsigned)},Lf.subtract=function(e){return mf(e)||(e=If(e)),this.add(e.neg())},Lf.sub=Lf.subtract,Lf.multiply=function(e){if(this.isZero())return Rf;if(mf(e)||(e=If(e)),yf)return _f(yf.mul(this.low,this.high,e.low,e.high),yf.get_high(),this.unsigned);if(e.isZero())return Rf;if(this.eq(Df))return e.isOdd()?Df:Rf;if(e.eq(Df))return this.isOdd()?Df:Rf;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(kf)&&e.lt(kf))return wf(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=65535&e.low,c=0,l=0,f=0,h=0;return f+=(h+=i*u)>>>16,l+=(f+=n*u)>>>16,f&=65535,l+=(f+=i*s)>>>16,c+=(l+=r*u)>>>16,l&=65535,c+=(l+=n*s)>>>16,l&=65535,c+=(l+=i*a)>>>16,c+=t*u+r*s+n*a+i*o,_f((f&=65535)<<16|(h&=65535),(c&=65535)<<16|(l&=65535),this.unsigned)},Lf.mul=Lf.multiply,Lf.divide=function(e){if(mf(e)||(e=If(e)),e.isZero())throw Error("division by zero");var t,r,n;if(yf)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?_f((this.unsigned?yf.div_u:yf.div_s)(this.low,this.high,e.low,e.high),yf.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Bf:Rf;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Bf;if(e.gt(this.shru(1)))return xf;n=Bf}else{if(this.eq(Df))return e.eq(Of)||e.eq(Nf)?Df:e.eq(Df)?Of:(t=this.shr(1).div(e).shl(1)).eq(Rf)?e.isNegative()?Of:Nf:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(Df))return this.unsigned?Bf:Rf;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=Rf}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:Cf(2,i-48),a=wf(t),s=a.mul(e);s.isNegative()||s.gt(r);)s=(a=wf(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=Of),n=n.add(a),r=r.sub(s)}return n},Lf.div=Lf.divide,Lf.modulo=function(e){return mf(e)||(e=If(e)),yf?_f((this.unsigned?yf.rem_u:yf.rem_s)(this.low,this.high,e.low,e.high),yf.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},Lf.mod=Lf.modulo,Lf.rem=Lf.modulo,Lf.not=function(){return _f(~this.low,~this.high,this.unsigned)},Lf.and=function(e){return mf(e)||(e=If(e)),_f(this.low&e.low,this.high&e.high,this.unsigned)},Lf.or=function(e){return mf(e)||(e=If(e)),_f(this.low|e.low,this.high|e.high,this.unsigned)},Lf.xor=function(e){return mf(e)||(e=If(e)),_f(this.low^e.low,this.high^e.high,this.unsigned)},Lf.shiftLeft=function(e){return mf(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?_f(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):_f(0,this.low<<e-32,this.unsigned)},Lf.shl=Lf.shiftLeft,Lf.shiftRight=function(e){return mf(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?_f(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):_f(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},Lf.shr=Lf.shiftRight,Lf.shiftRightUnsigned=function(e){if(mf(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?_f(this.low>>>e|t<<32-e,t>>>e,this.unsigned):_f(32===e?t:t>>>e-32,0,this.unsigned)},Lf.shru=Lf.shiftRightUnsigned,Lf.shr_u=Lf.shiftRightUnsigned,Lf.toSigned=function(){return this.unsigned?_f(this.low,this.high,!1):this},Lf.toUnsigned=function(){return this.unsigned?this:_f(this.low,this.high,!0)},Lf.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},Lf.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},Lf.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},vf.fromBytes=function(e,t,r){return r?vf.fromBytesLE(e,t):vf.fromBytesBE(e,t)},vf.fromBytesLE=function(e,t){return new vf(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},vf.fromBytesBE=function(e,t){return new vf(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var Mf=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e};var Kf=function(e){return e?Mf(to(e),0,4294967295):0};var Vf=function(e,t,r,n){var i=e.length;for((r=to(r))<0&&(r=-r>i?0:i+r),(n=void 0===n||n>i?i:to(n))<0&&(n+=i),n=r>n?0:Kf(n);r<n;)e[r++]=t;return e};var Hf=function(e,t,r,n){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&Da(e,t,r)&&(r=0,n=i),Vf(e,t,r,n)):[]},qf=u((function(e){var t=e.exports={intToBigEndian:function(e,r,n){if("number"==typeof e)switch(arguments.length){case 1:r=Buffer.alloc(4),t.intToBigEndian(e,r,0);break;case 3:r[n]=255&e>>>24,r[++n]=255&e>>>16,r[++n]=255&e>>>8,r[++n]=255&e;break;default:throw new TypeError("Expected 1 or 3 arguments.")}else switch(arguments.length){case 1:r=Buffer.alloc(4*e.length),t.intToBigEndian(e,r,0);break;case 3:for(var i=0;i<e.length;++i)t.intToBigEndian(e[i],r,n),n+=4;break;default:throw new TypeError("Expected 1 or 3 arguments.")}return r},longToBigEndian:function(e,r,n){if(Array.isArray(e))switch(arguments.length){case 1:r=Buffer.alloc(8*e.length),t.longToBigEndian(e,r,0);break;case 3:for(var i=0;i<e.length;++i)t.longToBigEndian(e[i],r,n),n+=8;break;default:throw new TypeError("Expected 1 or 3 arguments.")}else switch(arguments.length){case 1:r=Buffer.alloc(8),t.longToBigEndian(e,r,0);break;case 3:var o=e.low,a=e.high;t.intToBigEndian(a,r,n),t.intToBigEndian(o,r,n+4);break;default:throw new TypeError("Expected 1 or 3 arguments.")}return r},bigEndianToInt:function(e,r,n){switch(arguments.length){case 2:var i=e[r]<<24;return i|=(255&e[++r])<<16,i|=(255&e[++r])<<8,i|=255&e[++r];case 3:for(var o=0;o<n.length;++o)n[o]=t.bigEndianToInt(e,r),r+=4;break;default:throw new TypeError("Expected 2 or 3 arguments.")}},bigEndianToLong:function(e,r,n){switch(arguments.length){case 2:var i=t.bigEndianToInt(e,r),o=t.bigEndianToInt(e,r+4),a=new gf(o,i);return a;case 3:for(var s=0;s<n.length;++s)n[s]=t.bigEndianToLong(e,r),r+=8;break;default:throw new TypeError("Expected 2 or 3 arguments.")}}}})),zf=u((function(e){var t=3774873600,r=new gf(t>>8);var n=e.exports={E1:t,E1B:225,E1L:r,LOOKUP:function(){for(var e=[],r=0;r<256;++r){for(var n=0,i=7;i>=0;--i)0!=(r&1<<i)&&(n^=t>>>7-i);e.push(n)}return e}(),arrayCopy:function(e,t,r,n,i){if(t<0||n<0||i<0)throw new TypeError("Invalid input.");if(r instanceof Uint8Array){if(n>=r.length||n+i>r.length)throw new TypeError("Invalid input.");(0!==t||i<e.length)&&(e=e instanceof Uint8Array?e.subarray(t,t+i):e.slice(t,t+i)),r.set(e,n)}else for(var o=0;o<i;++o)r[n+o]=e[t+o]},arrayEqual:function(e,t){e=e||[],t=t||[];for(var r=Math.min(e.length,t.length),n=e.length===t.length,i=0;i<r;i++)n=n&&void 0!==e[i]&&void 0!==t[i]&&e[i]===t[i];return n},asBytes:function(e,t){switch(arguments.length){case 1:return t=Buffer.alloc(16),qf.intToBigEndian(e,t,0),t;case 2:qf.intToBigEndian(e,t,0);break;default:throw new TypeError("Expected 1 or 2 arguments.")}},asInts:function(e,t){switch(arguments.length){case 1:return Hf(t=[],0,0,4),qf.bigEndianToInt(e,0,t),t;case 2:qf.bigEndianToInt(e,0,t);break;default:throw new TypeError("Expected 1 or 2 arguments.")}},oneAsInts:function(){for(var e=[],t=0;t<4;++t)e.push(1<<31);return e},shiftRight:function(e,t){var r,n;switch(arguments.length){case 1:return r=e[0],e[0]=r>>>1,n=r<<31,r=e[1],e[1]=r>>>1|n,n=r<<31,r=e[2],e[2]=r>>>1|n,n=r<<31,r=e[3],e[3]=r>>>1|n,r<<31&4294967295;case 2:return r=e[0],t[0]=r>>>1,n=r<<31,r=e[1],t[1]=r>>>1|n,n=r<<31,r=e[2],t[2]=r>>>1|n,n=r<<31,r=e[3],t[3]=r>>>1|n,r<<31&4294967295;default:throw new TypeError("Expected 1 or 2 arguments.")}},shiftRightN:function(e,t,r){var n,i,o;switch(arguments.length){case 2:return i=e[0],n=32-t,e[0]=i>>>t,o=i<<n,i=e[1],e[1]=i>>>t|o,o=i<<n,i=e[2],e[2]=i>>>t|o,o=i<<n,i=e[3],e[3]=i>>>t|o,i<<n;case 3:return i=e[0],n=32-t,r[0]=i>>>t,o=i<<n,i=e[1],r[1]=i>>>t|o,o=i<<n,i=e[2],r[2]=i>>>t|o,o=i<<n,i=e[3],r[3]=i>>>t|o,i<<n;default:throw new TypeError("Expected 2 or 3 arguments.")}},xor:function(e,t,r){switch(arguments.length){case 2:e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3];break;case 3:r[0]=e[0]^t[0],r[1]=e[1]^t[1],r[2]=e[2]^t[2],r[3]=e[3]^t[3];break;default:throw new TypeError("Expected 2 or 3 arguments.")}},multiply:function(e,t){for(var r=e.slice(),i=[],o=0;o<4;++o)for(var a=t[o],s=31;s>=0;--s)0!=(a&1<<s)&&n.xor(i,r),0!==n.shiftRight(r)&&(r[0]^=n.E1);n.arrayCopy(i,0,e,0,4)},multiplyP:function(e,t){switch(arguments.length){case 1:0!==n.shiftRight(e)&&(e[0]^=n.E1);break;case 2:0!==n.shiftRight(e,t)&&(t[0]^=n.E1);break;default:throw new TypeError("Expected 1 or 2 arguments.")}},multiplyP8:function(e,t){var r;switch(arguments.length){case 1:r=n.shiftRightN(e,8),e[0]^=n.LOOKUP[r>>>24];break;case 2:r=n.shiftRightN(e,8,t),t[0]^=n.LOOKUP[r>>>24];break;default:throw new TypeError("Expected 1 or 2 arguments.")}}}}));
/*!
 * deps/ciphermodes/pack.js - Pack/Unpack Functions
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
/*!
 * deps/ciphermodes/gcm/multipliers.js - AES-GCM Multipliers
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
function $f(){this.H=[],this.M=null}$f.prototype.init=function(e){var t,r,n;if(null==this.M)for(this.M=[],t=0;t<32;++t)for(this.M[t]=[],r=0;r<16;++r)for(this.M[t][r]=[],n=0;n<4;++n)this.M[t][r][n]=0;else if(zf.arrayEqual(this.H,e))return;for(this.H=e.slice(),zf.asInts(e,this.M[1][8]),r=4;r>=1;r>>=1)zf.multiplyP(this.M[1][r+r],this.M[1][r]);for(zf.multiplyP(this.M[1][1],this.M[0][8]),r=4;r>=1;r>>=1)zf.multiplyP(this.M[0][r+r],this.M[0][r]);for(t=0;;){for(r=2;r<16;r+=r)for(n=1;n<r;++n)zf.xor(this.M[t][r],this.M[t][n],this.M[t][r+n]);if(32==++t)return;if(t>1)for(r=8;r>0;r>>=1)zf.multiplyP8(this.M[t-2][r],this.M[t][r])}},$f.prototype.multiplyH=function(e){for(var t=[],r=15;r>=0;--r){var n=this.M[r+r][15&e[r]];t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3],n=this.M[r+r+1][(240&e[r])>>>4],t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3]}qf.intToBigEndian(t,e,0)};var Gf={"8k":$f};
/*!
 * deps/ciphermodes/helpers.js - Cipher Helper Functions
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */var Wf={encrypt:function(e,t,r,n,i){var o=new Array(4),a=new Array(4);qf.bigEndianToInt(t,r,o),e.encrypt(o,a),qf.intToBigEndian(a,n,i)}};
/*!
 * deps/ciphermodes/gcm/index.js - AES-GCM implementation Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function Jf(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=this.blockSize||16}var Qf=function(e){var t=new Fu.aes.Algorithm("AES-GCM",Jf);return t.initialize({key:new $l(e.key)}),t.mode.start(e),t.mode},Yf=function(e){var t=new Fu.aes.Algorithm("AES-GCM",Jf);return t.initialize({key:new $l(e.key)}),t.mode._decrypt=!0,t.mode.start(e),t.mode};
/*!
 * algorithms/aes-gcm.js - AES-GCM Encryption and Key-Wrapping
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
function Xf(e,t){function r(r,n){if(e!==r.length<<3)throw new Error("invalid key size");if(!n&&!t)throw new Error("invalid iv");if(n&&12!==n.length)throw new Error("invalid iv")}function n(e){if(t){var r=Vu.base64url.encode(e.iv),n=Vu.base64url.encode(e.tag);e={data:e.data,header:{iv:r,tag:n}}}return e}return Hl.setupFallback((function(e,t,i){var o=i.iv,a=i.aad||i.adata||Buffer.alloc(0);try{r(e,o)}catch(c){return Promise.reject(c)}o=o||Vu.randomBytes(12);var s,u="aes-"+8*e.length+"-gcm";try{s=Hl.nodeCrypto.createCipheriv(u,e,o)}catch(c){throw new Error("unsupported algorithm: "+u)}if("function"!=typeof s.setAAD)throw new Error("unsupported algorithm: "+u);return a.length&&s.setAAD(a),n({data:Buffer.concat([s.update(t),s.final()]),iv:o,tag:s.getAuthTag()})}),(function(e,t,i){var o=i.iv,a=i.aad||i.adata||Buffer.alloc(0);try{r(e,o)}catch(u){return Promise.reject(u)}o=o||Vu.randomBytes(12);var s={name:"AES-GCM"};return Hl.subtleCrypto.importKey("raw",e,s,!0,["encrypt"]).then((function(e){return s.iv=o,s.tagLength=128,a.length&&(s.additionalData=a),Hl.subtleCrypto.encrypt(s,e,t)})).then((function(e){var t=e.byteLength-16,r=e.slice(t);r=Buffer.from(r);var i=e.slice(0,t);return n({data:i=Buffer.from(i),iv:o,tag:r})}))}),(function(e,t,i){var o,a,s=i.iv,u=i.aad||i.adata||Buffer.alloc(0);try{r(e,s)}catch(c){return Promise.reject(c)}return s=s||Vu.randomBytes(12),o=Qf({key:e,iv:s,additionalData:u}),a=Buffer.alloc(t.length),new Promise((function(e,r){var i=ql.CHUNK_SIZE,u=0,c=0;!function l(){var f=Math.min(i,t.length-c);if(u+=o.update(t,c,f,a,u),c+=f,t.length>c)setTimeout(l,0);else if((u+=o.finish(a,u))===t.length){var h=o.tag;e(n({data:a,iv:s,tag:h}))}else r(new Error("encryption failed"))}()}))}))}function Zf(e){function t(t,r,n){if(e!==t.length<<3)throw new Error("invalid key size");if(12!==r.length)throw new Error("invalid iv");if(16!==n.length)throw new Error("invalid tag length")}return Hl.setupFallback((function(e,r,n){var i=n.aad||n.adata||Buffer.alloc(0),o=n.iv||Buffer.alloc(0),a=n.tag||n.mac||Buffer.alloc(0);try{t(e,o,a)}catch(c){return Promise.reject(c)}var s,u="aes-"+8*e.length+"-gcm";try{s=Hl.nodeCrypto.createDecipheriv(u,e,o)}catch(c){throw new Error("unsupported algorithm: "+u)}if("function"!=typeof s.setAAD)throw new Error("unsupported algorithm: "+u);s.setAuthTag(a),i.length&&s.setAAD(i);try{return Buffer.concat([s.update(r),s.final()])}catch(c){throw new Error("decryption failed")}}),(function(e,r,n){var i=n.aad||n.adata||Buffer.alloc(0),o=n.iv||Buffer.alloc(0),a=n.tag||n.mac||Buffer.alloc(0);try{t(e,o,a)}catch(u){return Promise.reject(u)}var s={name:"AES-GCM"};return Hl.subtleCrypto.importKey("raw",e,s,!0,["decrypt"]).then((function(e){return s.iv=o,s.tagLength=128,i.length&&(s.additionalData=i),r=Buffer.concat([r,a],r.length+a.length),Hl.subtleCrypto.decrypt(s,e,r)})).then((function(e){return e=Buffer.from(e)}))}),(function(e,r,n){var i,o,a=n.aad||n.adata||Buffer.alloc(0),s=n.iv||Buffer.alloc(0),u=n.tag||n.mac||Buffer.alloc(0);try{t(e,s,u)}catch(c){return Promise.reject(c)}return i=Yf({key:e,iv:s,additionalData:a,tag:u}),o=Buffer.alloc(r.length),new Promise((function(e,t){var n=ql.CHUNK_SIZE,a=0,s=0;!function u(){var l=Math.min(n,r.length-s);if(a+=i.update(r,s,l,o,a),s+=l,r.length>s)setTimeout(u,0);else{try{a+=i.finish(o,a)}catch(c){return void t(new Error("decryption failed"))}a===r.length?e(o):t(new Error("decryption failed"))}}()}))}))}Jf.prototype.start=function(e){if(this.tag=null,!("iv"in(e=e||{})))throw new Error("Gcm needs ParametersWithIV or AEADParameters");if(this.nonce=e.iv,null==this.nonce||this.nonce.length<1)throw new Error("IV must be at least 1 byte");this.tagLength=16,"tag"in e&&(this.tag=Buffer.from(e.tag));var t=this._decrypt?this.blockSize+this.tagLength:this.blockSize;this.bufBlock=Buffer.alloc(t);var r=e.multiplier;if(null==r&&(r=new Gf["8k"]),this.multiplier=r,this.H=this.zeroBlock(),Wf.encrypt(this.cipher,this.H,0,this.H,0),this.multiplier.init(this.H),this.exp=null,this.J0=this.zeroBlock(),12===this.nonce.length)this.nonce.copy(this.J0,0,0,this.nonce.length),this.J0[this.blockSize-1]=1;else{this.gHASH(this.J0,this.nonce,this.nonce.length);var n=this.zeroBlock();qf.longToBigEndian(new gf(this.nonce.length).multiply(8),n,8),this.gHASHBlock(this.J0,n)}this.S=this.zeroBlock(),this.SAt=this.zeroBlock(),this.SAtPre=this.zeroBlock(),this.atBlock=this.zeroBlock(),this.atBlockPos=0,this.atLength=gf.ZERO,this.atLengthPre=gf.ZERO,this.counter=Buffer.from(this.J0),this.bufOff=0,this.totalLength=gf.ZERO,"additionalData"in e&&this.processAADBytes(e.additionalData,0,e.additionalData.length)},Jf.prototype.update=function(e,t,r,n,i){for(var o=0;r>0;){var a=Math.min(r,this.bufBlock.length-this.bufOff);e.copy(this.bufBlock,this.bufOff,t,t+a),r-=a,t+=a,this.bufOff+=a,this.bufOff===this.bufBlock.length&&(this.outputBlock(n,i+o),o+=this.blockSize)}return o},Jf.prototype.finish=function(e,t){var r=0;this._decrypt&&(r+=this.update(this.tag,0,this.tag.length,e,t)),this.totalLength.isZero()&&this.initCipher();var n=this.bufOff;if(this._decrypt){if(n<this.tagLength)throw new Error("data too short");n-=this.tagLength}n>0&&(this.gCTRPartial(this.bufBlock,0,n,e,t+r),r+=n),this.atLength=this.atLength.add(this.atBlockPos);var i=this.zeroBlock();qf.longToBigEndian(this.atLength.multiply(8),i,0),qf.longToBigEndian(this.totalLength.multiply(8),i,8),this.gHASHBlock(this.S,i);var o=Buffer.alloc(this.blockSize);if(Wf.encrypt(this.cipher,this.J0,0,o,0),this.xor(o,this.S),this._decrypt){if(!zf.arrayEqual(this.tag,o))throw new Error("mac check in Gcm failed")}else this.tag=Buffer.alloc(this.tagLength),o.copy(this.tag,0,0,this.tagLength);return r},Jf.prototype.initCipher=function(){this.atLength.greaterThan(gf.ZERO)&&(this.SAt.copy(this.SAtPre,0,0,this.blockSize),this.atLengthPre=this.atLength.add(gf.ZERO)),this.atBlockPos>0&&(this.gHASHPartial(this.SAtPre,this.atBlock,0,this.atBlockPos),this.atLengthPre=this.atLengthPre.add(this.atBlockPos)),this.atLengthPre.greaterThan(gf.ZERO)&&this.SAtPre.copy(this.S,0,0,this.blockSize)},Jf.prototype.outputBlock=function(e,t){this.totalLength.isZero()&&this.initCipher(),this.gCTRBlock(this.bufBlock,e,t),this._decrypt?(this.bufBlock.copy(this.bufBlock,0,this.blockSize,this.blockSize+this.tagLength),this.bufOff=this.tagLength):this.bufOff=0},Jf.prototype.processAADBytes=function(e,t,r){for(var n=0;n<r;++n)this.atBlock[this.atBlockPos]=e[t+n],++this.atBlockPos===this.blockSize&&(this.gHASHBlock(this.SAt,this.atBlock),this.atBlockPos=0,this.atLength=this.atLength.add(this.blockSize))},Jf.prototype.getNextCounterBlock=function(){for(var e=15;e>=12;--e){var t=this.counter[e]+1&255;if(this.counter[e]=t,0!==t)break}var r=Buffer.alloc(this.blockSize);return Wf.encrypt(this.cipher,this.counter,0,r,0),r},Jf.prototype.gCTRBlock=function(e,t,r){var n=this.getNextCounterBlock();this.xor(n,e),n.copy(t,r,0,this.blockSize),this.gHASHBlock(this.S,this._decrypt?e:n),this.totalLength=this.totalLength.add(this.blockSize)},Jf.prototype.gCTRPartial=function(e,t,r,n,i){var o=this.getNextCounterBlock();this.xor(o,e,t,r),o.copy(n,i,0,r),this.gHASHPartial(this.S,this._decrypt?e:o,0,r),this.totalLength=this.totalLength.add(r)},Jf.prototype.gHASHBlock=function(e,t){this.xor(e,t),this.multiplier.multiplyH(e)},Jf.prototype.gHASHPartial=function(e,t,r,n){this.xor(e,t,r,n),this.multiplier.multiplyH(e)},Jf.prototype.xor=function(e,t,r,n){switch(arguments.length){case 2:for(var i=15;i>=0;--i)e[i]^=t[i];break;case 4:for(;n-- >0;)e[n]^=t[r+n];break;default:throw new TypeError("Expected 2 or 4 arguments.")}return e},Jf.prototype.zeroBlock=function(){return Buffer.alloc(16)};var eh={};["A128GCM","A192GCM","A256GCM","A128GCMKW","A192GCMKW","A256GCMKW"].forEach((function(e){var t=/A(\d+)GCM(KW)?/g.exec(e),r=parseInt(t[1]),n="KW"===t[2];eh[e]={encrypt:Xf(r,n),decrypt:Zf(r)}}));var th=eh,rh=Buffer.from("a6a6a6a6a6a6a6a6","hex");
/*!
 * algorithms/aes-kw.js - AES-KW Key-Wrapping
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function nh(e,t){for(var r=Math.max(e.length,t.length),n=Buffer.alloc(r),i=0;r>i;i++)n[i]=(e[i]||0)^(t[i]||0);return n}function ih(e,t){for(var r=[],n=0;e.length>n;n+=t)r.push(e.slice(n,n+t));return r}function oh(e){var t=Math.floor(e/4294967296),r=e%4294967296,n=Buffer.alloc(8);return n[0]=255&t>>>24,n[1]=255&t>>>16,n[2]=255&t>>>8,n[3]=255&t>>>0,n[4]=255&r>>>24,n[5]=255&r>>>16,n[6]=255&r>>>8,n[7]=255&r>>>0,n}function ah(e){function t(t,r){if(e!==t.length<<3)throw new Error("invalid key size");if(0<r.length&&r.length%8!=0)throw new Error("invalid data length")}return Hl.setupFallback((function(r,n){try{t(r,n)}catch(h){return Promise.reject(h)}var i,o,a,s=ih(n,8),u=Buffer.alloc(16);i=rh;for(var c=0;6>c;c++)for(var l=0;s.length>l;l++){a=s.length*c+l+1,o=Buffer.concat([i,s[l]]),i=nh((o=Hl.nodeCrypto.createCipheriv("AES"+e,r,u).update(o)).slice(0,8),oh(a)),s[l]=o.slice(8,16)}s=[i].concat(s);var f=Buffer.concat(s);return Promise.resolve({data:f})}),(function(e,r){try{t(e,r)}catch(o){return Promise.reject(o)}var n={name:"AES-KW"},i=[Hl.subtleCrypto.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),Hl.subtleCrypto.importKey("raw",e,n,!0,["wrapKey"])];return i=(i=(i=Promise.all(i)).then((function(e){return Hl.subtleCrypto.wrapKey("raw",e[0],e[1],n)}))).then((function(e){return{data:e=Buffer.from(e)}}))}),(function(e,r){try{t(e,r)}catch(f){return Promise.reject(f)}var n,i,o,a=Fu.cipher.createCipher("AES",new $l(e)),s=ih(r,8);n=rh;for(var u=0;6>u;u++)for(var c=0;s.length>c;c++)o=s.length*u+c+1,i=Buffer.concat([n,s[c]]),a.start(),a.update(new $l(i)),a.finish(),n=nh((i=Buffer.from(a.output.bytes(),"binary")).slice(0,8),oh(o)),s[c]=i.slice(8,16);s=[n].concat(s);var l=Buffer.concat(s);return Promise.resolve({data:l})}))}function sh(e){function t(t,r){if(e!==t.length<<3)throw new Error("invalid key size");if(0<r.length-8&&r.length%8!=0)throw new Error("invalid data length")}return Hl.setupFallback((function(r,n){try{t(r,n)}catch(f){return Promise.reject(f)}var i,o,a=ih(n,8),s=Buffer.alloc(16);i=a[0],a=a.slice(1);for(var u=5;0<=u;--u)for(var c=a.length-1;0<=c;--c){o=nh(i,oh(a.length*u+c+1)),o=Buffer.concat([o,a[c],s]),i=(o=Hl.nodeCrypto.createDecipheriv("AES"+e,r,s).update(o)).slice(0,8),a[c]=o.slice(8,16)}if(i.toString()!==rh.toString())return Promise.reject(new Error("decryption failed"));var l=Buffer.concat(a);return Promise.resolve(l)}),(function(e,r){try{t(e,r)}catch(o){return Promise.reject(o)}var n={name:"AES-KW"},i=Hl.subtleCrypto.importKey("raw",e,n,!0,["unwrapKey"]);return i=(i=(i=i.then((function(e){return Hl.subtleCrypto.unwrapKey("raw",r,e,n,{name:"HMAC",hash:"SHA-256"},!0,["sign"])}))).then((function(e){return Hl.subtleCrypto.exportKey("raw",e)}))).then((function(e){return e=Buffer.from(e)}))}),(function(e,r){try{t(e,r)}catch(l){return Promise.reject(l)}var n,i,o=Fu.cipher.createDecipher("AES",new $l(e)),a=ih(r,8);n=a[0],a=a.slice(1);for(var s=5;0<=s;--s)for(var u=a.length-1;0<=u;--u)i=nh(n,oh(a.length*s+u+1)),i=Buffer.concat([i,a[u]]),o.start(),o.update(new $l(i)),o.finish(),n=(i=Buffer.from(o.output.bytes(),"binary")).slice(0,8),a[u]=i.slice(8,16);if(n.toString()!==rh.toString())return Promise.reject(new Error("decryption failed"));var c=Buffer.concat(a);return Promise.resolve(c)}))}var uh={};["A128KW","A192KW","A256KW"].forEach((function(e){var t=parseInt(/A(\d+)KW/g.exec(e)[1]);uh[e]={encrypt:ah(t),decrypt:sh(t)}}));var ch=uh;
/*!
 * algorithms/concat.js - Concat Key Derivation
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function lh(e){e=e.replace("CONCAT-","");return function(t,r){var n=(r=r||{}).length,i=ql.HASHLENGTH[e];if(!n)return Promise.reject(new Error("invalid key length"));if(!r.otherInfo)return Promise.reject(new Error("invalid otherInfo"));var o=r.otherInfo,a=Xl[e].digest,s=Math.ceil(n/i),u=0,c=[];return function e(){if(s===u++)return Buffer.concat(c).slice(0,n);var r=Buffer.alloc(4+t.length+o.length);return r.writeUInt32BE(u,0),t.copy(r,4),o.copy(r,4+t.length),a(r).then((function(t){return c.push(t),e()}))}()}}var fh={};["CONCAT-SHA-1","CONCAT-SHA-256","CONCAT-SHA-384","CONCAT-SHA-512"].forEach((function(e){fh[e]={derive:lh(e)}}));var hh=fh;
/*!
 * algorithms/dir.js - Direct key mode
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */var ph={dir:{encrypt:function(e){return Promise.resolve({data:e,once:!0,direct:!0})},decrypt:function(e){return Promise.resolve(e)}}},dh=Fu.jsbn.BigInteger;function gh(){return new dh(null)}function yh(e){this.r2=gh(),this.q3=gh(),dh.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function vh(e,t){this.x=t,this.p=e}function mh(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=n||dh.ONE,this.zinv=null}function bh(e,t,r){this.p=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new mh(this,null,null),this.reducer=new yh(this.p)}yh.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=gh();return e.copyTo(t),this.reduce(t),t},yh.prototype.revert=function(e){return e},yh.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},yh.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},yh.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},vh.prototype.equals=function(e){return e===this||this.p.equals(e.p)&&this.x.equals(e.x)},vh.prototype.toBigInteger=function(){return this.x},vh.prototype.negate=function(){return new vh(this.p,this.x.negate().mod(this.p))},vh.prototype.add=function(e){return new vh(this.p,this.x.add(e.toBigInteger()).mod(this.p))},vh.prototype.subtract=function(e){return new vh(this.p,this.x.subtract(e.toBigInteger()).mod(this.p))},vh.prototype.multiply=function(e){return new vh(this.p,this.x.multiply(e.toBigInteger()).mod(this.p))},vh.prototype.square=function(){return new vh(this.p,this.x.pow(2).mod(this.p))},vh.prototype.divide=function(e){return new vh(this.p,this.x.multiply(e.toBigInteger().modInverse(this.p)).mod(this.p))},mh.prototype.getX=function(){this.zinv||(this.zinv=this.z.modInverse(this.curve.p));var e=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(e),this.curve.fromBigInteger(e)},mh.prototype.getY=function(){this.zinv||(this.zinv=this.z.modInverse(this.curve.p));var e=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(e),this.curve.fromBigInteger(e)},mh.prototype.equals=function(e){return e===this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.p).equals(dh.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.p).equals(dh.ZERO))},mh.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(dh.ZERO)&&!this.y.toBigInteger().equals(dh.ZERO)},mh.prototype.negate=function(){return new mh(this.curve,this.x,this.y.negate(),this.z)},mh.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.p),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.p);if(dh.ZERO.equals(r))return dh.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new dh("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),a=r.pow(2),s=a.multiply(r),u=i.multiply(a),c=t.pow(2).multiply(this.z),l=c.subtract(u.shiftLeft(1)).multiply(e.z).subtract(s).multiply(r).mod(this.curve.p),f=u.multiply(n).multiply(t).subtract(o.multiply(s)).subtract(c.multiply(t)).multiply(e.z).add(t.multiply(s)).mod(this.curve.p),h=s.multiply(this.z).multiply(e.z).mod(this.curve.p);return new mh(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(f),h)},mh.prototype.twice=function(){if(this.isInfinity())return this;if(0===this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new dh("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.p),o=this.curve.a.toBigInteger(),a=t.pow(2).multiply(e);dh.ZERO.equals(o)||(a=a.add(this.z.pow(2).multiply(o)));var s=(a=a.mod(this.curve.p)).pow(2).subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.p),u=a.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.pow(2).multiply(a)).mod(this.curve.p),c=n.pow(2).multiply(n).shiftLeft(3).mod(this.curve.p);return new mh(this.curve,this.curve.fromBigInteger(s),this.curve.fromBigInteger(u),c)},mh.prototype.multiply=function(e){if(this.isInfinity())return this;if(0===e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new dh("3")),i=this.negate(),o=this;for(t=n.bitLength()-2;t>0;--t){o=o.twice();var a=n.testBit(t);a!==r.testBit(t)&&(o=o.add(a?this:i))}return o},mh.prototype.multiplyTwo=function(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(o):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i},bh.prototype.getP=function(){return this.p},bh.prototype.getA=function(){return this.a},bh.prototype.getB=function(){return this.b},bh.prototype.equals=function(e){return e===this||this.p.equals(e.p)&&this.a.equals(e.a)&&this.b.equals(e.b)},bh.prototype.contains=function(e){var t=e.getX().toBigInteger(),r=e.getY().toBigInteger(),n=this.a.toBigInteger(),i=this.b.toBigInteger(),o=this.p,a=r.pow(2).mod(o),s=t.pow(3).add(n.multiply(t)).add(i).mod(o);return a.equals(s)},bh.prototype.getInfinity=function(){return this.infinity},bh.prototype.fromBigInteger=function(e){return new vh(this.p,e)},bh.prototype.reduce=function(e){this.reducer.reduce(e)},bh.prototype.decodePointHex=function(e){switch(parseInt(e.substring(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),n=e.substr(t+2,t);return new mh(this,this.fromBigInteger(new dh(r,16)),this.fromBigInteger(new dh(n,16)));default:return null}},bh.prototype.encodePointHex=function(e){if(e.isInfinity())return"00";var t=e.getX().toBigInteger().toString(16),r=e.getY().toBigInteger().toString(16),n=this.getP().toString(16).length;for(n%2!=0&&n++;t.length<n;)t="0"+t;for(;r.length<n;)r="0"+r;return"04"+t+r};var Eh={ECFieldElementFp:vh,ECPointFp:mh,ECCurveFp:bh},Sh=u((function(e){var t=Fu.jsbn.BigInteger;function r(e,t,r,n){this.curve=e,this.g=t,this.n=r,this.h=n}function n(e){return new t(e,16)}r.prototype.getCurve=function(){return this.curve},r.prototype.getG=function(){return this.g},r.prototype.getN=function(){return this.n},r.prototype.getH=function(){return this.h};var i,o,a,s,u,c,l,f=e.exports={secp256r1:(i=n("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"),o=n("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"),a=n("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"),s=n("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"),u=t.ONE,c=new Eh.ECCurveFp(i,o,a),l=c.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5"),new r(c,l,s,u)),secp384r1:function(){var e=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF"),i=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC"),o=n("B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF"),a=n("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973"),s=t.ONE,u=new Eh.ECCurveFp(e,i,o),c=u.decodePointHex("04AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB73617DE4A96262C6F5D9E98BF9292DC29F8F41DBD289A147CE9DA3113B5F0B8C00A60B1CE1D7E819D7A431D7C90EA0E5F");return new r(u,c,a,s)}(),secp521r1:function(){var e=n("01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"),i=n("01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC"),o=n("0051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00"),a=n("01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409"),s=t.ONE,u=new Eh.ECCurveFp(e,i,o),c=u.decodePointHex("0400C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66011839296A789A3BC0045C8A5FB42C7D1BD998F54449579B446817AFBD17273E662C97EE72995EF42640C550B9013FAD0761353C7086A272C24088BE94769FD16650");return new r(u,c,a,s)}()};f["P-256"]=f.secp256r1,f["P-384"]=f.secp384r1,f["P-521"]=f.secp521r1})),wh=Fu.jsbn.BigInteger;function _h(e){return new wh(e,16)}function Ch(e,t){t||(t=Math.ceil(e.bitLength()/8)),t*=2;var r=e.toString(16);for(r=r.substring(Math.max(r.length-t,0));t>r.length;)r="0"+r;return Buffer.from(r,"hex")}function Ah(e){return"string"==typeof e&&(e=Buffer.from(e,"binary")),_h(e.toString("hex"))}function Ih(e){return Math.ceil(e.getN().bitLength()/8)}function Th(e){var t=Sh[e];if(!t)throw new TypeError("unsupported named curve: "+e);return t}function Ph(e,t){var r=e.getN().bitLength(),n=8*t.length,i=Ah(t);return r<n&&(i=i.shiftRight(n-r)),i}function Fh(e,t,r){var n=Th(e),i=n.getCurve(),o=new Eh.ECPointFp(i,i.fromBigInteger(t),i.fromBigInteger(r));this.curve=e,this.params=n,this.point=o;var a=Ih(n);this.x=Ch(t,a),this.y=Ch(r,a)}function kh(e,t){var r=Th(e);this.curve=e,this.params=r;var n=Ih(r);this.d=Ch(t,n)}Fh.prototype.isValid=function(){return this.params.curve.contains(this.point)},Fh.prototype.verify=function(e,t){var r=this.params.getN(),n=this.params.getG(),i=Ah(t.r),o=Ah(t.s);if(i.compareTo(wh.ONE)<0||i.compareTo(r)>=0)return!1;if(o.compareTo(wh.ONE)<0||i.compareTo(r)>=0)return!1;var a=Ph(this.params,e),s=o.modInverse(r),u=a.multiply(s).mod(r),c=i.multiply(s).mod(r),l=n.multiplyTwo(u,this.point,c).getX().toBigInteger();return(l=l.mod(r)).equals(i)},kh.prototype.toPublicKey=function(){var e=Ah(this.d),t=this.params.getG().multiply(e);return new Fh(this.curve,t.getX().toBigInteger(),t.getY().toBigInteger())},kh.prototype.sign=function(e){var t,r,n,i,o=Ih(this.params),a=this.params.getN(),s=this.params.getG(),u=Ph(this.params,e),c=Ah(this.d);do{do{do{n=Ah(Fu.random.getBytes(o))}while(n.equals(wh.ZERO)||n.compareTo(a)>=0);t=s.multiply(n).getX().toBigInteger().mod(a)}while(t.equals(wh.ZERO));i=c.multiply(t),i=u.add(i),r=n.modInverse(a).multiply(i).mod(a)}while(r.equals(wh.ONE));var l=Ih(this.params);return{r:t=Ch(t,l),s:r=Ch(r,l)}},kh.prototype.isValid=function(){var e=Ah(this.d),t=this.params.getN().subtract(wh.ONE);return e.compareTo(wh.ONE)>=0&&e.compareTo(t)<0},kh.prototype.computeSecret=function(e){var t=Ah(this.d),r=e.point.multiply(t).getX().toBigInteger();return r=Ch(r,Ih(this.params))};var Rh={generateKeyPair:function(e){var t=Th(e),r=t.getN(),n=Fu.random.getBytes(Ih(t));n=Ah(n);var i=r.subtract(wh.ONE),o=new kh(e,n.mod(i).add(wh.ONE)),a=o.toPublicKey();return{private:o,public:a}},asPublicKey:function(e,t,r){return"string"==typeof t?t=_h(t):Buffer.isBuffer(t)&&(t=Ah(t)),"string"==typeof r?r=_h(r):Buffer.isBuffer(r)&&(r=Ah(r)),new Fh(e,t,r)},asPrivateKey:function(e,t){return"string"==typeof t?t=_h(t):Buffer.isBuffer(t)&&(t=Ah(t)),new kh(e,t)}},Bh={"P-256":256,"P-384":384,"P-521":521};function Oh(e,t){var r=xc(e);return(t?["x","y"]:["d"]).forEach((function(e){r[e]=Vu.asBuffer(r[e],"base64url")})),r}var xh=Buffer.from([4]);var Nh="Could not extract parameters from DER signature";function Uh(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=128&&--n,n}var jh={convertToForge:function(e,t){var r=t?["x","y"]:["d"];return r=r.map((function(t){return new Fu.jsbn.BigInteger(e[t].toString("hex"),16)})),r=[e.crv].concat(r),(t?Rh.asPublicKey:Rh.asPrivateKey).apply(Rh,r)},convertToJWK:function(e,t){var r=xc(e);return(t?["x","y"]:["x","y","d"]).forEach((function(e){r[e]=Vu.base64url.encode(r[e])})),delete r.key_ops,delete r.use,delete r.alg,t&&delete r.d,r},convertToObj:Oh,convertToBuffer:function(e,t){return e=Oh(e,t),t?Buffer.concat([xh,e.x,e.y]):e.d},curveSize:function(e){return Bh[e||""]||NaN},derToConcat:function(e,t){var r=0;if(48!==e[r++])throw new Error(Nh);var n=e[r++];if(129===n&&(n=e[r++]),n>e.length-r)throw new Error(Nh);if(2!==e[r++])throw new Error(Nh);var i=e[r++];if(i>e.length-r-2)throw new Error(Nh);if(i>t+1)throw new Error(Nh);var o=r;if(r+=i,2!==e[r++])throw new Error(Nh);var a=e[r++];if(a!==e.length-r)throw new Error(Nh);if(a>t+1)throw new Error(Nh);var s=r;if((r+=a)!==e.length)throw new Error(Nh);var u=t-i,c=t-a,l=Buffer.alloc(u+i+c+a);for(r=0;r<u;++r)l[r]=0;var f=Math.max(-u,0);e.copy(l,r,o+f,o+i);for(var h=r=t;r<h+c;++r)l[r]=0;var p=Math.max(-c,0);return e.copy(l,r,s+p,s+a),l},concatToDer:function(e,t){var r=Uh(e,0,t),n=Uh(e,t,e.length),i=t-r,o=t-n,a=i+o+4,s=a<128,u=Buffer.alloc((s?2:3)+a),c=0;return u[c++]=48,s?u[c++]=a:(u[c++]=129,u[c++]=255&a),u[c++]=2,u[c++]=i,r<0?(u[c++]=0,c+=e.copy(u,c,0,t)):c+=e.copy(u,c,r,t),u[c++]=2,u[c++]=o,n<0?(u[c++]=0,e.copy(u,c,t)):e.copy(u,c,t+n),u},convertToPEM:function(e,t){var r,n,i,o=e.crv;return o=function(e){switch(e){case"P-256":return"1.2.840.10045.3.1.7";case"P-384":return"1.3.132.0.34";case"P-521":return"1.3.132.0.35";default:return null}}(o),o=Fu.asn1.oidToDer(o),t?(r="EC PRIVATE KEY",n=Buffer.concat([Buffer.from([0,4]),e.x,e.y]).toString("binary"),e=e.d.toString("binary"),i=Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.SEQUENCE,!0,[Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.INTEGER,!1,""),Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.OCTETSTRING,!1,e),Fu.asn1.create(Fu.asn1.Class.CONTEXT_SPECIFIC,0,!0,[Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.OID,!1,o.bytes())]),Fu.asn1.create(Fu.asn1.Class.CONTEXT_SPECIFIC,1,!0,[Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.BITSTRING,!1,n)])])):(r="PUBLIC KEY",e=Buffer.concat([Buffer.from([0,4]),e.x,e.y]).toString("binary"),i=Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.SEQUENCE,!0,[Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.SEQUENCE,!0,[Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.OID,!1,Fu.asn1.oidToDer("1.2.840.10045.2.1").bytes()),Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.OID,!1,o.bytes())]),Fu.asn1.create(Fu.asn1.Class.UNIVERSAL,Fu.asn1.Type.BITSTRING,!1,e)])),i=Fu.asn1.toDer(i).bytes(),Fu.pem.encode({type:r,body:i})},EC_OID:"1.2.840.10045.2.1"};
/*!
 * algorithms/hkdf.js - HMAC-based Extract-and-Expand Key Derivation
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function Dh(e){var t=e.replace("HKDF-",""),r=e.replace("HKDF-SHA-","HS");return function(e,n){var i=ql.HASHLENGTH[t]/8;"string"==typeof r&&(r=Ql[r].sign);var o=(n=n||{}).salt;o&&0!==o.length||(o=Buffer.alloc(i));var a=n.info||Buffer.alloc(0),s=n.length||i,u=Math.ceil(s/i),c=[],l=0;function f(e,t){return u===l++?Buffer.concat(c).slice(0,s):(t||(t=Buffer.alloc(0)),t=Buffer.concat([t,a,Buffer.from([l])]),t=(t=r(e,t)).then((function(r){return t=r.mac,c.push(t),f(e,t)})))}return r(o,e,{length:8*o.length}).then((function(e){return f(e.mac)}))}}var Lh={};["HKDF-SHA-1","HKDF-SHA-256","HKDF-SHA-384","HKDF-SHA-512"].forEach((function(e){Lh[e]={derive:Dh(e)}}));var Mh=Lh,Kh=u((function(e){function t(e){switch(e){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new Error("unsupported curve: "+e)}}var r=e.exports={};function n(e,t,n){function i(e){return Buffer.concat([Hl.int32ToBuffer(e.length),e])}var o=n.algorithm||"",a=ql.KEYLENGTH[o],s=Vu.asBuffer(n.apu||"","base64url"),u=Vu.asBuffer(n.apv||"","base64url"),c={public:t,length:a/8,hash:"SHA-256",otherInfo:Buffer.concat([i(Buffer.from(o,"utf8")),i(s),i(u),Hl.int32ToBuffer(a)])};return r["ECDH-CONCAT"].derive(e,c)}["ECDH","ECDH-HKDF","ECDH-CONCAT"].forEach((function(e){var n,i,o=/^ECDH(?:-(\w+))?$/g.exec(e||"")[1],a=r[e]=r[e]||{};switch(o||""){case"CONCAT":a.derive=function(e,n){var i;n=n||{};try{if(!(i=n.hash||t(e.crv)))throw new Error("invalid hash: "+i);i.toUpperCase()}catch(s){return Promise.reject(s)}var o=["public"],a=r.ECDH.derive(e,Dl(n,o));return a.then((function(e){return hh["CONCAT-"+i].derive(e,Rl(n,o))}))};break;case"HKDF":a.derive=function(e,n){var i;n=n||{};try{if(!(i=n.hash||t(e.crv)))throw new Error("invalid hash: "+i);i.toUpperCase()}catch(s){return Promise.reject(s)}var o=["public"],a=r.ECDH.derive(e,Dl(n,o));return a.then((function(e){return Mh["HKDF-"+i].derive(e,Rl(n,o))}))};break;case"":a.derive=(n={name:"ECDH"},i=function(e,t){var r=e&&jh.convertToForge(e,!0);if(!r||!r.isValid())return Promise.reject(new Error("invalid EC public key"));switch(t){case"jwk":r=jh.convertToJWK(e,!0);break;case"buffer":r=jh.convertToBuffer(e,!0)}return Promise.resolve(r)},Hl.setupFallback((function(e,t){if("function"!=typeof Hl.nodeCrypto.createECDH)throw new Error("unsupported algorithm: ECDH");var r,n=(t=t||{}).length||0;switch(e.crv){case"P-256":r="prime256v1";break;case"P-384":r="secp384r1";break;case"P-521":r="secp521r1";break;default:return Promise.reject(new Error("invalid curve: "+r))}var o=jh.convertToBuffer(e,!1),a=i(t.public,"buffer");return a.then((function(e){var t=Hl.nodeCrypto.createECDH(r);t.setPrivateKey(o);var i=t.computeSecret(e);if(n){if(i.length<n)return Promise.reject(new Error("key length too large: "+n));i=i.slice(0,n)}return i}))}),(function(e,t){e=e||{};var r=(t=t||{}).length||0,o=Ha(xc(n),{namedCurve:e.crv});r||(r=e.d.length);var a=jh.convertToJWK(e,!1);a=Hl.subtleCrypto.importKey("jwk",a,o,!1,["deriveBits"]);var s=i(t.public,"jwk");s=s.then((function(e){return Hl.subtleCrypto.importKey("jwk",e,o,!1,[])}));var u=Promise.all([a,s]);return(u=u.then((function(e){var t=e[0],i=e[1],o=Ha(xc(n),{public:i});return Hl.subtleCrypto.deriveBits(o,t,8*r)}))).then((function(e){return Buffer.from(e)}))}),(function(e,t){var r=(t=t||{}).length||0,n=jh.convertToForge(e,!1),o=i(t.public,"forge");return o.then((function(e){var t=n.computeSecret(e);if(r){if(t.length<r)return Promise.reject(new Error("key length too large: "+r));t=t.slice(0,r)}return t}))})));break;default:a.derive=null}})),["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"].forEach((function(e){var t,i,o=/^ECDH-ES(?:\+(.+))?/g.exec(e||"")[1],a=r[e]=r[e]||{};o?(o=ch[o])?(a.encrypt=(i=o.encrypt,function(e,t,r){if(!(r=r||{}).epk||!r.epk.d)return Promise.reject(new Error("missing ephemeral private key"));var o=jh.convertToObj(r.epk,!1);if(!e||!e.x||!e.y)return Promise.reject(new Error("missing static public key"));var a=n(o,jh.convertToObj(e,!0),{algorithm:r.alg,apu:r.apu,apv:r.apv});return a.then((function(e){return i(e,t)}))}),a.decrypt=(t=o.decrypt,function(e,r,i){if(!(i=i||{}).epk||!i.epk.x||!i.epk.y)return Promise.reject(new Error("missing ephemeral public key"));var o=jh.convertToObj(i.epk,!0);if(!e||!e.d)return Promise.reject(new Error("missing static private key"));var a=n(jh.convertToObj(e,!1),o,{algorithm:i.alg,apu:i.apu,apv:i.apv});return a.then((function(e){return t(e,r)}))})):a.ecrypt=a.decrypt=null:(a.encrypt=function(e,t,r){if(!(r=r||{}).epk||!r.epk.d)return Promise.reject(new Error("missing ephemeral private key"));var i=jh.convertToObj(r.epk,!1);if(!e||!e.x||!e.y)return Promise.reject(new Error("missing static public key"));var o=n(i,jh.convertToObj(e,!0),{algorithm:r.enc,apu:r.apu,apv:r.apv});return o.then((function(e){return{data:e,once:!0,direct:!0}}))},a.decrypt=function(e,t,r){if(!(r=r||{}).epk||!r.epk.x||!r.epk.y)return Promise.reject(new Error("missing ephemeral public key"));var i=jh.convertToObj(r.epk,!0);if(!e||!e.d)return Promise.reject(new Error("missing static private key"));var o=n(jh.convertToObj(e,!1),i,{algorithm:r.enc,apu:r.apu,apv:r.apv});return o.then((function(e){return e}))})}))}));
/*!
 * algorithms/ecdh.js - Elliptic Curve Diffie-Hellman algorithms
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
/*!
 * algorithms/ecdsa.js - Elliptic Curve Digitial Signature Algorithms
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */
function Vh(e){switch(e){case"SHA-256":return"P-256";case"SHA-384":return"P-384";case"SHA-512":return"P-521";default:throw new Error("unsupported hash: "+e)}}function Hh(e){var t,r=Vh(e),n=e.toLowerCase().replace("-","");return Hl.nodeCrypto&&Hl.nodeCrypto.getHashes().indexOf(n)>-1&&(t=function(e,t){if(r!==e.crv)return Promise.reject(new Error("invalid curve"));var i,o;switch(i=(i=Promise.resolve(Hl.nodeCrypto.createSign(n))).then((function(e){return e.update(t),e})),n.slice(-3)){case"384":o=48;break;case"512":o=66;break;default:o=32}return i=(i=i.then((function(t){return jh.derToConcat(t.sign(jh.convertToPEM(e,!0)),o)}))).then((function(e){return{data:t,mac:e}}))}),Hl.setupFallback(t,(function(t,n){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var i=jh.convertToJWK(t,!1),o={name:"ECDSA",namedCurve:i.crv,hash:{name:e}};return Hl.subtleCrypto.importKey("jwk",i,o,!0,["sign"]).then((function(e){return Hl.subtleCrypto.sign(o,e,n)})).then((function(e){return e=Buffer.from(e),{data:n,mac:e}}))}),(function(t,n){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var i=jh.convertToForge(t,!1);return Xl[e].digest(n).then((function(e){return e=i.sign(e),e=Buffer.concat([e.r,e.s]),{data:n,mac:e}}))}))}function qh(e){var t,r=Vh(e),n=e.toLowerCase().replace("-","");return Hl.nodeCrypto&&Hl.nodeCrypto.getHashes().indexOf(n)>-1&&(t=function(e,t,i){if(r!==e.crv)return Promise.reject(new Error("invalid curve"));var o;switch(n.slice(-3)){case"384":o=48;break;case"512":o=66;break;default:o=32}return Promise.resolve(Hl.nodeCrypto.createVerify(n)).then((function(r){return r.update(t),r.end(),r.verify(jh.convertToPEM(e,!1),jh.concatToDer(i,o))})).then((function(e){if(!e)throw new Error("verification failed");return{data:t,mac:i,valid:!0}}))}),Hl.setupFallback(t,(function(t,n,i){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var o=jh.convertToJWK(t,!0),a={name:"ECDSA",namedCurve:o.crv,hash:{name:e}};return Hl.subtleCrypto.importKey("jwk",o,a,!0,["verify"]).then((function(e){return Hl.subtleCrypto.verify(a,e,i,n)})).then((function(e){return e?{data:n,mac:i,valid:!0}:Promise.reject(new Error("verification failed"))}))}),(function(t,n,i){if(r!==t.crv)return Promise.reject(new Error("invalid curve"));var o=jh.convertToForge(t,!0);return Xl[e].digest(n).then((function(e){var t=i.length/2,r={r:i.slice(0,t),s:i.slice(t)};return o.verify(e,r)?{data:n,mac:i,valid:!0}:Promise.reject(new Error("verification failed"))}))}))}var zh={};["ES256","ES384","ES512"].forEach((function(e){var t=e.replace(/ES(\d+)/g,(function(e,t){return"SHA-"+t}));zh[e]={sign:Hh(t),verify:qh(t)}}));var $h=zh,Gh=Buffer.from([0]);
/*!
 * algorithms/pbes2.js - Password-Based Encryption (v2) Algorithms
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function Wh(e,t,r){var n="PBES2-"+e+"+"+t,i=[Buffer.from(n,"utf8"),Gh,r];return Buffer.concat(i)}function Jh(e){function t(e){var t=(e=e||{}).length||0,r=Vu.asBuffer(e.salt||Buffer.alloc(0),"base64u4l"),n=e.iterations||0;if(0>=t)throw new Error("invalid key length");if(0>=n)throw new Error("invalid iteration count");return e.length=t,e.salt=r,e.iterations=n,e}return Hl.setupFallback((function(r,n){if(6>Hl.nodeCrypto.pbkdf2.length)throw new Error("unsupported algorithm: PBKDF2-"+e);try{n=t(n)}catch(u){return Promise.reject(u)}var i=n.length,o=n.salt,a=n.iterations,s=e.replace("-","");return new Promise((function(e,t){Hl.nodeCrypto.pbkdf2(r,o,a,i,s,(function(r,n){r?t(r):e(n)}))}))}),(function(r,n){try{n=t(n)}catch(u){return Promise.reject(u)}var i=n.length,o=n.salt,a=n.iterations,s=Promise.resolve(r);return s=(s=(s=s.then((function(e){return Hl.subtleCrypto.importKey("raw",e,"PBKDF2",!1,["deriveBits"])}))).then((function(t){var r={name:"PBKDF2",salt:new Uint8Array(o),iterations:a,hash:e};return Hl.subtleCrypto.deriveBits(r,t,8*i)}))).then((function(e){return Vu.asBuffer(e)}))}),(function(r,n){try{n=t(n)}catch(s){return Promise.reject(s)}var i=n.length,o=n.salt,a=n.iterations;return new Promise((function(t,n){var s=Fu.md[e.replace("-","").toLowerCase()].create();Fu.pkcs5.pbkdf2(r.toString("binary"),o.toString("binary"),a,i,s,(function(e,r){e?n(e):(r=Buffer.from(r,"binary"),t(r))}))}))}))}function Qh(e,t){var r="PBKDF2-"+e.replace("HS","SHA-"),n=ql.KEYLENGTH[t]/8;return function(i,o,a){a=a||{};var s=Vu.asBuffer(a.p2s||Buffer.alloc(0),"base64url"),u=a.p2c||8192;if(0>=u)throw new Error("invalid iteration count");if(0===s.length)s=Vu.randomBytes(16);else if(8>s.length)throw new Error("salt too small");var c={p2s:Vu.base64url.encode(s),p2c:u};s=Wh(e,t,s),a=Ha(a,{salt:s,iterations:u,length:n});var l=Promise.resolve(i);return l=(l=(l=l.then((function(e){return Xh[r].derive(e,a)}))).then((function(e){return ch[t].encrypt(e,o)}))).then((function(e){return e.header=Ha(e.header||{},c),e}))}}function Yh(e,t){var r="PBKDF2-"+e.replace("HS","SHA-"),n=ql.KEYLENGTH[t]/8;return function(i,o,a){a=a||{};var s=Vu.asBuffer(a.p2s||Buffer.alloc(0),"base64url"),u=a.p2c||0;if(0>=u)return Promise.reject(new Error("invalid iteration count"));if(8>s.length)return Promise.reject(new Error("salt too small"));s=Wh(e,t,s),a=Ha(a,{salt:s,iterations:u,length:n});var c=Promise.resolve(i);return c=(c=c.then((function(e){return Xh[r].derive(e,a)}))).then((function(e){return ch[t].decrypt(e,o)}))}}var Xh={};["PBKDF2-SHA-256","PBKDF2-SHA-384","PBKDF2-SHA-512"].forEach((function(e){var t=e.replace("PBKDF2-","");Xh[e]={derive:Jh(t)}})),["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"].forEach((function(e){var t=/PBES2-(HS\d+)\+(A\d+KW)/g.exec(e),r=t[1],n=t[2];Xh[e]={encrypt:Qh(r,n),decrypt:Yh(r,n)}}));var Zh=Xh;
/*!
 * algorithms/rsa-util.js - RSA Utility Functions
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function ep(e,t){var r=t?["n","e"]:["n","e","d","p","q","dp","dq","qi"];return r=r.map((function(t){return new Fu.jsbn.BigInteger(e[t].toString("hex"),16)})),(t?Fu.pki.rsa.setPublicKey:Fu.pki.rsa.setPrivateKey).apply(Fu.pki.rsa,r)}var tp={convertToForge:ep,convertToJWK:function(e,t){var r=xc(e);return(t?["n","e"]:["n","e","d","p","q","dp","dq","qi"]).forEach((function(e){r[e]=Vu.base64url.encode(r[e])})),delete r.key_ops,delete r.use,delete r.alg,t&&(delete r.d,delete r.p,delete r.q,delete r.dp,delete r.dq,delete r.qi),r},convertToPem:function(e,t){var r,n=t?"__cachedPublicPem":"__cachedPrivatePem";return e[n]?e[n]:(r=t?Fu.pki.publicKeyToPem(ep(e,t)):Fu.pki.privateKeyToPem(ep(e,t)),Object.defineProperty(e,n,{value:r}),r)}},rp={"RSA-OAEP":"RSA_PKCS1_OAEP_PADDING",RSA1_5:"RSA_PKCS1_PADDING"};
/*!
 * algorithms/rsaes.js - RSA Signatures
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function np(e){return Hl.nodeCrypto&&Hl.nodeCrypto.constants&&-1!==Object.keys(rp).indexOf(e)}function ip(e){var t={name:e};"RSA-OAEP-256"===e?(t.name="RSA-OAEP",t.hash={name:"SHA-256"}):"RSA-OAEP"===e?t.hash={name:"SHA-1"}:t.name="RSAES-PKCS1-v1_5";var r,n;return r="RSAES-PKCS1-v1_5"!==t.name?function(e,r){return e=tp.convertToJWK(e,!0),Hl.subtleCrypto.importKey("jwk",e,t,!0,["encrypt"]).then((function(e){return Hl.subtleCrypto.encrypt(t,e,r)})).then((function(e){return{data:Buffer.from(e)}}))}:null,np(e)&&(n=function(t,r){return t=tp.convertToPem(t,!0),{data:Hl.nodeCrypto.publicEncrypt({key:t,padding:Hl.nodeCrypto.constants[rp[e]]},r)}}),Hl.setupFallback(n,r,(function(e,r){r=new $l(r).bytes();var n=tp.convertToForge(e,!0),i={};"RSA-OAEP"===t.name&&(i.md=t.hash.name.toLowerCase().replace(/-/g,""),i.md=Fu.md[i.md].create());var o=n.encrypt(r,t.name.toUpperCase(),i);return o=new $l(o).native(),Promise.resolve({data:o})}))}function op(e){var t={name:e};"RSA-OAEP-256"===e?(t.name="RSA-OAEP",t.hash={name:"SHA-256"}):"RSA-OAEP"===e?t.hash={name:"SHA-1"}:t.name="RSAES-PKCS1-v1_5";var r,n;return r="RSAES-PKCS1-v1_5"!==t.name?function(e,r){return e=tp.convertToJWK(e,!1),Hl.subtleCrypto.importKey("jwk",e,t,!0,["decrypt"]).then((function(e){return Hl.subtleCrypto.decrypt(t,e,r)})).then((function(e){return Buffer.from(e)}))}:null,np(e)?n=function(t,r){return t=tp.convertToPem(t,!1),Hl.nodeCrypto.privateDecrypt({key:t,padding:Hl.nodeCrypto.constants[rp[e]]},r)}:Hl.nodeCrypto&&"RSA-OAEP"===e&&(n=function(e,t){return e=tp.convertToPem(e,!1),Hl.nodeCrypto.privateDecrypt(e,t)}),Hl.setupFallback(n,r,(function(e,r){r=new $l(r).bytes();var n=tp.convertToForge(e,!1),i={};"RSA-OAEP"===t.name&&(i.md=t.hash.name.toLowerCase().replace(/-/g,""),i.md=Fu.md[i.md].create());var o=n.decrypt(r,t.name.toUpperCase(),i);return o=new $l(o).native(),Promise.resolve(o)}))}var ap={};["RSA-OAEP","RSA-OAEP-256","RSA1_5"].forEach((function(e){ap[e]={encrypt:ip(e),decrypt:op(e)}}));var sp=ap;
/*!
 * algorithms/rsassa.js - RSA Signatures
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */function up(){return Hl.nodeCrypto&&Hl.nodeCrypto.constants&&Hl.nodeCrypto.constants.RSA_PSS_SALTLEN_DIGEST}function cp(e){var t,r=e.replace("RS","SHA").toLowerCase(),n=e.replace("RS","SHA-"),i={name:"RSASSA-PKCS1-V1_5",hash:{name:n}},o="RSA-"+n.replace("-","");return Hl.nodeCrypto&&Hl.nodeCrypto.getHashes().indexOf(o)>-1&&(t=function(e,t){var r=Hl.nodeCrypto.createSign(o);return r.update(t),{data:t,mac:r.sign(tp.convertToPem(e,!1))}}),Hl.setupFallback(t,(function(e,t){return e=tp.convertToJWK(e,!1),Hl.subtleCrypto.importKey("jwk",e,i,!0,["sign"]).then((function(e){return Hl.subtleCrypto.sign(i,e,t)})).then((function(e){var r=Buffer.from(e);return{data:t,mac:r}}))}),(function(e,t){var n=Fu.md[r].create();n.start(),n.update(t);var i=tp.convertToForge(e,!1).sign(n,"RSASSA-PKCS1-V1_5");return i=Buffer.from(i,"binary"),Promise.resolve({data:t,mac:i})}))}function lp(e){var t,r=e.replace("RS","SHA").toLowerCase(),n={name:"RSASSA-PKCS1-V1_5",hash:{name:e.replace("RS","SHA-")}};return Hl.nodeCrypto&&Hl.nodeCrypto.getHashes().indexOf(r)>-1&&(t=function(e,t,n){var i=Hl.nodeCrypto.createVerify(r);return i.update(t),i.end(),i.verify(tp.convertToPem(e,!0),n)?{data:t,mac:n,valid:!0}:Promise.reject(new Error("verification failed"))}),Hl.setupFallback(t,(function(e,t,r){return e=tp.convertToJWK(e,!0),Hl.subtleCrypto.importKey("jwk",e,n,!0,["verify"]).then((function(e){return Hl.subtleCrypto.verify(n,e,r,t)})).then((function(e){return e?{data:t,mac:r,valid:!0}:Promise.reject(new Error("verification failed"))}))}),(function(e,t,n){var i=Fu.md[r].create();i.start(),i.update(t),i=i.digest().bytes();var o=tp.convertToForge(e,!0),a=n.toString("binary");return o.verify(i,a,"RSASSA-PKCS1-V1_5")?Promise.resolve({data:t,mac:n,valid:!0}):Promise.reject(new Error("verification failed"))}))}function fp(e){var t,r=e.replace("PS","SHA").toLowerCase(),n=e.replace("PS","SHA-"),i={name:"RSA-PSS",hash:{name:n},saltLength:ql.HASHLENGTH[n]/8},o="RSA-"+n.replace("-","");return up()&&(t=function(e,t){var r=Hl.nodeCrypto.createSign(o);return r.update(t),{data:t,mac:r.sign({key:tp.convertToPem(e,!1),padding:Hl.nodeCrypto.constants.RSA_PKCS1_PSS_PADDING,saltLength:Hl.nodeCrypto.constants.RSA_PSS_SALTLEN_DIGEST})}}),Hl.setupFallback(t,(function(e,t){return e=tp.convertToJWK(e,!1),Hl.subtleCrypto.importKey("jwk",e,i,!0,["sign"]).then((function(e){return Hl.subtleCrypto.sign(i,e,t)})).then((function(e){var r=Buffer.from(e);return{data:t,mac:r}}))}),(function(e,t){var i=Fu.md[r].create();i.start(),i.update(t);var o=Fu.pss.create({md:Fu.md[r].create(),mgf:Fu.mgf.mgf1.create(Fu.md[r].create()),saltLength:ql.HASHLENGTH[n]/8}),a=tp.convertToForge(e,!1).sign(i,o);return a=Buffer.from(a,"binary"),Promise.resolve({data:t,mac:a})}))}function hp(e){var t,r=e.replace("PS","SHA").toLowerCase(),n=e.replace("PS","SHA-"),i={name:"RSA-PSS",hash:{name:n},saltLength:ql.HASHLENGTH[n]/8};return up()&&(t=function(e,t,n){var i=Hl.nodeCrypto.createVerify(r);return i.update(t),i.end(),i.verify({key:tp.convertToPem(e,!0),padding:Hl.nodeCrypto.constants.RSA_PKCS1_PSS_PADDING,saltLength:Hl.nodeCrypto.constants.RSA_PSS_SALTLEN_DIGEST},n)?{data:t,mac:n,valid:!0}:Promise.reject(new Error("verification failed"))}),Hl.setupFallback(t,(function(e,t,r){return e=tp.convertToJWK(e,!0),Hl.subtleCrypto.importKey("jwk",e,i,!0,["verify"]).then((function(e){return Hl.subtleCrypto.verify(i,e,r,t)})).then((function(e){return e?{data:t,mac:r,valid:!0}:Promise.reject(new Error("verification failed"))}))}),(function(e,t,i){var o=Fu.md[r].create();o.start(),o.update(t),o=o.digest().bytes();var a=Fu.pss.create({md:Fu.md[r].create(),mgf:Fu.mgf.mgf1.create(Fu.md[r].create()),saltLength:ql.HASHLENGTH[n]/8}),s=tp.convertToForge(e,!0),u=i.toString("binary");return s.verify(o,u,a)?Promise.resolve({data:t,mac:i,valid:!0}):Promise.reject(new Error("verification failed"))}))}var pp={};["PS256","PS384","PS512"].forEach((function(e){pp[e]={sign:fp(e),verify:hp(e)}})),["RS256","RS384","RS512"].forEach((function(e){pp[e]={sign:cp(e),verify:lp(e)}}));var dp={},gp={},yp={},vp={},mp={},bp={};
/*!
 * algorithms/index.js - Cryptographic Algorithms Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc.  See LICENSE file.
 */[df,th,ch,hh,ph,Kh,$h,Mh,Ql,Zh,sp,pp,Xl].forEach((function(e){Object.keys(e).forEach((function(t){var r=e[t];"function"==typeof r.encrypt&&(mp[t]=r.encrypt),"function"==typeof r.decrypt&&(bp[t]=r.decrypt),"function"==typeof r.sign&&(yp[t]=r.sign),"function"==typeof r.verify&&(vp[t]=r.verify),"function"==typeof r.digest&&(dp[t]=r.digest),"function"==typeof r.derive&&(gp[t]=r.derive)}))}));var Ep={digest:function(e,t,r){var n=dp[e];return n?n(t,r):Promise.reject(new Error("unsupported algorithm: "+e))},derive:function(e,t,r){var n=gp[e];return n?n(t,r):Promise.reject(new Error("unsupported algorithm: "+e))},sign:function(e,t,r,n){var i=yp[e];return i?i(t,r,n||{}):Promise.reject(new Error("unsupported algorithm: "+e))},verify:function(e,t,r,n,i){var o=vp[e];return o?o(t,r,n,i||{}):Promise.reject(new Error("unsupported algorithm: "+e))},encrypt:function(e,t,r,n){var i=mp[e];return i?i(t,r,n||{}):Promise.reject(new Error("unsupported algorithm: "+e))},decrypt:function(e,t,r,n){var i=bp[e];return i?i(t,r,n||{}):Promise.reject(new Error("unsupported algorithm: "+e))}},Sp={MODE_SIGN:"sign",MODE_VERIFY:"verify",MODE_ENCRYPT:"encrypt",MODE_DECRYPT:"decrypt",MODE_WRAP:"wrap",MODE_UNWRAP:"unwrap"},wp={name:"PrivateKeyInfo",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"keyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OID,constructed:!1,capture:"keyOid"},{name:"AlgorithmIdentifier.parameters",captureAsn1:"keyParams"}]},{name:"PrivateKeyInfo",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OCTETSTRING,constructed:!1,capture:"keyValue"}]},_p={name:"SubjectPublicKeyInfo",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OID,constructed:!1,capture:"keyOid"},{name:"AlgorithmIdentifier.parameters",captureAsn1:"keyParams"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.BITSTRING,constructed:!1,capture:"keyValue"}]},Cp={name:"Certificate",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:Fu.asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},_p,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:Fu.asn1.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},Ap={THUMBPRINT_KEY:"internal\0thumbprint",THUMBPRINT_HASH:"SHA-256"},Ip={validators:{privateKey:wp,publicKey:_p,certificate:Cp},thumbprint:function(e,t,r){if("function"!=typeof e.thumbprint)return Promise.reject(new Error("thumbprint not supported"));r=(r||Ap.THUMBPRINT_HASH).toUpperCase();var n=e.thumbprint(t),i=Object.keys(n).sort().map((function(e){var t=n[e];return Buffer.isBuffer(t)&&(t=Vu.base64url.encode(t)),JSON.stringify(e)+":"+JSON.stringify(t)}));i="{"+i.join(",")+"}";try{return Ep.digest(r,Buffer.from(i,"utf8"))}catch(o){return Promise.reject(o)}},unpackProps:function(e,t){var r;t.forEach((function(t){if(t.name in e){r=r||{};var n=e[t.name];switch(t.type){case"binary":Buffer.isBuffer(n)?e[t.name]=Vu.base64url.encode(n):n=Vu.base64url.decode(n);break;case"string":case"number":case"boolean":break;case"array":n=[].concat(n);break;case"object":n=xc(n)}r[t.name]=n}}));var n=r||{};return Object.keys(e).forEach((function(t){t in n||delete e[t]})),r},COMMON_PROPS:[{name:"kty",type:"string"},{name:"kid",type:"string"},{name:"use",type:"string"},{name:"alg",type:"string"},{name:"x5c",type:"array"},{name:"x5t",type:"binary"},{name:"x5u",type:"string"},{name:"key_ops",type:"array"}],INTERNALS:Ap},Tp=function(e,t,r,n){if(!e)throw new Error("kty cannot be null");if(!t)throw new Error("keystore cannot be null");if(!r)throw new Error("props cannot be null");if("string"==typeof r&&(r=JSON.parse(r)),!n)throw new Error("cfg cannot be null");var i,o,a=[],s={},u={};r=xc(r),i=Wc({},r[Ip.INTERNALS.THUMBPRINT_KEY]||{}),delete r[Ip.INTERNALS.THUMBPRINT_KEY],Object.keys(i).forEach((function(e){var t=i[e];o||(o=t,Buffer.isBuffer(o)&&(o=Vu.base64url.encode(o))),Buffer.isBuffer(t)||(t=Vu.base64url.decode(t),i[e]=t)})),r.kty=e,r.kid=r.kid||o||$c();var c,l=Object.keys(Ip.COMMON_PROPS).map((function(e){return Ip.COMMON_PROPS[e].name}));u.base=Dl(r,l),a=a.concat(Object.keys(u.base)),u.public=xc(r),s.public=n.publicKey(u.public),s.public&&(a=a.concat(Object.keys(u.public))),u.private=xc(r),s.private=n.privateKey(u.private),s.private&&(a=a.concat(Object.keys(u.private))),u.extra=Rl(r,a),c=s.public&&"length"in s.public?s.public.length:s.private&&"length"in s.private?s.private.length:NaN,Object.defineProperty(this,"keystore",{value:t,enumerable:!0}),Object.defineProperty(this,"length",{value:c,enumerable:!0}),Object.defineProperty(this,"kty",{value:e,enumerable:!0}),Object.defineProperty(this,"kid",{value:u.base.kid,enumerable:!0}),Object.defineProperty(this,"use",{value:u.base.use||"",enumerable:!0}),Object.defineProperty(this,"alg",{value:u.base.alg||"",enumerable:!0}),Object.defineProperty(this,"thumbprint",{value:function(e){if(e=(e||Ip.INTERNALS.THUMBPRINT_HASH).toUpperCase(),i[e])return Promise.resolve(i[e]);var t=Ip.thumbprint(n,u,e);return t=t.then((function(t){return t&&(i[e]=t),t}))}}),Object.defineProperty(this,"algorithms",{value:function(t){var r=[];this.use&&"sig"!==this.use||(t&&Sp.MODE_SIGN!==t||r.push(Sp.MODE_SIGN),t&&Sp.MODE_VERIFY!==t||r.push(Sp.MODE_VERIFY)),this.use&&"enc"!==this.use||(t&&Sp.MODE_ENCRYPT!==t||r.push(Sp.MODE_ENCRYPT),t&&Sp.MODE_DECRYPT!==t||r.push(Sp.MODE_DECRYPT),t&&Sp.MODE_WRAP!==t||r.push(Sp.MODE_WRAP),t&&Sp.MODE_UNWRAP!==t||r.push(Sp.MODE_UNWRAP));var i,o=this,a=r.map((function(e){return n.algorithms.call(o,s,e)}));(a=Xc(a),a=Vl(a),this.alg)&&(i="oct"===e?[this.alg,"dir"]:[this.alg],a=cl(a,i));return a}}),Object.defineProperty(this,"supports",{value:function(e,t){return-1!==this.algorithms(t).indexOf(e)}}),Object.defineProperty(this,"has",{value:function(e,t){var r=!1;return r=(r=(r=(r=r||!(!u.base||!(e in u.base)))||!(!s.public||!(e in s.public)))||!(!u.extra||!(e in u.extra)))||!!(t&&s.private&&e in s.private)}}),Object.defineProperty(this,"get",{value:function(e,t){var r;return u.base&&e in u.base?r=u.base:s.public&&e in s.public?r=s.public:u.extra&&e in u.extra?r=u.extra:t&&s.private&&e in s.private&&(r=s.private),r&&r[e]||null}}),Object.defineProperty(this,"toJSON",{value:function(e,t){Array.isArray(e)&&(t=e,e=!1);var r={};return r=Ha(r,u.base,u.public,"boolean"==typeof e&&e?u.private:{},u.extra),r=Rl(r,t||[])}}),Object.defineProperty(this,"toPEM",{value:function(e){if(null===e&&(e=!1),!n.convertToPEM)throw new Error("Unsupported key type for PEM encoding");var t=e?s.private:s.public;if(!t)throw new Error("Invalid key");return n.convertToPEM.call(this,t,e)}}),Object.defineProperty(this,"toObject",{value:function(e,t){Array.isArray(e)&&(t=e,e=!1);var r={};return r=Ha(r,u.base,s.public,"boolean"==typeof e&&e?s.private:{},u.extra),r=Rl(r,(t||[]).concat("length"))}}),Object.defineProperty(this,"sign",{value:function(e,t,r){if(-1===this.algorithms("sign").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=n.signKey.call(this,e,s);return i?(r=r?xc(r):{},n.signProps&&(r=Ha(r,n.signProps.call(this,e,r))),Ep.sign(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"verify",{value:function(e,t,r,i){if(-1===this.algorithms("verify").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var o=n.verifyKey.call(this,e,s);return o?(i=i?xc(i):{},n.verifyProps&&(i=Ha(i,n.verifyProps.call(this,e,i))),Ep.verify(e,o,t,r,i)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"encrypt",{value:function(e,t,r){if(-1===this.algorithms("encrypt").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=n.encryptKey.call(this,e,s);return i?(r=r?xc(r):{},n.encryptProps&&(r=Ha(r,n.encryptProps.call(this,e,r))),Ep.encrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"decrypt",{value:function(e,t,r){if(-1===this.algorithms("decrypt").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=n.decryptKey.call(this,e,s);return i?(r=r?xc(r):{},n.decryptProps&&(r=Ha(r,n.decryptProps.call(this,e,r))),Ep.decrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"wrap",{value:function(e,t,r){if(-1===this.algorithms("wrap").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=n.wrapKey.call(this,e,s);return i?(r=r?xc(r):{},n.wrapProps&&(r=Ha(r,n.wrapProps.call(this,e,r))),Ep.encrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}}),Object.defineProperty(this,"unwrap",{value:function(e,t,r){if(-1===this.algorithms("unwrap").indexOf(e))return Promise.reject(new Error("unsupported algorithm"));var i=n.unwrapKey.call(this,e,s);return i?(r=r?xc(r):{},n.unwrapProps&&(r=Ha(r,n.unwrapProps.call(this,e,r))),Ep.decrypt(e,i,t,r)):Promise.reject(new Error("improper key"))}})},Pp={BaseKey:Tp,helpers:Ip},Fp=function(){var e={};Object.defineProperty(this,"register",{value:function(t){if(!t||"string"!=typeof t.kty||!t.kty)throw new Error("invalid Key factory");var r=t.kty;return e[r]=t,this}}),Object.defineProperty(this,"unregister",{value:function(t){if(!t||"string"!=typeof t.kty||!t.kty)throw new Error("invalid Key factory");var r=t.kty;return t===e[r]&&delete e[r],this}}),Object.defineProperty(this,"get",{value:function(t){return e[t||""]||void 0}}),Object.defineProperty(this,"all",{value:function(){return Object.keys(e).map((function(t){return e[t]}))}})},kp=new Fp;function Rp(e,t){var r,n={},i=[],o=t.form,a=t.body,s=null;switch(t=Fu.asn1.fromDer(a),o){case"private":e.all().some((function(e){if(r)return!1;if(!e.validators)return!1;var o=e.validators.oid,a=e.validators.privateKey;return!!a&&(n={},i=[],(r=Fu.asn1.validate(t,a,n,i))&&(n.keyOid=Fu.asn1.oidToDer(o),n.parsed=!0),r)})),n.type="private";break;case"pkcs8":r=Fu.asn1.validate(t,Pp.helpers.validators.privateKey,n,i),n.type="private";break;case"public":case"spki":r=Fu.asn1.validate(t,Pp.helpers.validators.publicKey,n,i),n.type="public";break;case"pkix":case"x509":if(r=Fu.asn1.validate(t,Pp.helpers.validators.certificate,n,i)){n=function(e){return["certIssuer","certSubject"].forEach((function(t){var r=Fu.pki.RDNAttributesAsArray(e[t]),n=e[t]={};r.forEach((function(e){n[e.name||e.type]=e.value}))})),e}(n);var u=Fu.md.sha1.create();u.update(a),s=Vu.base64url.encode(Buffer.from(u.digest().toHex(),"hex"))}n.type="public"}return r?(n.keyOid&&(n.keyOid=Fu.asn1.derToOid(n.keyOid)),r=null,kp.all().forEach((function(e){r||e&&"function"==typeof e.import&&(r=e.import(n))})),r&&n.certSubject&&n.certSubject.commonName&&(r.kid=n.certSubject.commonName),r&&s&&(r.x5t=s),r):null}var Bp=function(e,t){var r={};Object.defineProperty(this,"generate",{value:function(t,r,n){var i=e.get(t);if(!i)return Promise.reject(new Error("unsupported key type"));(n=xc(n||{})).kty=t;var o=this;return i.generate(r).then((function(e){return e=Ha(n,e,{kty:t}),o.add(e)}))}}),Object.defineProperty(this,"add",{value:function(t,n,i){var o;if(i=i||{},Buffer.isBuffer(t)||"string"==typeof t)if("json"===(n=(n||"json").toLowerCase()))t=JSON.parse(t.toString("utf8"));else try{if(o="pem"===n?function(e){var t={};if(!Fu.pem.decode(e).some((function(e){switch(e.type){case"CERTIFICATE":t.form="pkix";break;case"PUBLIC KEY":t.form="spki";break;case"PRIVATE KEY":t.form="pkcs8";break;case"EC PRIVATE KEY":case"RSA PRIVATE KEY":t.form="private";break;default:return!1}return t.body=e.body,!0})))throw new Error("supported PEM type not found");return t}(t):{body:t.toString("binary"),form:n},!(t=Rp(e,o)))throw new Error("no importer for key");Object.keys(i).forEach((function(e){t[e]=i[e]}))}catch(u){return Promise.reject(u)}else t=Bp.isKey(t)?t.toJSON(!0):xc(t);var a=e.get(t.kty);if(!a)return Promise.reject(new Error("unsupported key type"));var s=this;return a.prepare(t).then((function(e){return new Pp.BaseKey(t.kty,s,t,e)})).then((function(e){var t=e.kid||"";return(r[t]=r[t]||[]).push(e),e}))}}),Object.defineProperty(this,"remove",{value:function(e){if(e){var t=r[e.kid];if(t){var n=t.indexOf(e);-1!==n&&(t.splice(n,1),t.length||delete r[e.kid])}}}}),Object.defineProperty(this,"all",{value:function(e,n){void 0!==(e=e||{}).kid&&null!==e.kid&&"string"!=typeof e.kid&&(e.kid=String(e.kid));var i=[],o=function(t){return(!e.kty||!t.kty||e.kty===t.kty)&&((!e.use||!t.use||e.use===t.use)&&(!e.alg||("dir"===e.alg||!t.alg||e.alg===t.alg)&&t.supports(e.alg)))};return Object.keys(r).forEach((function(t){if(!e.kid||e.kid===t){var n=r[t].filter(o);n.length&&(i=i.concat(n))}})),!n&&t&&(i=i.concat(t.all(e))),i}}),Object.defineProperty(this,"get",{value:function(e,r,n){"boolean"==typeof e?(n=e,r=e=null):"object"==typeof e&&(n=r,r=e,e=null),r=r||{},e&&(r.kid=e),void 0!==r.kid&&null!==r.kid&&"string"!=typeof r.kid&&(r.kid=String(r.kid));var i=this.all(r,!0);return i.length||!t||n||(i=t.get(r,n)),i[0]||null}}),Object.defineProperty(this,"temp",{value:function(){return new Bp(e,this)}}),Object.defineProperty(this,"toJSON",{value:function(e){var t=[];return Object.keys(r).forEach((function(n){var i=r[n].map((function(t){return t.toJSON(e)}));t=t.concat(i)})),{keys:t}}})};Bp.isKeyStore=function(e){return!!e&&("object"==typeof e&&("function"==typeof e.get&&"function"==typeof e.all&&"function"==typeof e.generate&&"function"==typeof e.add&&"function"==typeof e.remove))},Bp.createKeyStore=function(){return new Bp(kp)},Bp.asKeyStore=function(e){if(Bp.isKeyStore(e))return Promise.resolve(e);var t,r=Bp.createKeyStore();if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e))t=e;else{if(!("keys"in e))return Promise.reject(new Error("invalid keystore"));t=e.keys}t=t.map((function(e){return r.add(e)}));var n=Promise.all(t);return n=n.then((function(){return r}))},Bp.isKey=function(e){return!!e&&("object"==typeof e&&(!!Bp.isKeyStore(e.keystore)&&("string"==typeof e.kty&&"number"==typeof e.length&&"function"==typeof e.algorithms&&"function"==typeof e.supports&&"function"==typeof e.encrypt&&"function"==typeof e.decrypt&&"function"==typeof e.wrap&&"function"==typeof e.unwrap&&"function"==typeof e.sign&&"function"==typeof e.verify)))},Bp.createKey=function(e,t,r){return Bp.createKeyStore().generate(e,t,r)},Bp.asKey=function(e,t,r){return Bp.isKey(e)?Promise.resolve(e):e=Bp.createKeyStore().add(e,t,r)};var Op={KeyRegistry:Fp,KeyStore:Bp,registry:kp},xp={BaseKey:Tp,helpers:Ip},Np=["HS256","HS384","HS512"],Up=["A128GCM","A192GCM","A256GCM","A128CBC-HS256","A192CBC-HS384","A256CBC-HS512","A128CBC+HS256","A192CBC+HS384","A256CBC+HS512"],jp=["A128KW","A192KW","A256KW","A128GCMKW","A192GCMKW","A256GCMKW","PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW","dir"];
/*!
 * jwk/octkey.js - Symmetric Octet Key Representation
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */function Dp(e,t){return"iv"in t&&(t.iv=Buffer.isBuffer(t.iv)?t.iv:Vu.base64url.decode(t.iv||"")),"adata"in t&&(t.adata=Buffer.isBuffer(t.adata)?t.adata:Buffer.from(t.adata||"","utf8")),"mac"in t&&(t.mac=Buffer.isBuffer(t.mac)?t.mac:Vu.base64url.decode(t.mac||"")),"tag"in t&&(t.tag=Buffer.isBuffer(t.tag)?t.tag:Vu.base64url.decode(t.tag||"")),t}function Lp(e,t){return"iv"in t&&(t.iv=Buffer.isBuffer(t.iv)?t.iv:Vu.base64url.decode(t.iv||"")),"adata"in t&&(t.adata=Buffer.isBuffer(t.adata)?t.adata:Buffer.from(t.adata||"","utf8")),t}var Mp={publicKey:function(e){var t=xp.helpers.COMMON_PROPS.concat([]);return xp.helpers.unpackProps(e,t)},privateKey:function(e){var t,r=xp.helpers.COMMON_PROPS.concat([{name:"k",type:"binary"}]);return(t=xp.helpers.unpackProps(e,r))&&t.k?t.length=8*t.k.length:t=void 0,t},thumbprint:function(e){return e.private&&(e=e.private),{k:e.k||"",kty:"oct"}},algorithms:function(e,t){var r=e.private&&8*e.private.k.length,n=[256,384,512];if(!r)return[];switch(t){case"encrypt":case"decrypt":return Up.filter((function(e){return e==="A"+r/2+"CBC-HS"+r||e==="A"+r/2+"CBC+HS"+r||e==="A"+r+"GCM"}));case"sign":case"verify":return Np.filter((function(e){var t=!1;return n.forEach((function(n){n>r||(t|=e==="HS"+n)})),t}));case"wrap":case"unwrap":return jp.filter((function(e){return e==="A"+r+"KW"||e==="A"+r+"GCMKW"||0===e.indexOf("PBES2-")||"dir"===e}))}return[]},encryptKey:function(e,t){return t.private&&t.private.k},encryptProps:Lp,decryptKey:function(e,t){return t.private&&t.private.k},decryptProps:Dp,wrapKey:function(e,t){return t.private&&t.private.k},wrapProps:Lp,unwrapKey:function(e,t){return t.private&&t.private.k},unwrapProps:Dp,signKey:function(e,t){return t.private&&t.private.k},verifyKey:function(e,t){return t.private&&t.private.k}},Kp={kty:"oct",prepare:function(e){var t=Mp,r=Promise.resolve(e);return r=(r=r.then((function(e){return xp.helpers.thumbprint(t,e)}))).then((function(r){var n={};return n[xp.helpers.INTERNALS.THUMBPRINT_HASH]=r,e[xp.helpers.INTERNALS.THUMBPRINT_KEY]=n,t}))},generate:function(e){var t=Vu.randomBytes(e/8);return Promise.resolve({k:t})}};Object.freeze({config:Mp,factory:Kp}),Op.registry.register(Kp);
/*!
 * jwk/rsa.js - RSA Key Representation
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
var Vp=Hl.nodeCrypto,Hp={BaseKey:Tp,helpers:Ip},qp=["RS256","RS384","RS512","PS256","PS384","PS512"],zp=["RSA-OAEP","RSA-OAEP-256","RSA1_5"],$p={publicKey:function(e){var t,r=Hp.helpers.COMMON_PROPS.concat([{name:"n",type:"binary"},{name:"e",type:"binary"}]);return(t=Hp.helpers.unpackProps(e,r))&&t.n&&t.e?t.length=8*t.n.length:(delete t.e,delete t.n),t},privateKey:function(e){var t,r=Hp.helpers.COMMON_PROPS.concat([{name:"n",type:"binary"},{name:"e",type:"binary"},{name:"d",type:"binary"},{name:"p",type:"binary"},{name:"q",type:"binary"},{name:"dp",type:"binary"},{name:"dq",type:"binary"},{name:"qi",type:"binary"}]);return(t=Hp.helpers.unpackProps(e,r))&&t.d&&t.n&&t.e&&t.p&&t.q&&t.dp&&t.dq&&t.qi?t.length=8*t.d.length:t=void 0,t},thumbprint:function(e){return e.public&&(e=e.public),{e:e.e,kty:"RSA",n:e.n}},algorithms:function(e,t){switch(t){case"encrypt":case"decrypt":return[];case"wrap":return e.public&&zp.slice()||[];case"unwrap":return e.private&&zp.slice()||[];case"sign":return e.private&&qp.slice()||[];case"verify":return e.public&&qp.slice()||[]}return[]},wrapKey:function(e,t){return t.public},unwrapKey:function(e,t){return t.private},signKey:function(e,t){return t.private},verifyKey:function(e,t){return t.public},convertToPEM:function(e,t){var r=tp.convertToForge(e,!t);return t?Fu.pki.privateKeyToPem(r):Fu.pki.publicKeyToPem(r)}};var Gp={oid:"1.2.840.113549.1.1.1",privateKey:{name:"RSAPrivateKey",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"version"},{name:"RSAPrivateKey.modulus",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"n"},{name:"RSAPrivateKey.publicExponent",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"e"},{name:"RSAPrivateKey.privateExponent",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"d"},{name:"RSAPrivateKey.prime1",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"p"},{name:"RSAPrivateKey.prime2",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"q"},{name:"RSAPrivateKey.exponent1",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"dp"},{name:"RSAPrivateKey.exponent2",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"dq"},{name:"RSAPrivateKey.coefficient",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"qi"}]},publicKey:{name:"RSAPublicKey",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"n"},{name:"RSAPublicKey.exponent",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1,capture:"e"}]}},Wp={kty:"RSA",validators:Gp,prepare:function(e){var t=$p,r=Promise.resolve(e);return r=(r=r.then((function(e){return Hp.helpers.thumbprint(t,e)}))).then((function(r){var n={};return n[Hp.helpers.INTERNALS.THUMBPRINT_HASH]=r,e[Hp.helpers.INTERNALS.THUMBPRINT_KEY]=n,t}))},generate:function(e){var t;if(Vp)t=new Promise((function(t,r){Fu.pki.rsa.generateKeyPair({bits:e,e:65537},(function(e,n){if(e)return r(e);t(n.privateKey)}))}));else{var r=Fu.pki.rsa.generateKeyPair({bits:e,e:65537});t=Promise.resolve(r.privateKey)}return t.then((function(e){var t={};return["e","n","d","p","q",{incoming:"dP",outgoing:"dp"},{incoming:"dQ",outgoing:"dq"},{incoming:"qInv",outgoing:"qi"}].forEach((function(r){var n,i,o;"string"==typeof r?n=i=r:(n=r.incoming,i=r.outgoing),n in e&&(t[i]=((o=(o=e[n]).toString(16)).length%2&&(o="0"+o),Buffer.from(o,"hex")))})),t}))},import:function(e){if(Gp.oid!==e.keyOid)return null;if(!e.parsed){"string"==typeof e.keyValue?e.keyValue=Fu.asn1.fromDer(e.keyValue):Array.isArray(e.keyValue)&&(e.keyValue=e.keyValue[0]);var t="private"===e.type?Gp.privateKey:Gp.publicKey,r={};if(!Fu.asn1.validate(e.keyValue,t,r,[]))return null;e=r}var n={kty:"RSA"};return["n","e","d","p","q","dp","dq","qi"].forEach((function(t){if(t in e){var r=Buffer.from(e[t],"binary");0===r[0]&&(r=r.slice(1)),n[t]=r}})),n}};Object.freeze({config:$p,factory:Wp}),Op.registry.register(Wp);
/*!
 * jwk/rsa.js - RSA Key Representation
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
var Jp={BaseKey:Tp,helpers:Ip},Qp=["ES256","ES384","ES512"],Yp=["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"],Xp=jh.EC_OID;function Zp(e){switch(e){case"1.2.840.10045.3.1.7":return"P-256";case"1.3.132.0.34":return"P-384";case"1.3.132.0.35":return"P-521";default:return null}}var ed={publicKey:function(e){var t=Jp.helpers.COMMON_PROPS.concat([{name:"crv",type:"string"},{name:"x",type:"binary"},{name:"y",type:"binary"}]),r=Jp.helpers.unpackProps(e,t);return r&&r.crv&&r.x&&r.y?r.length=jh.curveSize(r.crv):(delete r.crv,delete r.x,delete r.y),r},privateKey:function(e){var t=Jp.helpers.COMMON_PROPS.concat([{name:"crv",type:"string"},{name:"x",type:"binary"},{name:"y",type:"binary"},{name:"d",type:"binary"}]),r=Jp.helpers.unpackProps(e,t);return r&&r.crv&&r.x&&r.y&&r.d?r.length=jh.curveSize(r.crv):r=void 0,r},thumbprint:function(e){return e.public&&(e=e.public),{crv:e.crv,kty:"EC",x:e.x,y:e.y}},algorithms:function(e,t){var r=e.public&&e.public.length||e.private&&e.private.length||0;switch(521===r&&(r=512),t){case"encrypt":case"decrypt":return[];case"wrap":return e.public&&Yp||[];case"unwrap":return e.private&&Yp||[];case"sign":return e.private?Qp.filter((function(e){return e==="ES"+r})):[];case"verify":return e.public?Qp.filter((function(e){return e==="ES"+r})):[]}},encryptKey:function(e,t){return t.public},decryptKey:function(e,t){return t.private},wrapKey:function(e,t){return t.public},unwrapKey:function(e,t){return t.private},signKey:function(e,t){return t.private},verifyKey:function(e,t){return t.public}};ed.convertToPEM=jh.convertToPEM;var td={oid:Xp,privateKey:{name:"ECPrivateKey",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"ECPrivateKey.version",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1},{name:"ECPrivateKey.private",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OCTETSTRING,constructed:!1,capture:"d"},{tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,name:"ECPrivateKey.parameters",constructed:!0,value:[{name:"ECPrivateKey.namedCurve",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OID,constructed:!1,capture:"crv"}]},{name:"ECPrivateKey.publicKey",tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"ECPrivateKey.point",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.BITSTRING,constructed:!1,capture:"point"}]}]},embeddedPrivateKey:{name:"ECPrivateKey",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.SEQUENCE,constructed:!0,value:[{name:"ECPrivateKey.version",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.INTEGER,constructed:!1},{name:"ECPrivateKey.private",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.OCTETSTRING,constructed:!1,capture:"d"},{name:"ECPrivateKey.publicKey",tagClass:Fu.asn1.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"ECPrivateKey.point",tagClass:Fu.asn1.Class.UNIVERSAL,type:Fu.asn1.Type.BITSTRING,constructed:!1,capture:"point"}]}]}},rd={kty:"EC",validators:td,prepare:function(e){var t=ed,r=Promise.resolve(e);return r=(r=r.then((function(e){return Jp.helpers.thumbprint(t,e)}))).then((function(r){var n={};return n[Jp.helpers.INTERNALS.THUMBPRINT_HASH]=r,e[Jp.helpers.INTERNALS.THUMBPRINT_KEY]=n,t}))},generate:function(e){var t=Rh.generateKeyPair(e),r={crv:e,x:t.public.x,y:t.public.y,d:t.private.d};return Promise.resolve(r)},import:function(e){if(td.oid!==e.keyOid)return null;var t;if(e.keyParams&&Fu.asn1.Type.OID===e.keyParams.type?t=Zp(t=Fu.asn1.derToOid(e.keyParams.value)):e.crv&&(t=Zp(t=Fu.asn1.derToOid(e.crv))),!t)return null;if(!e.parsed){var r={};if("private"===e.type){if("string"==typeof e.keyValue?e.keyValue=Fu.asn1.fromDer(e.keyValue):Array.isArray(e.keyValue)&&(e.keyValue=e.keyValue[0]),!Fu.asn1.validate(e.keyValue,td.embeddedPrivateKey,r,[]))return null}else r.point=e.keyValue;e=r}var n={kty:"EC",crv:t};if(e.d&&(n.d=Buffer.from(e.d,"binary")),e.point){var i=Buffer.from(e.point,"binary");if(4!==i.readUInt16BE(0))return null;var o=(i=i.slice(2)).length/2;n.x=i.slice(0,o),n.y=i.slice(o)}return n}};Object.freeze({config:ed,factory:rd}),Op.registry.register(rd);
/*!
 * jwk/index.js - JSON Web Key (JWK) Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
var nd=u((function(e,t){Object.keys(Op.KeyStore).forEach((function(e){t[e]=Op.KeyStore[e]})),Object.keys(Sp).forEach((function(e){t[e]=Sp[e]}))})),id={compact:!1,protect:"*"},od=function(e,t){return Array.prototype.slice.call(e,t||0)},ad=function(e,t){var r=!1,n=e.format||"general",i=Buffer.alloc(0);Object.defineProperty(this,"compact",{get:function(){return"compact"===n},enumerable:!0}),Object.defineProperty(this,"format",{get:function(){return n},enumerable:!0}),Object.defineProperty(this,"update",{value:function(e,t){if(r)throw new Error("already final");return null!=e&&(e=Vu.asBuffer(e,t),i=i.length?Buffer.concat([i,e],i.length+e.length):e),this}}),Object.defineProperty(this,"final",{value:function(e,o){if(r)return Promise.reject(new Error("already final"));var a;switch(this.update(e,o),r=!0,a=(a=(a=Promise.all(t)).then((function(e){return i=Vu.base64url.encode(i),e=e.map((function(e){var t={},r=0,n=xc(e.header),o=Object.keys(n).length;e.protected.forEach((function(e){e in n&&(t[e]=n[e],r++,delete n[e],o--)})),r>0?(t=JSON.stringify(t),t=Vu.base64url.encode(t)):t="";var a=Buffer.from(t+"."+i,"ascii");return e=(e=e.key.sign(e.header.alg,a,e.header)).then((function(e){var i={};return 0<r&&(i.protected=t),0<o&&(i.header=n),i.signature=Vu.base64url.encode(e.mac),i}))})),e=[Promise.resolve(i)].concat(e),Promise.all(e)}))).then((function(e){return{payload:e[0],signatures:e.slice(1)}})),n){case"compact":a=a.then((function(e){var t=[e.signatures[0].protected,e.payload,e.signatures[0].signature];return t=t.join(".")}));break;case"flattened":a=a.then((function(e){var t={};t.payload=e.payload;var r=e.signatures[0];return r.protected&&(t.protected=r.protected),r.header&&(t.header=r.header),t.signature=r.signature,t}))}return a}})};
/*!
 * jws/helpers.js - JWS Internal Helper Functions
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
/*!
 * util/algconfig.js - Functions for managing algorithm set options
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
function sd(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var ud=function(e){e?"string"==typeof e&&(e=e.split(" ")):e=[];var t,r=[],n=[],i=[],o=[],a=/^(!)?([^*]*)(\*?)([^*]*)$/;e.forEach((function(e){if(e){a.lastIndex=0;var s=a.exec(e);s&&(t="("+function(e,t,r){var n=[];return n.push("^"),e&&(e=sd(e),n.push(e)),t&&n.push(e||r?".*":".+"),r&&(r=sd(r),n.push(r)),n.push("$"),n.join("")}(s[2],s[3],s[4])+")",s[1]?(o.push(t),n.push(s[0])):(i.push(t),r.push(s[0])))}})),i=i.length?new RegExp(i.join("|")):null,o=o.length?new RegExp(o.join("|")):null,r.length||(r=["*"]),Object.defineProperty(this,"spec",{value:r.join(" ")+" "+n.join(" "),enumerable:!0}),Object.defineProperty(this,"match",{value:function(e){var t=Boolean(e);return t&&i&&(i.lastIndex=0,t=i.test(e)),t&&o&&(o.lastIndex=0,t=!o.test(e)),t}})},cd={algorithms:"*",allowEmbeddedKey:!1},ld=function(e,t){var r,n;n=nd.isKey(e)?(r=e).keystore:nd.isKeyStore(e)?e:nd.createKeyStore(),t=Ha(cd,t),Object.defineProperty(this,"defaultKey",{value:r||void 0,enumerable:!0}),Object.defineProperty(this,"keystore",{value:n,enumerable:!0}),Object.defineProperty(this,"verify",{value:function(e,i){var o=(i=Ha({},t,i||{})).handlers||{},a=Object.keys(o),s=new ud(i.algorithms);if("string"==typeof e)e={payload:(e=e.split("."))[1],signatures:[{protected:e[0],signature:e[2]}]};else if(!e||"object"!=typeof e)throw new Error("invalid input");e.signature&&(e.signatures=[{protected:e.protected||void 0,header:e.header||void 0,signature:e.signature}]);var u=e.signatures||[{}];u=u.map((function(e){var t=xc(e.header||{}),r=e.protected?JSON.parse(Mu.decode(e.protected,"utf8")):{};t=Ha(t,r);var n=Mu.decode(e.signature);if(!s.match(t.alg))return Promise.reject(new Error("Algorithm not allowed: "+t.alg));var i=r.crit;if(i){if(!Array.isArray(i))return Promise.reject(new Error("Invalid 'crit' header"));for(var o=0;i.length>o;o++)if(-1===a.indexOf(i[o]))return Promise.reject(new Error("Critical extension is not supported: "+i[o]))}return r=Object.keys(r),Promise.resolve({protected:r,aad:e.protected||"",header:t,signature:n})}));var c=Promise.all(u);return c=c.then((function(t){return new Promise((function(s,u){var c=function(){var l=t.shift();if(l){l=Ha({},l,{payload:e.payload});var f=Promise.resolve(l);(f=(f=(f=(f=(f=(f=f.then((function(e){var t;return i.allowEmbeddedKey&&e.header.jwk?t=nd.asKey(e.header.jwk):i.allowEmbeddedKey&&e.header.x5c?(t=e.header.x5c[0],t=Buffer.from(t,"base64"),t=nd.asKey(t,"pkix")):t=Promise.resolve(r||n.get({use:"sig",alg:e.header.alg,kid:e.header.kid})),t.then((function(t){return t?(e.key=t,e):Promise.reject(new Error("key does not match"))}))}))).then((function(e){var t=[];return a.forEach((function(r){var n;"function"==typeof(r=o[r])?n=r(e):"object"==typeof r&&"function"==typeof r.prepare&&(n=r.prepare(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))}))).then((function(e){var t=e.aad||"",r=e.payload||"",n=Buffer.alloc(1+t.length+r.length),i=0;return n.write(t,i,"ascii"),i+=t.length,n.write(".",i,"ascii"),i++,Buffer.isBuffer(r)?r.copy(n,i):n.write(r,i,"binary"),e.content=n,e}))).then((function(e){return e.key.verify(e.header.alg,e.content,e.signature)}))).then((function(e){var t=l.payload;return t=Mu.decode(t),{protected:l.protected,header:l.header,payload:t,signature:e.mac,key:l.key}}))).then((function(e){var t=[];return a.forEach((function(r){var n;"object"==typeof(r=o[r])&&"function"==typeof r.complete&&(n=r.complete(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))}))).then(s,c)}else u(new Error("no key found"))};c()}))}))}})};var fd={createSign:{signer:ad,createSign:function(e,t){var r=e,n=1,i=t;if(0===arguments.length)throw new Error("at least one signatory must be provided");1===arguments.length||nd.isKey(e)||e&&"kty"in e||e&&"key"in e&&(nd.isKey(e.key)||"kty"in e.key)?(i=e,n=0,r={}):r=xc(e),Array.isArray(i)||(i=od(arguments,n));var o=(r=Ha(xc(id),r)).fields||{},a=r.format;if(a||(a=r.compact?"compact":"general"),("compact"===a||"flattened"===a)&&1<i.length)throw new Error("too many signatories for compact or flattened JSON serialization");var s="*"===r.protect;r.compact&&(s=!0),i=i.map((function(e,t){return(e&&"kty"in e?nd.asKey(e).then((function(e){return{key:e}})):e?nd.asKey(e.key).then((function(t){return{header:e.header,reference:e.reference,protect:e.protect,key:t}})):Promise.reject(new Error("missing key for signatory "+t))).then((function(e){var t=e.key,r=e.header||{};r=Ha(Ha({},o),r),e.header=r,r.alg||(r.alg=t.algorithms(nd.MODE_SIGN)[0]||"");var n,i=e.reference;if(delete e.reference,void 0===i?i=(i=["kid","jku","x5c","x5t","x5u"].some((function(e){return e in r})))?null:"kid":"boolean"==typeof i&&(i=i?"kid":null),i)if(n=t.toJSON(),"jwk"===i){if("oct"===t.kty)return Promise.reject(new Error("cannot embed key"));r.jwk=n}else i in n&&(r[i]=n[i]);var a=e.protect;if(s||"*"===a)a=Object.keys(r);else if("string"===a)a=[a];else if(Array.isArray(a))a=a.concat();else{if(a)return Promise.reject(new Error("protect must be a list of fields"));a=[]}return a=Vl(a),e.protected=a,e=Object.freeze(e)}))}));var u={format:a};return new ad(u,i)}}.createSign,createVerify:{verifier:ld,createVerify:function(e,t){return new ld(e,t)}}.createVerify},hd=function(e,t){return Array.prototype.slice.call(e,t||0)},pd=function(e){var t=nd.createKeyStore(),r=ql.KEYLENGTH[e];if(r)return t.generate("oct",r);throw new Error("unsupported encryption algorithm")},dd=u((function(e,t){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(r)}));
/*!
 * jws/index.js - JSON Web Signature (JWS) Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */function gd(e){for(var t=e.length;--t>=0;)e[t]=0}var yd=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],vd=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],md=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bd=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ed=new Array(576);gd(Ed);var Sd=new Array(60);gd(Sd);var wd=new Array(512);gd(wd);var _d=new Array(256);gd(_d);var Cd=new Array(29);gd(Cd);var Ad,Id,Td,Pd=new Array(30);function Fd(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function kd(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Rd(e){return e<256?wd[e]:wd[256+(e>>>7)]}function Bd(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Od(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,Bd(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function xd(e,t,r){Od(e,r[2*t],r[2*t+1])}function Nd(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function Ud(e,t,r){var n,i,o=new Array(16),a=0;for(n=1;n<=15;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=Nd(o[s]++,s))}}function jd(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Dd(e){e.bi_valid>8?Bd(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Ld(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function Md(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&Ld(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Ld(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function Kd(e,t,r){var n,i,o,a,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===n?xd(e,i,t):(xd(e,(o=_d[i])+256+1,t),0!==(a=yd[o])&&Od(e,i-=Cd[o],a),xd(e,o=Rd(--n),r),0!==(a=vd[o])&&Od(e,n-=Pd[o],a))}while(s<e.last_lit);xd(e,256,t)}function Vd(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<u;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)Md(e,o,r);i=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Md(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,Md(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,d=t.stat_desc.max_length,g=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)(o=u[2*u[2*(n=e.heap[r])+1]+1]+1)>d&&(o=d,g++),u[2*n+1]=o,n>c||(e.bl_count[o]++,a=0,n>=p&&(a=h[n-p]),s=u[2*n],e.opt_len+=s*(o+a),f&&(e.static_len+=s*(l[2*n+1]+a)));if(0!==g){do{for(o=d-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[d]--,g-=2}while(g>0);for(o=d;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>c||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}(e,t),Ud(o,c,e.bl_count)}function Hd(e,t,r){var n,i,o=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<u&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,o=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4))}function qd(e,t,r){var n,i,o=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<u&&i===a)){if(s<c)do{xd(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(xd(e,i,e.bl_tree),s--),xd(e,16,e.bl_tree),Od(e,s-3,2)):s<=10?(xd(e,17,e.bl_tree),Od(e,s-3,3)):(xd(e,18,e.bl_tree),Od(e,s-11,7));s=0,o=i,0===a?(u=138,c=3):i===a?(u=6,c=3):(u=7,c=4)}}gd(Pd);var zd=!1;function $d(e,t,r,n){Od(e,0+(n?1:0),3),function(e,t,r,n){Dd(e),n&&(Bd(e,r),Bd(e,~r)),dd.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r,!0)}var Gd={_tr_init:function(e){zd||(!function(){var e,t,r,n,i,o=new Array(16);for(r=0,n=0;n<28;n++)for(Cd[n]=r,e=0;e<1<<yd[n];e++)_d[r++]=n;for(_d[r-1]=n,i=0,n=0;n<16;n++)for(Pd[n]=i,e=0;e<1<<vd[n];e++)wd[i++]=n;for(i>>=7;n<30;n++)for(Pd[n]=i<<7,e=0;e<1<<vd[n]-7;e++)wd[256+i++]=n;for(t=0;t<=15;t++)o[t]=0;for(e=0;e<=143;)Ed[2*e+1]=8,e++,o[8]++;for(;e<=255;)Ed[2*e+1]=9,e++,o[9]++;for(;e<=279;)Ed[2*e+1]=7,e++,o[7]++;for(;e<=287;)Ed[2*e+1]=8,e++,o[8]++;for(Ud(Ed,287,o),e=0;e<30;e++)Sd[2*e+1]=5,Sd[2*e]=Nd(e,5);Ad=new Fd(Ed,yd,257,286,15),Id=new Fd(Sd,vd,0,30,15),Td=new Fd(new Array(0),md,0,19,7)}(),zd=!0),e.l_desc=new kd(e.dyn_ltree,Ad),e.d_desc=new kd(e.dyn_dtree,Id),e.bl_desc=new kd(e.bl_tree,Td),e.bi_buf=0,e.bi_valid=0,jd(e)},_tr_stored_block:$d,_tr_flush_block:function(e,t,r,n){var i,o,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Vd(e,e.l_desc),Vd(e,e.d_desc),a=function(e){var t;for(Hd(e,e.dyn_ltree,e.l_desc.max_code),Hd(e,e.dyn_dtree,e.d_desc.max_code),Vd(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*bd[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?$d(e,t,r,n):4===e.strategy||o===i?(Od(e,2+(n?1:0),3),Kd(e,Ed,Sd)):(Od(e,4+(n?1:0),3),function(e,t,r,n){var i;for(Od(e,t-257,5),Od(e,r-1,5),Od(e,n-4,4),i=0;i<n;i++)Od(e,e.bl_tree[2*bd[i]+1],3);qd(e,e.dyn_ltree,t-1),qd(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Kd(e,e.dyn_ltree,e.dyn_dtree)),jd(e),n&&Dd(e)},_tr_tally:function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(_d[r]+256+1)]++,e.dyn_dtree[2*Rd(t)]++),e.last_lit===e.lit_bufsize-1},_tr_align:function(e){Od(e,2,3),xd(e,256,Ed),function(e){16===e.bi_valid?(Bd(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}};var Wd=function(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+t[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0};var Jd=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();var Qd,Yd=function(e,t,r,n){var i=Jd,o=n+r;e^=-1;for(var a=n;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e},Xd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function Zd(e,t){return e.msg=Xd[t],t}function eg(e){return(e<<1)-(e>4?9:0)}function tg(e){for(var t=e.length;--t>=0;)e[t]=0}function rg(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(dd.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function ng(e,t){Gd._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,rg(e.strm)}function ig(e,t){e.pending_buf[e.pending++]=t}function og(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function ag(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,dd.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=Wd(e.adler,t,i,r):2===e.state.wrap&&(e.adler=Yd(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function sg(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,l=e.w_mask,f=e.prev,h=e.strstart+258,p=c[o+a-1],d=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===d&&c[r+a-1]===p&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<h);if(n=258-(h-o),o=h-258,n>a){if(e.match_start=t,a=n,n>=s)break;p=c[o+a-1],d=c[o+a]}}}while((t=f[t&l])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead}function ug(e){var t,r,n,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-262)){dd.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,t=r=e.hash_size;do{n=e.head[--t],e.head[t]=n>=a?n-a:0}while(--r);t=r=a;do{n=e.prev[--t],e.prev[t]=n>=a?n-a:0}while(--r);i+=a}if(0===e.strm.avail_in)break;if(r=ag(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+3-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function cg(e,t){for(var r,n;;){if(e.lookahead<262){if(ug(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-262&&(e.match_length=sg(e,r)),e.match_length>=3)if(n=Gd._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=Gd._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(ng(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(ng(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ng(e,!1),0===e.strm.avail_out)?1:2}function lg(e,t){for(var r,n,i;;){if(e.lookahead<262){if(ug(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-262&&(e.match_length=sg(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,n=Gd._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(ng(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=Gd._tr_tally(e,0,e.window[e.strstart-1]))&&ng(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Gd._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(ng(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ng(e,!1),0===e.strm.avail_out)?1:2}function fg(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function hg(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new dd.Buf16(1146),this.dyn_dtree=new dd.Buf16(122),this.bl_tree=new dd.Buf16(78),tg(this.dyn_ltree),tg(this.dyn_dtree),tg(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new dd.Buf16(16),this.heap=new dd.Buf16(573),tg(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new dd.Buf16(573),tg(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pg(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,Gd._tr_init(t),0):Zd(e,-2)}function dg(e){var t,r=pg(e);return 0===r&&((t=e.state).window_size=2*t.w_size,tg(t.head),t.max_lazy_match=Qd[t.level].max_lazy,t.good_match=Qd[t.level].good_length,t.nice_match=Qd[t.level].nice_length,t.max_chain_length=Qd[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),r}function gg(e,t,r,n,i,o){if(!e)return-2;var a=1;if(-1===t&&(t=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),i<1||i>9||8!==r||n<8||n>15||t<0||t>9||o<0||o>4)return Zd(e,-2);8===n&&(n=9);var s=new hg;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new dd.Buf8(2*s.w_size),s.head=new dd.Buf16(s.hash_size),s.prev=new dd.Buf16(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new dd.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=r,dg(e)}Qd=[new fg(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ug(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,ng(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(ng(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(ng(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(ng(e,!1),e.strm.avail_out),1)})),new fg(4,4,8,4,cg),new fg(4,5,16,8,cg),new fg(4,6,32,32,cg),new fg(4,4,16,16,lg),new fg(8,16,32,32,lg),new fg(8,16,128,128,lg),new fg(8,32,128,256,lg),new fg(32,128,258,1024,lg),new fg(32,258,258,4096,lg)];var yg={deflateInit:function(e,t){return gg(e,t,8,15,8,0)},deflateInit2:gg,deflateReset:dg,deflateResetKeep:pg,deflateSetHeader:function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},deflate:function(e,t){var r,n,i,o;if(!e||!e.state||t>5||t<0)return e?Zd(e,-2):-2;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return Zd(e,0===e.avail_out?-5:-2);if(n.strm=e,r=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,ig(n,31),ig(n,139),ig(n,8),n.gzhead?(ig(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ig(n,255&n.gzhead.time),ig(n,n.gzhead.time>>8&255),ig(n,n.gzhead.time>>16&255),ig(n,n.gzhead.time>>24&255),ig(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),ig(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(ig(n,255&n.gzhead.extra.length),ig(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Yd(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(ig(n,0),ig(n,0),ig(n,0),ig(n,0),ig(n,0),ig(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),ig(n,3),n.status=113);else{var a=8+(n.w_bits-8<<4)<<8;a|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=113,og(n,a),0!==n.strstart&&(og(n,e.adler>>>16),og(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=Yd(e.adler,n.pending_buf,n.pending-i,i)),rg(e),i=n.pending,n.pending!==n.pending_buf_size));)ig(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=Yd(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Yd(e.adler,n.pending_buf,n.pending-i,i)),rg(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,ig(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Yd(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=Yd(e.adler,n.pending_buf,n.pending-i,i)),rg(e),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,ig(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(e.adler=Yd(e.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&rg(e),n.pending+2<=n.pending_buf_size&&(ig(n,255&e.adler),ig(n,e.adler>>8&255),e.adler=0,n.status=113)):n.status=113),0!==n.pending){if(rg(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&eg(t)<=eg(r)&&4!==t)return Zd(e,-5);if(666===n.status&&0!==e.avail_in)return Zd(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var s=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(ug(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=Gd._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(ng(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(ng(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ng(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,n,i,o,a=e.window;;){if(e.lookahead<=258){if(ug(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=e.strstart+258;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);e.match_length=258-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=Gd._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Gd._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(ng(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(ng(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ng(e,!1),0===e.strm.avail_out)?1:2}(n,t):Qd[n.level].func(n,t);if(3!==s&&4!==s||(n.status=666),1===s||3===s)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===s&&(1===t?Gd._tr_align(n):5!==t&&(Gd._tr_stored_block(n,0,0,!1),3===t&&(tg(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),rg(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(ig(n,255&e.adler),ig(n,e.adler>>8&255),ig(n,e.adler>>16&255),ig(n,e.adler>>24&255),ig(n,255&e.total_in),ig(n,e.total_in>>8&255),ig(n,e.total_in>>16&255),ig(n,e.total_in>>24&255)):(og(n,e.adler>>>16),og(n,65535&e.adler)),rg(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},deflateEnd:function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?Zd(e,-2):(e.state=null,113===t?Zd(e,-3):0):-2},deflateSetDictionary:function(e,t){var r,n,i,o,a,s,u,c,l=t.length;if(!e||!e.state)return-2;if(2===(o=(r=e.state).wrap)||1===o&&42!==r.status||r.lookahead)return-2;for(1===o&&(e.adler=Wd(e.adler,t,l,0)),r.wrap=0,l>=r.w_size&&(0===o&&(tg(r.head),r.strstart=0,r.block_start=0,r.insert=0),c=new dd.Buf8(r.w_size),dd.arraySet(c,t,l-r.w_size,r.w_size,0),t=c,l=r.w_size),a=e.avail_in,s=e.next_in,u=e.input,e.avail_in=l,e.next_in=0,e.input=t,ug(r);r.lookahead>=3;){n=r.strstart,i=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=2,ug(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=u,e.avail_in=a,r.wrap=o,0},deflateInfo:"pako deflate (from Nodeca project)"},vg=!0,mg=!0;try{String.fromCharCode.apply(null,[0])}catch(Iw){vg=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Iw){mg=!1}for(var bg=new dd.Buf8(256),Eg=0;Eg<256;Eg++)bg[Eg]=Eg>=252?6:Eg>=248?5:Eg>=240?4:Eg>=224?3:Eg>=192?2:1;bg[254]=bg[254]=1;function Sg(e,t){if(t<65534&&(e.subarray&&mg||!e.subarray&&vg))return String.fromCharCode.apply(null,dd.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}var wg=function(e){var t,r,n,i,o,a=e.length,s=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new dd.Buf8(s),o=0,i=0;o<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|63&r):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|63&r):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|63&r);return t},_g=function(e){return Sg(e,e.length)},Cg=function(e){for(var t=new dd.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},Ag=function(e,t){var r,n,i,o,a=t||e.length,s=new Array(2*a);for(n=0,r=0;r<a;)if((i=e[r++])<128)s[n++]=i;else if((o=bg[i])>4)s[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<a;)i=i<<6|63&e[r++],o--;o>1?s[n++]=65533:i<65536?s[n++]=i:(i-=65536,s[n++]=55296|i>>10&1023,s[n++]=56320|1023&i)}return Sg(s,n)},Ig=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+bg[e[r]]>t?r:t};var Tg=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Pg=Object.prototype.toString;function Fg(e){if(!(this instanceof Fg))return new Fg(e);this.options=dd.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Tg,this.strm.avail_out=0;var r=yg.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(Xd[r]);if(t.header&&yg.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?wg(t.dictionary):"[object ArrayBuffer]"===Pg.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=yg.deflateSetDictionary(this.strm,n)))throw new Error(Xd[r]);this._dict_set=!0}}function kg(e,t){var r=new Fg(t);if(r.push(e,!0),r.err)throw r.msg||Xd[r.err];return r.result}Fg.prototype.push=function(e,t){var r,n,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=wg(e):"[object ArrayBuffer]"===Pg.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new dd.Buf8(o),i.next_out=0,i.avail_out=o),1!==(r=yg.deflate(i,n))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(_g(dd.shrinkBuf(i.output,i.next_out))):this.onData(dd.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==r);return 4===n?(r=yg.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==n||(this.onEnd(0),i.avail_out=0,!0)},Fg.prototype.onData=function(e){this.chunks.push(e)},Fg.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=dd.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Rg={Deflate:Fg,deflate:kg,deflateRaw:function(e,t){return(t=t||{}).raw=!0,kg(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,kg(e,t)}},Bg=function(e,t){var r,n,i,o,a,s,u,c,l,f,h,p,d,g,y,v,m,b,E,S,w,_,C,A,I;r=e.state,n=e.next_in,A=e.input,i=n+(e.avail_in-5),o=e.next_out,I=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),u=r.dmax,c=r.wsize,l=r.whave,f=r.wnext,h=r.window,p=r.hold,d=r.bits,g=r.lencode,y=r.distcode,v=(1<<r.lenbits)-1,m=(1<<r.distbits)-1;e:do{d<15&&(p+=A[n++]<<d,d+=8,p+=A[n++]<<d,d+=8),b=g[p&v];t:for(;;){if(p>>>=E=b>>>24,d-=E,0===(E=b>>>16&255))I[o++]=65535&b;else{if(!(16&E)){if(0==(64&E)){b=g[(65535&b)+(p&(1<<E)-1)];continue t}if(32&E){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}S=65535&b,(E&=15)&&(d<E&&(p+=A[n++]<<d,d+=8),S+=p&(1<<E)-1,p>>>=E,d-=E),d<15&&(p+=A[n++]<<d,d+=8,p+=A[n++]<<d,d+=8),b=y[p&m];r:for(;;){if(p>>>=E=b>>>24,d-=E,!(16&(E=b>>>16&255))){if(0==(64&E)){b=y[(65535&b)+(p&(1<<E)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(w=65535&b,d<(E&=15)&&(p+=A[n++]<<d,(d+=8)<E&&(p+=A[n++]<<d,d+=8)),(w+=p&(1<<E)-1)>u){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=E,d-=E,w>(E=o-a)){if((E=w-E)>l&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(_=0,C=h,0===f){if(_+=c-E,E<S){S-=E;do{I[o++]=h[_++]}while(--E);_=o-w,C=I}}else if(f<E){if(_+=c+f-E,(E-=f)<S){S-=E;do{I[o++]=h[_++]}while(--E);if(_=0,f<S){S-=E=f;do{I[o++]=h[_++]}while(--E);_=o-w,C=I}}}else if(_+=f-E,E<S){S-=E;do{I[o++]=h[_++]}while(--E);_=o-w,C=I}for(;S>2;)I[o++]=C[_++],I[o++]=C[_++],I[o++]=C[_++],S-=3;S&&(I[o++]=C[_++],S>1&&(I[o++]=C[_++]))}else{_=o-w;do{I[o++]=I[_++],I[o++]=I[_++],I[o++]=I[_++],S-=3}while(S>2);S&&(I[o++]=I[_++],S>1&&(I[o++]=I[_++]))}break}}break}}while(n<i&&o<s);n-=S=d>>3,p&=(1<<(d-=S<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=p,r.bits=d},Og=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],xg=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ng=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Ug=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],jg=function(e,t,r,n,i,o,a,s){var u,c,l,f,h,p,d,g,y,v=s.bits,m=0,b=0,E=0,S=0,w=0,_=0,C=0,A=0,I=0,T=0,P=null,F=0,k=new dd.Buf16(16),R=new dd.Buf16(16),B=null,O=0;for(m=0;m<=15;m++)k[m]=0;for(b=0;b<n;b++)k[t[r+b]]++;for(w=v,S=15;S>=1&&0===k[S];S--);if(w>S&&(w=S),0===S)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(E=1;E<S&&0===k[E];E++);for(w<E&&(w=E),A=1,m=1;m<=15;m++)if(A<<=1,(A-=k[m])<0)return-1;if(A>0&&(0===e||1!==S))return-1;for(R[1]=0,m=1;m<15;m++)R[m+1]=R[m]+k[m];for(b=0;b<n;b++)0!==t[r+b]&&(a[R[t[r+b]]++]=b);if(0===e?(P=B=a,p=19):1===e?(P=Og,F-=257,B=xg,O-=257,p=256):(P=Ng,B=Ug,p=-1),T=0,b=0,m=E,h=o,_=w,C=0,l=-1,f=(I=1<<w)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){d=m-C,a[b]<p?(g=0,y=a[b]):a[b]>p?(g=B[O+a[b]],y=P[F+a[b]]):(g=96,y=0),u=1<<m-C,E=c=1<<_;do{i[h+(T>>C)+(c-=u)]=d<<24|g<<16|y|0}while(0!==c);for(u=1<<m-1;T&u;)u>>=1;if(0!==u?(T&=u-1,T+=u):T=0,b++,0==--k[m]){if(m===S)break;m=t[r+a[b]]}if(m>w&&(T&f)!==l){for(0===C&&(C=w),h+=E,A=1<<(_=m-C);_+C<S&&!((A-=k[_+C])<=0);)_++,A<<=1;if(I+=1<<_,1===e&&I>852||2===e&&I>592)return 1;i[l=T&f]=w<<24|_<<16|h-o|0}}return 0!==T&&(i[h+T]=m-C<<24|64<<16|0),s.bits=w,0};function Dg(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function Lg(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new dd.Buf16(320),this.work=new dd.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Mg(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new dd.Buf32(852),t.distcode=t.distdyn=new dd.Buf32(592),t.sane=1,t.back=-1,0):-2}function Kg(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,Mg(e)):-2}function Vg(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Kg(e))):-2}function Hg(e,t){var r,n;return e?(n=new Lg,e.state=n,n.window=null,0!==(r=Vg(e,t))&&(e.state=null),r):-2}var qg,zg,$g=!0;function Gg(e){if($g){var t;for(qg=new dd.Buf32(512),zg=new dd.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(jg(1,e.lens,0,288,qg,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;jg(2,e.lens,0,32,zg,0,e.work,{bits:5}),$g=!1}e.lencode=qg,e.lenbits=9,e.distcode=zg,e.distbits=5}function Wg(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new dd.Buf8(o.wsize)),n>=o.wsize?(dd.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>n&&(i=n),dd.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(dd.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}var Jg={inflateReset:Kg,inflateReset2:Vg,inflateResetKeep:Mg,inflateInit:function(e){return Hg(e,15)},inflateInit2:Hg,inflate:function(e,t){var r,n,i,o,a,s,u,c,l,f,h,p,d,g,y,v,m,b,E,S,w,_,C,A,I=0,T=new dd.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(r=e.state).mode&&(r.mode=13),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,l=r.bits,f=s,h=u,_=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;l<16;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(2&r.wrap&&35615===c){r.check=0,T[0]=255&c,T[1]=c>>>8&255,r.check=Yd(r.check,T,2,0),c=0,l=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&c)){e.msg="unknown compression method",r.mode=30;break}if(l-=4,w=8+(15&(c>>>=4)),0===r.wbits)r.wbits=w;else if(w>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<w,e.adler=r.check=1,r.mode=512&c?10:12,c=0,l=0;break;case 2:for(;l<16;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(r.flags=c,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,r.check=Yd(r.check,T,2,0)),c=0,l=0,r.mode=3;case 3:for(;l<32;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}r.head&&(r.head.time=c),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,T[2]=c>>>16&255,T[3]=c>>>24&255,r.check=Yd(r.check,T,4,0)),c=0,l=0,r.mode=4;case 4:for(;l<16;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,r.check=Yd(r.check,T,2,0)),c=0,l=0,r.mode=5;case 5:if(1024&r.flags){for(;l<16;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&(T[0]=255&c,T[1]=c>>>8&255,r.check=Yd(r.check,T,2,0)),c=0,l=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((p=r.length)>s&&(p=s),p&&(r.head&&(w=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),dd.arraySet(r.head.extra,n,o,p,w)),512&r.flags&&(r.check=Yd(r.check,n,p,o)),s-=p,o+=p,r.length-=p),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===s)break e;p=0;do{w=n[o+p++],r.head&&w&&r.length<65536&&(r.head.name+=String.fromCharCode(w))}while(w&&p<s);if(512&r.flags&&(r.check=Yd(r.check,n,p,o)),s-=p,o+=p,w)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===s)break e;p=0;do{w=n[o+p++],r.head&&w&&r.length<65536&&(r.head.comment+=String.fromCharCode(w))}while(w&&p<s);if(512&r.flags&&(r.check=Yd(r.check,n,p,o)),s-=p,o+=p,w)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;l<16;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}c=0,l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;l<32;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}e.adler=r.check=Dg(c),c=0,l=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=l,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){c>>>=7&l,l-=7&l,r.mode=27;break}for(;l<3;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}switch(r.last=1&c,l-=1,3&(c>>>=1)){case 0:r.mode=14;break;case 1:if(Gg(r),r.mode=20,6===t){c>>>=2,l-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}c>>>=2,l-=2;break;case 14:for(c>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&c,c=0,l=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(p=r.length){if(p>s&&(p=s),p>u&&(p=u),0===p)break e;dd.arraySet(i,n,o,p,a),s-=p,o+=p,u-=p,a+=p,r.length-=p;break}r.mode=12;break;case 17:for(;l<14;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(r.nlen=257+(31&c),c>>>=5,l-=5,r.ndist=1+(31&c),c>>>=5,l-=5,r.ncode=4+(15&c),c>>>=4,l-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;l<3;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}r.lens[P[r.have++]]=7&c,c>>>=3,l-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,C={bits:r.lenbits},_=jg(0,r.lens,0,19,r.lencode,0,r.work,C),r.lenbits=C.bits,_){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;v=(I=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,m=65535&I,!((y=I>>>24)<=l);){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(m<16)c>>>=y,l-=y,r.lens[r.have++]=m;else{if(16===m){for(A=y+2;l<A;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(c>>>=y,l-=y,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}w=r.lens[r.have-1],p=3+(3&c),c>>>=2,l-=2}else if(17===m){for(A=y+3;l<A;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}l-=y,w=0,p=3+(7&(c>>>=y)),c>>>=3,l-=3}else{for(A=y+7;l<A;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}l-=y,w=0,p=11+(127&(c>>>=y)),c>>>=7,l-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;p--;)r.lens[r.have++]=w}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,C={bits:r.lenbits},_=jg(1,r.lens,0,r.nlen,r.lencode,0,r.work,C),r.lenbits=C.bits,_){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,C={bits:r.distbits},_=jg(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,C),r.distbits=C.bits,_){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(s>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=l,Bg(e,h),a=e.next_out,i=e.output,u=e.avail_out,o=e.next_in,n=e.input,s=e.avail_in,c=r.hold,l=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;v=(I=r.lencode[c&(1<<r.lenbits)-1])>>>16&255,m=65535&I,!((y=I>>>24)<=l);){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(v&&0==(240&v)){for(b=y,E=v,S=m;v=(I=r.lencode[S+((c&(1<<b+E)-1)>>b)])>>>16&255,m=65535&I,!(b+(y=I>>>24)<=l);){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}c>>>=b,l-=b,r.back+=b}if(c>>>=y,l-=y,r.back+=y,r.length=m,0===v){r.mode=26;break}if(32&v){r.back=-1,r.mode=12;break}if(64&v){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&v,r.mode=22;case 22:if(r.extra){for(A=r.extra;l<A;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;v=(I=r.distcode[c&(1<<r.distbits)-1])>>>16&255,m=65535&I,!((y=I>>>24)<=l);){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(0==(240&v)){for(b=y,E=v,S=m;v=(I=r.distcode[S+((c&(1<<b+E)-1)>>b)])>>>16&255,m=65535&I,!(b+(y=I>>>24)<=l);){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}c>>>=b,l-=b,r.back+=b}if(c>>>=y,l-=y,r.back+=y,64&v){e.msg="invalid distance code",r.mode=30;break}r.offset=m,r.extra=15&v,r.mode=24;case 24:if(r.extra){for(A=r.extra;l<A;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===u)break e;if(p=h-u,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}p>r.wnext?(p-=r.wnext,d=r.wsize-p):d=r.wnext-p,p>r.length&&(p=r.length),g=r.window}else g=i,d=a-r.offset,p=r.length;p>u&&(p=u),u-=p,r.length-=p;do{i[a++]=g[d++]}while(--p);0===r.length&&(r.mode=21);break;case 26:if(0===u)break e;i[a++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;l<32;){if(0===s)break e;s--,c|=n[o++]<<l,l+=8}if(h-=u,e.total_out+=h,r.total+=h,h&&(e.adler=r.check=r.flags?Yd(r.check,i,h,a-h):Wd(r.check,i,h,a-h)),h=u,(r.flags?c:Dg(c))!==r.check){e.msg="incorrect data check",r.mode=30;break}c=0,l=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;l<32;){if(0===s)break e;s--,c+=n[o++]<<l,l+=8}if(c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}c=0,l=0}r.mode=29;case 29:_=1;break e;case 30:_=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=s,r.hold=c,r.bits=l,(r.wsize||h!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&Wg(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=r.flags?Yd(r.check,i,h,e.next_out-h):Wd(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===f&&0===h||4===t)&&0===_&&(_=-5),_},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:(r.head=t,t.done=!1,0):-2},inflateSetDictionary:function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&Wd(1,t,n,0)!==r.check?-3:Wg(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},Qg={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Yg=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Xg=Object.prototype.toString;function Zg(e){if(!(this instanceof Zg))return new Zg(e);this.options=dd.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Tg,this.strm.avail_out=0;var r=Jg.inflateInit2(this.strm,t.windowBits);if(r!==Qg.Z_OK)throw new Error(Xd[r]);if(this.header=new Yg,Jg.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=wg(t.dictionary):"[object ArrayBuffer]"===Xg.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Jg.inflateSetDictionary(this.strm,t.dictionary))!==Qg.Z_OK))throw new Error(Xd[r])}function ey(e,t){var r=new Zg(t);if(r.push(e,!0),r.err)throw r.msg||Xd[r.err];return r.result}Zg.prototype.push=function(e,t){var r,n,i,o,a,s=this.strm,u=this.options.chunkSize,c=this.options.dictionary,l=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?Qg.Z_FINISH:Qg.Z_NO_FLUSH,"string"==typeof e?s.input=Cg(e):"[object ArrayBuffer]"===Xg.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new dd.Buf8(u),s.next_out=0,s.avail_out=u),(r=Jg.inflate(s,Qg.Z_NO_FLUSH))===Qg.Z_NEED_DICT&&c&&(r=Jg.inflateSetDictionary(this.strm,c)),r===Qg.Z_BUF_ERROR&&!0===l&&(r=Qg.Z_OK,l=!1),r!==Qg.Z_STREAM_END&&r!==Qg.Z_OK)return this.onEnd(r),this.ended=!0,!1;s.next_out&&(0!==s.avail_out&&r!==Qg.Z_STREAM_END&&(0!==s.avail_in||n!==Qg.Z_FINISH&&n!==Qg.Z_SYNC_FLUSH)||("string"===this.options.to?(i=Ig(s.output,s.next_out),o=s.next_out-i,a=Ag(s.output,i),s.next_out=o,s.avail_out=u-o,o&&dd.arraySet(s.output,s.output,i,o,0),this.onData(a)):this.onData(dd.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(l=!0)}while((s.avail_in>0||0===s.avail_out)&&r!==Qg.Z_STREAM_END);return r===Qg.Z_STREAM_END&&(n=Qg.Z_FINISH),n===Qg.Z_FINISH?(r=Jg.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Qg.Z_OK):n!==Qg.Z_SYNC_FLUSH||(this.onEnd(Qg.Z_OK),s.avail_out=0,!0)},Zg.prototype.onData=function(e){this.chunks.push(e)},Zg.prototype.onEnd=function(e){e===Qg.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=dd.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ty={Inflate:Zg,inflate:ey,inflateRaw:function(e,t){return(t=t||{}).raw=!0,ey(e,t)},ungzip:ey},ry={};(0,dd.assign)(ry,Rg,ty,Qg);var ny=ry,iy={zip:!1,format:"general",contentAlg:"A128CBC-HS256",protect:"*"},oy=pd,ay=hd;
/*!
 * jwe/defaults.js - Defaults for JWEs
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */function sy(e,t,r){var n=!1,i=e.format||"general",o=!!e.protectAll,a=Buffer.alloc(0);Object.defineProperty(this,"zip",{get:function(){return t.zip||""},enumerable:!0}),Object.defineProperty(this,"compact",{get:function(){return"compact"===i},enumerable:!0}),Object.defineProperty(this,"format",{get:function(){return i},enumerable:!0}),Object.defineProperty(this,"protected",{get:function(){return xc(e.protect)},enumerable:!0}),Object.defineProperty(this,"header",{get:function(){return xc(t)},enumerable:!0}),Object.defineProperty(this,"update",{value:function(e,t){if(n)throw new Error("already final");return null!=e&&(e=Vu.asBuffer(e,t),a=a.length?Buffer.concat([a,e],a.length+e.length):e),this}}),Object.defineProperty(this,"final",{value:function(s,u){if(n)return Promise.reject(new Error("already final"));this.update(s,u),n=!0;var c,l=Promise.resolve({}),f=t.enc;l=(l=l.then((function(t){return e.cek&&(c=nd.asKey(e.cek)),t}))).then((function(n){var i=Promise.all(r);return i=(i=i.then((function(r){var n=1===r.length;return r=r.map((function(r){return function(r,n){var i={};i=Wc(i,t),i=Wc(i,r.header);var o,a,s=r.key,u=i.alg;return 0===(i.alg||"").indexOf("ECDH-ES")?(o=s.keystore.temp(),a=r.epk?Promise.resolve(r.epk).then((function(e){r.header.epk=e.toJSON(!1,["kid"]),i.epk=e.toObject(!0,["kid"])})):o.generate("EC",s.get("crv")).then((function(e){r.header.epk=e.toJSON(!1,["kid"]),i.epk=e.toObject(!0,["kid"])}))):a=Promise.resolve(),(a=a.then((function(){var r,o;return"dir"===u&&n?o=(c=Promise.resolve(s)).then((function(e){return f||(i.enc=t.enc=f=e.algorithms(nd.MODE_ENCRYPT)[0]),{once:!0,direct:!0}})):(c||(f||(i.enc=t.enc=f=e.contentAlg),c=oy(f)),o=(o=c.then((function(e){return r=e.get("k",!0),s}))).then((function(e){return e.wrap(u,r,i)}))),o}))).then((function(e){if(e.once&&!n)return Promise.reject(new Error("cannot use 'alg':'"+u+"' with multiple recipients"));var t,i={};return e.data&&(t=e.data,t=Vu.base64url.encode(t)),e.direct&&t?c=nd.asKey({kty:"oct",k:t}):t&&(i.encrypted_key=t),r.header&&Object.keys(r.header).length&&(i.header=xc(r.header||{})),e.header&&(i.header=Wc(i.header||{},e.header)),i}))}(r,n)})),Promise.all(r)}))).then((function(e){return n.recipients=e.filter((function(e){return!!e})),n}))}));var h={};switch(l=(l=(l=l.then((function(r){var n,a,s,u;return s=xc(t),o&&1===r.recipients.length||"compact"===i?(n={},n=Wc({},s,r.recipients[0].header),a=Object.keys(n).length,s=void 0,u=0,delete r.recipients[0].header,0===Object.keys(r.recipients[0]).length&&r.recipients.splice(0,1)):(n={},a=0,u=Object.keys(s).length,e.protect.forEach((function(e){e in s&&(n[e]=s[e],a++,delete s[e],u--)})),r.recipients=(r.recipients||[]).map((function(e){var t=(e=e||{}).header;return t&&(Object.keys(t).forEach((function(e){e in n&&delete t[e]})),Object.keys(t).length||delete e.header),e}))),r.recipients&&0!==r.recipients.length||delete r.recipients,s&&u>0&&(h=Wc(h,s),r.unprotected=s),n&&a>0&&(h=Wc(h,n),n=JSON.stringify(n),r.protected=Vu.base64url.encode(n,"utf8")),r}))).then((function(e){var t=a;return h.zip?"DEF"===h.zip?new Promise((function(r,n){try{var i=ny.deflateRaw(Buffer.from(t,"binary"));e.plaintext=i,r(e)}catch(o){n(o)}})):Promise.reject(new Error("unsupported 'zip' mode")):(e.plaintext=t,e)}))).then((function(t){h.adata=t.protected,"aad"in e&&null!=e.aad&&(h.adata+="."+e.aad,h.adata=Buffer.from(h.adata,"utf8"));var r=e.iv||Vu.randomBytes(ql.NONCELENGTH[f]/8);"string"==typeof r&&(r=Vu.base64url.decode(r)),h.iv=r,"recipients"in t&&1===t.recipients.length&&(h.kdata=t.recipients[0].encrypted_key),"epu"in e&&null!=e.epu&&(h.epu=e.epu),"epv"in e&&null!=e.epv&&(h.epv=e.epv);var n=t.plaintext;return delete t.plaintext,c.then((function(i){var o=i.encrypt(f,n,h);return o=o.then((function(n){return t.iv=Vu.base64url.encode(r,"binary"),"aad"in e&&null!=e.aad&&(t.aad=e.aad),t.ciphertext=Vu.base64url.encode(n.data,"binary"),t.tag=Vu.base64url.encode(n.tag,"binary"),t}))}))})),i){case"compact":l=l.then((function(e){var t=new Array(5);return t[0]=e.protected,e.recipients&&e.recipients[0]&&(t[1]=e.recipients[0].encrypted_key),t[2]=e.iv,t[3]=e.ciphertext,t[4]=e.tag,t=t.join(".")}));break;case"flattened":l=l.then((function(e){var t={},r=e.recipients&&e.recipients[0];return e.protected&&(t.protected=e.protected),e.unprotected&&(t.unprotected=e.unprotected),["header","encrypted_key"].forEach((function(e){r&&e in r&&r[e]&&("object"!=typeof r[e]||Object.keys(r[e]).length)&&(t[e]=r[e])})),e.aad&&(t.aad=e.aad),t.iv=e.iv,t.ciphertext=e.ciphertext,t.tag=e.tag,t}));break;case"general":l=l.then((function(e){var t=e.recipients||[];return(t=(t=t.map((function(e){if(Object.keys(e).length)return e}))).filter((function(e){return!!e}))).length?e.recipients=t:delete e.recipients,e}))}return l}})}var uy={algorithms:"*"};
/*!
 * jwe/decrypt.js - Decrypt from a JWE
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */function cy(e,t){var r,n;if(nd.isKey(e))n=(r=e).keystore;else{if(!nd.isKeyStore(e))throw new TypeError("Keystore must be provided");n=e}t=Ha(uy,t),Object.defineProperty(this,"decrypt",{value:function(e,i){var o=(i=Ha({},t,i||{})).handlers||{},a=Object.keys(o),s=new ud(i.algorithms);if("string"==typeof e)e={protected:(e=e.split("."))[0],recipients:[{encrypted_key:e[1]}],iv:e[2],ciphertext:e[3],tag:e[4]};else if(!e||"object"!=typeof e)throw new Error("invalid input");"encrypted_key"in e&&(e.recipients=[{encrypted_key:e.encrypted_key}]);var u,c,l,f,h,p=e.recipients||[{}];return Promise.resolve(p).then((function(t){if(e.protected){c=Mu.decode(e.protected).toString("utf8");var r=(c=JSON.parse(c)).crit;if(r){if(!Array.isArray(r))return Promise.reject(new Error("Invalid 'crit' header"));for(var n=0;r.length>n;n++)if(-1===a.indexOf(r[n]))return Promise.reject(new Error("Critical extension is not supported: "+r[n]))}u=c,c=Object.keys(c)}else u={},c=[];return u=Ha(e.unprotected||{},u),t=t.map((function(e){var t=Promise.resolve(),r=e.header||{};return r=Ha(r,u),e.header=r,e.protected=c,s.match(r.alg)||(t=t.then((function(){return Promise.reject(new Error("Algorithm not allowed: "+r.alg))}))),s.match(r.enc)||(t=t.then((function(){return Promise.reject(new Error("Algorithm not allowed: "+r.enc))}))),r.epk&&(t=(t=t.then((function(){return nd.asKey(r.epk)}))).then((function(e){r.epk=e.toObject(!1)}))),t.then((function(){return e}))})),Promise.all(t)})).then((function(e){var t={};return new Promise((function(i,o){var a=function(){var s=e.shift();if(s){var u=Promise.resolve(s);(u=(u=u.then((function(e){var t=h=e.encrypted_key||"";return t=Mu.decode(t),(l=r||n.get({use:"enc",alg:e.header.alg,kid:e.header.kid}))?l.unwrap(e.header.alg,t,e.header):Promise.reject()}))).then((function(e){f={kty:"oct",k:Mu.encode(e)},f=nd.asKey(f),t.key=l,t.header=s.header,t.protected=s.protected,i(t)}))).catch(a)}else o(new Error("no key found"))};a()}))})).then((function(t){return t.iv=e.iv,t.tag=e.tag,t.ciphertext=e.ciphertext,t})).then((function(e){var t=[];return a.forEach((function(r){var n;"function"==typeof(r=o[r])?n=r(e):"object"==typeof r&&"function"==typeof r.prepare&&(n=r.prepare(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))})).then((function(e){return Buffer.isBuffer(e.ciphertext)||(e.ciphertext=Mu.decode(e.ciphertext)),e})).then((function(t){var r=e.protected;"aad"in e&&null!=e.aad&&(r+="."+e.aad);var n={iv:t.iv,adata:r,tag:t.tag,kdata:h,epu:t.epu,epv:t.epv},i=t.ciphertext;return delete t.iv,delete t.tag,delete t.ciphertext,f.then((function(e){return e.decrypt(t.header.enc,i,n).then((function(e){return t.payload=t.plaintext=e,t}))}))})).then((function(e){return"DEF"===e.header.zip?new Promise((function(t,r){try{var n=ny.inflateRaw(Buffer.from(e.plaintext));e.payload=e.plaintext=Buffer.from(n),t(e)}catch(i){r(i)}})):e})).then((function(e){var t=[];return a.forEach((function(r){var n;"object"==typeof(r=o[r])&&"function"==typeof r.complete&&(n=r.complete(e)),n&&t.push(Promise.resolve(n))})),Promise.all(t).then((function(){return e}))}))}})}var ly={createEncrypt:{encrypter:sy,createEncrypt:function(e,t){var r=e,n=1,i=t;if(0===arguments.length)throw new Error("at least one recipient must be provided");1===arguments.length||nd.isKey(e)||e&&"kty"in e||e&&"key"in e&&(nd.isKey(e.key)||"kty"in e.key)?(i=e,n=0,r={}):r=xc(e),Array.isArray(i)||(i=ay(arguments,n)),r=Wc(xc(iy),r);var o=xc(r.fields||{});switch(r.zip&&(o.zip="boolean"==typeof r.zip?!!r.zip&&"DEF":r.zip),r.format=(r.compact?"compact":r.format)||"general",r.format){case"compact":if("aad"in e)throw new Error("additional authenticated data cannot be used for compact serialization");case"flattened":if(i.length>1)throw new Error("too many recipients for compact serialization")}var a=!1;if("compact"===r.format||"*"===r.protect)a=!0,r.protect=Object.keys(o).concat("enc");else if("string"==typeof r.protect)r.protect=[r.protect];else if(Array.isArray(r.protect))r.protect=r.protect.concat();else{if(r.protect)throw new Error("protect must be a list of fields");r.protect=[]}if(a&&1<i.length)throw new Error("too many recipients to protect all header parameters");i=i.map((function(e,t){var r;return r=e&&"kty"in e?(r=nd.asKey(e)).then((function(e){return{key:e}})):e?(r=nd.asKey(e.key)).then((function(t){return{header:e.header,reference:e.reference,key:t}})):Promise.reject(new Error("missing key for recipient "+t)),e.epk&&(r=r.then((function(t){return nd.asKey(e.epk).then((function(e){return t.epk=e,t}))}))),r=r.then((function(e){var r=e.key,n=e.header||{};e.header=n;var i={};if(i=Wc(i,o),(i=Wc(i,e.header)).alg||(i.alg=r.algorithms(nd.MODE_WRAP)[0],n.alg=i.alg),!i.alg)return Promise.reject(new Error("key not valid for encrypting to recipient "+t));n.alg=i.alg;var a,s=e.reference;if(delete e.reference,void 0===s?s=(s=["kid","jku","x5c","x5t","x5u"].some((function(e){return e in n})))?null:"kid":"boolean"==typeof s&&(s=s?"kid":null),s)if(a=r.toJSON(),"jwk"===s){if("oct"===r.kty)return Promise.reject(new Error("cannot embed key"));n.jwk=a}else s in a&&(n[s]=a[s]);return e=Object.freeze(e)}))}));var s={aad:"aad"in r?Vu.base64url.encode(r.aad||""):null,contentAlg:r.contentAlg,format:r.format,protect:r.protect,cek:r.cek,iv:r.iv,protectAll:a},u=new sy(s,o,i);return u}}.createEncrypt,createDecrypt:{decrypter:cy,createDecrypt:function(e,t){return new cy(e,t)}}.createDecrypt},fy={JWE:ly,JWS:fd,util:Vu};
/*!
 * jwe/index.js - JSON Web Encryption (JWE) Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */var hy=function(e){var t,r,n,i=e.split(".");if(3===i.length)t="JWS",r=function(t,r){return fy.JWS.createVerify(t).verify(e,r)};else{if(5!==i.length)throw new TypeError("invalid jose serialization");t="JWE",r=function(t,r){return fy.JWE.createDecrypt(t).decrypt(e,r)}}return n=fy.util.base64url.decode(i[0],"utf8"),n=JSON.parse(n),{type:t,format:"compact",input:e,header:n,perform:r}},py={JWE:ly,JWS:fd,util:Vu};
/*!
 * parse/compact.js - JOSE JSON Serialization Parser
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */var dy=function(e){var t,r,n;if("signatures"in e||"signature"in e)t="JWS",r=function(t,r){return py.JWS.createVerify(t).verify(e,r)},n=(n=e.signatures||[{protected:e.protected,header:e.header,signature:e.signature}]).map((function(e){var t,r={};return e.header&&(r=Ha(r,e.header)),e.protected&&(t=e.protected,t=py.util.base64url.decode(t,"utf8"),t=JSON.parse(t),r=Ha(r,t)),r}));else if("ciphertext"in e){t="JWE",r=function(t,r){return py.JWE.createDecrypt(t).decrypt(e,r)};var i={};e.protected&&(i.protected=e.protected,i.protected=py.util.base64url.decode(i.protected,"utf8"),i.protected=JSON.parse(i.protected)),e.unprotected&&(i.unprotected=e.unprotected),n=(n=e.recipients||[{}]).map((function(e){var t={};return e.header&&(t=Ha(t,e.header)),i.unprotected&&(t=Ha(t,i.unprotected)),i.protected&&(t=Ha(t,i.protected)),t}))}return{type:t,format:"json",input:e,all:n,perform:r}},gy=u((function(e){var t=e.exports=function(e){if(Buffer.isBuffer(e))return hy(e.toString("ascii"));if("string"==typeof e)return hy(e);if(e)return dy(e);throw new TypeError("invalid input")};t.compact=hy,t.json=dy}));
/*!
 * parse/index.js - JOSE Parser Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
/*!
 * index.js - Main Entry Point
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */
"undefined"==typeof Promise&&Ur.polyfill(),"undefined"==typeof Buffer&&((a||window).Buffer=Yr.Buffer),"undefined"==typeof process&&((a||window).process=Xr),process.version||(process.version="");var yy={JWA:Ep,JWE:ly,JWK:nd,JWS:fd,util:Vu,parse:gy,canYouSee:fd.createVerify},vy=u((function(e,t){const r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=o,t.SlowBuffer=function(e){+e!=e&&(e=0);return o.alloc(+e)},t.INSPECT_MAX_BYTES=50;const n=2147483647;function i(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|h(e,t);let n=i(r);const a=n.write(e,t);a!==r&&(n=n.slice(0,a));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){const t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return c(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return l(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return l(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return o.from(n,t,r);const a=function(e){if(o.isBuffer(e)){const t=0|f(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||G(e.length)?i(0):c(e);if("Buffer"===e.type&&Array.isArray(e.data))return c(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return s(e),i(e<0?0:0|f(e))}function c(e){const t=e.length<0?0:0|f(e.length),r=i(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function l(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,o.prototype),n}function f(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function h(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return q(e).length;default:if(i)return n?-1:H(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return w(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function d(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),G(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){let o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===u)return n*a}else-1!==n&&(o-=o-n),n=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){let r=!0;for(let n=0;n<u;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return-1}function v(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=t.length;let a;for(n>o/2&&(n=o/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(G(n))return a;e[r+a]=n}return a}function m(e,t,r,n){return z(H(t,e.length-r),e,r,n)}function b(e,t,r,n){return z(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function E(e,t,r,n){return z(q(t),e,r,n)}function S(e,t,r,n){return z(function(e,t){let r,n,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function w(e,t,r){return 0===t&&r===e.length?Wr.fromByteArray(e):Wr.fromByteArray(e.slice(t,r))}function _(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,s,u;switch(a){case 1:t<128&&(o=t);break;case 2:r=e[i+1],128==(192&r)&&(u=(31&t)<<6|63&r,u>127&&(o=u));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(u=(15&t)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(o=u));break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(u=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s,u>65535&&u<1114112&&(o=u))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=a}return function(e){const t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}t.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(Aw){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return a(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return function(e,t,r){return s(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if($(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=o.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if($(t,Uint8Array))i+t.length>n.length?(o.isBuffer(t)||(t=o.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!o.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},o.byteLength=h,o.prototype._isBuffer=!0,o.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)d(this,t,t+1);return this},o.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)d(this,t,t+3),d(this,t+1,t+2);return this},o.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)d(this,t,t+7),d(this,t+1,t+6),d(this,t+2,t+5),d(this,t+3,t+4);return this},o.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?_(this,0,e):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(e,t,r,n,i){if($(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0);const u=Math.min(a,s),c=this.slice(n,i),l=e.slice(t,r);for(let o=0;o<u;++o)if(c[o]!==l[o]){a=c[o],s=l[o];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return m(this,e,t,r);case"ascii":case"latin1":case"binary":return b(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function A(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function T(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=t;o<r;++o)i+=W[e[o]];return i}function P(e,t,r){const n=e.slice(t,r);let i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function F(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,r,n,i,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i){L(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function B(e,t,r,n,i){L(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function O(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function x(e,t,r,n,i){return t=+t,r>>>=0,i||O(e,0,r,4),Qr(e,t,r,n,23,4),r+4}function N(e,t,r,n,i){return t=+t,r>>>=0,i||O(e,0,r,8),Qr(e,t,r,n,52,8),r+8}o.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=J((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||K(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),o.prototype.readBigUInt64BE=J((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||K(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||F(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=J((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||K(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),o.prototype.readBigInt64BE=J((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||K(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),o.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),Jr(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),Jr(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),Jr(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),Jr(this,e,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){k(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){k(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigUInt64LE=J((function(e,t=0){return R(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),o.prototype.writeBigUInt64BE=J((function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);k(this,e,t,r,n-1,-n)}let i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);k(this,e,t,r,n-1,-n)}let i=r-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigInt64LE=J((function(e,t=0){return R(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),o.prototype.writeBigInt64BE=J((function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),o.prototype.writeFloatLE=function(e,t,r){return x(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return x(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return N(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return N(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const a=o.isBuffer(e)?e:o.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};const U={};function j(e,t,r){U[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function D(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function L(e,t,r,n,i,o){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new U.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){M(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||K(t,e.length-(r+1))}(n,i,o)}function M(e,t){if("number"!=typeof e)throw new U.ERR_INVALID_ARG_TYPE(t,"number",e)}function K(e,t,r){if(Math.floor(e)!==e)throw M(e,r),new U.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=D(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=D(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function H(e,t){let r;t=t||1/0;const n=e.length;let i=null;const o=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function q(e){return Wr.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function z(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function G(e){return e!=e}const W=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function J(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}})),my=u((function(e,t){var r=vy.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=vy:(n(vy,t),t.Buffer=i),i.prototype=Object.create(r.prototype),n(r,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return vy.SlowBuffer(e)}})),by="undefined"!=typeof Symbol&&Symbol,Ey=function(){return"function"==typeof by&&("function"==typeof Symbol&&("symbol"==typeof by("foo")&&("symbol"==typeof Symbol("bar")&&function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}())))},Sy="Function.prototype.bind called on incompatible ",wy=Array.prototype.slice,_y=Object.prototype.toString,Cy=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==_y.call(t))throw new TypeError(Sy+t);for(var r,n=wy.call(arguments,1),i=function(){if(this instanceof r){var i=t.apply(this,n.concat(wy.call(arguments)));return Object(i)===i?i:this}return t.apply(e,n.concat(wy.call(arguments)))},o=Math.max(0,t.length-n.length),a=[],s=0;s<o;s++)a.push("$"+s);if(r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(i),t.prototype){var u=function(){};u.prototype=t.prototype,r.prototype=new u,u.prototype=null}return r},Ay=Cy.call(Function.call,Object.prototype.hasOwnProperty),Iy=SyntaxError,Ty=Function,Py=TypeError,Fy=function(e){try{return Ty('"use strict"; return ('+e+").constructor;")()}catch(Aw){}},ky=Object.getOwnPropertyDescriptor;
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */if(ky)try{ky({},"")}catch(Aw){ky=null}var Ry=function(){throw new Py},By=ky?function(){try{return Ry}catch(e){try{return ky(arguments,"callee").get}catch(t){return Ry}}}():Ry,Oy=Ey(),xy=Object.getPrototypeOf||function(e){return e.__proto__},Ny={},Uy="undefined"==typeof Uint8Array?undefined:xy(Uint8Array),jy={"%AggregateError%":"undefined"==typeof AggregateError?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":Oy?xy([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":Ny,"%AsyncGenerator%":Ny,"%AsyncGeneratorFunction%":Ny,"%AsyncIteratorPrototype%":Ny,"%Atomics%":"undefined"==typeof Atomics?undefined:Atomics,"%BigInt%":"undefined"==typeof BigInt?undefined:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?undefined:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?undefined:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?undefined:FinalizationRegistry,"%Function%":Ty,"%GeneratorFunction%":Ny,"%Int8Array%":"undefined"==typeof Int8Array?undefined:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?undefined:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Oy?xy(xy([][Symbol.iterator]())):undefined,"%JSON%":"object"==typeof JSON?JSON:undefined,"%Map%":"undefined"==typeof Map?undefined:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Oy?xy((new Map)[Symbol.iterator]()):undefined,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?undefined:Promise,"%Proxy%":"undefined"==typeof Proxy?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?undefined:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?undefined:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Oy?xy((new Set)[Symbol.iterator]()):undefined,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Oy?xy(""[Symbol.iterator]()):undefined,"%Symbol%":Oy?Symbol:undefined,"%SyntaxError%":Iy,"%ThrowTypeError%":By,"%TypedArray%":Uy,"%TypeError%":Py,"%Uint8Array%":"undefined"==typeof Uint8Array?undefined:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?undefined:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?undefined:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?undefined:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?undefined:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?undefined:WeakSet},Dy=function e(t){var r;if("%AsyncFunction%"===t)r=Fy("async function () {}");else if("%GeneratorFunction%"===t)r=Fy("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=Fy("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(r=xy(i.prototype))}return jy[t]=r,r},Ly={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},My=Cy.call(Function.call,Array.prototype.concat),Ky=Cy.call(Function.apply,Array.prototype.splice),Vy=Cy.call(Function.call,String.prototype.replace),Hy=Cy.call(Function.call,String.prototype.slice),qy=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,zy=/\\(\\)?/g,$y=function(e){var t=Hy(e,0,1),r=Hy(e,-1);if("%"===t&&"%"!==r)throw new Iy("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new Iy("invalid intrinsic syntax, expected opening `%`");var n=[];return Vy(e,qy,(function(e,t,r,i){n[n.length]=r?Vy(i,zy,"$1"):t||e})),n},Gy=function(e,t){var r,n=e;if(Ay(Ly,n)&&(n="%"+(r=Ly[n])[0]+"%"),Ay(jy,n)){var i=jy[n];if(i===Ny&&(i=Dy(n)),void 0===i&&!t)throw new Py("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new Iy("intrinsic "+e+" does not exist!")},Wy=function(e,t){if("string"!=typeof e||0===e.length)throw new Py("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new Py('"allowMissing" argument must be a boolean');var r=$y(e),n=r.length>0?r[0]:"",i=Gy("%"+n+"%",t),o=i.name,a=i.value,s=!1,u=i.alias;u&&(n=u[0],Ky(r,My([0,1],u)));for(var c=1,l=!0;c<r.length;c+=1){var f=r[c],h=Hy(f,0,1),p=Hy(f,-1);if(('"'===h||"'"===h||"`"===h||'"'===p||"'"===p||"`"===p)&&h!==p)throw new Iy("property names with quotes must have matching quotes");if("constructor"!==f&&l||(s=!0),Ay(jy,o="%"+(n+="."+f)+"%"))a=jy[o];else if(null!=a){if(!(f in a)){if(!t)throw new Py("base intrinsic for "+e+" exists, but the property is not available.");return}if(ky&&c+1>=r.length){var d=ky(a,f);a=(l=!!d)&&"get"in d&&!("originalValue"in d.get)?d.get:a[f]}else l=Ay(a,f),a=a[f];l&&!s&&(jy[o]=a)}}return a},Jy=u((function(e){var t=Wy("%Function.prototype.apply%"),r=Wy("%Function.prototype.call%"),n=Wy("%Reflect.apply%",!0)||Cy.call(r,t),i=Wy("%Object.getOwnPropertyDescriptor%",!0),o=Wy("%Object.defineProperty%",!0),a=Wy("%Math.max%");if(o)try{o({},"a",{value:1})}catch(Aw){o=null}e.exports=function(e){var t=n(Cy,r,arguments);if(i&&o){var s=i(t,"length");s.configurable&&o(t,"length",{value:1+a(0,e.length-(arguments.length-1))})}return t};var s=function(){return n(Cy,t,arguments)};o?o(e.exports,"apply",{value:s}):e.exports.apply=s})),Qy=Jy(Wy("String.prototype.indexOf")),Yy=function(e,t){var r=Wy(e,!!t);return"function"==typeof r&&Qy(e,".prototype.")>-1?Jy(r):r},Xy="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,Zy=Yy("Object.prototype.toString"),ev=function(e){return!(Xy&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===Zy(e)},tv=function(e){return!!ev(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==Zy(e)&&"[object Function]"===Zy(e.callee)},rv=function(){return ev(arguments)}();ev.isLegacyArguments=tv;var nv=rv?ev:tv,iv=Object.prototype.toString,ov=Function.prototype.toString,av=/^\s*(?:function)?\*/,sv="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,uv=Object.getPrototypeOf,cv=function(){if(!sv)return!1;try{return Function("return function*() {}")()}catch(Aw){}}(),lv=!(!uv||!cv)&&uv(cv),fv=function(e){return"function"==typeof e&&(!!av.test(ov.call(e))||(sv?uv&&uv(e)===lv:"[object GeneratorFunction]"===iv.call(e)))},hv=Object.prototype.hasOwnProperty,pv=Object.prototype.toString,dv=function(e,t,r){if("[object Function]"!==pv.call(t))throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var i=0;i<n;i++)t.call(r,e[i],i,e);else for(var o in e)hv.call(e,o)&&t.call(r,e[o],o,e)},gv=Object.prototype.hasOwnProperty,yv=function(){return function(e,t,r){if(e.filter)return e.filter(t,r);if(null==e)throw new TypeError;if("function"!=typeof t)throw new TypeError;for(var n=[],i=0;i<e.length;i++)if(gv.call(e,i)){var o=e[i];t.call(r,o,i,e)&&n.push(o)}return n}(["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],(function(e){return"function"==typeof a[e]}))},vv=Wy("%Object.getOwnPropertyDescriptor%");if(vv)try{vv([],"length")}catch(Aw){vv=null}var mv=vv,bv=Yy("Object.prototype.toString"),Ev=Ey()&&"symbol"==typeof Symbol.toStringTag,Sv=yv(),wv=Yy("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},_v=Yy("String.prototype.slice"),Cv={},Av=Object.getPrototypeOf;Ev&&mv&&Av&&dv(Sv,(function(e){var t=new a[e];if(!(Symbol.toStringTag in t))throw new EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var r=Av(t),n=mv(r,Symbol.toStringTag);if(!n){var i=Av(r);n=mv(i,Symbol.toStringTag)}Cv[e]=n.get}));var Iv=function(e){if(!e||"object"!=typeof e)return!1;if(!Ev){var t=_v(bv(e),8,-1);return wv(Sv,t)>-1}return!!mv&&function(e){var t=!1;return dv(Cv,(function(r,n){if(!t)try{t=r.call(e)===n}catch(Aw){}})),t}(e)},Tv=Yy("Object.prototype.toString"),Pv=Ey()&&"symbol"==typeof Symbol.toStringTag,Fv=yv(),kv=Yy("String.prototype.slice"),Rv={},Bv=Object.getPrototypeOf;Pv&&mv&&Bv&&dv(Fv,(function(e){if("function"==typeof a[e]){var t=new a[e];if(!(Symbol.toStringTag in t))throw new EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var r=Bv(t),n=mv(r,Symbol.toStringTag);if(!n){var i=Bv(r);n=mv(i,Symbol.toStringTag)}Rv[e]=n.get}}));var Ov=function(e){return!!Iv(e)&&(Pv?function(e){var t=!1;return dv(Rv,(function(r,n){if(!t)try{var i=r.call(e);i===n&&(t=i)}catch(Aw){}})),t}(e):kv(Tv(e),8,-1))},xv=u((function(e,t){function r(e){return e.call.bind(e)}var n="undefined"!=typeof BigInt,i="undefined"!=typeof Symbol,o=r(Object.prototype.toString),a=r(Number.prototype.valueOf),s=r(String.prototype.valueOf),u=r(Boolean.prototype.valueOf);if(n)var c=r(BigInt.prototype.valueOf);if(i)var l=r(Symbol.prototype.valueOf);function f(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(Aw){return!1}}function h(e){return"[object Map]"===o(e)}function p(e){return"[object Set]"===o(e)}function d(e){return"[object WeakMap]"===o(e)}function g(e){return"[object WeakSet]"===o(e)}function y(e){return"[object ArrayBuffer]"===o(e)}function v(e){return"undefined"!=typeof ArrayBuffer&&(y.working?y(e):e instanceof ArrayBuffer)}function m(e){return"[object DataView]"===o(e)}function b(e){return"undefined"!=typeof DataView&&(m.working?m(e):e instanceof DataView)}function E(e){return"[object SharedArrayBuffer]"===o(e)}function S(e){return"undefined"!=typeof SharedArrayBuffer&&(E.working?E(e):e instanceof SharedArrayBuffer)}function w(e){return f(e,a)}function _(e){return f(e,s)}function C(e){return f(e,u)}function A(e){return n&&f(e,c)}function I(e){return i&&f(e,l)}t.isArgumentsObject=nv,t.isGeneratorFunction=fv,t.isTypedArray=Iv,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):Iv(e)||b(e)},t.isUint8Array=function(e){return"Uint8Array"===Ov(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===Ov(e)},t.isUint16Array=function(e){return"Uint16Array"===Ov(e)},t.isUint32Array=function(e){return"Uint32Array"===Ov(e)},t.isInt8Array=function(e){return"Int8Array"===Ov(e)},t.isInt16Array=function(e){return"Int16Array"===Ov(e)},t.isInt32Array=function(e){return"Int32Array"===Ov(e)},t.isFloat32Array=function(e){return"Float32Array"===Ov(e)},t.isFloat64Array=function(e){return"Float64Array"===Ov(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===Ov(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===Ov(e)},h.working="undefined"!=typeof Map&&h(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(h.working?h(e):e instanceof Map)},p.working="undefined"!=typeof Set&&p(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(p.working?p(e):e instanceof Set)},d.working="undefined"!=typeof WeakMap&&d(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(d.working?d(e):e instanceof WeakMap)},g.working="undefined"!=typeof WeakSet&&g(new WeakSet),t.isWeakSet=function(e){return g(e)},y.working="undefined"!=typeof ArrayBuffer&&y(new ArrayBuffer),t.isArrayBuffer=v,m.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&m(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=b,E.working="undefined"!=typeof SharedArrayBuffer&&E(new SharedArrayBuffer),t.isSharedArrayBuffer=S,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===o(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===o(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===o(e)},t.isGeneratorObject=function(e){return"[object Generator]"===o(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===o(e)},t.isNumberObject=w,t.isStringObject=_,t.isBooleanObject=C,t.isBigIntObject=A,t.isSymbolObject=I,t.isBoxedPrimitive=function(e){return w(e)||_(e)||C(e)||A(e)||I(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(v(e)||S(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))})),Nv=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8},Uv=u((function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}})),jv=u((function(e,t){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},n=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(a(arguments[r]));return t.join(" ")}r=1;for(var i=arguments,o=i.length,s=String(e).replace(n,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return e}})),u=i[r];r<o;u=i[++r])d(u)||!b(u)?s+=" "+u:s+=" "+a(u);return s},t.deprecate=function(e,r){if("undefined"!=typeof process&&!0===process.noDeprecation)return e;if("undefined"==typeof process)return function(){return t.deprecate(e,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}};var i={},o=/^$/;function a(e,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(r)?n.showHidden=r:r&&t._extend(n,r),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),c(n,e,n.depth)}function s(e,t){var r=a.styles[t];return r?"["+a.colors[r][0]+"m"+e+"["+a.colors[r][1]+"m":e}function u(e,t){return e}function c(e,r,n){if(e.customInspect&&r&&w(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return y(i)||(i=c(e,i,n)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(d(t))return e.stylize("null","null")}(e,r);if(o)return o;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),S(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(r);if(0===a.length){if(w(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(m(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(E(r))return e.stylize(Date.prototype.toString.call(r),"date");if(S(r))return l(r)}var b,_="",C=!1,A=["{","}"];(h(r)&&(C=!0,A=["[","]"]),w(r))&&(_=" [Function"+(r.name?": "+r.name:"")+"]");return m(r)&&(_=" "+RegExp.prototype.toString.call(r)),E(r)&&(_=" "+Date.prototype.toUTCString.call(r)),S(r)&&(_=" "+l(r)),0!==a.length||C&&0!=r.length?n<0?m(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),b=C?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)T(t,String(a))?o.push(f(e,t,r,n,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(e,t,r,n,i,!0))})),o}(e,r,n,s,a):a.map((function(t){return f(e,r,n,s,t,C)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(b,_,A)):A[0]+_+A[1]}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,n,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),T(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=d(r)?c(e,u.value,null):c(e,u.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function d(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function v(e){return void 0===e}function m(e){return b(e)&&"[object RegExp]"===_(e)}function b(e){return"object"==typeof e&&null!==e}function E(e){return b(e)&&"[object Date]"===_(e)}function S(e){return b(e)&&("[object Error]"===_(e)||e instanceof Error)}function w(e){return"function"==typeof e}function _(e){return Object.prototype.toString.call(e)}function C(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!i[e])if(o.test(e)){var r=process.pid;i[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else i[e]=function(){};return i[e]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=xv,t.isArray=h,t.isBoolean=p,t.isNull=d,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=m,t.types.isRegExp=m,t.isObject=b,t.isDate=E,t.types.isDate=E,t.isError=S,t.types.isNativeError=S,t.isFunction=w,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=Nv;var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var e=new Date,t=[C(e.getHours()),C(e.getMinutes()),C(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",I(),t.format.apply(t,arguments))},t.inherits=Uv,t._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function F(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(a){r(a)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=P,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};e.apply(this,t).then((function(e){process.nextTick(o.bind(null,null,e))}),(function(e){process.nextTick(F.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}})),Dv=my.Buffer;function Lv(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=Dv.alloc(0),this;if("function"==typeof e.pipe)return this.buffer=Dv.alloc(0),e.pipe(this),this;if(e.length||"object"==typeof e)return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}jv.inherits(Lv,ss),Lv.prototype.write=function(e){this.buffer=Dv.concat([this.buffer,Dv.from(e)]),this.emit("data",e)},Lv.prototype.end=function(e){e&&this.write(e),this.emit("end",e),this.emit("close"),this.writable=!1,this.readable=!1};var Mv=Lv,Kv=vy.Buffer,Vv=vy.SlowBuffer,Hv=qv;function qv(e,t){if(!Kv.isBuffer(e)||!Kv.isBuffer(t))return!1;if(e.length!==t.length)return!1;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}qv.install=function(){Kv.prototype.equal=Vv.prototype.equal=function(e){return qv(this,e)}};var zv=Kv.prototype.equal,$v=Vv.prototype.equal;function Gv(e){return(e/8|0)+(e%8==0?0:1)}qv.restore=function(){Kv.prototype.equal=zv,Vv.prototype.equal=$v};var Wv={ES256:Gv(256),ES384:Gv(384),ES512:Gv(521)};var Jv=function(e){var t=Wv[e];if(t)return t;throw new Error('Unknown algorithm "'+e+'"')},Qv=my.Buffer;function Yv(e){if(Qv.isBuffer(e))return e;if("string"==typeof e)return Qv.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function Xv(e,t,r){for(var n=0;t+n<r&&0===e[t+n];)++n;return e[t+n]>=128&&--n,n}var Zv={derToJose:function(e,t){e=Yv(e);var r=Jv(t),n=r+1,i=e.length,o=0;if(48!==e[o++])throw new Error('Could not find expected "seq"');var a=e[o++];if(129===a&&(a=e[o++]),i-o<a)throw new Error('"seq" specified length of "'+a+'", only "'+(i-o)+'" remaining');if(2!==e[o++])throw new Error('Could not find expected "int" for "r"');var s=e[o++];if(i-o-2<s)throw new Error('"r" specified length of "'+s+'", only "'+(i-o-2)+'" available');if(n<s)throw new Error('"r" specified length of "'+s+'", max of "'+n+'" is acceptable');var u=o;if(o+=s,2!==e[o++])throw new Error('Could not find expected "int" for "s"');var c=e[o++];if(i-o!==c)throw new Error('"s" specified length of "'+c+'", expected "'+(i-o)+'"');if(n<c)throw new Error('"s" specified length of "'+c+'", max of "'+n+'" is acceptable');var l=o;if((o+=c)!==i)throw new Error('Expected to consume entire buffer, but "'+(i-o)+'" bytes remain');var f=r-s,h=r-c,p=Qv.allocUnsafe(f+s+h+c);for(o=0;o<f;++o)p[o]=0;e.copy(p,o,u+Math.max(-f,0),u+s);for(var d=o=r;o<d+h;++o)p[o]=0;return e.copy(p,o,l+Math.max(-h,0),l+c),p=(p=p.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(e,t){e=Yv(e);var r=Jv(t),n=e.length;if(n!==2*r)throw new TypeError('"'+t+'" signatures must be "'+2*r+'" bytes, saw "'+n+'"');var i=Xv(e,0,r),o=Xv(e,r,e.length),a=r-i,s=r-o,u=2+a+1+1+s,c=u<128,l=Qv.allocUnsafe((c?2:3)+u),f=0;return l[f++]=48,c?l[f++]=u:(l[f++]=129,l[f++]=255&u),l[f++]=2,l[f++]=a,i<0?(l[f++]=0,f+=e.copy(l,f,0,r)):f+=e.copy(l,f,i,r),l[f++]=2,l[f++]=s,o<0?(l[f++]=0,e.copy(l,f,r)):e.copy(l,f,r+o),l}},em=my.Buffer,tm="secret must be a string or buffer",rm="key must be a string or a buffer",nm="function"==typeof ss.createPublicKey;function im(e){if(!em.isBuffer(e)&&"string"!=typeof e){if(!nm)throw um(rm);if("object"!=typeof e)throw um(rm);if("string"!=typeof e.type)throw um(rm);if("string"!=typeof e.asymmetricKeyType)throw um(rm);if("function"!=typeof e.export)throw um(rm)}}function om(e){if(!em.isBuffer(e)&&"string"!=typeof e&&"object"!=typeof e)throw um("key must be a string, a buffer or an object")}function am(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function sm(e){var t=4-(e=e.toString()).length%4;if(4!==t)for(var r=0;r<t;++r)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function um(e){var t=[].slice.call(arguments,1),r=jv.format.bind(jv,e).apply(null,t);return new TypeError(r)}function cm(e){var t;return t=e,em.isBuffer(t)||"string"==typeof t||(e=JSON.stringify(e)),e}function lm(e){return function(t,r){!function(e){if(!em.isBuffer(e)){if("string"==typeof e)return e;if(!nm)throw um(tm);if("object"!=typeof e)throw um(tm);if("secret"!==e.type)throw um(tm);if("function"!=typeof e.export)throw um(tm)}}(r),t=cm(t);var n=ss.createHmac("sha"+e,r);return am((n.update(t),n.digest("base64")))}}function fm(e){return function(t,r,n){var i=lm(e)(t,n);return Hv(em.from(r),em.from(i))}}function hm(e){return function(t,r){om(r),t=cm(t);var n=ss.createSign("RSA-SHA"+e);return am((n.update(t),n.sign(r,"base64")))}}function pm(e){return function(t,r,n){im(n),t=cm(t),r=sm(r);var i=ss.createVerify("RSA-SHA"+e);return i.update(t),i.verify(n,r,"base64")}}function dm(e){return function(t,r){om(r),t=cm(t);var n=ss.createSign("RSA-SHA"+e);return am((n.update(t),n.sign({key:r,padding:ss.constants.RSA_PKCS1_PSS_PADDING,saltLength:ss.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function gm(e){return function(t,r,n){im(n),t=cm(t),r=sm(r);var i=ss.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:n,padding:ss.constants.RSA_PKCS1_PSS_PADDING,saltLength:ss.constants.RSA_PSS_SALTLEN_DIGEST},r,"base64")}}function ym(e){var t=hm(e);return function(){var r=t.apply(null,arguments);return r=Zv.derToJose(r,"ES"+e)}}function vm(e){var t=pm(e);return function(r,n,i){return n=Zv.joseToDer(n,"ES"+e).toString("base64"),t(r,n,i)}}function mm(){return function(){return""}}function bm(){return function(e,t){return""===t}}nm&&(rm+=" or a KeyObject",tm+="or a KeyObject");var Em=function(e){var t={hs:lm,rs:hm,ps:dm,es:ym,none:mm},r={hs:fm,rs:pm,ps:gm,es:vm,none:bm},n=e.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw um('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',e);var i=(n[1]||n[3]).toLowerCase(),o=n[2];return{sign:t[i](o),verify:r[i](o)}},Sm=vy.Buffer,wm=function(e){return"string"==typeof e?e:"number"==typeof e||Sm.isBuffer(e)?e.toString():JSON.stringify(e)},_m=my.Buffer;function Cm(e,t){return _m.from(e,t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Am(e){var t=e.header,r=e.payload,n=e.secret||e.privateKey,i=e.encoding,o=Em(t.alg),a=function(e,t,r){r=r||"utf8";var n=Cm(wm(e),"binary"),i=Cm(wm(t),r);return jv.format("%s.%s",n,i)}(t,r,i),s=o.sign(a,n);return jv.format("%s.%s",a,s)}function Im(e){var t=e.secret||e.privateKey||e.key,r=new Mv(t);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=r,this.payload=new Mv(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}jv.inherits(Im,ss),Im.prototype.sign=function(){try{var e=Am({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",e),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(Aw){this.readable=!1,this.emit("error",Aw),this.emit("close")}},Im.sign=Am;var Tm=Im,Pm=my.Buffer,Fm=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function km(e){if(function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e))return e;try{return JSON.parse(e)}catch(Aw){return}}function Rm(e){var t=e.split(".",1)[0];return km(Pm.from(t,"base64").toString("binary"))}function Bm(e){return e.split(".")[2]}function Om(e){return Fm.test(e)&&!!Rm(e)}function xm(e,t,r){if(!t){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}var i=Bm(e=wm(e)),o=function(e){return e.split(".",2).join(".")}(e);return Em(t).verify(o,i,r)}function Nm(e,t){if(t=t||{},!Om(e=wm(e)))return null;var r=Rm(e);if(!r)return null;var n=function(e,t){t=t||"utf8";var r=e.split(".")[1];return Pm.from(r,"base64").toString(t)}(e);return("JWT"===r.typ||t.json)&&(n=JSON.parse(n,t.encoding)),{header:r,payload:n,signature:Bm(e)}}function Um(e){var t=(e=e||{}).secret||e.publicKey||e.key,r=new Mv(t);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=r,this.signature=new Mv(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}jv.inherits(Um,ss),Um.prototype.verify=function(){try{var e=xm(this.signature.buffer,this.algorithm,this.key.buffer),t=Nm(this.signature.buffer,this.encoding);return this.emit("done",e,t),this.emit("data",e),this.emit("end"),this.readable=!1,e}catch(Aw){this.readable=!1,this.emit("error",Aw),this.emit("close")}},Um.decode=Nm,Um.isValid=Om,Um.verify=xm;var jm=Um,Dm={ALGORITHMS:["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],sign:Tm.sign,verify:jm.verify,decode:jm.decode,isValid:jm.isValid,createSign:function(e){return new Tm(e)},createVerify:function(e){return new jm(e)}},Lm=function(e,t){t=t||{};var r=Dm.decode(e,t);if(!r)return null;var n=r.payload;if("string"==typeof n)try{var i=JSON.parse(n);null!==i&&"object"==typeof i&&(n=i)}catch(Aw){}return!0===t.complete?{header:r.header,payload:n,signature:r.signature}:n},Mm=function(e,t){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,t&&(this.inner=t)};(Mm.prototype=Object.create(Error.prototype)).constructor=Mm;var Km=Mm,Vm=function(e,t){Km.call(this,e),this.name="NotBeforeError",this.date=t};(Vm.prototype=Object.create(Km.prototype)).constructor=Vm;var Hm=Vm,qm=function(e,t){Km.call(this,e),this.name="TokenExpiredError",this.expiredAt=t};(qm.prototype=Object.create(Km.prototype)).constructor=qm;var zm=qm,$m=1e3,Gm=60*$m,Wm=60*Gm,Jm=24*Wm,Qm=7*Jm,Ym=365.25*Jm,Xm=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*Ym;case"weeks":case"week":case"w":return r*Qm;case"days":case"day":case"d":return r*Jm;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Wm;case"minutes":case"minute":case"mins":case"min":case"m":return r*Gm;case"seconds":case"second":case"secs":case"sec":case"s":return r*$m;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=Jm)return Zm(e,t,Jm,"day");if(t>=Wm)return Zm(e,t,Wm,"hour");if(t>=Gm)return Zm(e,t,Gm,"minute");if(t>=$m)return Zm(e,t,$m,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=Jm)return Math.round(e/Jm)+"d";if(t>=Wm)return Math.round(e/Wm)+"h";if(t>=Gm)return Math.round(e/Gm)+"m";if(t>=$m)return Math.round(e/$m)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Zm(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}var eb=function(e,t){var r=t||Math.floor(Date.now()/1e3);if("string"==typeof e){var n=Xm(e);if(void 0===n)return;return Math.floor(r+n/1e3)}return"number"==typeof e?r+e:void 0},tb=u((function(e,t){var r;t=e.exports=$,r="object"==typeof process&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,i=t.re=[],o=t.src=[],a=0,s=a++;o[s]="0|[1-9]\\d*";var u=a++;o[u]="[0-9]+";var c=a++;o[c]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var l=a++;o[l]="("+o[s]+")\\.("+o[s]+")\\.("+o[s]+")";var f=a++;o[f]="("+o[u]+")\\.("+o[u]+")\\.("+o[u]+")";var h=a++;o[h]="(?:"+o[s]+"|"+o[c]+")";var p=a++;o[p]="(?:"+o[u]+"|"+o[c]+")";var d=a++;o[d]="(?:-("+o[h]+"(?:\\."+o[h]+")*))";var g=a++;o[g]="(?:-?("+o[p]+"(?:\\."+o[p]+")*))";var y=a++;o[y]="[0-9A-Za-z-]+";var v=a++;o[v]="(?:\\+("+o[y]+"(?:\\."+o[y]+")*))";var m=a++,b="v?"+o[l]+o[d]+"?"+o[v]+"?";o[m]="^"+b+"$";var E="[v=\\s]*"+o[f]+o[g]+"?"+o[v]+"?",S=a++;o[S]="^"+E+"$";var w=a++;o[w]="((?:<|>)?=?)";var _=a++;o[_]=o[u]+"|x|X|\\*";var C=a++;o[C]=o[s]+"|x|X|\\*";var A=a++;o[A]="[v=\\s]*("+o[C]+")(?:\\.("+o[C]+")(?:\\.("+o[C]+")(?:"+o[d]+")?"+o[v]+"?)?)?";var I=a++;o[I]="[v=\\s]*("+o[_]+")(?:\\.("+o[_]+")(?:\\.("+o[_]+")(?:"+o[g]+")?"+o[v]+"?)?)?";var T=a++;o[T]="^"+o[w]+"\\s*"+o[A]+"$";var P=a++;o[P]="^"+o[w]+"\\s*"+o[I]+"$";var F=a++;o[F]="(?:^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])";var k=a++;o[k]="(?:~>?)";var R=a++;o[R]="(\\s*)"+o[k]+"\\s+",i[R]=new RegExp(o[R],"g");var B=a++;o[B]="^"+o[k]+o[A]+"$";var O=a++;o[O]="^"+o[k]+o[I]+"$";var x=a++;o[x]="(?:\\^)";var N=a++;o[N]="(\\s*)"+o[x]+"\\s+",i[N]=new RegExp(o[N],"g");var U=a++;o[U]="^"+o[x]+o[A]+"$";var j=a++;o[j]="^"+o[x]+o[I]+"$";var D=a++;o[D]="^"+o[w]+"\\s*("+E+")$|^$";var L=a++;o[L]="^"+o[w]+"\\s*("+b+")$|^$";var M=a++;o[M]="(\\s*)"+o[w]+"\\s*("+E+"|"+o[A]+")",i[M]=new RegExp(o[M],"g");var K=a++;o[K]="^\\s*("+o[A]+")\\s+-\\s+("+o[A]+")\\s*$";var V=a++;o[V]="^\\s*("+o[I]+")\\s+-\\s+("+o[I]+")\\s*$";var H=a++;o[H]="(<|>)?=?\\s*\\*";for(var q=0;q<35;q++)r(q,o[q]),i[q]||(i[q]=new RegExp(o[q]));function z(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof $)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?i[S]:i[m]).test(e))return null;try{return new $(e,t)}catch(r){return null}}function $(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof $){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof $))return new $(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var o=e.trim().match(t.loose?i[S]:i[m]);if(!o)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}t.parse=z,t.valid=function(e,t){var r=z(e,t);return r?r.version:null},t.clean=function(e,t){var r=z(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null},t.SemVer=$,$.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},$.prototype.toString=function(){return this.version},$.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof $||(e=new $(e,this.options)),this.compareMain(e)||this.comparePre(e)},$.prototype.compareMain=function(e){return e instanceof $||(e=new $(e,this.options)),W(this.major,e.major)||W(this.minor,e.minor)||W(this.patch,e.patch)},$.prototype.comparePre=function(e){if(e instanceof $||(e=new $(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return W(n,i)}while(++t)},$.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new $(e,r).inc(t,n).version}catch(i){return null}},t.diff=function(e,t){if(X(e,t))return null;var r=z(e),n=z(t),i="";if(r.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var a in r)if(("major"===a||"minor"===a||"patch"===a)&&r[a]!==n[a])return i+a;return o},t.compareIdentifiers=W;var G=/^[0-9]+$/;function W(e,t){var r=G.test(e),n=G.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1}function J(e,t,r){return new $(e,r).compare(new $(t,r))}function Q(e,t,r){return J(e,t,r)>0}function Y(e,t,r){return J(e,t,r)<0}function X(e,t,r){return 0===J(e,t,r)}function Z(e,t,r){return 0!==J(e,t,r)}function ee(e,t,r){return J(e,t,r)>=0}function te(e,t,r){return J(e,t,r)<=0}function re(e,t,r,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return X(e,r,n);case"!=":return Z(e,r,n);case">":return Q(e,r,n);case">=":return ee(e,r,n);case"<":return Y(e,r,n);case"<=":return te(e,r,n);default:throw new TypeError("Invalid operator: "+t)}}function ne(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof ne){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof ne))return new ne(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ie?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}t.rcompareIdentifiers=function(e,t){return W(t,e)},t.major=function(e,t){return new $(e,t).major},t.minor=function(e,t){return new $(e,t).minor},t.patch=function(e,t){return new $(e,t).patch},t.compare=J,t.compareLoose=function(e,t){return J(e,t,!0)},t.rcompare=function(e,t,r){return J(t,e,r)},t.sort=function(e,r){return e.sort((function(e,n){return t.compare(e,n,r)}))},t.rsort=function(e,r){return e.sort((function(e,n){return t.rcompare(e,n,r)}))},t.gt=Q,t.lt=Y,t.eq=X,t.neq=Z,t.gte=ee,t.lte=te,t.cmp=re,t.Comparator=ne;var ie={};function oe(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof oe)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new oe(e.raw,t);if(e instanceof ne)return new oe(e.value,t);if(!(this instanceof oe))return new oe(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function ae(e){return!e||"x"===e.toLowerCase()||"*"===e}function se(e,t,r,n,i,o,a,s,u,c,l,f,h){return((t=ae(r)?"":ae(n)?">="+r+".0.0":ae(i)?">="+r+"."+n+".0":">="+t)+" "+(s=ae(u)?"":ae(c)?"<"+(+u+1)+".0.0":ae(l)?"<"+u+"."+(+c+1)+".0":f?"<="+u+"."+c+"."+l+"-"+f:"<="+s)).trim()}function ue(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==ie&&e[i].semver.prerelease.length>0){var o=e[i].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}function ce(e,t,r){try{t=new oe(t,r)}catch(n){return!1}return t.test(e)}function le(e,t,r,n){var i,o,a,s,u;switch(e=new $(e,n),t=new oe(t,n),r){case">":i=Q,o=te,a=Y,s=">",u=">=";break;case"<":i=Y,o=ee,a=Q,s="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(ce(e,t,n))return!1;for(var c=0;c<t.set.length;++c){var l=t.set[c],f=null,h=null;if(l.forEach((function(e){e.semver===ie&&(e=new ne(">=0.0.0")),f=f||e,h=h||e,i(e.semver,f.semver,n)?f=e:a(e.semver,h.semver,n)&&(h=e)})),f.operator===s||f.operator===u)return!1;if((!h.operator||h.operator===s)&&o(e,h.semver))return!1;if(h.operator===u&&a(e,h.semver))return!1}return!0}ne.prototype.parse=function(e){var t=this.options.loose?i[D]:i[L],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=r[1],"="===this.operator&&(this.operator=""),r[2]?this.semver=new $(r[2],this.options.loose):this.semver=ie},ne.prototype.toString=function(){return this.value},ne.prototype.test=function(e){return r("Comparator.test",e,this.options.loose),this.semver===ie||("string"==typeof e&&(e=new $(e,this.options)),re(e,this.operator,this.semver,this.options))},ne.prototype.intersects=function(e,t){if(!(e instanceof ne))throw new TypeError("a Comparator is required");var r;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return r=new oe(e.value,t),ce(this.value,r,t);if(""===e.operator)return r=new oe(this.value,t),ce(e.semver,r,t);var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),i=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=re(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=re(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||i||o&&a||s||u},t.Range=oe,oe.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},oe.prototype.toString=function(){return this.range},oe.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?i[V]:i[K];e=e.replace(n,se),r("hyphen replace",e),e=e.replace(i[M],"$1$2$3"),r("comparator trim",e,i[M]),e=(e=(e=e.replace(i[R],"$1~")).replace(i[N],"$1^")).split(/\s+/).join(" ");var o=t?i[D]:i[L],a=e.split(" ").map((function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){r("caret",e,t);var n=t.loose?i[j]:i[U];return e.replace(n,(function(t,n,i,o,a){var s;return r("caret",e,t,n,i,o,a),ae(n)?s="":ae(i)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?s="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":a?(r("replaceCaret pr",a),s="0"===n?"0"===i?">="+n+"."+i+"."+o+"-"+a+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+"-"+a+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+"-"+a+" <"+(+n+1)+".0.0"):(r("no pr"),s="0"===n?"0"===i?">="+n+"."+i+"."+o+" <"+n+"."+i+"."+(+o+1):">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+o+" <"+(+n+1)+".0.0"),r("caret return",s),s}))}(e,t)})).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?i[O]:i[B];return e.replace(n,(function(t,n,i,o,a){var s;return r("tilde",e,t,n,i,o,a),ae(n)?s="":ae(i)?s=">="+n+".0.0 <"+(+n+1)+".0.0":ae(o)?s=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":a?(r("replaceTilde pr",a),s=">="+n+"."+i+"."+o+"-"+a+" <"+n+"."+(+i+1)+".0"):s=">="+n+"."+i+"."+o+" <"+n+"."+(+i+1)+".0",r("tilde return",s),s}))}(e,t)})).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?i[P]:i[T];return e.replace(n,(function(t,n,i,o,a,s){r("xRange",e,t,n,i,o,a,s);var u=ae(i),c=u||ae(o),l=c||ae(a);return"="===n&&l&&(n=""),u?t=">"===n||"<"===n?"<0.0.0":"*":n&&l?(c&&(o=0),a=0,">"===n?(n=">=",c?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===n&&(n="<",c?i=+i+1:o=+o+1),t=n+i+"."+o+"."+a):c?t=">="+i+".0.0 <"+(+i+1)+".0.0":l&&(t=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0"),r("xRange return",t),t}))}(e,t)})).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(i[H],"")}(e,t),r("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(o)}))),a=a.map((function(e){return new ne(e,this.options)}),this)},oe.prototype.intersects=function(e,t){if(!(e instanceof oe))throw new TypeError("a Range is required");return this.set.some((function(r){return r.every((function(r){return e.set.some((function(e){return e.every((function(e){return r.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new oe(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},oe.prototype.test=function(e){if(!e)return!1;"string"==typeof e&&(e=new $(e,this.options));for(var t=0;t<this.set.length;t++)if(ue(this.set[t],e,this.options))return!0;return!1},t.satisfies=ce,t.maxSatisfying=function(e,t,r){var n=null,i=null;try{var o=new oe(t,r)}catch(a){return null}return e.forEach((function(e){o.test(e)&&(n&&-1!==i.compare(e)||(i=new $(n=e,r)))})),n},t.minSatisfying=function(e,t,r){var n=null,i=null;try{var o=new oe(t,r)}catch(a){return null}return e.forEach((function(e){o.test(e)&&(n&&1!==i.compare(e)||(i=new $(n=e,r)))})),n},t.minVersion=function(e,t){e=new oe(e,t);var r=new $("0.0.0");if(e.test(r))return r;if(r=new $("0.0.0-0"),e.test(r))return r;r=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new $(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":r&&!Q(r,t)||(r=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(r&&e.test(r))return r;return null},t.validRange=function(e,t){try{return new oe(e,t).range||"*"}catch(r){return null}},t.ltr=function(e,t,r){return le(e,t,"<",r)},t.gtr=function(e,t,r){return le(e,t,">",r)},t.outside=le,t.prerelease=function(e,t){var r=z(e,t);return r&&r.prerelease.length?r.prerelease:null},t.intersects=function(e,t,r){return e=new oe(e,r),t=new oe(t,r),e.intersects(t)},t.coerce=function(e){if(e instanceof $)return e;if("string"!=typeof e)return null;var t=e.match(i[F]);if(null==t)return null;return z(t[1]+"."+(t[2]||"0")+"."+(t[3]||"0"))}})).satisfies(process.version,"^6.12.0 || >=8.0.0"),rb=["RS256","RS384","RS512","ES256","ES384","ES512"],nb=["RS256","RS384","RS512"],ib=["HS256","HS384","HS512"];tb&&(rb.splice(3,0,"PS256","PS384","PS512"),nb.splice(3,0,"PS256","PS384","PS512"));var ob=17976931348623157e292,ab="[object GeneratorFunction]",sb=/^\s+|\s+$/g,ub=/^[-+]0x[0-9a-f]+$/i,cb=/^0b[01]+$/i,lb=/^0o[0-7]+$/i,fb=/^(?:0|[1-9]\d*)$/,hb=parseInt;function pb(e){return e!=e}function db(e,t){return function(e,t){for(var r=-1,n=e?e.length:0,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}(t,(function(t){return e[t]}))}var gb,yb,vb=Object.prototype,mb=vb.hasOwnProperty,bb=vb.toString,Eb=vb.propertyIsEnumerable,Sb=(gb=Object.keys,yb=Object,function(e){return gb(yb(e))}),wb=Math.max;function _b(e,t){var r=Ib(e)||function(e){return function(e){return Fb(e)&&Tb(e)}(e)&&mb.call(e,"callee")&&(!Eb.call(e,"callee")||"[object Arguments]"==bb.call(e))}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,i=!!n;for(var o in e)!t&&!mb.call(e,o)||i&&("length"==o||Ab(o,n))||r.push(o);return r}function Cb(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||vb,t!==n)return Sb(e);var t,r,n,i=[];for(var o in Object(e))mb.call(e,o)&&"constructor"!=o&&i.push(o);return i}function Ab(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||fb.test(e))&&e>-1&&e%1==0&&e<t}var Ib=Array.isArray;function Tb(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=Pb(e)?bb.call(e):"";return"[object Function]"==t||t==ab}(e)}function Pb(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Fb(e){return!!e&&"object"==typeof e}var kb=function(e,t,r,n){var i;e=Tb(e)?e:(i=e)?db(i,function(e){return Tb(e)?_b(e):Cb(e)}(i)):[],r=r&&!n?function(e){var t=function(e){if(!e)return 0===e?e:0;if(Infinity===(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||Fb(e)&&"[object Symbol]"==bb.call(e)}(e))return NaN;if(Pb(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Pb(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(sb,"");var r=cb.test(e);return r||lb.test(e)?hb(e.slice(2),r?2:8):ub.test(e)?NaN:+e}(e))||-Infinity===e){return(e<0?-1:1)*ob}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(r):0;var o=e.length;return r<0&&(r=wb(o+r,0)),function(e){return"string"==typeof e||!Ib(e)&&Fb(e)&&"[object String]"==bb.call(e)}(e)?r<=o&&e.indexOf(t,r)>-1:!!o&&function(e,t,r){if(t!=t)return function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,pb,r);for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r)>-1},Rb=Object.prototype.toString;var Bb=function(e){return!0===e||!1===e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Boolean]"==Rb.call(e)},Ob=17976931348623157e292,xb=/^\s+|\s+$/g,Nb=/^[-+]0x[0-9a-f]+$/i,Ub=/^0b[01]+$/i,jb=/^0o[0-7]+$/i,Db=parseInt,Lb=Object.prototype.toString;function Mb(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var Kb=function(e){return"number"==typeof e&&e==function(e){var t=function(e){if(!e)return 0===e?e:0;if(Infinity===(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==Lb.call(e)}(e))return NaN;if(Mb(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Mb(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(xb,"");var r=Ub.test(e);return r||jb.test(e)?Db(e.slice(2),r?2:8):Nb.test(e)?NaN:+e}(e))||-Infinity===e){return(e<0?-1:1)*Ob}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e)},Vb=Object.prototype.toString;var Hb=function(e){return"number"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Number]"==Vb.call(e)};var qb=Function.prototype,zb=Object.prototype,$b=qb.toString,Gb=zb.hasOwnProperty,Wb=$b.call(Object),Jb=zb.toString,Qb=function(e,t){return function(r){return e(t(r))}}(Object.getPrototypeOf,Object);var Yb=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=Jb.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(Aw){}return t}(e))return!1;var t=Qb(e);if(null===t)return!0;var r=Gb.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&$b.call(r)==Wb},Xb=Object.prototype.toString,Zb=Array.isArray;var eE=function(e){return"string"==typeof e||!Zb(e)&&function(e){return!!e&&"object"==typeof e}(e)&&"[object String]"==Xb.call(e)},tE=17976931348623157e292,rE=/^\s+|\s+$/g,nE=/^[-+]0x[0-9a-f]+$/i,iE=/^0b[01]+$/i,oE=/^0o[0-7]+$/i,aE=parseInt,sE=Object.prototype.toString;function uE(e,t){var r;if("function"!=typeof t)throw new TypeError("Expected a function");return e=function(e){var t=function(e){if(!e)return 0===e?e:0;if(Infinity===(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==sE.call(e)}(e))return NaN;if(cE(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=cE(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(rE,"");var r=iE.test(e);return r||oE.test(e)?aE(e.slice(2),r?2:8):nE.test(e)?NaN:+e}(e))||-Infinity===e){return(e<0?-1:1)*tE}return e==e?e:0}(e),r=t%1;return t==t?r?t-r:t:0}(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}function cE(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var lE=function(e){return uE(2,e)},fE=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];tb&&fE.splice(3,0,"PS256","PS384","PS512");var hE={expiresIn:{isValid:function(e){return Kb(e)||eE(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return Kb(e)||eE(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return eE(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:kb.bind(null,fE),message:'"algorithm" must be a valid string enum value'},header:{isValid:Yb,message:'"header" must be an object'},encoding:{isValid:eE,message:'"encoding" must be a string'},issuer:{isValid:eE,message:'"issuer" must be a string'},subject:{isValid:eE,message:'"subject" must be a string'},jwtid:{isValid:eE,message:'"jwtid" must be a string'},noTimestamp:{isValid:Bb,message:'"noTimestamp" must be a boolean'},keyid:{isValid:eE,message:'"keyid" must be a string'},mutatePayload:{isValid:Bb,message:'"mutatePayload" must be a boolean'}},pE={iat:{isValid:Hb,message:'"iat" should be a number of seconds'},exp:{isValid:Hb,message:'"exp" should be a number of seconds'},nbf:{isValid:Hb,message:'"nbf" should be a number of seconds'}};function dE(e,t,r,n){if(!Yb(r))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(r).forEach((function(i){var o=e[i];if(o){if(!o.isValid(r[i]))throw new Error(o.message)}else if(!t)throw new Error('"'+i+'" is not allowed in "'+n+'"')}))}var gE={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},yE=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"],vE=Lm,mE=function(e,t,r,n){var i;if("function"!=typeof r||n||(n=r,r={}),r||(r={}),r=Object.assign({},r),i=n||function(e,t){if(e)throw e;return t},r.clockTimestamp&&"number"!=typeof r.clockTimestamp)return i(new Km("clockTimestamp must be a number"));if(void 0!==r.nonce&&("string"!=typeof r.nonce||""===r.nonce.trim()))return i(new Km("nonce must be a non-empty string"));var o=r.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return i(new Km("jwt must be provided"));if("string"!=typeof e)return i(new Km("jwt must be a string"));var a,s=e.split(".");if(3!==s.length)return i(new Km("jwt malformed"));try{a=Lm(e,{complete:!0})}catch(l){return i(l)}if(!a)return i(new Km("invalid token"));var u,c=a.header;if("function"==typeof t){if(!n)return i(new Km("verify must be called asynchronous if secret or public key is provided as a callback"));u=t}else u=function(e,r){return r(null,t)};return u(c,(function(t,n){if(t)return i(new Km("error in secret or public key callback: "+t.message));var u,l=""!==s[2].trim();if(!l&&n)return i(new Km("jwt signature is required"));if(l&&!n)return i(new Km("secret or public key must be provided"));if(l||r.algorithms||(r.algorithms=["none"]),r.algorithms||(r.algorithms=~n.toString().indexOf("BEGIN CERTIFICATE")||~n.toString().indexOf("BEGIN PUBLIC KEY")?rb:~n.toString().indexOf("BEGIN RSA PUBLIC KEY")?nb:ib),!~r.algorithms.indexOf(a.header.alg))return i(new Km("invalid algorithm"));try{u=Dm.verify(e,a.header.alg,n)}catch(Aw){return i(Aw)}if(!u)return i(new Km("invalid signature"));var f=a.payload;if(void 0!==f.nbf&&!r.ignoreNotBefore){if("number"!=typeof f.nbf)return i(new Km("invalid nbf value"));if(f.nbf>o+(r.clockTolerance||0))return i(new Hm("jwt not active",new Date(1e3*f.nbf)))}if(void 0!==f.exp&&!r.ignoreExpiration){if("number"!=typeof f.exp)return i(new Km("invalid exp value"));if(o>=f.exp+(r.clockTolerance||0))return i(new zm("jwt expired",new Date(1e3*f.exp)))}if(r.audience){var h=Array.isArray(r.audience)?r.audience:[r.audience];if(!(Array.isArray(f.aud)?f.aud:[f.aud]).some((function(e){return h.some((function(t){return t instanceof RegExp?t.test(e):t===e}))})))return i(new Km("jwt audience invalid. expected: "+h.join(" or ")))}if(r.issuer&&("string"==typeof r.issuer&&f.iss!==r.issuer||Array.isArray(r.issuer)&&-1===r.issuer.indexOf(f.iss)))return i(new Km("jwt issuer invalid. expected: "+r.issuer));if(r.subject&&f.sub!==r.subject)return i(new Km("jwt subject invalid. expected: "+r.subject));if(r.jwtid&&f.jti!==r.jwtid)return i(new Km("jwt jwtid invalid. expected: "+r.jwtid));if(r.nonce&&f.nonce!==r.nonce)return i(new Km("jwt nonce invalid. expected: "+r.nonce));if(r.maxAge){if("number"!=typeof f.iat)return i(new Km("iat required when maxAge is specified"));var p=eb(r.maxAge,f.iat);if(void 0===p)return i(new Km('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(o>=p+(r.clockTolerance||0))return i(new zm("maxAge exceeded",new Date(1e3*p)))}if(!0===r.complete){var d=a.signature;return i(null,{header:c,payload:f,signature:d})}return i(null,f)}))},bE=function(e,t,r,n){"function"==typeof r?(n=r,r={}):r=r||{};var i="object"==typeof e&&!Buffer.isBuffer(e),o=Object.assign({alg:r.algorithm||"HS256",typ:i?"JWT":void 0,kid:r.keyid},r.header);function a(e){if(n)return n(e);throw e}if(!t&&"none"!==r.algorithm)return a(new Error("secretOrPrivateKey must have a value"));if(void 0===e)return a(new Error("payload is required"));if(i){try{!function(e){dE(pE,!0,e,"payload")}(e)}catch(l){return a(l)}r.mutatePayload||(e=Object.assign({},e))}else{var s=yE.filter((function(e){return void 0!==r[e]}));if(s.length>0)return a(new Error("invalid "+s.join(",")+" option for "+typeof e+" payload"))}if(void 0!==e.exp&&void 0!==r.expiresIn)return a(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(void 0!==e.nbf&&void 0!==r.notBefore)return a(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{!function(e){dE(hE,!1,e,"options")}(r)}catch(l){return a(l)}var u=e.iat||Math.floor(Date.now()/1e3);if(r.noTimestamp?delete e.iat:i&&(e.iat=u),void 0!==r.notBefore){try{e.nbf=eb(r.notBefore,u)}catch(f){return a(f)}if(void 0===e.nbf)return a(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(void 0!==r.expiresIn&&"object"==typeof e){try{e.exp=eb(r.expiresIn,u)}catch(f){return a(f)}if(void 0===e.exp)return a(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(gE).forEach((function(t){var n=gE[t];if(void 0!==r[t]){if(void 0!==e[n])return a(new Error('Bad "options.'+t+'" option. The payload already has an "'+n+'" property.'));e[n]=r[t]}}));var c=r.encoding||"utf8";if("function"!=typeof n)return Dm.sign({header:o,payload:e,secret:t,encoding:c});n=n&&lE(n),Dm.createSign({header:o,privateKey:t,payload:e,encoding:c}).once("error",n).once("done",(function(e){n(null,e)}))},EE=(e,t={})=>{const{sorted:r,skipIndex:n,ignorenull:i,skipBracket:o,useDot:a,whitespace:s="+"}=t,u=e=>String(e).replace(/[^ !'()~*]/gu,encodeURIComponent).replace(/ /g,s).replace(/[!'()~*]/g,(e=>`%${e.charCodeAt().toString(16).slice(-2).toUpperCase()}`)),c=(e,t=Object.keys(e))=>r?t.sort():t,l=e=>e.filter((e=>e)).join("&"),f=(e,t,r=typeof t,s=null)=>(t===s?s=i?s:u(e)+"="+s:/string|number|boolean/.test(r)?s=u(e)+"="+u(t):Array.isArray(t)?s=((e,t,r=(o?"":"[]"))=>t.length?l(t.map(((t,i)=>f(n?e+r:e+"["+i+"]",t)))):u(e+r))(e,t):t instanceof Set?s=((e,t)=>l(Array.from(t).map((t=>f(e,t)))))(e,t):"object"===r&&(s=((e,t)=>l(c(t).map((r=>f(a?`${e}.${r}`:`${e}[${r}]`,t[r])))))(e,t)),s);return e&&l(c(e).map((t=>f(t,e[t]))))},SE=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:EE});async function wE(e,t,r){const n=(await yy.JWK.asKey(t)).toPEM(!0);return bE(e,n,r)}async function _E(e,t,r){if(t){const n=(await yy.JWK.asKey(t)).toPEM(!1);return mE(e,n,r)}return vE(e)}async function CE(e){return await yy.JWK.asKey(e,"public")}function AE(e){const t=new URL(e);return t.hash="",t.username="",t.password="",t.toString()}async function IE(e,t,r){return wE({htu:AE(e),htm:t.toUpperCase(),jti:B()},r,{header:{jwk:await CE(r),typ:"dpop+jwt"},algorithm:"ES256"})}async function TE(e,t,r){return(await yy.JWK.createKey(e,t,r)).toJSON(!0)}async function PE(){return TE("EC","P-256",{alg:"ES256"})}async function FE(e){const t=await _E(e);if((void 0===(r=t).sub||"string"!=typeof r.sub||void 0===r.iss||"string"!=typeof r.iss||r.webid)&&"string"!=typeof r.webid)throw new Error(`Invalid ID token: ${JSON.stringify(t)} is missing 'sub' or 'iss' claims`);var r;if(t.webid)return t.webid;try{new URL(t.sub)}catch(n){throw new Error(`Cannot extract WebID from ID token: the ID token returned by [${t.iss}] has no 'webid' claim, nor an IRI-like 'sub' claim: [${t.sub}]. Attempting to construct a URL from the 'sub' claim threw: ${n}`)}return t.sub}async function kE(e,t,r,n){!function(e,t){if(t.grantType&&(!e.grantTypesSupported||!e.grantTypesSupported.includes(t.grantType)))throw new Error(`The issuer [${e.issuer}] does not support the [${t.grantType}] grant`);if(!e.tokenEndpoint)throw new Error(`This issuer [${e.issuer}] does not have a token endpoint`)}(e,r);const i={"content-type":"application/x-www-form-urlencoded"};let o;n&&(o=await PE(),i.DPoP=await IE(e.tokenEndpoint,"POST",o)),t.clientSecret&&(i.Authorization=`Basic ${btoa(`${t.clientId}:${t.clientSecret}`)}`);const a={method:"POST",headers:i,body:EE({grant_type:r.grantType,redirect_uri:r.redirectUrl,code:r.code,code_verifier:r.codeVerifier,client_id:t.clientId})},s=function(e,t){if(void 0===(r=e).access_token||"string"!=typeof r.access_token)throw new Error(`Invalid token endpoint response (missing the field 'access_token'): ${JSON.stringify(e)}`);var r;if(!function(e){return void 0!==e.id_token&&"string"==typeof e.id_token}(e))throw new Error(`Invalid token endpoint response (missing the field 'id_token'): ${JSON.stringify(e)}.`);if(!function(e){return void 0!==e.token_type&&"string"==typeof e.token_type}(e))throw new Error(`Invalid token endpoint response (missing the field 'token_type'): ${JSON.stringify(e)}`);if(!function(e){return void 0===e.expires_in||"number"==typeof e.expires_in}(e))throw new Error(`Invalid token endpoint response (invalid field 'expires_in'): ${JSON.stringify(e)}`);if(!t&&"bearer"!==e.token_type.toLowerCase())throw new Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${e.token_type}].`);return e}(await(await fetch(e.tokenEndpoint,a)).json(),n),u=await FE(s.id_token);return{accessToken:s.access_token,idToken:s.id_token,refreshToken:(c=s,void 0!==c.refresh_token&&"string"==typeof c.refresh_token?s.refresh_token:void 0),webId:u,dpopJwk:o,expiresIn:s.expires_in};var c}var RE=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",clearOidcPersistentStorage:async function(){const e=new Nr.OidcClient({response_mode:"query"});await e.clearStaleState(new Nr.WebStorageStateStore({}));const t=window.localStorage,r=[];for(let n=0;n<=t.length;n+=1){const e=t.key(n);e&&(e.match(/^oidc\..+$/)||e.match(/^solidClientAuthenticationUser:.+$/))&&r.push(e)}r.forEach((e=>t.removeItem(e)))},createDpopHeader:IE,decodeJwt:_E,generateJwkForDpop:PE,generateJwkRsa:async function(){return TE("RSA")},getBearerToken:async function(e){let t;try{t=await new Nr.OidcClient({response_mode:"query",loadUserInfo:!1}).processSigninResponse(e)}catch(n){throw new Error(`Problem handling Auth Code Grant (Flow) redirect - URL [${e}]: ${n}`)}const r=await FE(t.id_token);return{accessToken:t.access_token,idToken:t.id_token,webId:r,refreshToken:t.refresh_token}},getDpopToken:async function(e,t,r){return kE(e,t,r,!0)},privateJwkToPublicJwk:CE,registerClient:async function(e,t){var r;const n={client_name:e.clientName,application_type:"web",redirect_uris:[null===(r=e.redirectUrl)||void 0===r?void 0:r.toString()],subject_type:"pairwise",token_endpoint_auth_method:"client_secret_basic"};if(!t.registrationEndpoint)throw new Error("Dynamic Registration could not be completed because the issuer has no registration endpoint.");const i={"Content-Type":"application/json"};e.registrationAccessToken&&(i.Authorization=`Bearer ${e.registrationAccessToken}`);const o=await fetch(t.registrationEndpoint.toString(),{method:"POST",headers:i,body:JSON.stringify(n)});if(o.ok){const t=await o.json();return function(e,t){if(void 0===e.client_id)throw new Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(e)}`);if(t.redirectUrl&&(void 0===e.redirect_uris||e.redirect_uris[0]!==t.redirectUrl.toString()))throw new Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(e.redirect_uris)} don't match the provided ${JSON.stringify([t.redirectUrl.toString()])}`)}(t,e),{clientId:t.client_id,clientSecret:t.client_secret}}throw 400===o.status&&function(e,t){var r,n,i,o;if("invalid_redirect_uri"===e.error)throw new Error(`Dynamic client registration failed: the provided redirect uri [${null===(r=t.redirectUrl)||void 0===r?void 0:r.toString()}] is invalid - ${null!==(n=e.error_description)&&void 0!==n?n:""}`);if("invalid_client_metadata"===e.error)throw new Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(t)} is invalid - ${null!==(i=e.error_description)&&void 0!==i?i:""}`);throw new Error(`Dynamic client registration failed: ${e.error} - ${null!==(o=e.error_description)&&void 0!==o?o:""}`)}(await o.json(),e),new Error(`Dynamic client registration failed: the server returned ${o.status} ${o.statusText} - ${await o.text()}`)},removeOidcQueryParam:function(e){const t=new URL(e);return t.searchParams.delete("code"),t.searchParams.delete("state"),t.hash="",t.toString()},signJwt:wE,validateIdToken:async function(e,t,r,n){const i=t.keys[0],o=await yy.JWK.asKey(i);try{mE(e,o.toPEM(!1),{issuer:r,audience:n,algorithms:["ES256","RS256"]})}catch(Aw){return!1}return!0},CordovaIFrameNavigator:Nr.CordovaIFrameNavigator,CordovaPopupNavigator:Nr.CordovaPopupNavigator,InMemoryWebStorage:Nr.InMemoryWebStorage,Log:Nr.Log,OidcClient:Nr.OidcClient,SessionMonitor:Nr.SessionMonitor,User:Nr.User,UserManager:Nr.UserManager,Version:Nr.Version,WebStorageStateStore:Nr.WebStorageStateStore}),BE=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CURRENT_URL=t.KEY_CURRENT_SESSION=void 0,t.KEY_CURRENT_SESSION=`${Tr.SOLID_CLIENT_AUTHN_KEY_PREFIX}currentSession`,t.KEY_CURRENT_URL=`${Tr.SOLID_CLIENT_AUTHN_KEY_PREFIX}currentUrl`})),OE=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.appendToUrlPathname=void 0,t.appendToUrlPathname=function(e,t){const r=new URL(e),n=r.pathname;return r.pathname=`${n}${n.endsWith("/")?"":"/"}${t.startsWith("/")?t.substring(1):t}`,r.toString()}})),xE=u((function(e,t){var r,n=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},i=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.getJwks=t.WELL_KNOWN_OPENID_CONFIG=void 0,t.WELL_KNOWN_OPENID_CONFIG=".well-known/openid-configuration";const s={issuer:{toKey:"issuer",convertToUrl:!0},authorization_endpoint:{toKey:"authorizationEndpoint",convertToUrl:!0},token_endpoint:{toKey:"tokenEndpoint",convertToUrl:!0},userinfo_endpoint:{toKey:"userinfoEndpoint",convertToUrl:!0},jwks_uri:{toKey:"jwksUri",convertToUrl:!0},registration_endpoint:{toKey:"registrationEndpoint",convertToUrl:!0},scopes_supported:{toKey:"scopesSupported"},response_types_supported:{toKey:"responseTypesSupported"},response_modes_supported:{toKey:"responseModesSupported"},grant_types_supported:{toKey:"grantTypesSupported"},acr_values_supported:{toKey:"acrValuesSupported"},subject_types_supported:{toKey:"subjectTypesSupported"},id_token_signing_alg_values_supported:{toKey:"idTokenSigningAlgValuesSupported"},id_token_encryption_alg_values_supported:{toKey:"idTokenEncryptionAlgValuesSupported"},id_token_encryption_enc_values_supported:{toKey:"idTokenEncryptionEncValuesSupported"},userinfo_signing_alg_values_supported:{toKey:"userinfoSigningAlgValuesSupported"},userinfo_encryption_alg_values_supported:{toKey:"userinfoEncryptionAlgValuesSupported"},userinfo_encryption_enc_values_supported:{toKey:"userinfoEncryptionEncValuesSupported"},request_object_signing_alg_values_supported:{toKey:"requestObjectSigningAlgValuesSupported"},request_object_encryption_alg_values_supported:{toKey:"requestObjectEncryptionAlgValuesSupported"},request_object_encryption_enc_values_supported:{toKey:"requestObjectEncryptionEncValuesSupported"},token_endpoint_auth_methods_supported:{toKey:"tokenEndpointAuthMethodsSupported"},token_endpoint_auth_signing_alg_values_supported:{toKey:"tokenEndpointAuthSigningAlgValuesSupported"},display_values_supported:{toKey:"displayValuesSupported"},claim_types_supported:{toKey:"claimTypesSupported"},claims_supported:{toKey:"claimsSupported"},service_documentation:{toKey:"serviceDocumentation"},claims_locales_supported:{toKey:"claimsLocalesSupported"},ui_locales_supported:{toKey:"uiLocalesSupported"},claims_parameter_supported:{toKey:"claimsParameterSupported"},request_parameter_supported:{toKey:"requestParameterSupported"},request_uri_parameter_supported:{toKey:"requestUriParameterSupported"},require_request_uri_registration:{toKey:"requireRequestUriRegistration"},op_policy_uri:{toKey:"opPolicyUri",convertToUrl:!0},op_tos_uri:{toKey:"opTosUri",convertToUrl:!0}};t.getJwks=async function(e){return(await fetch(e.jwksUri)).json()};let u=r=class{constructor(e){this.storageUtility=e}static getLocalStorageKey(e){return`issuerConfig:${e}`}async fetchConfig(e){let n;const i=OE.appendToUrlPathname(e,t.WELL_KNOWN_OPENID_CONFIG),o=await window.fetch(i);try{n=function(e){const t={};return Object.keys(e).forEach((r=>{s[r]&&(t[s[r].toKey]=e[r])})),t}(await o.json())}catch(a){throw new Tr.ConfigurationError(`[${e.toString()}] has an invalid configuration: ${a.message}`)}return await this.storageUtility.set(r.getLocalStorageKey(e),JSON.stringify(n)),n}};u=r=n([Pr.injectable(),o(0,Pr.inject("storageUtility")),i("design:paramtypes",[Object])],u),t.default=u})),NE=s(RE),UE=u((function(e,t){var r=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},n=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchWithCookies=void 0;t.fetchWithCookies=(e,t)=>window.fetch(e,o(o({},t),{credentials:"include"}));let s=class{constructor(e,r,n,i,o){this.loginHandler=e,this.redirectHandler=r,this.logoutHandler=n,this.sessionInfoManager=i,this.issuerConfigFetcher=o,this.login=async(e,t)=>{var r,n,i;await this.sessionInfoManager.clear(e);const o=NE.removeOidcQueryParam(null!==(r=t.redirectUrl)&&void 0!==r?r:window.location.href);await this.loginHandler.handle({sessionId:e,oidcIssuer:t.oidcIssuer,redirectUrl:o,clientId:t.clientId,clientSecret:t.clientSecret,clientName:null!==(n=t.clientName)&&void 0!==n?n:t.clientId,popUp:t.popUp||!1,handleRedirect:t.handleRedirect,tokenType:null!==(i=t.tokenType)&&void 0!==i?i:"DPoP",prompt:t.prompt})},this.fetch=t.fetchWithCookies,this.logout=async e=>{await this.logoutHandler.handle(e),this.fetch=(e,t)=>window.fetch(e,t)},this.getSessionInfo=async e=>this.sessionInfoManager.get(e),this.getAllSessionInfo=async()=>this.sessionInfoManager.getAll(),this.validateCurrentSession=async()=>{const e=window.localStorage.getItem(BE.KEY_CURRENT_SESSION);if(null===e)return null;const t=await this.sessionInfoManager.get(e);if(void 0===t||void 0===t.idToken||void 0===t.clientAppId||void 0===t.issuer)return null;const r=await this.issuerConfigFetcher.fetchConfig(t.issuer);try{const e=await xE.getJwks(r);if(await NE.validateIdToken(t.idToken,e,t.issuer,t.clientAppId))return t}catch(Aw){}return null},this.handleIncomingRedirect=async e=>{const t=await this.redirectHandler.handle(e);this.fetch=t.fetch;const r=new URL(e);return r.searchParams.delete("state"),r.searchParams.delete("code"),r.searchParams.delete("id_token"),r.searchParams.delete("access_token"),window.history.replaceState(null,"",r.toString()),{isLoggedIn:t.isLoggedIn,webId:t.webId,sessionId:t.sessionId,expirationDate:t.expirationDate}}}};s=r([Pr.injectable(),i(0,Pr.inject("loginHandler")),i(1,Pr.inject("redirectHandler")),i(2,Pr.inject("logoutHandler")),i(3,Pr.inject("sessionInfoManager")),i(4,Pr.inject("issuerConfigFetcher")),n("design:paramtypes",[Object,Object,Object,Object,Object])],s),t.default=s})),jE=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},DE=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},LE=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};function ME(e){return"string"==typeof e.oidcIssuer}function KE(e){return"string"==typeof e.redirectUrl}let VE=class{constructor(e,t,r,n){this.storageUtility=e,this.oidcHandler=t,this.issuerConfigFetcher=r,this.clientRegistrar=n}async canHandle(e){return ME(e)&&KE(e)}async handle(e){if(!ME(e))throw new Tr.ConfigurationError(`OidcLoginHandler requires an OIDC issuer: missing property 'oidcIssuer' in ${JSON.stringify(e)}`);if(!KE(e))throw new Tr.ConfigurationError(`OidcLoginHandler requires a redirect URL: missing property 'redirectUrl' in ${JSON.stringify(e)}`);const t=await this.issuerConfigFetcher.fetchConfig(e.oidcIssuer);let r;e.clientId?(r={clientId:e.clientId,clientSecret:e.clientSecret,clientName:e.clientName},await this.storageUtility.setForUser(e.sessionId,{clientId:e.clientId}),e.clientSecret&&await this.storageUtility.setForUser(e.sessionId,{clientSecret:e.clientSecret}),e.clientName&&await this.storageUtility.setForUser(e.sessionId,{clientName:e.clientName})):r=await this.clientRegistrar.getClient({sessionId:e.sessionId,clientName:e.clientName,redirectUrl:e.redirectUrl},t);const n={issuer:t.issuer,dpop:"dpop"===e.tokenType.toLowerCase(),redirectUrl:e.redirectUrl,issuerConfiguration:t,client:r,sessionId:e.sessionId,handleRedirect:e.handleRedirect,prompt:e.prompt};return this.oidcHandler.handle(n)}};VE=jE([Pr.injectable(),LE(0,Pr.inject("storageUtility")),LE(1,Pr.inject("oidcHandler")),LE(2,Pr.inject("issuerConfigFetcher")),LE(3,Pr.inject("clientRegistrar")),DE("design:paramtypes",[Object,Object,Object,Object])],VE);var HE=VE,qE=Object.defineProperty({default:HE},"__esModule",{value:!0}),zE=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},$E=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},GE=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let WE=class extends Tr.AggregateHandler{constructor(e){super(e)}};WE=zE([Pr.injectable(),GE(0,Pr.injectAll("oidcHandlers")),$E("design:paramtypes",[Array])],WE);var JE=WE,QE=Object.defineProperty({default:JE},"__esModule",{value:!0});var YE=class{async canHandle(e){return!1}async handle(e){throw new Tr.NotImplementedError("AuthorizationCodeOidcHandler handle")}},XE=Object.defineProperty({default:YE},"__esModule",{value:!0}),ZE=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},eS=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},tS=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let rS=class{constructor(e,t){this.storageUtility=e,this.redirector=t}async canHandle(e){return!!(e.issuerConfiguration.grantTypesSupported&&e.issuerConfiguration.grantTypesSupported.indexOf("authorization_code")>-1)}async handle(e){const t={authority:e.issuer.toString(),client_id:e.client.clientId,client_secret:e.client.clientSecret,redirect_uri:e.redirectUrl.toString(),post_logout_redirect_uri:e.redirectUrl.toString(),response_type:"code",scope:"openid webid",filterProtocolClaims:!0,loadUserInfo:!1,code_verifier:!0,prompt:e.prompt},r=new NE.OidcClient(t),{redirector:n}=this,i=this.storageUtility;await r.createSigninRequest().then((t=>Promise.all([i.setForUser(t.state._id,{sessionId:e.sessionId}),i.setForUser(e.sessionId,{codeVerifier:t.state._code_verifier,issuer:e.issuer.toString(),redirectUrl:e.redirectUrl,dpop:e.dpop?"true":"false"})]).then((()=>{n.redirect(t.url.toString(),{handleRedirect:e.handleRedirect})})).catch((e=>{console.error(e)}))))}};rS=ZE([Pr.injectable(),tS(0,Pr.inject("storageUtility")),tS(1,Pr.inject("redirector")),eS("design:paramtypes",[Object,Object])],rS);var nS=rS,iS=Object.defineProperty({default:nS},"__esModule",{value:!0});var oS=class{async canHandle(e){return!1}async handle(e){throw new Tr.NotImplementedError("ClientCredentialsOidcHandler handle")}},aS=Object.defineProperty({default:oS},"__esModule",{value:!0});var sS=class{async canHandle(e){return!1}async handle(e){throw new Tr.NotImplementedError("PrimaryDeviceOidcHandler handle")}},uS=Object.defineProperty({default:sS},"__esModule",{value:!0});var cS=class{async canHandle(e){return!1}async handle(e){throw new Tr.NotImplementedError("SecondaryDeviceOidcHandler handle")}},lS=Object.defineProperty({default:cS},"__esModule",{value:!0});var fS=class{async canHandle(e){return!1}async handle(e){throw new Tr.NotImplementedError("RefreshTokenOidcHandler handle")}},hS=Object.defineProperty({default:fS},"__esModule",{value:!0}),pS=s(M),dS=u((function(e,t){var r=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},n=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};async function o(e,t){const r=await t.get("tmp-resource-server-session-info"),n=JSON.parse(null!=r?r:"{}"),{webId:i}=n;if(void 0!==i){const e=new URL(i).origin;await t.clearResourceServerSessionInfo(e)}await Promise.all([t.deleteAllUserData(e,{secure:!1}),t.deleteAllUserData(e,{secure:!0}),t.delete("clientKey",{secure:!1})]),await NE.clearOidcPersistentStorage()}Object.defineProperty(t,"__esModule",{value:!0}),t.SessionInfoManager=t.clear=t.getUnauthenticatedSession=void 0,t.getUnauthenticatedSession=function(){return{isLoggedIn:!1,sessionId:pS.v4(),fetch:UE.fetchWithCookies}},t.clear=o;let s=class{constructor(e){this.storageUtility=e}update(e,t){throw new Error("Not Implemented")}async get(e){const t=await this.storageUtility.getForUser(e,"isLoggedIn",{secure:!0}),r=await this.storageUtility.getForUser(e,"webId",{secure:!0}),n=await this.storageUtility.getForUser(e,"clientId",{secure:!1}),i=await this.storageUtility.getForUser(e,"clientSecret",{secure:!1}),o=await this.storageUtility.getForUser(e,"idToken",{secure:!1}),a=await this.storageUtility.getForUser(e,"redirectUrl",{secure:!1}),s=await this.storageUtility.getForUser(e,"refreshToken",{secure:!0}),u=await this.storageUtility.getForUser(e,"issuer",{secure:!1});if(void 0!==n||void 0!==o||void 0!==t||void 0!==r||void 0!==s)return{sessionId:e,webId:r,isLoggedIn:"true"===t,redirectUrl:a,idToken:o,refreshToken:s,issuer:u,clientAppId:n,clientAppSecret:i}}async getAll(){throw new Error("Not implemented")}async clear(e){return o(e,this.storageUtility)}async register(e){throw new Error("Not implemented")}async getRegisteredSessionIdAll(){throw new Error("Not implemented")}async clearAll(){throw new Error("Not implemented")}};s=r([Pr.injectable(),i(0,Pr.inject("storageUtility")),n("design:paramtypes",[Object])],s),t.SessionInfoManager=s})),gS=u((function(e,t){var r=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.FallbackRedirectHandler=void 0;let n=class{async canHandle(e){try{return new URL(e),!0}catch(Aw){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${Aw.toString()}`)}}async handle(e){return dS.getUnauthenticatedSession()}};n=r([Pr.injectable()],n),t.FallbackRedirectHandler=n})),yS=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},vS=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mS=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let bS=class{constructor(e){this.sessionInfoManager=e}async canHandle(){return!0}async handle(e){await this.sessionInfoManager.clear(e)}};bS=yS([Pr.injectable(),mS(0,Pr.inject("sessionInfoManager")),vS("design:paramtypes",[Object])],bS);var ES=bS,SS=Object.defineProperty({default:ES},"__esModule",{value:!0}),wS=u((function(e,t){async function r(e,t,r,n){var i;return o(o({},n),{headers:o(o({},null==n?void 0:n.headers),{Authorization:`DPoP ${t}`,DPoP:await NE.createDpopHeader(e,null!==(i=null==n?void 0:n.method)&&void 0!==i?i:"get",r)}),credentials:"include"})}Object.defineProperty(t,"__esModule",{value:!0}),t.buildDpopFetch=t.buildBearerFetch=void 0,t.buildBearerFetch=function(e,t){return(t,r)=>fetch(t,o(o({},r),{credentials:"include",headers:o(o({},null==r?void 0:r.headers),{Authorization:`Bearer ${e}`})}))},t.buildDpopFetch=async function(e,t,n){return async(t,i)=>{const o=await fetch(t,await r(t.toString(),e,n,i)),a=!o.ok&&(s=o.status,![401,403].includes(s));var s;const u=o.url!==t;return o.ok||a||!u?o:fetch(o.url,await r(o.url,e,n,i))}}})),_S=u((function(e,t){var r=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},n=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCodeRedirectHandler=t.DEFAULT_LIFESPAN=void 0,t.DEFAULT_LIFESPAN=18e5;let o=class{constructor(e,t,r,n){this.storageUtility=e,this.sessionInfoManager=t,this.issuerConfigFetcher=r,this.clientRegistrar=n}async canHandle(e){try{const t=new URL(e);return null!==t.searchParams.get("code")&&null!==t.searchParams.get("state")}catch(Aw){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${Aw.toString()}`)}}async handle(e){if(!(await this.canHandle(e)))throw new Error(`AuthCodeRedirectHandler cannot handle [${e}]: it is missing one of [code, state].`);const r=new URL(e),n=r.searchParams.get("state"),i=await this.storageUtility.getForUser(n,"sessionId",{errorIfNull:!0}),o="true"===await this.storageUtility.getForUser(i,"dpop"),a=await this.storageUtility.getForUser(i,"issuer",{errorIfNull:!0});window.localStorage.setItem(BE.KEY_CURRENT_SESSION,i);const s=await this.issuerConfigFetcher.fetchConfig(a),u=await this.clientRegistrar.getClient({sessionId:i},s);let c,l;const f=Date.now();if(o){const e=await this.storageUtility.getForUser(i,"codeVerifier",{errorIfNull:!0}),t=await this.storageUtility.getForUser(i,"redirectUrl",{errorIfNull:!0});c=await NE.getDpopToken(s,u,{grantType:"authorization_code",code:r.searchParams.get("code"),codeVerifier:e,redirectUrl:t}),l=await wS.buildDpopFetch(c.accessToken,c.refreshToken,c.dpopJwk)}else c=await NE.getBearerToken(r.toString()),l=wS.buildBearerFetch(c.accessToken,c.refreshToken);if(!(await async function(e,t,r,n){const i=await xE.getJwks(e);return NE.validateIdToken(n,i,r,t.clientId)}(s,u,a,c.idToken)))throw new Error(`Invalid ID token [${c.idToken}]. Possible issues are bad signature, or mismatching audience (expected [${u.clientId}])`);await this.storageUtility.setForUser(i,{refreshToken:"<Refresh token that *is* coming back in the redirect URL is not yet being parsed and provided by oidc-client-js in it's response object>",webId:c.webId,isLoggedIn:"true"},{secure:!0}),r.searchParams.delete("code"),await this.storageUtility.setForUser(i,{redirectUrl:r.toString(),idToken:c.idToken},{secure:!1});"false"===window.localStorage.getItem("tmp-resource-server-session-enabled")||await async function(e,r,n){const i=new URL(e).origin;await r(e);try{if(200===(await r(`${i}/session`)).status)return void(await n.storeResourceServerSessionInfo(e,i,Date.now()+t.DEFAULT_LIFESPAN));await n.clearResourceServerSessionInfo(i)}catch(o){await n.clearResourceServerSessionInfo(i)}}(c.webId,l,this.storageUtility);const h=await this.sessionInfoManager.get(i);if(!h)throw new Error(`Could not retrieve session: [${i}].`);return Object.assign(h,{fetch:l,expirationDate:"number"==typeof c.expiresIn?f+1e3*c.expiresIn:null})}};o=r([Pr.injectable(),i(0,Pr.inject("storageUtility")),i(1,Pr.inject("sessionInfoManager")),i(2,Pr.inject("issuerConfigFetcher")),i(3,Pr.inject("clientRegistrar")),n("design:paramtypes",[Object,Object,Object,Object])],o),t.AuthCodeRedirectHandler=o})),CS=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},AS=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},IS=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let TS=class extends Tr.AggregateHandler{constructor(e){super(e)}};TS=CS([Pr.injectable(),IS(0,Pr.injectAll("redirectHandlers")),AS("design:paramtypes",[Array])],TS);var PS=TS,FS=Object.defineProperty({default:PS},"__esModule",{value:!0});var kS=class{get storage(){return window.localStorage}async get(e){return this.storage.getItem(e)||void 0}async set(e,t){this.storage.setItem(e,t)}async delete(e){this.storage.removeItem(e)}},RS=Object.defineProperty({default:kS},"__esModule",{value:!0}),BS=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let OS=class{redirect(e,t){t&&t.handleRedirect?t.handleRedirect(e):t&&t.redirectByReplacingState?window.history.replaceState({},"",e):window.location.href=e}};OS=BS([Pr.injectable()],OS);var xS=OS,NS=Object.defineProperty({default:xS},"__esModule",{value:!0}),US=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},jS=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DS=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let LS=class{constructor(e,t){this.loginHandler=e,this.sessionCreator=t}async canHandle(e){return!(!e.popUp||!e.redirectUrl)}async handle(e){throw new Error("Popup login is not implemented yet")}};LS=US([Pr.injectable(),DS(0,Pr.inject("postPopUpLoginHandler")),DS(1,Pr.inject("sessionInfoManager")),jS("design:paramtypes",[Object,Object])],LS);var MS=LS,KS=Object.defineProperty({default:MS},"__esModule",{value:!0}),VS=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},HS=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},qS=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let zS=class extends Tr.AggregateHandler{constructor(e){super(e)}};zS=VS([Pr.injectable(),qS(0,Pr.injectAll("postPopUpLoginHandlers")),HS("design:paramtypes",[Array])],zS);var $S=zS,GS=Object.defineProperty({default:$S},"__esModule",{value:!0}),WS=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},JS=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},QS=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let YS=class{constructor(e){this.storageUtility=e}async getClient(e,t){var r;const[n,i]=await Promise.all([this.storageUtility.getForUser(e.sessionId,"clientId",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientSecret",{secure:!1})]);if(n)return{clientId:n,clientSecret:i};const a=o({},e);a.registrationAccessToken=null!==(r=a.registrationAccessToken)&&void 0!==r?r:await this.storageUtility.getForUser(e.sessionId,"registrationAccessToken");try{const e=await NE.registerClient(a,t),r={clientId:e.clientId};return e.clientSecret&&(r.clientSecret=e.clientSecret),await this.storageUtility.setForUser(a.sessionId,r,{secure:!1}),e}catch(s){throw new Error(`Client registration failed: [${s.toString()}]`)}}};YS=WS([Pr.injectable(),QS(0,Pr.inject("storageUtility")),JS("design:paramtypes",[Object])],YS);var XS=YS,ZS=Object.defineProperty({default:XS},"__esModule",{value:!0}),ew=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},tw=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},rw=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let nw=class{constructor(e,t){this.storageUtility=e,this.tokenRequester=t}async refresh(e){const t=await this.storageUtility.getForUser(e,"refreshToken",{errorIfNull:!0,secure:!0});await this.tokenRequester.request(e,{grant_type:"refresh_token",refresh_token:t})}};nw=ew([Pr.injectable(),rw(0,Pr.inject("storageUtility")),rw(1,Pr.inject("tokenRequester")),tw("design:paramtypes",[Object,Object])],nw);var iw=nw,ow=Object.defineProperty({default:iw},"__esModule",{value:!0}),aw=s(SE),sw=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},uw=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cw=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};const lw=(a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(aw);let fw=class{constructor(e,t,r){this.storageUtility=e,this.issuerConfigFetcher=t,this.clientRegistrar=r}async request(e,t){const[r]=await Promise.all([this.storageUtility.getForUser(e,"issuer",{errorIfNull:!0})]),n=await this.issuerConfigFetcher.fetchConfig(r),i=await this.clientRegistrar.getClient({sessionId:e},n);if(t.grant_type&&(!n.grantTypesSupported||!n.grantTypesSupported.includes(t.grant_type)))throw new Error(`The issuer [${r}] does not support the [${t.grant_type}] grant`);if(!n.tokenEndpoint)throw new Error(`This issuer [${r}] does not have a token endpoint`);const a=await NE.generateJwkForDpop(),s={method:"POST",headers:{DPoP:await NE.createDpopHeader(n.tokenEndpoint,"POST",a),"content-type":"application/x-www-form-urlencoded"},body:lw.default(o(o({},t),{client_id:i.clientId}))};var u;i.clientSecret&&(s.headers.Authorization=`Basic ${u=`${i.clientId}:${i.clientSecret}`,Buffer.from(u.toString(),"binary").toString("base64")}`);const c=await(await window.fetch(n.tokenEndpoint,s)).json();if(!(c&&c.access_token&&c.id_token&&"string"==typeof c.access_token&&"string"==typeof c.id_token)||c.refresh_token&&"string"!=typeof c.refresh_token)throw new Error("IDP token route returned an invalid response.");const l=await NE.decodeJwt(c.access_token);if(!l||!l.sub)throw new Error("The Authorization Server returned a bad token (i.e. when decoded we did not find the required 'sub' claim).");await this.storageUtility.setForUser(e,{accessToken:c.access_token,idToken:c.id_token,refreshToken:c.refresh_token,webId:l.sub,isLoggedIn:"true"},{secure:!0})}};fw=sw([Pr.injectable(),cw(0,Pr.inject("storageUtility")),cw(1,Pr.inject("issuerConfigFetcher")),cw(2,Pr.inject("clientRegistrar")),uw("design:paramtypes",[Object,Object,Object])],fw);var hw=fw,pw=Object.defineProperty({default:hw},"__esModule",{value:!0}),dw=u((function(e,t){var r=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},n=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionManager=void 0;let i=class extends ss.EventEmitter{constructor(e={}){super(),this.sessionRecords={},this.isInitialized=!1,this.handledIncomingRedirect=!1,this.clientAuthn=Sw.getClientAuthenticationWithDependencies({secureStorage:e.secureStorage,insecureStorage:e.insecureStorage})}async init(){this.isInitialized||(await this.handleIncomingRedirect(window.location.href),this.isInitialized=!0)}addNewSessionRecord(e){const t=()=>{this.emit("sessionLogout",e)};return e.onLogout(t),this.sessionRecords[e.info.sessionId]={session:e,logoutCallback:t},e}getSessionFromCurrentSessionInfo(e){const t=this.sessionRecords[e.sessionId];return t?(t.session.info.webId=e.webId,t.session.info.isLoggedIn=e.isLoggedIn,t.session):this.addNewSessionRecord(new ww.Session({clientAuthentication:this.clientAuthn,sessionInfo:e}))}async getSessions(){await this.init();return(await this.clientAuthn.getAllSessionInfo()).map((e=>this.getSessionFromCurrentSessionInfo(e)))}async getSession(e){let t;if(await this.init(),e){const r=await this.clientAuthn.getSessionInfo(e);t=r?this.getSessionFromCurrentSessionInfo(r):this.addNewSessionRecord(new ww.Session({clientAuthentication:this.clientAuthn},e))}else t=this.addNewSessionRecord(new ww.Session({clientAuthentication:this.clientAuthn}));return t}async hasSession(e){return await this.init(),void 0!==await this.clientAuthn.getSessionInfo(e)}onSessionLogin(e){this.on("sessionLogin",e)}onSessionLogout(e){this.on("sessionLogout",e)}detachSession(e){const t=this.sessionRecords[e];t&&(t.session.removeListener("onLogout",t.logoutCallback),delete this.sessionRecords[e])}async handleIncomingRedirect(e){const t=await this.clientAuthn.handleIncomingRedirect(e);if(t){const e=this.getSessionFromCurrentSessionInfo(t);return this.emit("sessionLogin",e),e.emit("login"),e}}};i=r([Pr.injectable(),n("design:paramtypes",[Object])],i),t.SessionManager=i})),gw=a&&a.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},yw=a&&a.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},vw=a&&a.__param||function(e,t){return function(r,n){t(r,n,e)}};let mw=class extends Tr.AggregateHandler{constructor(e){super(e)}};mw=gw([Pr.injectable(),vw(0,Pr.injectAll("loginHandlers")),yw("design:paramtypes",[Array])],mw);var bw=mw,Ew=Object.defineProperty({default:bw},"__esModule",{value:!0}),Sw=u((function(e,t){var r=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getClientAuthenticationWithDependencies=void 0;const n=r(xr),i=r(UE),o=r(qE),s=r(QE),u=r(XE),c=r(iS),l=r(aS),f=r(uS),h=r(lS),p=r(hS),d=r(xE),g=r(SS),y=r(FS),v=r(RS),m=r(NS),b=r(KS),E=r(GS),S=r(ZS),w=r(ow),_=r(pw),C=r(Ew),A=Pr.container;A.register("storageUtility",{useClass:n.default}),A.register("sessionInfoManager",{useClass:dS.SessionInfoManager}),A.register("sessionManager",{useClass:dw.SessionManager}),A.register("loginHandler",{useClass:C.default}),A.register("loginHandlers",{useClass:b.default}),A.register("loginHandlers",{useClass:o.default}),A.register("postPopUpLoginHandler",{useClass:E.default}),A.register("postPopUpLoginHandlers",{useClass:o.default}),A.register("oidcHandler",{useClass:s.default}),A.register("oidcHandlers",{useClass:p.default}),A.register("oidcHandlers",{useClass:u.default}),A.register("oidcHandlers",{useClass:c.default}),A.register("oidcHandlers",{useClass:l.default}),A.register("oidcHandlers",{useClass:f.default}),A.register("oidcHandlers",{useClass:h.default}),A.register("redirector",{useClass:m.default}),A.register("clientRegistrar",{useClass:S.default}),A.register("tokenRequester",{useClass:_.default}),A.register("redirectHandler",{useClass:y.default}),A.register("redirectHandlers",{useClass:_S.AuthCodeRedirectHandler}),A.register("redirectHandlers",{useClass:gS.FallbackRedirectHandler}),A.register("issuerConfigFetcher",{useClass:d.default}),A.register("tokenRefresher",{useClass:w.default}),A.register("logoutHandler",{useClass:g.default}),t.getClientAuthenticationWithDependencies=function(e){const t=e.secureStorage||new Tr.InMemoryStorage,r=e.insecureStorage||new v.default,n=A.createChildContainer();return n.register("secureStorage",{useValue:t}),n.register("insecureStorage",{useValue:r}),n.resolve(i.default)}})),ww=u((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;class r extends ss.EventEmitter{constructor(e={},t){super(),this.tokenRequestInProgress=!1,this.login=async e=>{await this.clientAuthentication.login(this.info.sessionId,o({},e))},this.fetch=async(e,t)=>this.clientAuthentication.fetch(e,t),this.logout=async()=>{await this.clientAuthentication.logout(this.info.sessionId),this.info.isLoggedIn=!1,this.emit("logout")},this.handleIncomingRedirect=async(e={})=>{var t;if(this.info.isLoggedIn)return this.info;if(this.tokenRequestInProgress)return;const r="string"==typeof e?{url:e}:e,n=null!==(t=r.url)&&void 0!==t?t:window.location.href;!1===r.useEssSession||!0===r.restorePreviousSession?window.localStorage.setItem("tmp-resource-server-session-enabled","false"):window.localStorage.setItem("tmp-resource-server-session-enabled","true");const i=window.localStorage.getItem("tmp-resource-server-session-info");if("string"==typeof i&&!0!==r.restorePreviousSession&&!1!==r.useEssSession){let e=function(e){var t;const r=Object.keys(null!==(t=e.sessions)&&void 0!==t?t:{});return"string"==typeof e.webId&&r.length>0&&"number"==typeof e.sessions[r[0]].expiration};const t=JSON.parse(i);if(e(t)){const e=Object.keys(t.sessions),r=new URL(t.webId).hostname,n=e.find((e=>new URL(e).hostname===r)),i=null!=n?n:e[0];if(t.sessions[i].expiration-Date.now()>3e5)return this.info.isLoggedIn=!0,this.info.webId=t.webId,this.info}}this.tokenRequestInProgress=!0;const o=await this.clientAuthentication.handleIncomingRedirect(n);if(null==o?void 0:o.isLoggedIn){this.info.isLoggedIn=o.isLoggedIn,this.info.webId=o.webId,this.info.sessionId=o.sessionId;const e=window.localStorage.getItem(BE.KEY_CURRENT_URL);null===e?this.emit("login"):(window.localStorage.removeItem(BE.KEY_CURRENT_URL),this.emit("sessionRestore",e)),"number"==typeof o.expirationDate&&setTimeout((async()=>{await this.logout()}),o.expirationDate-Date.now())}else if(!0===r.restorePreviousSession){const e=window.localStorage.getItem(BE.KEY_CURRENT_SESSION);null!==e&&await async function(e,t){const r=await t.validateCurrentSession();null!==r&&(window.localStorage.setItem(BE.KEY_CURRENT_URL,window.location.href),await t.login(e,{prompt:"none",oidcIssuer:r.issuer,redirectUrl:r.redirectUrl,clientId:r.clientAppId,clientSecret:r.clientAppSecret}))}(e,this.clientAuthentication)}return this.tokenRequestInProgress=!1,o},e.clientAuthentication?this.clientAuthentication=e.clientAuthentication:e.secureStorage&&e.insecureStorage?this.clientAuthentication=Sw.getClientAuthenticationWithDependencies({secureStorage:e.secureStorage,insecureStorage:e.insecureStorage}):this.clientAuthentication=Sw.getClientAuthenticationWithDependencies({}),e.sessionInfo?this.info={sessionId:e.sessionInfo.sessionId,isLoggedIn:!1,webId:e.sessionInfo.webId}:this.info={sessionId:null!=t?t:pS.v4(),isLoggedIn:!1}}onLogin(e){this.on("login",e)}onLogout(e){this.on("logout",e)}onSessionRestore(e){this.on("sessionRestore",e)}}t.Session=r})),_w=u((function(e,t){let r;function n(){return void 0===r&&(r=new ww.Session),r}Object.defineProperty(t,"__esModule",{value:!0}),t.onSessionRestore=t.onLogout=t.onLogin=t.handleIncomingRedirect=t.logout=t.login=t.fetch=t.getDefaultSession=void 0,t.getDefaultSession=n;t.fetch=(...e)=>n().fetch(...e);t.login=(...e)=>n().login(...e);t.logout=(...e)=>n().logout(...e);t.handleIncomingRedirect=(...e)=>n().handleIncomingRedirect(...e);t.onLogin=(...e)=>n().onLogin(...e);t.onLogout=(...e)=>n().onLogout(...e);t.onSessionRestore=(...e)=>n().onSessionRestore(...e)})),Cw=u((function(e,t){var r=a&&a.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=a&&a.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStorage=t.ConfigurationError=t.NotImplementedError=t.getClientAuthenticationWithDependencies=t.SessionManager=t.Session=void 0,Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return ww.Session}}),Object.defineProperty(t,"SessionManager",{enumerable:!0,get:function(){return dw.SessionManager}}),Object.defineProperty(t,"getClientAuthenticationWithDependencies",{enumerable:!0,get:function(){return Sw.getClientAuthenticationWithDependencies}}),n(_w,t),Object.defineProperty(t,"NotImplementedError",{enumerable:!0,get:function(){return Tr.NotImplementedError}}),Object.defineProperty(t,"ConfigurationError",{enumerable:!0,get:function(){return Tr.ConfigurationError}}),Object.defineProperty(t,"InMemoryStorage",{enumerable:!0,get:function(){return Tr.InMemoryStorage}})}));export{Cw as D};
